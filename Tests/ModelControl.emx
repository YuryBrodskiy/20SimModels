<?xml version="1.0" encoding="UTF-8"?>
<Document>
 <Model version="4.1" build="4.1.2.2">
  <Sidops><![CDATA[model 128 184
 description '<Description>
   <Version>4.1</Version>
<IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Z:\Users\yury\workspaces\Ubuntu_shared\ut_git\20SimModels\Tests\ModelControl.emx</LibraryPath>
  <TimeStamp>2011-10-14 17:05:00</TimeStamp>
</Description>';
 type Mainmodel
 end;
 implementation bg
  submodels
   Constant 744 368
    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Sources\Constant.emx</LibraryPath>
  <TimeStamp>2007-10-19 14:48:44</TimeStamp>
</Description>';
    type Constant
     ports
      signal out output [9,1];
    end;
    icon bg bottom
     figures
      rectangle 728.1 352 759.9 384 fill 15132390;
      line 732.9 363.6 754.9 363.6 color 16711680 width 2;
      line 730.2 374.7 755.9 374.7;
      line 732.5 358.7 732.5 377;
    end;
    implementation eq
parameters
	real C = 1.0;		// output value
equations
	output = C;
     implementation_end;
   Constant2 112 208
    description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\Constant.emx</LibraryPath>
 <TimeStamp>2007-10-19 14:48:44</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
    type Constant
     ports
      signal out setPoint [6,1];
    end;
    icon bg bottom
     figures
      rectangle 96.1 192 127.9 224 fill 15132390;
      line 100.9 203.6 122.9 203.6 color 16711680 width 2;
      line 98.2 214.7 123.9 214.7;
      line 100.5 198.7 100.5 217;
    end;
    implementation eq
parameters
	real C[6,6] = [
			0.0, 0.0, 1.0, 0.0, 0.0, 0.0;
			-0.1, -0.1, 0.4, -2.0, 1.3, 0.0;
			0.0, 0.2, 0.35, -3.0, 0.0, 1.0;
			0.2, 0.2, 0.35, -4.0, 1.0, 1.0;
			0.0, 0.2, 0.35, 0.0, 0.0, 0.0;
			0.0, 0.2, 0.35, 1.5, 0.0, 0.0];		// output value
variables
  integer	taskTime;
  integer TimePeriod;

equations


taskTime=800;
TimePeriod= time div taskTime+2;
if TimePeriod<=6 then
	setPoint = transpose(C[TimePeriod,1:6]);//+[0;sin(time)*0.1;0;0;0;0];
  else
	setPoint = transpose(C[1,1:6]);
end;

/*
variables
//	real Rz[3,3];
//	real Ry[3,3];
//	real Rx[3,3];
	real R[3,3];
	real qw,qx,qy,qz;
equations

/*	Rz=[cos(xyzrpy[5]), sin(xyzrpy[5]), 0; -sin(xyzrpy[5]), cos(xyzrpy[5]), 0; 0, 0, 1];
	Ry=[cos(xyzrpy[4]), 0, -sin(xyzrpy[4]); 0, 1, 0; sin(xyzrpy[4]), 0, cos(xyzrpy[4])];
	Rx=[1, 0, 0; 0, cos(xyzrpy[6]), sin(xyzrpy[6]); 0, -sin(xyzrpy[6]), cos(xyzrpy[6])];
	
output=homogeneous(Rx*Ry*Rz,xyzrpy[1:3]);*/

//Rodrigues formula
/*
qw = xyzQuart[7];
qx = xyzQuart[4];
qy = xyzQuart[5];
qz = xyzQuart[6];

R = [qw^2 + qx^2 - qy^2 - qz^2, 2*qx*qy - 2*qz*qw, 2*qx*qz + 2*qy*qw;
2*qx*qy + 2*qz*qw, qw^2 - qx^2 + qy^2 - qz^2, 2*qy*qz - 2*qx*qw;
2*qx*qz - 2*qy*qw,  2*qy*qz + 2*qx*qw, qw^2 - qx^2 - qy^2 + qz^2];


//	R = eye(3) + skew(xyzQuart[4:6])*sin(xyzQuart[7]) + skew(xyzQuart[4:6])*skew(xyzQuart[4:6])*(1-cos(xyzQuart[7]));
		

	output = homogeneous(R,xyzQuart[1:3]);
     */implementation_end;
   interaction_control 312 208
    description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
    type Submodel
     ports
      signal in measured_angles_arm [5,1];
      signal in xyzypr [6,1];
      rotation out bond_to_arm [5,1];
      signal in odometry_base [3,1];
      mechanical out bond_to_base [3,1];
    end;
    implementation bg
     submodels
      C 488 176
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type C
        ports
         power in p [8,1];
         signal in state [8,1];
        restrictions
         causality preferred out p;
       end;
       icon bg bottom
        figures
         text 'C' 488 176 18 bold;
       end;
       implementation eq
parameters
	real c[8] = [0.0;0;0;10;10;10;10;10];
variables
	 real x[8];
	real sub_state[3];
equations
    //state = int(p.f);
	sub_state=int(p.f[1:3]);
	x[1:3]=sub_state;
	x[4:8]=state[4:8];
	p.e=diag(c)*x;implementation_end;
      CalculateJ 384 136
       description '<Description>
   <Version>4.1</Version>
  <LibraryPath>CalculateYoubotJ.emx</LibraryPath>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <TimeStamp>2011-1-19 15:06:55</TimeStamp>
<AllowLibraryUpdate>False</AllowLibraryUpdate>
</Description>';
       type 'Submodel-Equation'
        ports
         signal in jointVelocities [8,1];
         signal out controllableJ [6,8];
         signal out Htip0 [4,4];
        parameters
         real InitialJointPos[5,1] = [1.0; 1.0; 1.0; 1.0; 1.0];
         real Linkdim[3,6] = [0.024, 0.033, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.096, 0.019, 0.155, 0.135, 0.096, 0.034];
         real InitialBasePos[4,4] = [1.0, 0.0, 0.0, 1.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];
       end;
       icon bg top
        figures
         rectangle 347 114 421 158 fill 11206627;
         text 'Calculate
YouBot J' 384 136 16;
       end;
       implementation eq
parameters
	real baseoffset[3]=[0.143;  0;  0.046]; //coordinates of joint_1 
constants
	
	real hidden vx[3] = [1;0;0];
	real hidden vy[3] = [0;1;0];
	real hidden omegaz[3] = [0;0;1];

	real hidden omega1[3] = [0;0;-1]; 
	real hidden omega2[3] = [0;1;0]; 
	real hidden omega3[3] = [0;1;0]; 
	real hidden omega4[3] = [0;1;0]; 
	real hidden omega5[3] = [0;0;-1];
	
variables
	real uTrzrefref[6];
	real uTryrefref[6];
	real uTrxrefref[6];
	real uTr1refref[6];
	real uTr211[6];	
	real uTr322[6];	
	real uTr433[6];
	real uTr544[6];


	real 					R1ref[3,3], 	R21[3,3], 	R32[3,3], 	R43[3,3], 	R54[3,3], 	Rtip5[3,3];
	real 					p1ref[3], 		p21[3], 		p32[3], 		p43[3], 		p54[3], 		ptip5[3];
	real 	Href0[4,4],	H1ref[4,4], 	H21[4,4], 	H32[4,4], 	H43[4,4], 	H54[4,4], 	Htip5[4,4];
	real 					H10[4,4],		H20[4,4],	H30[4,4],	H40[4,4],	H50[4,4];
	
	real base_offset_H[4,4];

	real q[8];
/*	real T[6];
	real tildeT[4,4];
	real dotH[4,4];*/
	real initialq[8];
real Rz[3,3];
/*
code

	T = [0;0;jointVelocities[1];jointVelocities[3];jointVelocities[2];0];	
	tildeT = tilde(T);
	dotH = Href0*tildeT;
	Href0 = int(dotH,InitialBasePos);
*/
initialequations
	initialq = [0;0;0;InitialJointPos[1];InitialJointPos[2];InitialJointPos[3];InitialJointPos[4];InitialJointPos[5]];
equations
	base_offset_H=homogeneous(eye(3),baseoffset);
	q =jointVelocities;// int(jointVelocities,initialq);
	Rz=[cos(q[1]), -sin(q[1]), 0; 
		sin(q[1]), cos(q[1]), 	0;
		 0, 					0, 					1];
Href0 =homogeneous(Rz,[q[2];q[3];0])*base_offset_H;
//Calculate relative positions of the joints
R1ref = [	cos(-q[4]),	-sin(-q[4]),	0;
			sin(-q[4]),	cos(-q[4]),	0;
			0,				0,				1];
p1ref = Linkdim[1:3,1];
H1ref = homogeneous(R1ref,p1ref);

R21 = [	cos(q[5]),	0,	sin(q[5]);
			0,				1,	0;
			-sin(q[5]),	0,	cos(q[5])];
p21 = Linkdim[1:3,2];
H21 = homogeneous(R21,p21);

R32 = [	cos(q[6]),	0,	sin(q[6]);
			0,				1,	0;
			-sin(q[6]),	0,	cos(q[6])];
p32 = Linkdim[1:3,3];
H32 = homogeneous(R32,p32);

R43 = [	cos(q[7]),	0,	sin(q[7]);
			0,				1,	0;
			-sin(q[7]),	0,	cos(q[7])];
p43 = Linkdim[1:3,4];
H43 = homogeneous(R43,p43);

R54 = [	cos(-q[8]),	-sin(-q[8]),	0;
			sin(-q[8]),	cos(-q[8]),	0;
			0,				0,				1];
p54 = Linkdim[1:3,5];
H54 = homogeneous(R54,p54);

Rtip5 = eye(3);
ptip5 = Linkdim[1:3,6];
Htip5 = homogeneous(Rtip5,ptip5);

//calculate position of the joints with respect to inertial frame

H10 = Href0 * H1ref;
H20 = H10 * H21;
H30 = H20 * H32;
H40 = H30 * H43;
H50 = H40 * H54;
Htip0 = H50 * Htip5;

uTrzrefref[1:3] = omegaz; 
uTrzrefref[4:6] = 0;
uTryrefref[1:3] = 0;
uTryrefref[4:6] = vy;
uTrxrefref[1:3] = 0;
uTrxrefref[4:6] = vx;
uTr1refref[1:3] = omega1;
uTr1refref[4:6] = skew(Linkdim[1:3,1])*omega1;
uTr211[1:3] = omega2;
uTr211[4:6] = skew(Linkdim[1:3,2])*omega2;
uTr322[1:3] = omega3;
uTr322[4:6] = skew(Linkdim[1:3,3])*omega3;
uTr433[1:3] = omega4;
uTr433[4:6] = skew(Linkdim[1:3,4])*omega4;
uTr544[1:3] = omega5;
uTr544[4:6] = skew(Linkdim[1:3,5])*omega5;

//Construct Geometric Jacobian

controllableJ[1:6,1] = Adjoint(Href0)*uTrzrefref;
controllableJ[1:6,2] = Adjoint(Href0)*uTryrefref;
controllableJ[1:6,3] = Adjoint(Href0)*uTrxrefref;

controllableJ[1:6,4] = Adjoint(Href0)*uTr1refref;
controllableJ[1:6,5] = Adjoint(H10)*uTr211;
controllableJ[1:6,6] = Adjoint(H20)*uTr322;
controllableJ[1:6,7] = Adjoint(H30)*uTr433;
controllableJ[1:6,8] = Adjoint(H40)*uTr544;



implementation_end;
      ControllableJ 384 248
       description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>GeometricJacobian.emx</LibraryPath>
 <TimeStamp>2010-11-23 11:48:09</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type MTF
        ports
         power out joints [8,1];
         power in tip [6,1];
         signal in controlledJ [6,8];
        restrictions
         causality fixed out joints;
         causality fixed in tip;
       end;
       icon bg bottom
        figures
         text 'MTF' 384 248 18 bold;
       end;
       implementation eq
equations
joints.e = transpose(controlledJ)*tip.e;
tip.f = controlledJ*joints.f;implementation_end;
      CtipControl 256 248
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type C
        ports
         power in p [6,1];
         signal out state [4,4];
         signal in Hvp0 [4,4];
         signal in Htip0 [4,4];
        restrictions
         causality preferred out p;
        parameters
         real CtipControl = 0.001;
       end;
       icon bg bottom
        figures
         text 'C' 256 248 18 bold;
       end;
       implementation eq
variables
	real theta;
	real omega[3];
	real Wr[6];
	real Wt[6];
	real temp;
	real stenght;
	real interesting optimizationCriteria;
equations
	state = inverse(Hvp0)*Htip0;

	temp = (trace(state[1:3,1:3])-1)/2;

	if (temp < -1) then temp = -1; end;
	if (temp > 1) then temp = 1; end;

	theta = arccos(temp);
	if(theta == 0) then
		omega = 0;
	else
	omega = (1/(2*sin(theta)))*[	state[3,2] - state[2,3];
											state[1,3] - state[3,1];
											state[2,1] - state[1,2]];
	end;

	Wt[1:3] = 0;
	Wt[4:6] = (state[1:3,4]*CtipControl);
	stenght=sqrt(transpose(Wt)*Wt);
	optimizationCriteria=int(transpose(state[1:3,4])*state[1:3,4]);
	Wr[1:3] = theta*omega*(CtipControl/15);
	Wr[4:6] = 0;
		
	p.e = inverse(transpose(Adjoint(Hvp0)))*(Wt+Wr );
	

	
				


implementation_end;
      DemuxHW1 800 248
       description '<Description>
 <Version>4.0</Version>
 <LibraryPath>Template\Submodel-Equation.emx</LibraryPath>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <TimeStamp>2007-11-1 22:32:1</TimeStamp>
 <AllowLibraryUpdate>False</AllowLibraryUpdate>
</Description>';
       type 'Submodel-Equation'
        ports
         power out base [3,1];
         power in control [8,1];
         power out arm [5,1];
        restrictions
         causality fixed out base;
         causality fixed out arm;
         causality fixed in control;
       end;
       implementation eq
/* Equation Submodel
Enter you equations here. You can use the Toolbar buttons at the left ( Add , f(x) etc. ).
*/
equations
  // start typing here
  	control.f[1:3] = base.f;
	control.f[4:8] = arm.f;

	base.e = control.e[1:3];
	arm.e = control.e[4:8];	
 implementation_end;
      EffortSensor1 672 248
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\EffortSensor.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:59:27</TimeStamp>
</Description>';
       knot EffortSensor
        ports
         power knot in p1 [8,1];
         rotation knot out p2 [8,1];
         signal knot out effort [8,1];
        restrictions
         causality constraint not_equal p1 p2;
       end;
       icon bg ellipse
        figures
         ellipse 665.1 242.3 678.9 256.4 fill 16777215;
         text 'e' 672.5 246.6;
       end;
       implementation eq
equations
	p2.e = p1.e;
	p1.f = p2.f;
	effort = p1.e;
implementation_end;
      filter 120 248
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type Gain
        ports
         signal in u [6,1];
         signal out y [6,1];
       end;
       icon bg bottom
        figures
         rectangle 104.1 232 135.9 264 fill 15132390;
         text 'K' 120 248 color 16711680 16 bold;
       end;
       implementation eq
// Created by C. Kleijn, 27 September 1999
parameters
    real BW  = 0.3;	// Bandwidth (Hz)
	real initPos[6]=[0;0;1;0;0;0];
variables
    real hidden s1y[6],s2y[6],BWrad;
equations
		BWrad = BW*2*3.1415926536;
    	s2y = BWrad^2*(u - y) - 1.4142*BWrad*s1y;
    	s1y = int(s2y);
   	y = int(s1y,initPos);         implementation_end;
      Gain 200 248
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:15:12</TimeStamp>
</Description>';
       type Gain
        ports
         signal in xyzrpy [6,1];
         signal out H [4,4];
       end;
       icon bg bottom
        figures
         rectangle 184.1 232 215.9 264 fill 15132390;
         text 'K' 200 248 color 16711680 16 bold;
       end;
       implementation eq
variables
	real Rz[3,3];
	real Ry[3,3];
	real Rx[3,3];
/*	real R[3,3];
	real qw,qx,qy,qz;*/
equations
	Rz=[cos(xyzrpy[4]), -sin(xyzrpy[4]), 0; 
		sin(xyzrpy[4]), cos(xyzrpy[4]), 	0;
		 0, 					0, 					1];

	Ry=[cos(xyzrpy[5]), 0, sin(xyzrpy[5]);
		 0, 1, 0;
		 -sin(xyzrpy[5]), 0, cos(xyzrpy[5])];




	Rx=[1, 0, 0;
	 0, cos(xyzrpy[6]), -sin(xyzrpy[6]);
	 0, sin(xyzrpy[6]), cos(xyzrpy[6])];
	
H=homogeneous(Rz*Ry*Rx,xyzrpy[1:3]);

//Rodrigues formula
/*
qw = xyzQuart[7];
qx = xyzQuart[4];
qy = xyzQuart[5];
qz = xyzQuart[6];

R = [qw^2 + qx^2 - qy^2 - qz^2, 2*qx*qy - 2*qz*qw, 2*qx*qz + 2*qy*qw;
2*qx*qy + 2*qz*qw, qw^2 - qx^2 + qy^2 - qz^2, 2*qy*qz - 2*qx*qw;
2*qx*qz - 2*qy*qw,  2*qy*qz + 2*qx*qw, qw^2 - qx^2 - qy^2 + qz^2];


//	R = eye(3) + skew(xyzQuart[4:6])*sin(xyzQuart[7]) + skew(xyzQuart[4:6])*skew(xyzQuart[4:6])*(1-cos(xyzQuart[7]));
		

	output = homogeneous(R,xyzQuart[1:3]);
     */implementation_end;
      GravityCompensation1 488 456
       description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>youBot_GravityCompensation.emx</LibraryPath>
  <TimeStamp>2011-1-21 10:13:56</TimeStamp>
</Description>';
       type Submodel
        ports
         power out joints [8,1];
         signal in jointPos [8,1];
        parameters
         real InitialJointPos[5,1] = [0.0; 0.0; 0.0; 0.0; 0.0];
         real LinkCOMdim[3,6] = [0.01489, 0.10453, 0.001, 0.011, 0.0, 0.0; 0.00213, 0.0017, 0.0967, 0.05103, 0.00115, 0.0; 0.00213, -0.00297, 0.02107, -0.02319, -0.01683, 0.001];
         real Linkdim[3,6] = [0.024, 0.033, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.096, 0.019, 0.155, 0.135, 0.096, 0.034];
         real Linkm[6,1] = [2.412; 1.155; 93.4; 0.877; 0.251; 0.12];
       end;
       icon bg bottom
        figures
         rectangle 433.5 417 542.5 495 fill 11206638;
         text '     youBot
     Gravity
Compensation' 486.5 457 16;
       end;
       implementation bg
        submodels
         Base 368 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Link_GravityCompensation.emx</LibraryPath>
  <TimeStamp>2011-1-19 11:37:47</TimeStamp>
<Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real m = 2.412;
            real COMdim[3,1] = [0.01489; 0.00213; 0.00213];
            real dim[3,1] = [0.024; 0.0; 0.096];
          end;
          icon bg bottom
           figures
            rectangle 336 432 400 576 fill 10025880;
            text 'Link
GC' 368 504;
           terminals
            p 336 464 fixed;
            Hin 336 544 fixed;
            p1 400 464 fixed;
            Hout 400 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.01489; 0.00213; 0.00213];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 2.412;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.024; 0.0; 0.096];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            plug Hin 592 496;
            plug p1 904 304;
            plug Hout 896 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 416 376;
          implementation_end;
         Hfloor0 272 544
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\Constant.emx</LibraryPath>
 <TimeStamp>2007-10-19 14:48:44</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Constant
           ports
            signal out output [4,4];
          end;
          icon bg bottom
           figures
            rectangle 256.1 528 287.9 560 fill 15132390;
            line 260.9 539.6 282.9 539.6 color 16711680 width 2;
            line 258.2 550.7 283.9 550.7;
            line 260.5 534.7 260.5 553;
          end;
          implementation eq
equations
	output = eye(4);
     implementation_end;
         Htip0 1248 544
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\SignalMonitor.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:14:4</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type SignalMonitor
           ports
            signal in input [4,4];
          end;
          icon bg bottom
           figures
            rectangle 1232 528 1264 560 fill 15132390;
            rectangle 1237.7 533.8 1258.3 554.6 color 16711680 fill 11776947 width 2;
            rectangle 1239.8 536.4 1255.9 552 color -1 fill 16777215;
            line 1241.9 538.7 1241.9 550 fill 16777215;
            line 1240 548.4 1252.5 548.4 fill 16777215;
            line 1241.5 548.1 1254.4 541.7 color 255 fill 16777215;
          end;
          implementation eq

   implementation_end;
         Joint12 608.2 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Joint-roty_GravityCompensation.emx</LibraryPath>
  <TimeStamp>2011-1-19 11:38:03</TimeStamp>
</Description>';
          type 'Submodel-roty'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
            signal in angle;
           parameters
            real InitialPos = 0.0;
          end;
          icon bg bottom
           figures
            rectangle 576.4 432 639.9 576 fill 14745599;
            text 'Joint-roty
   GC' 608.4 507 fill 14745599;
           terminals
            p 575.9 464 fixed;
            p1 607.4 432 fixed;
            p2 639.9 464 fixed;
            Hin 575.9 544 fixed;
            Hout 639.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = input;//int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 496
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 480 335.9 512 fill 15132390;
               text 'X' 320 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 56;
            plug p2 496 424;
            plug Hin 112 496;
            plug Hout 504 496;
            plug angle 320 208;
            plug p 112 424;
            OneJunction 240 272
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 272 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Tbai 240 384
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg left
              figures
               text '1' 240 384 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            uTbai 240 328
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'TF' 240 328 18 bold;
             end;
             implementation eq
equations
	p2.f = [0;p1.f;0;0;0;0];
	p1.e = p2.e[2];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            p1 => ZeroJunction\p;
            uTbai\p2 => Tbai\p;
            Tbai\p => Wbai\p;
            p <= Wbai\p;
            ZeroJunction\p => OneJunction\p;
            OneJunction\p => uTbai\p1;
            Wbai\p <= AdHji\p1;
            p2 => AdHji\p2;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            Splitter2\output -> AdHji\H 424 368;
            angle -> Integrate\input;
           end;
           parameterrelations
Integrate\init = InitialPos;parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
          implementation_end;
         Joint23 768.2 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-roty_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:38:03</TimeStamp>
</Description>';
          type 'Submodel-roty'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
            signal in angle;
           parameters
            real InitialPos = 0.0;
          end;
          icon bg bottom
           figures
            rectangle 736.4 432 799.9 576 fill 14745599;
            text 'Joint-roty
   GC' 768.4 507 fill 14745599;
           terminals
            p 735.9 464 fixed;
            p1 767.4 432 fixed;
            p2 799.9 464 fixed;
            Hin 735.9 544 fixed;
            Hout 799.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = input;//int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 496
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 480 335.9 512 fill 15132390;
               text 'X' 320 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 56;
            plug p2 496 424;
            plug Hin 112 496;
            plug Hout 504 496;
            plug angle 352 216;
            plug p 112 424;
            OneJunction 240 272
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 272 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Tbai 240 384
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg left
              figures
               text '1' 240 384 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            uTbai 240 328
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'TF' 240 328 18 bold;
             end;
             implementation eq
equations
	p2.f = [0;p1.f;0;0;0;0];
	p1.e = p2.e[2];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            p1 => ZeroJunction\p;
            uTbai\p2 => Tbai\p;
            Tbai\p => Wbai\p;
            p <= Wbai\p;
            ZeroJunction\p => OneJunction\p;
            OneJunction\p => uTbai\p1;
            Wbai\p <= AdHji\p1;
            p2 => AdHji\p2;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            Splitter2\output -> AdHji\H 424 368;
            angle -> Integrate\input;
           end;
           parameterrelations
Integrate\init = InitialPos;parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
          implementation_end;
         Joint34 928.2 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-roty_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:38:03</TimeStamp>
</Description>';
          type 'Submodel-roty'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
            signal in angle;
           parameters
            real InitialPos = 0.0;
          end;
          icon bg bottom
           figures
            rectangle 896.4 432 959.9 576 fill 14745599;
            text 'Joint-roty
   GC' 928.4 507 fill 14745599;
           terminals
            p 895.9 464 fixed;
            p1 927.4 432 fixed;
            p2 959.9 464 fixed;
            Hin 895.9 544 fixed;
            Hout 959.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = input;//int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 496
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 480 335.9 512 fill 15132390;
               text 'X' 320 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 56;
            plug p2 496 424;
            plug Hin 112 496;
            plug Hout 504 496;
            plug angle 336 216;
            plug p 112 424;
            OneJunction 240 272
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 272 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Tbai 240 384
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg left
              figures
               text '1' 240 384 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            uTbai 240 328
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'TF' 240 328 18 bold;
             end;
             implementation eq
equations
	p2.f = [0;p1.f;0;0;0;0];
	p1.e = p2.e[2];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            p1 => ZeroJunction\p;
            uTbai\p2 => Tbai\p;
            Tbai\p => Wbai\p;
            p <= Wbai\p;
            ZeroJunction\p => OneJunction\p;
            OneJunction\p => uTbai\p1;
            Wbai\p <= AdHji\p1;
            p2 => AdHji\p2;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            angle -> Integrate\input;
            Splitter2\output -> AdHji\H 424 368;
           end;
           parameterrelations
Integrate\init = InitialPos;parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
          implementation_end;
         Joint45 1088.2 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-rotz_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:37:54</TimeStamp>
</Description>';
          type 'Submodel-rotz'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
            signal in angle;
           parameters
            real InitialPos = 0.0;
          end;
          icon bg bottom
           figures
            rectangle 1056.4 432 1119.9 576 fill 14745599;
            text 'Joint-rotz
   GC' 1088.4 507 fill 14745599;
           terminals
            p 1055.9 464 fixed;
            p1 1087.4 432 fixed;
            p2 1119.9 464 fixed;
            Hin 1055.9 544 fixed;
            Hout 1119.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            Integrate 320 288
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 272 336 304 fill 15132390;
               text 'ò' 320 285.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = input;//int(input,init);
R = [	cos(-q),	-sin(-q),	0;
			sin(-q),	cos(-q),	0;
			0,				0,				1];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 576
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 560 335.9 592 fill 15132390;
               text 'X' 320 576 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 40;
            plug p2 496 424;
            plug Hin 112 576;
            plug Hout 504 576;
            plug angle 336 184;
            plug p 112 424;
            OneJunction 240 288
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 288 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            uTbai 240 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
               causality fixed out p1;
               causality fixed in p2;
             end;
             icon bg left
              figures
               text 'TF' 240 336 18 bold;
             end;
             implementation eq
equations
	p1.e = p2.e[3];
	p2.f = [0;0;p1.f;0;0;0];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            uTbai\p1 <= OneJunction\p;
            Wbai\p <= AdHji\p1;
            p2 => AdHji\p2;
            ZeroJunction\p => OneJunction\p;
            p1 => ZeroJunction\p;
            uTbai\p2 => Wbai\p;
            p <= Wbai\p;
            Splitter2\output -> AdHji\H 424 368;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            angle -> Integrate\input;
           end;
           parameterrelations
Integrate\init = InitialPos;

parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 680 488;
          implementation_end;
         JointBase1 448.2 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Joint-rotz_GravityCompensation.emx</LibraryPath>
  <TimeStamp>2011-1-21 10:09:48</TimeStamp>
</Description>';
          type 'Submodel-rotz'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
            signal in angle;
           parameters
            real InitialPos = 0.0;
          end;
          icon bg bottom
           figures
            rectangle 416.4 432 479.9 576 fill 14745599;
            text 'Joint-rotz
   GC' 448.4 507 fill 14745599;
           terminals
            p 415.9 464 fixed;
            p1 447.4 432 fixed;
            p2 479.9 464 fixed;
            Hin 415.9 544 fixed;
            Hout 479.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            Integrate 320 288
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 272 336 304 fill 15132390;
               text 'ò' 320 285.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = input;//int(input,init);
R = [	cos(-q),	-sin(-q),	0;
			sin(-q),	cos(-q),	0;
			0,				0,				1];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 576
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 560 335.9 592 fill 15132390;
               text 'X' 320 576 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 40;
            plug p2 496 424;
            plug Hin 112 576;
            plug Hout 504 576;
            plug angle 320 216;
            plug p 112 424;
            OneJunction 240 288
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 288 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            uTbai 240 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
               causality fixed out p1;
               causality fixed in p2;
             end;
             icon bg left
              figures
               text 'TF' 240 336 18 bold;
             end;
             implementation eq
equations
	p1.e = p2.e[3];
	p2.f = [0;0;p1.f;0;0;0];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            uTbai\p1 <= OneJunction\p;
            Wbai\p <= AdHji\p1;
            p2 => AdHji\p2;
            ZeroJunction\p => OneJunction\p;
            p1 => ZeroJunction\p;
            uTbai\p2 => Wbai\p;
            p <= Wbai\p;
            Splitter2\output -> AdHji\H 424 368;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            angle -> Integrate\input;
           end;
           parameterrelations
Integrate\init = InitialPos;

parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 680 488;
          implementation_end;
         Link1 528 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:37:47</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real m = 1.155;
            real COMdim[3,1] = [0.10453; 0.0017; -0.00297];
            real dim[3,1] = [0.033; 0.0; 0.019];
          end;
          icon bg bottom
           figures
            rectangle 496 432 560 576 fill 10025880;
            text 'Link
GC' 528 504;
           terminals
            p 496 464 fixed;
            Hin 496 544 fixed;
            p1 560 464 fixed;
            Hout 560 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.10453; 0.0017; -0.00297];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.155;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.033; 0.0; 0.019];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            plug Hin 592 496;
            plug p1 904 304;
            plug Hout 896 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 416 376;
          implementation_end;
         Link2 688 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:37:47</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real m = 93.4;
            real COMdim[3,1] = [0.001; 0.0967; 0.02107];
            real dim[3,1] = [0.0; 0.0; 0.155];
          end;
          icon bg bottom
           figures
            rectangle 656 432 720 576 fill 10025880;
            text 'Link
GC' 688 504;
           terminals
            p 656 464 fixed;
            Hin 656 544 fixed;
            p1 720 464 fixed;
            Hout 720 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.001; 0.0967; 0.02107];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 93.4;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.155];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            plug Hin 592 496;
            plug p1 904 304;
            plug Hout 896 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 416 376;
          implementation_end;
         Link3 848 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:37:47</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real m = 0.877;
            real COMdim[3,1] = [0.011; 0.05103; -0.02319];
            real dim[3,1] = [0.0; 0.0; 0.135];
          end;
          icon bg bottom
           figures
            rectangle 816 432 880 576 fill 10025880;
            text 'Link
GC' 848 504;
           terminals
            p 816 464 fixed;
            Hin 816 544 fixed;
            p1 880 464 fixed;
            Hout 880 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.011; 0.05103; -0.02319];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 0.877;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.135];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            plug Hin 592 496;
            plug p1 904 304;
            plug Hout 896 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 416 376;
          implementation_end;
         Link4 1008 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:37:47</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real m = 0.251;
            real COMdim[3,1] = [0.0; 0.00115; -0.01683];
            real dim[3,1] = [0.0; 0.0; 0.096];
          end;
          icon bg bottom
           figures
            rectangle 976 432 1040 576 fill 10025880;
            text 'Link
GC' 1008 504;
           terminals
            p 976 464 fixed;
            Hin 976 544 fixed;
            p1 1040 464 fixed;
            Hout 1040 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.00115; -0.01683];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 0.251;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.096];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            plug Hin 592 496;
            plug p1 904 304;
            plug Hout 896 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 416 376;
          implementation_end;
         Link5 1168 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:37:47</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real m = 0.12;
            real COMdim[3,1] = [0.0; 0.0; 0.001];
            real dim[3,1] = [0.0; 0.0; 0.034];
          end;
          icon bg bottom
           figures
            rectangle 1136 432 1200 576 fill 10025880;
            text 'Link
GC' 1168 504;
           terminals
            p 1136 464 fixed;
            Hin 1136 544 fixed;
            p1 1200 464 fixed;
            Hout 1200 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.001];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 0.12;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.034];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            plug Hin 592 496;
            plug p1 904 304;
            plug Hout 896 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 416 376;
          implementation_end;
         Mux 696 193
          description '<Description>
 <Version>4.0</Version>
 <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:32:54</TimeStamp>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Submodel
           ports
            power out port [8,1];
            power out port5;
            power out port6;
            power out port7;
            power out port8;
            power out port9;
           restrictions
            causality fixed in port8;
            causality fixed in port9;
            causality fixed in port5;
            causality fixed in port6;
            causality fixed in port7;
            causality fixed out port;
          end;
          icon bg
           figures
            rectangle 616 178 776 208 fill 14013909;
            text 'Mux' 696 192 16;
           terminals
            port 696 176 fixed;
            port5 696 208 fixed;
            port6 712 208 fixed;
            port7 728 208 fixed;
            port8 744 208 fixed;
            port9 760 208 fixed;
          end;
          implementation eq
parameters
	real calibartion=1;
equations
	port.e[1] = 0;
	port.e[2] = 0;
	port.e[3] = 0;
	port.e[4] = port5.e*calibartion;
	port.e[5] = port6.e*calibartion;
	port.e[6] = port7.e*calibartion;
	port.e[7] = port8.e*calibartion;
	port.e[8] = port9.e*calibartion;
	
	port5.f = port.f[4];
	port6.f = port.f[5];
	port7.f = port.f[6];
	port8.f = port.f[7];
	port9.f = port.f[8];implementation_end;
         plug jointPos 200 160;
         plug joints 696 120;
         Submodel13 336 128
          description '<Description>
 <Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:32:54</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          type Submodel
           ports
            signal in jointPos [8,1];
            signal out port1;
            signal out port2;
            signal out port3;
            signal out port4;
            signal out port5;
          end;
          implementation eq

equations
port1=jointPos[4];
port2=jointPos[5];
port3=jointPos[6];
port4=jointPos[7];
port5=jointPos[8];implementation_end;
         Wtip0 1240 464
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Se
           ports
            power out p [6,1];
           restrictions
            causality fixed out p;
          end;
          icon bg bottom
           figures
            text 'Se' 1240 464 18 bold;
          end;
          implementation eq
parameters
	real effort = 0;
variables
	real flow[6];
equations
	p.e = effort;
	flow = p.f;
implementation_end;
         ZeroJunction 272 464
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out effort [6,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg
           figures
            text '0' 272 464 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
        end;
        connections
         Base\p => ZeroJunction\p;
         Joint34\p => Link3\p1;
         Link4\p => Joint34\p2;
         Joint45\p => Link4\p1;
         joints <= Mux\port;
         Link5\p => Joint45\p2;
         JointBase1\p1 <= Mux\port5 448 304 696 304;
         Joint12\p1 <= Mux\port6 608 320 712 320;
         JointBase1\p => Base\p1;
         Wtip0\p => Link5\p1;
         Mux\port7 => Joint23\p1 728 256 768 256;
         Mux\port8 => Joint34\p1 744 240 928 240;
         Mux\port9 => Joint45\p1 760 224 1088 224;
         JointBase1\p2 <= Link1\p;
         Joint12\p => Link1\p1;
         Joint12\p2 <= Link2\p;
         Joint23\p => Link2\p1;
         Joint23\p2 <= Link3\p;
         Hfloor0\output -> Base\Hin;
         Submodel13\port4 -> Joint34\angle;
         Submodel13\port5 -> Joint45\angle;
         Joint34\Hout -> Link4\Hin;
         Joint34\Hin <- Link3\Hout;
         Link3\Hin <- Joint23\Hout;
         Link2\Hout -> Joint23\Hin;
         Link2\Hin <- Joint12\Hout;
         Joint12\Hin <- Link1\Hout;
         Base\Hout -> JointBase1\Hin;
         Htip0\input <- Link5\Hout;
         Link1\Hin <- JointBase1\Hout;
         Joint45\Hout -> Link5\Hin;
         Joint45\Hin <- Link4\Hout;
         jointPos -> Submodel13\jointPos;
         Submodel13\port1 -> JointBase1\angle;
         Submodel13\port2 -> Joint12\angle;
         Submodel13\port3 -> Joint23\angle;
        end;
        parameterrelations
Base\m = Linkm[1];
Base\COMdim = LinkCOMdim[1:3,1];
Base\dim = Linkdim[1:3,1];

Link1\m = Linkm[2];
Link1\COMdim = LinkCOMdim[1:3,2];
Link1\dim = Linkdim[1:3,2];

Link2\m = Linkm[3];
Link2\COMdim = LinkCOMdim[1:3,3];
Link2\dim = Linkdim[1:3,3];

Link3\m = Linkm[4];
Link3\COMdim = LinkCOMdim[1:3,4];
Link3\dim = Linkdim[1:3,4];

Link4\m = Linkm[5];
Link4\COMdim = LinkCOMdim[1:3,5];
Link4\dim = Linkdim[1:3,5];

Link5\m = Linkm[6];
Link5\COMdim = LinkCOMdim[1:3,6];
Link5\dim = Linkdim[1:3,6];

JointBase1\InitialPos = InitialJointPos[1];

Joint12\InitialPos = InitialJointPos[2];

Joint23\InitialPos = InitialJointPos[3];

Joint34\InitialPos = InitialJointPos[4];

Joint45\InitialPos = InitialJointPos[5];

parameterrelations_end;
       implementation_end;
      JointSoftLimits 560 304
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type C
        ports
         power in p [8,1];
         signal in state [8,1];
        restrictions
         causality preferred out p;
        parameters
         real CendstopAvoidanceControl = 50.0;
         real dangerzone = 0.05 {rad};
         real InitialJointPos[5,1] = [0.0; 0.0; 0.0; 0.0; 0.0];
         real MaxEndstopPos[5,1] = [2.95; 1.5; 2.55; 1.79; 2.92];
         real MinEndstopPos[5,1] = [-2.95; -1.05; -2.64; -1.79; -2.92];
       end;
       icon bg bottom
        figures
         text 'C' 560 304 18 bold;
       end;
       implementation eq
parameters
 real forceMap[8]= [0;0;0;-1.0;-1.0;-1.0;-1.0;-1.0];

variables

	real K[8,8];
	real ks[8];
	real posdangerzones[8];
	real negdangerzones[8];
	real tempstate[8];
code
  
	tempstate = state;

	posdangerzones = [
		0;
		0;
		0;
		MaxEndstopPos[1]-dangerzone;
		MaxEndstopPos[2]-dangerzone;
		MaxEndstopPos[3]-dangerzone;
		MaxEndstopPos[4]-dangerzone;
		MaxEndstopPos[5]-dangerzone
	];

	negdangerzones = [
		0;
		0;
		0;
		MinEndstopPos[1]+dangerzone;
		MinEndstopPos[2]+dangerzone;
		MinEndstopPos[3]+dangerzone;
		MinEndstopPos[4]+dangerzone;
		MinEndstopPos[5]+dangerzone
	];

	ks[1] = 0;
	ks[2] = 0;
	ks[3] = 0;
	
	if (state[4] > posdangerzones[4]) then
		ks[4] = CendstopAvoidanceControl;
		tempstate[4] = (posdangerzones[4]-state[4]);
	else 
		if (state[4] < negdangerzones[4]) then
			ks[4] = CendstopAvoidanceControl;
			tempstate[4] = (negdangerzones[4]-state[4]);
		else
			ks[4] = 0;
		end;
	end;

	if (state[5] > posdangerzones[5]) then
		ks[5] = CendstopAvoidanceControl;
		tempstate[5] = (posdangerzones[5]-state[5]);
	else 
		if (state[5] < negdangerzones[5]) then
			ks[5] = CendstopAvoidanceControl;
			tempstate[5] = (negdangerzones[5]-state[5]);
		else
			ks[5] = 0;
		end;
	end;

	if (state[6] > posdangerzones[6]) then
		ks[6] = CendstopAvoidanceControl;
		tempstate[6] = (posdangerzones[6]-state[6]);
	else 
		if (state[6] < negdangerzones[6]) then
			ks[6] = CendstopAvoidanceControl;
			tempstate[6] = (negdangerzones[6]-state[6]);
		else
			ks[6] = 0;
		end;
	end;

	if (state[7] > posdangerzones[7]) then
		ks[7] = CendstopAvoidanceControl;
		tempstate[7] = (posdangerzones[7]-state[7]);
	else 
		if (state[7] < negdangerzones[7]) then
			ks[7] = CendstopAvoidanceControl;
			tempstate[7] = (negdangerzones[7]-state[7]);
		else
			ks[7] = 0;
		end;
	end;

	if (state[8] > posdangerzones[8]) then
		ks[8] = CendstopAvoidanceControl;
		tempstate[8] = (posdangerzones[8]-state[8]);
	else 
		if (state[8] < negdangerzones[8]) then
			ks[8] = CendstopAvoidanceControl;
			tempstate[8] = (negdangerzones[8]-state[8]);
		else
			ks[8] = 0;
		end;
	end;
	K = diag(ks);
   p.e = diag(forceMap)*K*tempstate;
implementation_end;
      MuxToControl1 680 64
       description '<Description>
 <Version>4.0</Version>
 <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:32:54</TimeStamp>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type Submodel
        ports
         signal out control [8,1];
         signal in arm [5,1];
         signal in base [3,1];
       end;
       implementation eq
parameters
	real zero_angles[5]=[169.0;65.0;-146.0;102.5;167.5];
equations
control[4:8]=arm-zero_angles*pi/180;
control[1:3]=base;implementation_end;
      plug odometry_base 840 64;
      plug bond_to_arm 1000 272;
      plug xyzypr 32 248;
      plug measured_angles_arm 848 112;
      plug bond_to_base 1008 184;
      OneJunction 320 248
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none p [6,1];
         signal knot out flow [6,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 320 248 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
      OneJunction1 488 344
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none p [8,1];
         signal knot out flow [8,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 488 344 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
      OneJunction2 488 248
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none p [8,1];
         signal knot out flow [8,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 488 248 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
      R 424 304
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\3D\R-3.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:11:54</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type 'R-3'
        ports
         power in p [8,1];
       end;
       icon bg bottom
        figures
         text 'R' 424 304 18 bold;
       end;
       implementation eq
parameters
	real r[8]= [10;10;10;10;10;10;10;10];
variables
	real R[8,8] ;
equations
	R=diag(r);					
	p.e = R * p.f;
implementation_end;
      Splitter1 552 176
       description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       knot Splitter
        ports
         signal knot duplicatable out output [8,1];
         signal knot in input [8,1];
       end;
       icon bg ellipse
        figures
         ellipse 548.8 172.8 555.2 179.2 color -1 fill 0;
         ellipse 547.7 171.7 556.3 180.3 color -1;
        terminals
         input 552 176 fixed;
       end;
       implementation eq
equations
    collect (output) = input;
implementation_end;
     end;
     connections
      OneJunction\p => CtipControl\p;
      ControllableJ\joints => OneJunction2\p;
      C\p <= OneJunction2\p;
      OneJunction2\p => EffortSensor1\p1;
      OneJunction2\p => JointSoftLimits\p;
      OneJunction2\p => R\p;
      bond_to_base <= DemuxHW1\base;
      DemuxHW1\arm => bond_to_arm;
      OneJunction1\p => OneJunction2\p;
      GravityCompensation1\joints => OneJunction1\p;
      EffortSensor1\p2 => DemuxHW1\control;
      OneJunction\p => ControllableJ\tip;
      Splitter1\output -> CalculateJ\jointVelocities 560 136;
      odometry_base -> MuxToControl1\base;
      Splitter1\output -> GravityCompensation1\jointPos 656 384;
      Gain\H -> CtipControl\Hvp0;
      CalculateJ\Htip0 -> CtipControl\Htip0 256 136;
      CalculateJ\controllableJ -> ControllableJ\controlledJ;
      Splitter1\output -> JointSoftLimits\state;
      measured_angles_arm -> MuxToControl1\arm;
      Splitter1\output -> C\state;
      MuxToControl1\control -> Splitter1\input;
      filter\y -> Gain\xyzrpy;
      xyzypr -> filter\u;
     end;
    implementation_end;
   Mux2 616 328
    description '<Description>
 <Version>4.0</Version>
 <LibraryPath>Template\Submodel-Equation.emx</LibraryPath>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <TimeStamp>2007-11-1 22:32:1</TimeStamp>
 <AllowLibraryUpdate>False</AllowLibraryUpdate>
</Description>';
    type 'Submodel-Equation'
     ports
      power in input1 [3,1];
      power out output [8,1];
      power in input2 [5,1];
     restrictions
      causality fixed in input1;
      causality fixed out output;
      causality fixed in input2;
    end;
    implementation eq
/* Equation Submodel
Enter you equations here. You can use the Toolbar buttons at the left ( Add , f(x) etc. ).
*/
equations
  // start typing here
input1.f=  	output.f[1:3]  ;
	 input2.f=output.f[4:8] ;

output.e[1:3]=	input1.e;
	output.e[4:8]=input2.e ;	
 implementation_end;
   Plant 784 248
    description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>youBot.emx</LibraryPath>
  <TimeStamp>2011-1-21 10:28:22</TimeStamp>
</Description>';
    type Submodel
     ports
      power in joints [9,1];
      signal out q [8,1];
     parameters
      real Rconstraint = 1000.0;
      real Cconstraint = 1.0e-4;
      real Rjoint = 1.0;
      real InitialJointPos[5,1] = [-2.9496; -1.1345; 2.5482; -1.789; -2.9234];
      real InitialBasePos[4,4] = [1.0, 0.0, 0.0, 0.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];
      real LinkI[3,6] = [20.0, 1.0, 1.0, 1.0, 1.0, 1.0; 20.0, 1.0, 1.0, 1.0, 1.0, 1.0; 20.0, 1.0, 1.0, 1.0, 1.0, 1.0];
      real LinkCOMdim[3,6] = [0.01489, 0.01489, 0.10453, 0.001, 0.011, 0.0; 0.00213, 0.00213, 0.0017, 0.0967, 0.05103, 0.00115; 0.00213, 0.00213, -0.00297, 0.02107, -0.02319, -0.01683];
      real Linkdim[3,6] = [0.024, 0.033, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.096, 0.019, 0.155, 0.135, 0.096, 0.034];
      real Linkm[6,1] = [20.0; 2.412; 1.155; 0.934; 0.877; 1.121];
      real MinEndstopPos[5,1] = [-2.95; -1.13; -2.64; -1.79; -2.92];
      real MaxEndstopPos[5,1] = [2.95; 1.57; 2.55; 1.79; 2.92];
      real Wheelpos[2,4] = [0.215, 0.215, -0.215, -0.215; -0.15, 0.15, -0.15, 0.15]; "[1:2,1] = LF, [1:2,2] = RF, [1:2,3] = LR, [1:2,4] = RR "
      real MecanumWheelRadius = 0.053;
      real Rwheel = 1.0;
    end;
    icon bg bottom
     figures
      rectangle 747 226 821 270 fill 11206638;
      text 'youBot' 784 248 16;
    end;
    implementation bg
     submodels
      Base 368 504
       description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Link.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:36:40</TimeStamp>
<Description>Base</Description>
</Description>';
       type Submodel
        ports
         power out p [6,1];
         signal in Hin [4,4];
         power in p1 [6,1];
         signal out Hout [4,4];
        parameters
         real I[3,1] = [20.0; 20.0; 20.0];
         real m = 20.0;
         real COMdim[3,1] = [0.01489; 0.00213; 0.00213];
         real dim[3,1] = [0.024; 0.0; 0.096];
       end;
       icon bg bottom
        figures
         rectangle 336 432 400 576 fill 10025880;
         text 'Link' 368 504;
        terminals
         p 336 464 fixed;
         Hin 336 544 fixed;
         p1 400 464 fixed;
         Hout 400 544 fixed;
       end;
       implementation bg
        submodels
         AdHi0 664 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power in p1 [6,1];
            power out p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg left
           figures
            text 'MTF' 664 416 18 bold;
          end;
          implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
         AdHij 816 304
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg top
           figures
            text 'MTF' 816 304 18 bold;
          end;
          implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
         AdHik 664 224
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1 [6,1];
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real COMdim[3,1] = [0.01489; 0.00213; 0.00213];
          end;
          icon bg left
           figures
            text 'TF' 664 224 18 bold;
          end;
          implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
         AdHik1 664 368
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real COMdim[3,1] = [0.01489; 0.00213; 0.00213];
          end;
          icon bg left
           figures
            text 'TF' 664 368 18 bold;
          end;
          implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
         EJS 728 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MGY
           ports
            power in p1 [6,1];
           parameters
            real I[3,1] = [20.0; 20.0; 20.0];
            real m = 20.0;
          end;
          icon bg top
           figures
            text 'MGY' 728 184 18 bold;
          end;
          implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
         Gravity 776 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Se
           ports
            power out p [6,1];
           restrictions
            causality fixed out p;
           parameters
            real m = 20.0;
          end;
          icon bg bottom
           figures
            text 'Se' 776 416 18 bold;
          end;
          implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
         Hij 816 496
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Gain
           ports
            signal in input [4,4];
            signal out output [4,4];
            signal out Hab [4,4];
           parameters
            real dim[3,1] = [0.024; 0.0; 0.096];
          end;
          icon bg bottom
           figures
            rectangle 800.1 480 831.9 512 fill 15132390;
            text 'H' 816 496 color 16711680 16 bold;
          end;
          implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
         InertialTensor 616 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type I
           ports
            power in p [6,1];
            signal out state [6,1];
           restrictions
            causality preferred in p;
           parameters
            real m = 1.0;
            real I[3,1] = [20.0; 20.0; 20.0];
          end;
          icon bg top
           figures
            text 'I' 616 184 18 bold;
          end;
          implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
         plug Hout 896 496;
         plug p1 904 304;
         plug Hin 592 496;
         plug p 592 304;
         Splitter1 664 496
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [4,4];
            signal knot in input [4,4];
          end;
          icon bg ellipse
           figures
            ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
            ellipse 659.7 491.7 668.3 500.3 color -1;
           terminals
            input 664 496 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Ta00 720 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 720 416 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Ta0i 664 304
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 664 304 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Ta0k 664 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 664 184 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         AdHik\p2 => Ta0k\p;
         Ta0i\p <= AdHik1\p1;
         AdHi0\p2 => AdHik1\p2;
         Gravity\p => Ta00\p;
         Ta0i\p => AdHik\p1;
         p <= Ta0i\p;
         Ta0i\p <= AdHij\p1;
         Ta0k\p => EJS\p1;
         p1 => AdHij\p2;
         Ta00\p => AdHi0\p1;
         Ta0k\p => InertialTensor\p;
         Hin -> Splitter1\input;
         Hij\output -> Hout;
         Splitter1\output -> Hij\input;
         Splitter1\output -> AdHi0\H;
         Hij\Hab -> AdHij\H;
        end;
        parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
        figures
         text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
       implementation_end;
      Hfloor0 208 544
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\Constant.emx</LibraryPath>
 <TimeStamp>2007-10-19 14:48:44</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type Constant
        ports
         signal out output [4,4];
       end;
       icon bg bottom
        figures
         rectangle 192.1 528 223.9 560 fill 15132390;
         line 196.9 539.6 218.9 539.6 color 16711680 width 2;
         line 194.2 550.7 219.9 550.7;
         line 196.5 534.7 196.5 553;
       end;
       implementation eq
equations
	output = eye(4);
     implementation_end;
      Htip0 1248 544
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\SignalMonitor.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:14:4</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type SignalMonitor
        ports
         signal in input [4,4];
       end;
       icon bg bottom
        figures
         rectangle 1232 528 1264 560 fill 15132390;
         rectangle 1237.7 533.8 1258.3 554.6 color 16711680 fill 11776947 width 2;
         rectangle 1239.8 536.4 1255.9 552 color -1 fill 16777215;
         line 1241.9 538.7 1241.9 550 fill 16777215;
         line 1240 548.4 1252.5 548.4 fill 16777215;
         line 1241.5 548.1 1254.4 541.7 color 255 fill 16777215;
       end;
       implementation eq

   implementation_end;
      Joint12 608.2 504
       description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Joint-roty.emx</LibraryPath>
  <TimeStamp>2011-1-18 17:30:05</TimeStamp>
</Description>';
       type 'Submodel-roty'
        ports
         power out p [6,1];
         power in p1;
         power in p2 [6,1];
         signal in Hin [4,4];
         signal out Hout [4,4];
         signal out q;
        parameters
         real Rconstraint = 1000.0;
         real Cconstraint = 1.0e-4;
         real Rendstop = 1000.0;
         real Cendstop = 1.0e-4;
         real InitialPos = -1.1345;
         real MaxEndstopPos = 1.57;
         real MinEndstopPos = -1.13;
         real Rjoint = 1.0;
       end;
       icon bg bottom
        figures
         rectangle 576.4 432 639.9 576 fill 14745599;
         text 'Joint-roty' 608.4 507 fill 14745599;
        terminals
         p 575.9 464 fixed;
         p1 607.4 432 fixed;
         p2 639.9 464 fixed;
         Hin 575.9 544 fixed;
         Hout 639.9 544 fixed;
       end;
       implementation bg
        submodels
         AdHji 424 424
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg bottom
           figures
            text 'MTF' 424 424 18 bold;
          end;
          implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
         EndstopMax 575 81
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Submodel
           ports
            power out p2;
            signal boolean out collision;
           parameters
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = -1.1345;
            real EndstopPos = 1.57;
          end;
          icon bg bottom
           figures
            rectangle 526 58 624 104 fill 14013909;
            text 'EndstopMax' 576 80 16;
           terminals
            p2 576 104 fixed;
          end;
          implementation bg
           submodels
            Cendstop 704 144
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type C
              ports
               power in p;
               signal out state;
              restrictions
               causality preferred out p;
              parameters
               real Cendstop = 1.0e-4;
             end;
             icon bg right
              figures
               text 'C' 704 144 18 bold;
             end;
             implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
            Collision 704 216
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type X0e
              ports
               power in p1;
               power out p2;
               power out p12;
               signal boolean out Collision;
              restrictions
               causality fixed in p12;
               causality fixed out p2;
               causality fixed out p1;
              parameters
               real InitialPos = -1.1345;
               real EndstopPos = 1.57;
             end;
             icon bg
              figures
               text 'X0e' 704 216 18 bold;
             end;
             implementation bg
              submodels
               Condition1 224.9 231.5
                type Condition
                 ports
                  signal in dx;
                  signal boolean out contact;
                end;
                icon bg
                 figures
                  rectangle 197.2 215 252.6 248 fill 15132390;
                  text 'Condition' 224 231.5;
                 terminals
                  dx 224 248 fixed;
                  contact 224 215 fixed;
                end;
                implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
               plug p1 96 176;
               plug p2 352 176;
               plug p12 224 64;
               plug Collision 408 192;
               Splitter1 224 200
                description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot Splitter
                 ports
                  signal knot boolean duplicatable out output [1];
                  signal knot boolean in input [1];
                end;
                icon bg ellipse
                 figures
                  ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                  ellipse 219.7 195.7 228.3 204.3 color -1;
                 terminals
                  input 224 200 fixed;
                end;
                implementation eq
equations
    collect (output) = input;
implementation_end;
               v1 160 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 160 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v12 224 120
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg right
                 figures
                  text '1' 224 120 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v2 296 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 296 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               X0 224 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type X0
                 ports
                  mechanical in p1;
                  mechanical out p2;
                  mechanical out p12;
                  signal boolean in condition;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                end;
                icon bg
                 figures
                  text 'X0' 224 176 color 8388608 18 bold;
                end;
                implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
               x1 160 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = 1.57;
                end;
                icon bg left
                 figures
                  rectangle 145 289 175 319 fill 15132390;
                  text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
               x12 224 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot PlusMinus
                 ports
                  signal knot duplicatable in plus [1];
                  signal knot duplicatable in minus [1];
                  signal knot out output [1];
                end;
                icon bg ellipse bottom
                 figures
                  ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                end;
                implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
               x2 296 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = -1.1345;
                end;
                icon bg right
                 figures
                  rectangle 281 289 311 319 fill 15132390;
                  text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
              end;
              connections
               v1\p => X0\p1;
               X0\p2 => v2\p;
               X0\p12 => v12\p;
               v2\p => p2;
               v12\p => p12;
               p1 => v1\p;
               v1\flow -> x1\input;
               x1\output -> x12\plus;
               v2\flow -> x2\input;
               x2\output -> x12\minus;
               x12\output -> Condition1\dx;
               Condition1\contact -> Splitter1\input;
               Splitter1\output -> X0\condition;
               Splitter1\output -> Collision;
              end;
              parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
             implementation_end;
            plug p2 648 216;
            plug collision 800 216;
            OneJunction5 704 176
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 704 176 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Rendstop 736 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rendstop = 1000.0;
             end;
             icon bg bottom
              figures
               text 'R' 736 176 18 bold;
             end;
             implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
            Sf1 704 264
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
             type Sf
              ports
               power out p;
              restrictions
               causality fixed in p;
             end;
             icon bg bottom
              figures
               text 'Sf' 704 264 18 bold;
             end;
             implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
           end;
           connections
            OneJunction5\p => Cendstop\p;
            Collision\p12 => OneJunction5\p;
            Sf1\p => Collision\p1;
            OneJunction5\p => Rendstop\p;
            Collision\p2 => p2;
            Collision\Collision -> collision;
           end;
           parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
          implementation_end;
         EndstopMin 344 128
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 14:37:57</TimeStamp>
</Description>';
          type Submodel
           ports
            power out p2;
            signal boolean out collision;
           parameters
            real Cendstop = 1.0e-4;
            real Rendstop = 1000.0;
            real InitialPos = -1.1345;
            real EndstopPos = -1.13;
          end;
          icon bg bottom
           figures
            rectangle 295 105 393 151 fill 14013909;
            text 'EndstopMin' 345 127 16;
          end;
          implementation bg
           submodels
            Cendstop 248 208
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type C
              ports
               power in p;
               signal out state;
              restrictions
               causality preferred out p;
              parameters
               real Cendstop = 1.0e-4;
             end;
             icon bg right
              figures
               text 'C' 248 208 18 bold;
             end;
             implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
            Collision 248 120
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type X0e
              ports
               power in p1;
               power out p2;
               power out p12;
               signal boolean out collision;
              restrictions
               causality fixed out p1;
               causality fixed out p2;
               causality fixed in p12;
              parameters
               real InitialPos = -1.1345;
               real EndstopLocation = -1.13;
             end;
             icon bg
              figures
               text 'X0e' 248 120 18 bold;
             end;
             implementation bg
              submodels
               Condition1 224.9 231.5
                type Condition
                 ports
                  signal in dx;
                  signal boolean out contact;
                end;
                icon bg
                 figures
                  rectangle 197.2 215 252.6 248 fill 15132390;
                  text 'Condition' 224 231.5;
                 terminals
                  dx 224 248 fixed;
                  contact 224 215 fixed;
                end;
                implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
               plug p1 96 176;
               plug p2 352 176;
               plug p12 224 64;
               plug collision 400 200;
               Splitter1 224 200
                description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot Splitter
                 ports
                  signal knot boolean duplicatable out output [1];
                  signal knot boolean in input [1];
                end;
                icon bg ellipse
                 figures
                  ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                  ellipse 219.7 195.7 228.3 204.3 color -1;
                 terminals
                  input 224 200 fixed;
                end;
                implementation eq
equations
    collect (output) = input;
implementation_end;
               v1 160 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 160 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v12 224 120
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg right
                 figures
                  text '1' 224 120 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v2 296 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 296 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               X0 224 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type X0
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean in condition;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                end;
                icon bg
                 figures
                  text 'X0' 224 176 color 8388608 18 bold;
                end;
                implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
               x1 160 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = -1.13;
                end;
                icon bg left
                 figures
                  rectangle 145 289 175 319 fill 15132390;
                  text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
               x12 224 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot PlusMinus
                 ports
                  signal knot duplicatable in plus [1];
                  signal knot duplicatable in minus [1];
                  signal knot out output [1];
                end;
                icon bg ellipse bottom
                 figures
                  ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                end;
                implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
               x2 296 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = -1.1345;
                end;
                icon bg right
                 figures
                  rectangle 281 289 311 319 fill 15132390;
                  text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
              end;
              connections
               v1\p => X0\p1;
               X0\p2 => v2\p;
               X0\p12 => v12\p;
               v2\p => p2;
               v12\p => p12;
               p1 => v1\p;
               v1\flow -> x1\input;
               x1\output -> x12\plus;
               v2\flow -> x2\input;
               x2\output -> x12\minus;
               x12\output -> Condition1\dx;
               Condition1\contact -> Splitter1\input;
               Splitter1\output -> X0\condition;
               Splitter1\output -> collision;
              end;
              parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
             implementation_end;
            plug p2 152 120;
            plug collision 360 120;
            OneJunction 248 160
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 248 160 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Rendstop 288 160
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rendstop = 1000.0;
             end;
             icon bg bottom
              figures
               text 'R' 288 160 18 bold;
             end;
             implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
            Sf2 248 64
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
             type Sf
              ports
               power out p;
              restrictions
               causality fixed in p;
             end;
             icon bg bottom
              figures
               text 'Sf' 248 64 18 bold;
             end;
             implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
           end;
           connections
            Collision\p12 => OneJunction\p;
            OneJunction\p => Rendstop\p;
            OneJunction\p => Cendstop\p;
            Sf2\p => Collision\p1;
            Collision\p2 => p2;
            Collision\collision -> collision;
           end;
           parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
          implementation_end;
         Integrate 320 336
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input;
            signal out output [4,4];
            signal out q;
           parameters
            real init = -1.1345;
          end;
          icon bg
           figures
            rectangle 304 320 336 352 fill 15132390;
            text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
variables
	real R[3,3];
	real p[3];
	//real q;
equations
q = int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
         MatrixMul 320 496
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Gain
           ports
            signal in input1 [4,4];
            signal out output [4,4];
            signal in input2 [4,4];
          end;
          icon bg bottom
           figures
            rectangle 304.1 480 335.9 512 fill 15132390;
            text 'X' 320 496 color 16711680 16 bold;
          end;
          implementation eq
equations
	output = input2*input1;    implementation_end;
         plug Hout 504 496;
         plug Hin 112 496;
         plug p2 496 424;
         plug p1 240 56;
         plug p 112 424;
         plug q 384 336;
         OneJunction 240 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [1];
            signal knot out flow [1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 240 272 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Or 392 216
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
          type 'Or-Or'
           ports
            signal boolean in input1;
            signal boolean out output;
            signal boolean in input2;
          end;
          icon bg bottom
           figures
            rectangle 376.1 200 407.9 232 fill 15132390;
            group
             line 378.3 209.3 388.8 209.3 color 16711680 fill 16711680;
             line 378.3 223.1 388.8 223.1 color 16711680 fill 16711680;
            end;
            spline 387.9 204.8 389.9 216.5 387.9 227.7 color 16711680 fill 16711680;
            line 396.7 216 405.5 216 color 16711680 fill 16711680;
            spline 387.7 204.3 393.9 206.6 396.8 216.4 393.6 225.4 387.7 227.7 color 16711680 fill 15132390;
          end;
          implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
         Rjoint 192 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p;
           parameters
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            text 'R' 192 272 18 bold;
          end;
          implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
         Splitter2 320 368
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [4,4];
            signal knot in input [4,4];
          end;
          icon bg ellipse
           figures
            ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
            ellipse 315.7 363.7 324.3 372.3 color -1;
           terminals
            input 320 368 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Tbai 240 384
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 240 384 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         uTbai 240 328
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1;
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real Rconstraint = 1000.0;
            real Cconstraint = 1.0e-4;
          end;
          icon bg left
           figures
            text 'TF' 240 328 18 bold;
          end;
          implementation eq
equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = p1.e;
	p2.e[3] = (Rconstraint*-p2.f[3] + int(-p2.f[3])/Cconstraint);
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[2];
implementation_end;
         Wbai 240 424
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out effort [6,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg bottom
           figures
            text '0' 240 424 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         ZeroJunction 240 104
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [1];
            signal knot out effort [1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg
           figures
            text '0' 240 104 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
        end;
        connections
         p1 => ZeroJunction\p;
         OneJunction\p <= EndstopMax\p2;
         OneJunction\p => Rjoint\p;
         uTbai\p2 => Tbai\p;
         Tbai\p => Wbai\p;
         p <= Wbai\p;
         ZeroJunction\p => OneJunction\p;
         OneJunction\p => uTbai\p1;
         Wbai\p <= AdHji\p1;
         OneJunction\p <= EndstopMin\p2;
         p2 => AdHji\p2;
         EndstopMin\collision -> Or\input2;
         OneJunction\flow -> Integrate\input 320 272;
         Splitter2\output -> AdHji\H 424 368;
         Integrate\q -> q;
         MatrixMul\output -> Hout;
         Hin -> MatrixMul\input2;
         Integrate\output -> Splitter2\input;
         Splitter2\output -> MatrixMul\input1;
         EndstopMax\collision -> Or\input1;
        end;
        parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;parameterrelations_end;
        figures
         text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
       implementation_end;
      Joint23 768.2 504
       description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-roty.emx</LibraryPath>
 <TimeStamp>2011-1-18 17:30:05</TimeStamp>
</Description>';
       type 'Submodel-roty'
        ports
         power out p [6,1];
         power in p1;
         power in p2 [6,1];
         signal in Hin [4,4];
         signal out Hout [4,4];
         signal out q;
        parameters
         real Rconstraint = 1000.0;
         real Cconstraint = 1.0e-4;
         real Rendstop = 1000.0;
         real Cendstop = 1.0e-4;
         real InitialPos = 2.5482;
         real MaxEndstopPos = 2.55;
         real MinEndstopPos = -2.64;
         real Rjoint = 1.0;
       end;
       icon bg bottom
        figures
         rectangle 736.4 432 799.9 576 fill 14745599;
         text 'Joint-roty' 768.4 507 fill 14745599;
        terminals
         p 735.9 464 fixed;
         p1 767.4 432 fixed;
         p2 799.9 464 fixed;
         Hin 735.9 544 fixed;
         Hout 799.9 544 fixed;
       end;
       implementation bg
        submodels
         AdHji 424 424
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg bottom
           figures
            text 'MTF' 424 424 18 bold;
          end;
          implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
         EndstopMax 471 217
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Submodel
           ports
            power out p2;
            signal boolean out collision;
           parameters
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = 2.5482;
            real EndstopPos = 2.55;
          end;
          icon bg bottom
           figures
            rectangle 422 194 520 240 fill 14013909;
            text 'EndstopMax' 472 216 16;
           terminals
            p2 472 240 fixed;
          end;
          implementation bg
           submodels
            Cendstop 704 144
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type C
              ports
               power in p;
               signal out state;
              restrictions
               causality preferred out p;
              parameters
               real Cendstop = 1.0e-4;
             end;
             icon bg right
              figures
               text 'C' 704 144 18 bold;
             end;
             implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
            Collision 704 216
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type X0e
              ports
               power in p1;
               power out p2;
               power out p12;
               signal boolean out Collision;
              restrictions
               causality fixed in p12;
               causality fixed out p2;
               causality fixed out p1;
              parameters
               real InitialPos = 2.5482;
               real EndstopPos = 2.55;
             end;
             icon bg
              figures
               text 'X0e' 704 216 18 bold;
             end;
             implementation bg
              submodels
               Condition1 224.9 231.5
                type Condition
                 ports
                  signal in dx;
                  signal boolean out contact;
                end;
                icon bg
                 figures
                  rectangle 197.2 215 252.6 248 fill 15132390;
                  text 'Condition' 224 231.5;
                 terminals
                  dx 224 248 fixed;
                  contact 224 215 fixed;
                end;
                implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
               plug p1 96 176;
               plug p2 352 176;
               plug p12 224 64;
               plug Collision 408 192;
               Splitter1 224 200
                description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot Splitter
                 ports
                  signal knot boolean duplicatable out output [1];
                  signal knot boolean in input [1];
                end;
                icon bg ellipse
                 figures
                  ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                  ellipse 219.7 195.7 228.3 204.3 color -1;
                 terminals
                  input 224 200 fixed;
                end;
                implementation eq
equations
    collect (output) = input;
implementation_end;
               v1 160 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 160 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v12 224 120
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg right
                 figures
                  text '1' 224 120 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v2 296 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 296 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               X0 224 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type X0
                 ports
                  mechanical in p1;
                  mechanical out p2;
                  mechanical out p12;
                  signal boolean in condition;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                end;
                icon bg
                 figures
                  text 'X0' 224 176 color 8388608 18 bold;
                end;
                implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
               x1 160 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = 2.55;
                end;
                icon bg left
                 figures
                  rectangle 145 289 175 319 fill 15132390;
                  text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
               x12 224 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot PlusMinus
                 ports
                  signal knot duplicatable in plus [1];
                  signal knot duplicatable in minus [1];
                  signal knot out output [1];
                end;
                icon bg ellipse bottom
                 figures
                  ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                end;
                implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
               x2 296 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = 2.5482;
                end;
                icon bg right
                 figures
                  rectangle 281 289 311 319 fill 15132390;
                  text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
              end;
              connections
               v1\p => X0\p1;
               X0\p2 => v2\p;
               X0\p12 => v12\p;
               v2\p => p2;
               v12\p => p12;
               p1 => v1\p;
               v1\flow -> x1\input;
               x1\output -> x12\plus;
               v2\flow -> x2\input;
               x2\output -> x12\minus;
               x12\output -> Condition1\dx;
               Condition1\contact -> Splitter1\input;
               Splitter1\output -> X0\condition;
               Splitter1\output -> Collision;
              end;
              parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
             implementation_end;
            plug p2 648 216;
            plug collision 800 216;
            OneJunction5 704 176
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 704 176 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Rendstop 736 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rendstop = 1000.0;
             end;
             icon bg bottom
              figures
               text 'R' 736 176 18 bold;
             end;
             implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
            Sf1 704 264
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
             type Sf
              ports
               power out p;
              restrictions
               causality fixed in p;
             end;
             icon bg bottom
              figures
               text 'Sf' 704 264 18 bold;
             end;
             implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
           end;
           connections
            OneJunction5\p => Cendstop\p;
            Collision\p12 => OneJunction5\p;
            Sf1\p => Collision\p1;
            OneJunction5\p => Rendstop\p;
            Collision\p2 => p2;
            Collision\Collision -> collision;
           end;
           parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
          implementation_end;
         EndstopMin 312 216
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 14:37:57</TimeStamp>
</Description>';
          type Submodel
           ports
            power out p2;
            signal boolean out collision;
           parameters
            real Cendstop = 1.0e-4;
            real Rendstop = 1000.0;
            real InitialPos = 2.5482;
            real EndstopPos = -2.64;
          end;
          icon bg bottom
           figures
            rectangle 263 193 361 239 fill 14013909;
            text 'EndstopMin' 313 215 16;
          end;
          implementation bg
           submodels
            Cendstop 248 208
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type C
              ports
               power in p;
               signal out state;
              restrictions
               causality preferred out p;
              parameters
               real Cendstop = 1.0e-4;
             end;
             icon bg right
              figures
               text 'C' 248 208 18 bold;
             end;
             implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
            Collision 248 120
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type X0e
              ports
               power in p1;
               power out p2;
               power out p12;
               signal boolean out collision;
              restrictions
               causality fixed out p1;
               causality fixed out p2;
               causality fixed in p12;
              parameters
               real InitialPos = 2.5482;
               real EndstopLocation = -2.64;
             end;
             icon bg
              figures
               text 'X0e' 248 120 18 bold;
             end;
             implementation bg
              submodels
               Condition1 224.9 231.5
                type Condition
                 ports
                  signal in dx;
                  signal boolean out contact;
                end;
                icon bg
                 figures
                  rectangle 197.2 215 252.6 248 fill 15132390;
                  text 'Condition' 224 231.5;
                 terminals
                  dx 224 248 fixed;
                  contact 224 215 fixed;
                end;
                implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
               plug p1 96 176;
               plug p2 352 176;
               plug p12 224 64;
               plug collision 400 200;
               Splitter1 224 200
                description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot Splitter
                 ports
                  signal knot boolean duplicatable out output [1];
                  signal knot boolean in input [1];
                end;
                icon bg ellipse
                 figures
                  ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                  ellipse 219.7 195.7 228.3 204.3 color -1;
                 terminals
                  input 224 200 fixed;
                end;
                implementation eq
equations
    collect (output) = input;
implementation_end;
               v1 160 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 160 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v12 224 120
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg right
                 figures
                  text '1' 224 120 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v2 296 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 296 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               X0 224 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type X0
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean in condition;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                end;
                icon bg
                 figures
                  text 'X0' 224 176 color 8388608 18 bold;
                end;
                implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
               x1 160 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = -2.64;
                end;
                icon bg left
                 figures
                  rectangle 145 289 175 319 fill 15132390;
                  text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
               x12 224 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot PlusMinus
                 ports
                  signal knot duplicatable in plus [1];
                  signal knot duplicatable in minus [1];
                  signal knot out output [1];
                end;
                icon bg ellipse bottom
                 figures
                  ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                end;
                implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
               x2 296 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = 2.5482;
                end;
                icon bg right
                 figures
                  rectangle 281 289 311 319 fill 15132390;
                  text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
              end;
              connections
               v1\p => X0\p1;
               X0\p2 => v2\p;
               X0\p12 => v12\p;
               v2\p => p2;
               v12\p => p12;
               p1 => v1\p;
               v1\flow -> x1\input;
               x1\output -> x12\plus;
               v2\flow -> x2\input;
               x2\output -> x12\minus;
               x12\output -> Condition1\dx;
               Condition1\contact -> Splitter1\input;
               Splitter1\output -> X0\condition;
               Splitter1\output -> collision;
              end;
              parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
             implementation_end;
            plug p2 152 120;
            plug collision 360 120;
            OneJunction 248 160
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 248 160 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Rendstop 288 160
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rendstop = 1000.0;
             end;
             icon bg bottom
              figures
               text 'R' 288 160 18 bold;
             end;
             implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
            Sf2 248 64
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
             type Sf
              ports
               power out p;
              restrictions
               causality fixed in p;
             end;
             icon bg bottom
              figures
               text 'Sf' 248 64 18 bold;
             end;
             implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
           end;
           connections
            Collision\p12 => OneJunction\p;
            OneJunction\p => Rendstop\p;
            OneJunction\p => Cendstop\p;
            Sf2\p => Collision\p1;
            Collision\p2 => p2;
            Collision\collision -> collision;
           end;
           parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
          implementation_end;
         Integrate 320 336
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input;
            signal out output [4,4];
            signal out q;
           parameters
            real init = 2.5482;
          end;
          icon bg
           figures
            rectangle 304 320 336 352 fill 15132390;
            text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
variables
	real R[3,3];
	real p[3];
//	real q;
equations
q = int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
         MatrixMul 320 496
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Gain
           ports
            signal in input1 [4,4];
            signal out output [4,4];
            signal in input2 [4,4];
          end;
          icon bg bottom
           figures
            rectangle 304.1 480 335.9 512 fill 15132390;
            text 'X' 320 496 color 16711680 16 bold;
          end;
          implementation eq
equations
	output = input2*input1;    implementation_end;
         plug Hout 504 496;
         plug Hin 112 496;
         plug p2 496 424;
         plug p1 240 56;
         plug p 112 424;
         plug q 376 336;
         OneJunction 240 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [1];
            signal knot out flow [1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 240 272 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Or 392 216
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
          type 'Or-Or'
           ports
            signal boolean in input1;
            signal boolean out output;
            signal boolean in input2;
          end;
          icon bg bottom
           figures
            rectangle 376.1 200 407.9 232 fill 15132390;
            group
             line 378.3 209.3 388.8 209.3 color 16711680 fill 16711680;
             line 378.3 223.1 388.8 223.1 color 16711680 fill 16711680;
            end;
            spline 387.9 204.8 389.9 216.5 387.9 227.7 color 16711680 fill 16711680;
            line 396.7 216 405.5 216 color 16711680 fill 16711680;
            spline 387.7 204.3 393.9 206.6 396.8 216.4 393.6 225.4 387.7 227.7 color 16711680 fill 15132390;
          end;
          implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
         Rjoint 192 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p;
           parameters
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            text 'R' 192 272 18 bold;
          end;
          implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
         Splitter2 320 368
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [4,4];
            signal knot in input [4,4];
          end;
          icon bg ellipse
           figures
            ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
            ellipse 315.7 363.7 324.3 372.3 color -1;
           terminals
            input 320 368 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Tbai 240 384
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 240 384 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         uTbai 240 328
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1;
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real Rconstraint = 1000.0;
            real Cconstraint = 1.0e-4;
          end;
          icon bg left
           figures
            text 'TF' 240 328 18 bold;
          end;
          implementation eq
equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = p1.e;
	p2.e[3] = (Rconstraint*-p2.f[3] + int(-p2.f[3])/Cconstraint);
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[2];
implementation_end;
         Wbai 240 424
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out effort [6,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg bottom
           figures
            text '0' 240 424 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         ZeroJunction 240 104
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [1];
            signal knot out effort [1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg
           figures
            text '0' 240 104 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
        end;
        connections
         p1 => ZeroJunction\p;
         OneJunction\p <= EndstopMin\p2;
         p2 => AdHji\p2;
         OneJunction\p <= EndstopMax\p2;
         OneJunction\p => Rjoint\p;
         uTbai\p2 => Tbai\p;
         Tbai\p => Wbai\p;
         p <= Wbai\p;
         ZeroJunction\p => OneJunction\p;
         OneJunction\p => uTbai\p1;
         Wbai\p <= AdHji\p1;
         EndstopMin\collision -> Or\input2;
         OneJunction\flow -> Integrate\input 320 272;
         Integrate\q -> q;
         Splitter2\output -> AdHji\H 424 368;
         MatrixMul\output -> Hout;
         Hin -> MatrixMul\input2;
         Integrate\output -> Splitter2\input;
         Splitter2\output -> MatrixMul\input1;
         EndstopMax\collision -> Or\input1;
        end;
        parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;parameterrelations_end;
        figures
         text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
       implementation_end;
      Joint34 928.2 504
       description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-roty.emx</LibraryPath>
 <TimeStamp>2011-1-18 17:30:05</TimeStamp>
</Description>';
       type 'Submodel-roty'
        ports
         power out p [6,1];
         power in p1;
         power in p2 [6,1];
         signal in Hin [4,4];
         signal out Hout [4,4];
         signal out q;
        parameters
         real Rconstraint = 1000.0;
         real Cconstraint = 1.0e-4;
         real Rendstop = 1000.0;
         real Cendstop = 1.0e-4;
         real InitialPos = -1.789;
         real MaxEndstopPos = 1.79;
         real MinEndstopPos = -1.79;
         real Rjoint = 1.0;
       end;
       icon bg bottom
        figures
         rectangle 896.4 432 959.9 576 fill 14745599;
         text 'Joint-roty' 928.4 507 fill 14745599;
        terminals
         p 895.9 464 fixed;
         p1 927.4 432 fixed;
         p2 959.9 464 fixed;
         Hin 895.9 544 fixed;
         Hout 959.9 544 fixed;
       end;
       implementation bg
        submodels
         AdHji 424 424
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg bottom
           figures
            text 'MTF' 424 424 18 bold;
          end;
          implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
         EndstopMax 471 217
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Submodel
           ports
            power out p2;
            signal boolean out collision;
           parameters
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = -1.789;
            real EndstopPos = 1.79;
          end;
          icon bg bottom
           figures
            rectangle 422 194 520 240 fill 14013909;
            text 'EndstopMax' 472 216 16;
           terminals
            p2 472 240 fixed;
          end;
          implementation bg
           submodels
            Cendstop 704 144
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type C
              ports
               power in p;
               signal out state;
              restrictions
               causality preferred out p;
              parameters
               real Cendstop = 1.0e-4;
             end;
             icon bg right
              figures
               text 'C' 704 144 18 bold;
             end;
             implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
            Collision 704 216
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type X0e
              ports
               power in p1;
               power out p2;
               power out p12;
               signal boolean out Collision;
              restrictions
               causality fixed in p12;
               causality fixed out p2;
               causality fixed out p1;
              parameters
               real InitialPos = -1.789;
               real EndstopPos = 1.79;
             end;
             icon bg
              figures
               text 'X0e' 704 216 18 bold;
             end;
             implementation bg
              submodels
               Condition1 224.9 231.5
                type Condition
                 ports
                  signal in dx;
                  signal boolean out contact;
                end;
                icon bg
                 figures
                  rectangle 197.2 215 252.6 248 fill 15132390;
                  text 'Condition' 224 231.5;
                 terminals
                  dx 224 248 fixed;
                  contact 224 215 fixed;
                end;
                implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
               plug p1 96 176;
               plug p2 352 176;
               plug p12 224 64;
               plug Collision 408 192;
               Splitter1 224 200
                description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot Splitter
                 ports
                  signal knot boolean duplicatable out output [1];
                  signal knot boolean in input [1];
                end;
                icon bg ellipse
                 figures
                  ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                  ellipse 219.7 195.7 228.3 204.3 color -1;
                 terminals
                  input 224 200 fixed;
                end;
                implementation eq
equations
    collect (output) = input;
implementation_end;
               v1 160 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 160 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v12 224 120
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg right
                 figures
                  text '1' 224 120 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v2 296 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 296 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               X0 224 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type X0
                 ports
                  mechanical in p1;
                  mechanical out p2;
                  mechanical out p12;
                  signal boolean in condition;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                end;
                icon bg
                 figures
                  text 'X0' 224 176 color 8388608 18 bold;
                end;
                implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
               x1 160 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = 1.79;
                end;
                icon bg left
                 figures
                  rectangle 145 289 175 319 fill 15132390;
                  text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
               x12 224 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot PlusMinus
                 ports
                  signal knot duplicatable in plus [1];
                  signal knot duplicatable in minus [1];
                  signal knot out output [1];
                end;
                icon bg ellipse bottom
                 figures
                  ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                end;
                implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
               x2 296 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = -1.789;
                end;
                icon bg right
                 figures
                  rectangle 281 289 311 319 fill 15132390;
                  text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
              end;
              connections
               v1\p => X0\p1;
               X0\p2 => v2\p;
               X0\p12 => v12\p;
               v2\p => p2;
               v12\p => p12;
               p1 => v1\p;
               v1\flow -> x1\input;
               x1\output -> x12\plus;
               v2\flow -> x2\input;
               x2\output -> x12\minus;
               x12\output -> Condition1\dx;
               Condition1\contact -> Splitter1\input;
               Splitter1\output -> X0\condition;
               Splitter1\output -> Collision;
              end;
              parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
             implementation_end;
            plug p2 648 216;
            plug collision 800 216;
            OneJunction5 704 176
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 704 176 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Rendstop 736 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rendstop = 1000.0;
             end;
             icon bg bottom
              figures
               text 'R' 736 176 18 bold;
             end;
             implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
            Sf1 704 264
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
             type Sf
              ports
               power out p;
              restrictions
               causality fixed in p;
             end;
             icon bg bottom
              figures
               text 'Sf' 704 264 18 bold;
             end;
             implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
           end;
           connections
            OneJunction5\p => Cendstop\p;
            Collision\p12 => OneJunction5\p;
            Sf1\p => Collision\p1;
            OneJunction5\p => Rendstop\p;
            Collision\p2 => p2;
            Collision\Collision -> collision;
           end;
           parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
          implementation_end;
         EndstopMin 312 216
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 14:37:57</TimeStamp>
</Description>';
          type Submodel
           ports
            power out p2;
            signal boolean out collision;
           parameters
            real Cendstop = 1.0e-4;
            real Rendstop = 1000.0;
            real InitialPos = -1.789;
            real EndstopPos = -1.79;
          end;
          icon bg bottom
           figures
            rectangle 263 193 361 239 fill 14013909;
            text 'EndstopMin' 313 215 16;
          end;
          implementation bg
           submodels
            Cendstop 248 208
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type C
              ports
               power in p;
               signal out state;
              restrictions
               causality preferred out p;
              parameters
               real Cendstop = 1.0e-4;
             end;
             icon bg right
              figures
               text 'C' 248 208 18 bold;
             end;
             implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
            Collision 248 120
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type X0e
              ports
               power in p1;
               power out p2;
               power out p12;
               signal boolean out collision;
              restrictions
               causality fixed out p1;
               causality fixed out p2;
               causality fixed in p12;
              parameters
               real InitialPos = -1.789;
               real EndstopLocation = -1.79;
             end;
             icon bg
              figures
               text 'X0e' 248 120 18 bold;
             end;
             implementation bg
              submodels
               Condition1 224.9 231.5
                type Condition
                 ports
                  signal in dx;
                  signal boolean out contact;
                end;
                icon bg
                 figures
                  rectangle 197.2 215 252.6 248 fill 15132390;
                  text 'Condition' 224 231.5;
                 terminals
                  dx 224 248 fixed;
                  contact 224 215 fixed;
                end;
                implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
               plug p1 96 176;
               plug p2 352 176;
               plug p12 224 64;
               plug collision 400 200;
               Splitter1 224 200
                description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot Splitter
                 ports
                  signal knot boolean duplicatable out output [1];
                  signal knot boolean in input [1];
                end;
                icon bg ellipse
                 figures
                  ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                  ellipse 219.7 195.7 228.3 204.3 color -1;
                 terminals
                  input 224 200 fixed;
                end;
                implementation eq
equations
    collect (output) = input;
implementation_end;
               v1 160 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 160 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v12 224 120
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg right
                 figures
                  text '1' 224 120 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v2 296 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 296 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               X0 224 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type X0
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean in condition;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                end;
                icon bg
                 figures
                  text 'X0' 224 176 color 8388608 18 bold;
                end;
                implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
               x1 160 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = -1.79;
                end;
                icon bg left
                 figures
                  rectangle 145 289 175 319 fill 15132390;
                  text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
               x12 224 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot PlusMinus
                 ports
                  signal knot duplicatable in plus [1];
                  signal knot duplicatable in minus [1];
                  signal knot out output [1];
                end;
                icon bg ellipse bottom
                 figures
                  ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                end;
                implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
               x2 296 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = -1.789;
                end;
                icon bg right
                 figures
                  rectangle 281 289 311 319 fill 15132390;
                  text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
              end;
              connections
               v1\p => X0\p1;
               X0\p2 => v2\p;
               X0\p12 => v12\p;
               v2\p => p2;
               v12\p => p12;
               p1 => v1\p;
               v1\flow -> x1\input;
               x1\output -> x12\plus;
               v2\flow -> x2\input;
               x2\output -> x12\minus;
               x12\output -> Condition1\dx;
               Condition1\contact -> Splitter1\input;
               Splitter1\output -> X0\condition;
               Splitter1\output -> collision;
              end;
              parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
             implementation_end;
            plug p2 152 120;
            plug collision 360 120;
            OneJunction 248 160
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 248 160 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Rendstop 288 160
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rendstop = 1000.0;
             end;
             icon bg bottom
              figures
               text 'R' 288 160 18 bold;
             end;
             implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
            Sf2 248 64
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
             type Sf
              ports
               power out p;
              restrictions
               causality fixed in p;
             end;
             icon bg bottom
              figures
               text 'Sf' 248 64 18 bold;
             end;
             implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
           end;
           connections
            Collision\p12 => OneJunction\p;
            OneJunction\p => Rendstop\p;
            OneJunction\p => Cendstop\p;
            Sf2\p => Collision\p1;
            Collision\p2 => p2;
            Collision\collision -> collision;
           end;
           parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
          implementation_end;
         Integrate 320 336
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input;
            signal out output [4,4];
            signal out q;
           parameters
            real init = -1.789;
          end;
          icon bg
           figures
            rectangle 304 320 336 352 fill 15132390;
            text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
variables
	real R[3,3];
	real p[3];
	//real q;
equations
q = int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
         MatrixMul 320 496
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Gain
           ports
            signal in input1 [4,4];
            signal out output [4,4];
            signal in input2 [4,4];
          end;
          icon bg bottom
           figures
            rectangle 304.1 480 335.9 512 fill 15132390;
            text 'X' 320 496 color 16711680 16 bold;
          end;
          implementation eq
equations
	output = input2*input1;    implementation_end;
         plug Hout 504 496;
         plug Hin 112 496;
         plug p2 496 424;
         plug p1 240 56;
         plug p 112 424;
         plug q 384 328;
         OneJunction 240 272
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [1];
            signal knot out flow [1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 240 272 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Or 392 216
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
          type 'Or-Or'
           ports
            signal boolean in input1;
            signal boolean out output;
            signal boolean in input2;
          end;
          icon bg bottom
           figures
            rectangle 376.1 200 407.9 232 fill 15132390;
            group
             line 378.3 209.3 388.8 209.3 color 16711680 fill 16711680;
             line 378.3 223.1 388.8 223.1 color 16711680 fill 16711680;
            end;
            spline 387.9 204.8 389.9 216.5 387.9 227.7 color 16711680 fill 16711680;
            line 396.7 216 405.5 216 color 16711680 fill 16711680;
            spline 387.7 204.3 393.9 206.6 396.8 216.4 393.6 225.4 387.7 227.7 color 16711680 fill 15132390;
          end;
          implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
         Rjoint 192 272
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p;
           parameters
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            text 'R' 192 272 18 bold;
          end;
          implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
         Splitter2 320 368
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [4,4];
            signal knot in input [4,4];
          end;
          icon bg ellipse
           figures
            ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
            ellipse 315.7 363.7 324.3 372.3 color -1;
           terminals
            input 320 368 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Tbai 240 384
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg left
           figures
            text '1' 240 384 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         uTbai 240 328
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1;
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real Rconstraint = 1000.0;
            real Cconstraint = 1.0e-4;
          end;
          icon bg left
           figures
            text 'TF' 240 328 18 bold;
          end;
          implementation eq
equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = p1.e;
	p2.e[3] = (Rconstraint*-p2.f[3] + int(-p2.f[3])/Cconstraint);
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[2];
implementation_end;
         Wbai 240 424
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out effort [6,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg bottom
           figures
            text '0' 240 424 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         ZeroJunction 240 104
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [1];
            signal knot out effort [1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg
           figures
            text '0' 240 104 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
        end;
        connections
         p1 => ZeroJunction\p;
         uTbai\p2 => Tbai\p;
         Tbai\p => Wbai\p;
         p <= Wbai\p;
         ZeroJunction\p => OneJunction\p;
         OneJunction\p => uTbai\p1;
         Wbai\p <= AdHji\p1;
         OneJunction\p <= EndstopMin\p2;
         p2 => AdHji\p2;
         OneJunction\p <= EndstopMax\p2;
         OneJunction\p => Rjoint\p;
         EndstopMin\collision -> Or\input2;
         OneJunction\flow -> Integrate\input 320 272;
         Splitter2\output -> AdHji\H 424 368;
         MatrixMul\output -> Hout;
         Integrate\q -> q;
         Hin -> MatrixMul\input2;
         Integrate\output -> Splitter2\input;
         Splitter2\output -> MatrixMul\input1;
         EndstopMax\collision -> Or\input1;
        end;
        parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;parameterrelations_end;
        figures
         text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
       implementation_end;
      Joint45 1088.2 504
       description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-rotz.emx</LibraryPath>
 <TimeStamp>2011-1-18 17:30:00</TimeStamp>
</Description>';
       type 'Submodel-rotz'
        ports
         power out p [6,1];
         power in p1;
         power in p2 [6,1];
         signal in Hin [4,4];
         signal out Hout [4,4];
         signal out q;
        parameters
         real Rendstop = 1000.0;
         real Cendstop = 1.0e-4;
         real InitialPos = -2.9234;
         real MinEndstopPos = -2.92;
         real MaxEndstopPos = 2.92;
         real Rconstraint = 1000.0;
         real Cconstraint = 1.0e-4;
         real Rjoint = 1.0;
       end;
       icon bg bottom
        figures
         rectangle 1056.4 432 1119.9 576 fill 14745599;
         text 'Joint-rotz' 1088.4 507 fill 14745599;
        terminals
         p 1055.9 464 fixed;
         p1 1087.4 432 fixed;
         p2 1119.9 464 fixed;
         Hin 1055.9 544 fixed;
         Hout 1119.9 544 fixed;
       end;
       implementation bg
        submodels
         AdHji 424 424
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg bottom
           figures
            text 'MTF' 424 424 18 bold;
          end;
          implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
         EndstopMax 479 225
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMax.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:54:54</TimeStamp>
</Description>';
          type Submodel
           ports
            power out p2;
            signal boolean out collision;
           parameters
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = -2.9234;
            real EndstopPos = 2.92;
          end;
          icon bg bottom
           figures
            rectangle 430 202 528 248 fill 14013909;
            text 'EndstopMax' 480 224 16;
           terminals
            p2 480 248 fixed;
          end;
          implementation bg
           submodels
            Cendstop 704 144
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type C
              ports
               power in p;
               signal out state;
              restrictions
               causality preferred out p;
              parameters
               real Cendstop = 1.0e-4;
             end;
             icon bg right
              figures
               text 'C' 704 144 18 bold;
             end;
             implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
            Collision 704 216
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type X0e
              ports
               power in p1;
               power out p2;
               power out p12;
               signal boolean out Collision;
              restrictions
               causality fixed out p2;
               causality fixed out p1;
               causality fixed in p12;
              parameters
               real InitialPos = -2.9234;
               real EndstopPos = 2.92;
             end;
             icon bg
              figures
               text 'X0e' 704 216 18 bold;
             end;
             implementation bg
              submodels
               Condition1 224.9 231.5
                type Condition
                 ports
                  signal in dx;
                  signal boolean out contact;
                end;
                icon bg
                 figures
                  rectangle 197.2 215 252.6 248 fill 15132390;
                  text 'Condition' 224 231.5;
                 terminals
                  dx 224 248 fixed;
                  contact 224 215 fixed;
                end;
                implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
               plug p1 96 176;
               plug p2 352 176;
               plug p12 224 64;
               plug Collision 408 192;
               Splitter1 224 200
                description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot Splitter
                 ports
                  signal knot boolean duplicatable out output [1];
                  signal knot boolean in input [1];
                end;
                icon bg ellipse
                 figures
                  ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                  ellipse 219.7 195.7 228.3 204.3 color -1;
                 terminals
                  input 224 200 fixed;
                end;
                implementation eq
equations
    collect (output) = input;
implementation_end;
               v1 160 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 160 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v12 224 120
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg right
                 figures
                  text '1' 224 120 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v2 296 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 296 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               X0 224 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type X0
                 ports
                  mechanical in p1;
                  mechanical out p2;
                  mechanical out p12;
                  signal boolean in condition;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                end;
                icon bg
                 figures
                  text 'X0' 224 176 color 8388608 18 bold;
                end;
                implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
               x1 160 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = 2.92;
                end;
                icon bg left
                 figures
                  rectangle 145 289 175 319 fill 15132390;
                  text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
               x12 224 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot PlusMinus
                 ports
                  signal knot duplicatable in plus [1];
                  signal knot duplicatable in minus [1];
                  signal knot out output [1];
                end;
                icon bg ellipse bottom
                 figures
                  ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                end;
                implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
               x2 296 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = -2.9234;
                end;
                icon bg right
                 figures
                  rectangle 281 289 311 319 fill 15132390;
                  text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
              end;
              connections
               v1\p => X0\p1;
               X0\p2 => v2\p;
               X0\p12 => v12\p;
               v2\p => p2;
               v12\p => p12;
               p1 => v1\p;
               v1\flow -> x1\input;
               x1\output -> x12\plus;
               v2\flow -> x2\input;
               x2\output -> x12\minus;
               x12\output -> Condition1\dx;
               Condition1\contact -> Splitter1\input;
               Splitter1\output -> X0\condition;
               Splitter1\output -> Collision;
              end;
              parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
             implementation_end;
            plug p2 648 216;
            plug collision 800 216;
            OneJunction5 704 176
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 704 176 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Rendstop 736 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rendstop = 1000.0;
             end;
             icon bg bottom
              figures
               text 'R' 736 176 18 bold;
             end;
             implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
            Sf1 704 264
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
             type Sf
              ports
               power out p;
              restrictions
               causality fixed in p;
             end;
             icon bg bottom
              figures
               text 'Sf' 704 264 18 bold;
             end;
             implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
           end;
           connections
            OneJunction5\p => Cendstop\p;
            Collision\p12 => OneJunction5\p;
            Sf1\p => Collision\p1;
            OneJunction5\p => Rendstop\p;
            Collision\p2 => p2;
            Collision\Collision -> collision;
           end;
           parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
          implementation_end;
         EndstopMin 320 224
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:54:44</TimeStamp>
</Description>';
          type Submodel
           ports
            power out p2;
            signal boolean out collision;
           parameters
            real Cendstop = 1.0e-4;
            real Rendstop = 1000.0;
            real InitialPos = -2.9234;
            real EndstopPos = -2.92;
          end;
          icon bg bottom
           figures
            rectangle 271 201 369 247 fill 14013909;
            text 'EndstopMin' 321 223 16;
          end;
          implementation bg
           submodels
            Cendstop 248 208
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type C
              ports
               power in p;
               signal out state;
              restrictions
               causality preferred out p;
              parameters
               real Cendstop = 1.0e-4;
             end;
             icon bg right
              figures
               text 'C' 248 208 18 bold;
             end;
             implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
            Collision 248 120
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type X0e
              ports
               power in p1;
               power out p2;
               power out p12;
               signal boolean out collision;
              restrictions
               causality fixed out p1;
               causality fixed out p2;
               causality fixed in p12;
              parameters
               real InitialPos = -2.9234;
               real EndstopLocation = -2.92;
             end;
             icon bg
              figures
               text 'X0e' 248 120 18 bold;
             end;
             implementation bg
              submodels
               Condition1 224.9 231.5
                type Condition
                 ports
                  signal in dx;
                  signal boolean out contact;
                end;
                icon bg
                 figures
                  rectangle 197.2 215 252.6 248 fill 15132390;
                  text 'Condition' 224 231.5;
                 terminals
                  dx 224 248 fixed;
                  contact 224 215 fixed;
                end;
                implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
               plug p1 96 176;
               plug p2 352 176;
               plug p12 224 64;
               plug collision 400 200;
               Splitter1 224 200
                description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot Splitter
                 ports
                  signal knot boolean duplicatable out output [1];
                  signal knot boolean in input [1];
                end;
                icon bg ellipse
                 figures
                  ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                  ellipse 219.7 195.7 228.3 204.3 color -1;
                 terminals
                  input 224 200 fixed;
                end;
                implementation eq
equations
    collect (output) = input;
implementation_end;
               v1 160 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 160 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v12 224 120
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg right
                 figures
                  text '1' 224 120 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v2 296 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 296 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               X0 224 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type X0
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean in condition;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                end;
                icon bg
                 figures
                  text 'X0' 224 176 color 8388608 18 bold;
                end;
                implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
               x1 160 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = -2.92;
                end;
                icon bg left
                 figures
                  rectangle 145 289 175 319 fill 15132390;
                  text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
               x12 224 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot PlusMinus
                 ports
                  signal knot duplicatable in plus [1];
                  signal knot duplicatable in minus [1];
                  signal knot out output [1];
                end;
                icon bg ellipse bottom
                 figures
                  ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                end;
                implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
               x2 296 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = -2.9234;
                end;
                icon bg right
                 figures
                  rectangle 281 289 311 319 fill 15132390;
                  text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
              end;
              connections
               v1\p => X0\p1;
               X0\p2 => v2\p;
               X0\p12 => v12\p;
               v2\p => p2;
               v12\p => p12;
               p1 => v1\p;
               v1\flow -> x1\input;
               x1\output -> x12\plus;
               v2\flow -> x2\input;
               x2\output -> x12\minus;
               x12\output -> Condition1\dx;
               Condition1\contact -> Splitter1\input;
               Splitter1\output -> X0\condition;
               Splitter1\output -> collision;
              end;
              parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
             implementation_end;
            plug p2 152 120;
            plug collision 360 120;
            OneJunction 248 160
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 248 160 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Rendstop 288 160
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rendstop = 1000.0;
             end;
             icon bg bottom
              figures
               text 'R' 288 160 18 bold;
             end;
             implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
            Sf2 248 64
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
             type Sf
              ports
               power out p;
              restrictions
               causality fixed in p;
             end;
             icon bg bottom
              figures
               text 'Sf' 248 64 18 bold;
             end;
             implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
           end;
           connections
            Collision\p12 => OneJunction\p;
            OneJunction\p => Rendstop\p;
            OneJunction\p => Cendstop\p;
            Sf2\p => Collision\p1;
            Collision\p2 => p2;
            Collision\collision -> collision;
           end;
           parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
          implementation_end;
         Integrate 320 336
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input;
            signal out output [4,4];
            signal out q;
           parameters
            real init = -2.9234;
          end;
          icon bg
           figures
            rectangle 304 320 336 352 fill 15132390;
            text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
variables
	real R[3,3];
	real p[3];
	//real q;
equations
q = int(input,init);
R = [	cos(-q),	-sin(-q),	0;
			sin(-q),	cos(-q),	0;
			0,				0,				1];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
         MatrixMul 320 576
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Gain
           ports
            signal in input1 [4,4];
            signal out output [4,4];
            signal in input2 [4,4];
          end;
          icon bg bottom
           figures
            rectangle 304.1 560 335.9 592 fill 15132390;
            text 'X' 320 576 color 16711680 16 bold;
          end;
          implementation eq
equations
	output = input2*input1;    implementation_end;
         plug Hout 504 576;
         plug Hin 112 576;
         plug p2 496 424;
         plug p 112 424;
         plug p1 240 40;
         plug q 376 336;
         OneJunction 240 288
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            mechanical knot duplicatable none p [1];
            signal knot out flow [1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 240 288 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Or 400 224
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
          type 'Or-Or'
           ports
            signal boolean in input1;
            signal boolean out output;
            signal boolean in input2;
          end;
          icon bg bottom
           figures
            rectangle 384.1 208 415.9 240 fill 15132390;
            group
             line 386.3 217.3 396.8 217.3 color 16711680 fill 16711680;
             line 386.3 231.1 396.8 231.1 color 16711680 fill 16711680;
            end;
            spline 395.9 212.8 397.9 224.5 395.9 235.7 color 16711680 fill 16711680;
            line 404.7 224 413.5 224 color 16711680 fill 16711680;
            spline 395.7 212.3 401.9 214.6 404.8 224.4 401.6 233.4 395.7 235.7 color 16711680 fill 15132390;
          end;
          implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
         Rjoint 168 288
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p;
           parameters
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            text 'R' 168 288 18 bold;
          end;
          implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
         Splitter2 320 368
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [4,4];
            signal knot in input [4,4];
          end;
          icon bg ellipse
           figures
            ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
            ellipse 315.7 363.7 324.3 372.3 color -1;
           terminals
            input 320 368 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         uTbai 240 336
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1;
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
            causality fixed in p1;
            causality fixed out p2;
           parameters
            real Cconstraint = 1.0e-4;
            real Rconstraint = 1000.0;
          end;
          icon bg left
           figures
            text 'TF' 240 336 18 bold;
          end;
          implementation eq

equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = (Rconstraint*-p2.f[2] + int(-p2.f[2])/Cconstraint);
	p2.e[3] = p1.e;
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[3];
implementation_end;
         Wbai 240 424
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out effort [6,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg bottom
           figures
            text '0' 240 424 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         ZeroJunction 240 104
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
          knot ZeroJunction
           ports
            mechanical knot duplicatable none p [1];
            signal knot out effort [1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg
           figures
            text '0' 240 104 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
        end;
        connections
         uTbai\p1 <= OneJunction\p;
         OneJunction\p <= EndstopMin\p2;
         Wbai\p <= AdHji\p1;
         p2 => AdHji\p2;
         OneJunction\p <= EndstopMax\p2;
         Rjoint\p <= OneJunction\p;
         ZeroJunction\p => OneJunction\p;
         p1 => ZeroJunction\p;
         uTbai\p2 => Wbai\p;
         p <= Wbai\p;
         OneJunction\flow -> Integrate\input 288 336;
         Splitter2\output -> AdHji\H 424 368;
         MatrixMul\output -> Hout;
         q <- Integrate\q;
         Hin -> MatrixMul\input2;
         Integrate\output -> Splitter2\input;
         Splitter2\output -> MatrixMul\input1;
         EndstopMin\collision -> Or\input2;
         EndstopMax\collision -> Or\input1;
        end;
        parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;

parameterrelations_end;
        figures
         text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 680 488;
       implementation_end;
      JointBase1 448.2 504
       description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Joint-rotz.emx</LibraryPath>
  <TimeStamp>2011-1-21 10:08:41</TimeStamp>
</Description>';
       type 'Submodel-rotz'
        ports
         power out p [6,1];
         power in p1;
         power in p2 [6,1];
         signal in Hin [4,4];
         signal out Hout [4,4];
         signal out q;
        parameters
         real Rendstop = 1000.0;
         real Cendstop = 1.0e-4;
         real InitialPos = -2.9496;
         real MinEndstopPos = -2.95;
         real MaxEndstopPos = 2.95;
         real Rconstraint = 1000.0;
         real Cconstraint = 1.0e-4;
         real Rjoint = 1.0;
       end;
       icon bg bottom
        figures
         rectangle 416.4 432 479.9 576 fill 14745599;
         text 'Joint-rotz' 448.4 507 fill 14745599;
        terminals
         p 415.9 464 fixed;
         p1 447.4 432 fixed;
         p2 479.9 464 fixed;
         Hin 415.9 544 fixed;
         Hout 479.9 544 fixed;
       end;
       implementation bg
        submodels
         AdHji 424 424
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg bottom
           figures
            text 'MTF' 424 424 18 bold;
          end;
          implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
         EndstopMax 479 225
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMax.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:54:54</TimeStamp>
</Description>';
          type Submodel
           ports
            power out p2;
            signal boolean out collision;
           parameters
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = -2.9496;
            real EndstopPos = 2.95;
          end;
          icon bg bottom
           figures
            rectangle 430 202 528 248 fill 14013909;
            text 'EndstopMax' 480 224 16;
           terminals
            p2 480 248 fixed;
          end;
          implementation bg
           submodels
            Cendstop 704 144
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type C
              ports
               power in p;
               signal out state;
              restrictions
               causality preferred out p;
              parameters
               real Cendstop = 1.0e-4;
             end;
             icon bg right
              figures
               text 'C' 704 144 18 bold;
             end;
             implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
            Collision 704 216
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type X0e
              ports
               power in p1;
               power out p2;
               power out p12;
               signal boolean out Collision;
              restrictions
               causality fixed out p2;
               causality fixed out p1;
               causality fixed in p12;
              parameters
               real InitialPos = -2.9496;
               real EndstopPos = 2.95;
             end;
             icon bg
              figures
               text 'X0e' 704 216 18 bold;
             end;
             implementation bg
              submodels
               Condition1 224.9 231.5
                type Condition
                 ports
                  signal in dx;
                  signal boolean out contact;
                end;
                icon bg
                 figures
                  rectangle 197.2 215 252.6 248 fill 15132390;
                  text 'Condition' 224 231.5;
                 terminals
                  dx 224 248 fixed;
                  contact 224 215 fixed;
                end;
                implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
               plug p1 96 176;
               plug p2 352 176;
               plug p12 224 64;
               plug Collision 408 192;
               Splitter1 224 200
                description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot Splitter
                 ports
                  signal knot boolean duplicatable out output [1];
                  signal knot boolean in input [1];
                end;
                icon bg ellipse
                 figures
                  ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                  ellipse 219.7 195.7 228.3 204.3 color -1;
                 terminals
                  input 224 200 fixed;
                end;
                implementation eq
equations
    collect (output) = input;
implementation_end;
               v1 160 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 160 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v12 224 120
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg right
                 figures
                  text '1' 224 120 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v2 296 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 296 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               X0 224 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type X0
                 ports
                  mechanical in p1;
                  mechanical out p2;
                  mechanical out p12;
                  signal boolean in condition;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                end;
                icon bg
                 figures
                  text 'X0' 224 176 color 8388608 18 bold;
                end;
                implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
               x1 160 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = 2.95;
                end;
                icon bg left
                 figures
                  rectangle 145 289 175 319 fill 15132390;
                  text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
               x12 224 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot PlusMinus
                 ports
                  signal knot duplicatable in plus [1];
                  signal knot duplicatable in minus [1];
                  signal knot out output [1];
                end;
                icon bg ellipse bottom
                 figures
                  ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                end;
                implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
               x2 296 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = -2.9496;
                end;
                icon bg right
                 figures
                  rectangle 281 289 311 319 fill 15132390;
                  text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
              end;
              connections
               v1\p => X0\p1;
               X0\p2 => v2\p;
               X0\p12 => v12\p;
               v2\p => p2;
               v12\p => p12;
               p1 => v1\p;
               v1\flow -> x1\input;
               x1\output -> x12\plus;
               v2\flow -> x2\input;
               x2\output -> x12\minus;
               x12\output -> Condition1\dx;
               Condition1\contact -> Splitter1\input;
               Splitter1\output -> X0\condition;
               Splitter1\output -> Collision;
              end;
              parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
             implementation_end;
            plug p2 648 216;
            plug collision 800 216;
            OneJunction5 704 176
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 704 176 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Rendstop 736 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rendstop = 1000.0;
             end;
             icon bg bottom
              figures
               text 'R' 736 176 18 bold;
             end;
             implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
            Sf1 704 264
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
             type Sf
              ports
               power out p;
              restrictions
               causality fixed in p;
             end;
             icon bg bottom
              figures
               text 'Sf' 704 264 18 bold;
             end;
             implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
           end;
           connections
            OneJunction5\p => Cendstop\p;
            Collision\p12 => OneJunction5\p;
            Sf1\p => Collision\p1;
            OneJunction5\p => Rendstop\p;
            Collision\p2 => p2;
            Collision\Collision -> collision;
           end;
           parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
          implementation_end;
         EndstopMin 320 224
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:54:44</TimeStamp>
</Description>';
          type Submodel
           ports
            power out p2;
            signal boolean out collision;
           parameters
            real Cendstop = 1.0e-4;
            real Rendstop = 1000.0;
            real InitialPos = -2.9496;
            real EndstopPos = -2.95;
          end;
          icon bg bottom
           figures
            rectangle 271 201 369 247 fill 14013909;
            text 'EndstopMin' 321 223 16;
          end;
          implementation bg
           submodels
            Cendstop 248 208
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type C
              ports
               power in p;
               signal out state;
              restrictions
               causality preferred out p;
              parameters
               real Cendstop = 1.0e-4;
             end;
             icon bg right
              figures
               text 'C' 248 208 18 bold;
             end;
             implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
            Collision 248 120
             description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type X0e
              ports
               power in p1;
               power out p2;
               power out p12;
               signal boolean out collision;
              restrictions
               causality fixed out p1;
               causality fixed out p2;
               causality fixed in p12;
              parameters
               real InitialPos = -2.9496;
               real EndstopLocation = -2.95;
             end;
             icon bg
              figures
               text 'X0e' 248 120 18 bold;
             end;
             implementation bg
              submodels
               Condition1 224.9 231.5
                type Condition
                 ports
                  signal in dx;
                  signal boolean out contact;
                end;
                icon bg
                 figures
                  rectangle 197.2 215 252.6 248 fill 15132390;
                  text 'Condition' 224 231.5;
                 terminals
                  dx 224 248 fixed;
                  contact 224 215 fixed;
                end;
                implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
               plug p1 96 176;
               plug p2 352 176;
               plug p12 224 64;
               plug collision 400 200;
               Splitter1 224 200
                description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot Splitter
                 ports
                  signal knot boolean duplicatable out output [1];
                  signal knot boolean in input [1];
                end;
                icon bg ellipse
                 figures
                  ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                  ellipse 219.7 195.7 228.3 204.3 color -1;
                 terminals
                  input 224 200 fixed;
                end;
                implementation eq
equations
    collect (output) = input;
implementation_end;
               v1 160 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 160 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v12 224 120
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg right
                 figures
                  text '1' 224 120 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               v2 296 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg top
                 figures
                  text '1' 296 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
               X0 224 176
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type X0
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean in condition;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                end;
                icon bg
                 figures
                  text 'X0' 224 176 color 8388608 18 bold;
                end;
                implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
               x1 160 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = -2.95;
                end;
                icon bg left
                 figures
                  rectangle 145 289 175 319 fill 15132390;
                  text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
               x12 224 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                knot PlusMinus
                 ports
                  signal knot duplicatable in plus [1];
                  signal knot duplicatable in minus [1];
                  signal knot out output [1];
                end;
                icon bg ellipse bottom
                 figures
                  ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                end;
                implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
               x2 296 304
                description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                type Integrate
                 ports
                  signal in input;
                  signal out output;
                 parameters
                  real Initial = -2.9496;
                end;
                icon bg right
                 figures
                  rectangle 281 289 311 319 fill 15132390;
                  text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                end;
                implementation eq
equations
	output = int (input, Initial);
     implementation_end;
              end;
              connections
               v1\p => X0\p1;
               X0\p2 => v2\p;
               X0\p12 => v12\p;
               v2\p => p2;
               v12\p => p12;
               p1 => v1\p;
               v1\flow -> x1\input;
               x1\output -> x12\plus;
               v2\flow -> x2\input;
               x2\output -> x12\minus;
               x12\output -> Condition1\dx;
               Condition1\contact -> Splitter1\input;
               Splitter1\output -> X0\condition;
               Splitter1\output -> collision;
              end;
              parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
             implementation_end;
            plug p2 152 120;
            plug collision 360 120;
            OneJunction 248 160
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 248 160 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Rendstop 288 160
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rendstop = 1000.0;
             end;
             icon bg bottom
              figures
               text 'R' 288 160 18 bold;
             end;
             implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
            Sf2 248 64
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
             type Sf
              ports
               power out p;
              restrictions
               causality fixed in p;
             end;
             icon bg bottom
              figures
               text 'Sf' 248 64 18 bold;
             end;
             implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
           end;
           connections
            Collision\p12 => OneJunction\p;
            OneJunction\p => Rendstop\p;
            OneJunction\p => Cendstop\p;
            Sf2\p => Collision\p1;
            Collision\p2 => p2;
            Collision\collision -> collision;
           end;
           parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
          implementation_end;
         Integrate 320 336
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Integrate
           ports
            signal in input;
            signal out output [4,4];
            signal out q;
           parameters
            real init = -2.9496;
          end;
          icon bg
           figures
            rectangle 304 320 336 352 fill 15132390;
            text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq
variables
	real R[3,3];
	real p[3];
	//real q;
equations
q = int(input,init);
R = [	cos(-q),	-sin(-q),	0;
			sin(-q),	cos(-q),	0;
			0,				0,				1];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
         MatrixMul 320 576
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Gain
           ports
            signal in input1 [4,4];
            signal out output [4,4];
            signal in input2 [4,4];
          end;
          icon bg bottom
           figures
            rectangle 304.1 560 335.9 592 fill 15132390;
            text 'X' 320 576 color 16711680 16 bold;
          end;
          implementation eq
equations
	output = input2*input1;    implementation_end;
         plug Hout 504 576;
         plug Hin 112 576;
         plug p2 496 424;
         plug p 112 424;
         plug p1 240 40;
         plug q 384 328;
         OneJunction 240 288
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            mechanical knot duplicatable none p [1];
            signal knot out flow [1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 240 288 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Or 400 224
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
          type 'Or-Or'
           ports
            signal boolean in input1;
            signal boolean out output;
            signal boolean in input2;
          end;
          icon bg bottom
           figures
            rectangle 384.1 208 415.9 240 fill 15132390;
            group
             line 386.3 217.3 396.8 217.3 color 16711680 fill 16711680;
             line 386.3 231.1 396.8 231.1 color 16711680 fill 16711680;
            end;
            spline 395.9 212.8 397.9 224.5 395.9 235.7 color 16711680 fill 16711680;
            line 404.7 224 413.5 224 color 16711680 fill 16711680;
            spline 395.7 212.3 401.9 214.6 404.8 224.4 401.6 233.4 395.7 235.7 color 16711680 fill 15132390;
          end;
          implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
         Rjoint 168 288
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p;
           parameters
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            text 'R' 168 288 18 bold;
          end;
          implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
         Splitter2 320 368
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [4,4];
            signal knot in input [4,4];
          end;
          icon bg ellipse
           figures
            ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
            ellipse 315.7 363.7 324.3 372.3 color -1;
           terminals
            input 320 368 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         uTbai 240 336
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1;
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
            causality fixed in p1;
            causality fixed out p2;
           parameters
            real Cconstraint = 1.0e-4;
            real Rconstraint = 1000.0;
          end;
          icon bg left
           figures
            text 'TF' 240 336 18 bold;
          end;
          implementation eq

equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = (Rconstraint*-p2.f[2] + int(-p2.f[2])/Cconstraint);
	p2.e[3] = p1.e;
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[3];
implementation_end;
         Wbai 240 424
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out effort [6,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg bottom
           figures
            text '0' 240 424 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
         ZeroJunction 240 104
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
          knot ZeroJunction
           ports
            mechanical knot duplicatable none p [1];
            signal knot out effort [1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg
           figures
            text '0' 240 104 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
        end;
        connections
         uTbai\p1 <= OneJunction\p;
         uTbai\p2 => Wbai\p;
         p <= Wbai\p;
         OneJunction\p <= EndstopMin\p2;
         Wbai\p <= AdHji\p1;
         p2 => AdHji\p2;
         OneJunction\p <= EndstopMax\p2;
         Rjoint\p <= OneJunction\p;
         ZeroJunction\p => OneJunction\p;
         p1 => ZeroJunction\p;
         OneJunction\flow -> Integrate\input 288 336;
         EndstopMax\collision -> Or\input1;
         Integrate\q -> q;
         Splitter2\output -> AdHji\H 424 368;
         MatrixMul\output -> Hout;
         Hin -> MatrixMul\input2;
         Integrate\output -> Splitter2\input;
         Splitter2\output -> MatrixMul\input1;
         EndstopMin\collision -> Or\input2;
        end;
        parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;

parameterrelations_end;
        figures
         text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 680 488;
       implementation_end;
      Link1 528 504
       description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Link.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:36:40</TimeStamp>
<Description>Base</Description>
</Description>';
       type Submodel
        ports
         power out p [6,1];
         signal in Hin [4,4];
         power in p1 [6,1];
         signal out Hout [4,4];
        parameters
         real I[3,1] = [1.0; 1.0; 1.0];
         real m = 2.412;
         real COMdim[3,1] = [0.10453; 0.0017; -0.00297];
         real dim[3,1] = [0.033; 0.0; 0.019];
       end;
       icon bg bottom
        figures
         rectangle 496 432 560 576 fill 10025880;
         text 'Link' 528 504;
        terminals
         p 496 464 fixed;
         Hin 496 544 fixed;
         p1 560 464 fixed;
         Hout 560 544 fixed;
       end;
       implementation bg
        submodels
         AdHi0 664 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power in p1 [6,1];
            power out p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg left
           figures
            text 'MTF' 664 416 18 bold;
          end;
          implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
         AdHij 816 304
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg top
           figures
            text 'MTF' 816 304 18 bold;
          end;
          implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
         AdHik 664 224
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1 [6,1];
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real COMdim[3,1] = [0.10453; 0.0017; -0.00297];
          end;
          icon bg left
           figures
            text 'TF' 664 224 18 bold;
          end;
          implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
         AdHik1 664 368
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real COMdim[3,1] = [0.10453; 0.0017; -0.00297];
          end;
          icon bg left
           figures
            text 'TF' 664 368 18 bold;
          end;
          implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
         EJS 728 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MGY
           ports
            power in p1 [6,1];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 2.412;
          end;
          icon bg top
           figures
            text 'MGY' 728 184 18 bold;
          end;
          implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
         Gravity 776 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Se
           ports
            power out p [6,1];
           restrictions
            causality fixed out p;
           parameters
            real m = 2.412;
          end;
          icon bg bottom
           figures
            text 'Se' 776 416 18 bold;
          end;
          implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
         Hij 816 496
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Gain
           ports
            signal in input [4,4];
            signal out output [4,4];
            signal out Hab [4,4];
           parameters
            real dim[3,1] = [0.033; 0.0; 0.019];
          end;
          icon bg bottom
           figures
            rectangle 800.1 480 831.9 512 fill 15132390;
            text 'H' 816 496 color 16711680 16 bold;
          end;
          implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
         InertialTensor 616 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type I
           ports
            power in p [6,1];
            signal out state [6,1];
           restrictions
            causality preferred in p;
           parameters
            real m = 1.0;
            real I[3,1] = [1.0; 1.0; 1.0];
          end;
          icon bg top
           figures
            text 'I' 616 184 18 bold;
          end;
          implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
         plug Hout 896 496;
         plug p1 904 304;
         plug Hin 592 496;
         plug p 592 304;
         Splitter1 664 496
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [4,4];
            signal knot in input [4,4];
          end;
          icon bg ellipse
           figures
            ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
            ellipse 659.7 491.7 668.3 500.3 color -1;
           terminals
            input 664 496 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Ta00 720 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 720 416 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Ta0i 664 304
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 664 304 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Ta0k 664 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 664 184 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         AdHik\p2 => Ta0k\p;
         Ta0i\p <= AdHik1\p1;
         AdHi0\p2 => AdHik1\p2;
         Gravity\p => Ta00\p;
         Ta0i\p => AdHik\p1;
         p <= Ta0i\p;
         Ta0i\p <= AdHij\p1;
         Ta0k\p => EJS\p1;
         p1 => AdHij\p2;
         Ta00\p => AdHi0\p1;
         Ta0k\p => InertialTensor\p;
         Hin -> Splitter1\input;
         Hij\output -> Hout;
         Splitter1\output -> Hij\input;
         Splitter1\output -> AdHi0\H;
         Hij\Hab -> AdHij\H;
        end;
        parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
        figures
         text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
       implementation_end;
      Link2 688 504
       description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Link.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:36:40</TimeStamp>
<Description>Base</Description>
</Description>';
       type Submodel
        ports
         power out p [6,1];
         signal in Hin [4,4];
         power in p1 [6,1];
         signal out Hout [4,4];
        parameters
         real I[3,1] = [1.0; 1.0; 1.0];
         real m = 1.155;
         real COMdim[3,1] = [0.001; 0.0967; 0.02107];
         real dim[3,1] = [0.0; 0.0; 0.155];
       end;
       icon bg bottom
        figures
         rectangle 656 432 720 576 fill 10025880;
         text 'Link' 688 504;
        terminals
         p 656 464 fixed;
         Hin 656 544 fixed;
         p1 720 464 fixed;
         Hout 720 544 fixed;
       end;
       implementation bg
        submodels
         AdHi0 664 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power in p1 [6,1];
            power out p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg left
           figures
            text 'MTF' 664 416 18 bold;
          end;
          implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
         AdHij 816 304
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg top
           figures
            text 'MTF' 816 304 18 bold;
          end;
          implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
         AdHik 664 224
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1 [6,1];
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real COMdim[3,1] = [0.001; 0.0967; 0.02107];
          end;
          icon bg left
           figures
            text 'TF' 664 224 18 bold;
          end;
          implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
         AdHik1 664 368
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real COMdim[3,1] = [0.001; 0.0967; 0.02107];
          end;
          icon bg left
           figures
            text 'TF' 664 368 18 bold;
          end;
          implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
         EJS 728 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MGY
           ports
            power in p1 [6,1];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 1.155;
          end;
          icon bg top
           figures
            text 'MGY' 728 184 18 bold;
          end;
          implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
         Gravity 776 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Se
           ports
            power out p [6,1];
           restrictions
            causality fixed out p;
           parameters
            real m = 1.155;
          end;
          icon bg bottom
           figures
            text 'Se' 776 416 18 bold;
          end;
          implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
         Hij 816 496
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Gain
           ports
            signal in input [4,4];
            signal out output [4,4];
            signal out Hab [4,4];
           parameters
            real dim[3,1] = [0.0; 0.0; 0.155];
          end;
          icon bg bottom
           figures
            rectangle 800.1 480 831.9 512 fill 15132390;
            text 'H' 816 496 color 16711680 16 bold;
          end;
          implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
         InertialTensor 616 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type I
           ports
            power in p [6,1];
            signal out state [6,1];
           restrictions
            causality preferred in p;
           parameters
            real m = 1.0;
            real I[3,1] = [1.0; 1.0; 1.0];
          end;
          icon bg top
           figures
            text 'I' 616 184 18 bold;
          end;
          implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
         plug Hout 896 496;
         plug p1 904 304;
         plug Hin 592 496;
         plug p 592 304;
         Splitter1 664 496
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [4,4];
            signal knot in input [4,4];
          end;
          icon bg ellipse
           figures
            ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
            ellipse 659.7 491.7 668.3 500.3 color -1;
           terminals
            input 664 496 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Ta00 720 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 720 416 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Ta0i 664 304
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 664 304 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Ta0k 664 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 664 184 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         AdHik\p2 => Ta0k\p;
         Ta0i\p <= AdHik1\p1;
         AdHi0\p2 => AdHik1\p2;
         Gravity\p => Ta00\p;
         Ta0i\p => AdHik\p1;
         p <= Ta0i\p;
         Ta0i\p <= AdHij\p1;
         Ta0k\p => EJS\p1;
         p1 => AdHij\p2;
         Ta00\p => AdHi0\p1;
         Ta0k\p => InertialTensor\p;
         Hin -> Splitter1\input;
         Hij\output -> Hout;
         Splitter1\output -> Hij\input;
         Splitter1\output -> AdHi0\H;
         Hij\Hab -> AdHij\H;
        end;
        parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
        figures
         text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
       implementation_end;
      Link3 848 504
       description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link.emx</LibraryPath>
 <TimeStamp>2011-1-18 16:36:40</TimeStamp>
   <Description>Base</Description>
</Description>';
       type Submodel
        ports
         power out p [6,1];
         signal in Hin [4,4];
         power in p1 [6,1];
         signal out Hout [4,4];
        parameters
         real I[3,1] = [1.0; 1.0; 1.0];
         real m = 0.934;
         real COMdim[3,1] = [0.011; 0.05103; -0.02319];
         real dim[3,1] = [0.0; 0.0; 0.135];
       end;
       icon bg bottom
        figures
         rectangle 816 432 880 576 fill 10025880;
         text 'Link' 848 504;
        terminals
         p 816 464 fixed;
         Hin 816 544 fixed;
         p1 880 464 fixed;
         Hout 880 544 fixed;
       end;
       implementation bg
        submodels
         AdHi0 664 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power in p1 [6,1];
            power out p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg left
           figures
            text 'MTF' 664 416 18 bold;
          end;
          implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
         AdHij 816 304
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg top
           figures
            text 'MTF' 816 304 18 bold;
          end;
          implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
         AdHik 664 224
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1 [6,1];
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real COMdim[3,1] = [0.011; 0.05103; -0.02319];
          end;
          icon bg left
           figures
            text 'TF' 664 224 18 bold;
          end;
          implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
         AdHik1 664 368
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real COMdim[3,1] = [0.011; 0.05103; -0.02319];
          end;
          icon bg left
           figures
            text 'TF' 664 368 18 bold;
          end;
          implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
         EJS 728 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MGY
           ports
            power in p1 [6,1];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 0.934;
          end;
          icon bg top
           figures
            text 'MGY' 728 184 18 bold;
          end;
          implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
         Gravity 776 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Se
           ports
            power out p [6,1];
           restrictions
            causality fixed out p;
           parameters
            real m = 0.934;
          end;
          icon bg bottom
           figures
            text 'Se' 776 416 18 bold;
          end;
          implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
         Hij 816 496
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Gain
           ports
            signal in input [4,4];
            signal out output [4,4];
            signal out Hab [4,4];
           parameters
            real dim[3,1] = [0.0; 0.0; 0.135];
          end;
          icon bg bottom
           figures
            rectangle 800.1 480 831.9 512 fill 15132390;
            text 'H' 816 496 color 16711680 16 bold;
          end;
          implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
         InertialTensor 616 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type I
           ports
            power in p [6,1];
            signal out state [6,1];
           restrictions
            causality preferred in p;
           parameters
            real m = 1.0;
            real I[3,1] = [1.0; 1.0; 1.0];
          end;
          icon bg top
           figures
            text 'I' 616 184 18 bold;
          end;
          implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
         plug Hout 896 496;
         plug p1 904 304;
         plug Hin 592 496;
         plug p 592 304;
         Splitter1 664 496
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [4,4];
            signal knot in input [4,4];
          end;
          icon bg ellipse
           figures
            ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
            ellipse 659.7 491.7 668.3 500.3 color -1;
           terminals
            input 664 496 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Ta00 720 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 720 416 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Ta0i 664 304
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 664 304 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Ta0k 664 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 664 184 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         AdHik\p2 => Ta0k\p;
         Ta00\p => AdHi0\p1;
         Ta0k\p => InertialTensor\p;
         Ta0i\p <= AdHik1\p1;
         AdHi0\p2 => AdHik1\p2;
         Gravity\p => Ta00\p;
         Ta0i\p => AdHik\p1;
         p <= Ta0i\p;
         Ta0i\p <= AdHij\p1;
         Ta0k\p => EJS\p1;
         p1 => AdHij\p2;
         Hin -> Splitter1\input;
         Hij\output -> Hout;
         Splitter1\output -> Hij\input;
         Splitter1\output -> AdHi0\H;
         Hij\Hab -> AdHij\H;
        end;
        parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
        figures
         text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
       implementation_end;
      Link4 1008 504
       description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link.emx</LibraryPath>
 <TimeStamp>2011-1-18 16:36:40</TimeStamp>
   <Description>Base</Description>
</Description>';
       type Submodel
        ports
         power out p [6,1];
         signal in Hin [4,4];
         power in p1 [6,1];
         signal out Hout [4,4];
        parameters
         real I[3,1] = [1.0; 1.0; 1.0];
         real m = 0.877;
         real COMdim[3,1] = [0.0; 0.00115; -0.01683];
         real dim[3,1] = [0.0; 0.0; 0.096];
       end;
       icon bg bottom
        figures
         rectangle 976 432 1040 576 fill 10025880;
         text 'Link' 1008 504;
        terminals
         p 976 464 fixed;
         Hin 976 544 fixed;
         p1 1040 464 fixed;
         Hout 1040 544 fixed;
       end;
       implementation bg
        submodels
         AdHi0 664 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power in p1 [6,1];
            power out p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg left
           figures
            text 'MTF' 664 416 18 bold;
          end;
          implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
         AdHij 816 304
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg top
           figures
            text 'MTF' 816 304 18 bold;
          end;
          implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
         AdHik 664 224
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1 [6,1];
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real COMdim[3,1] = [0.0; 0.00115; -0.01683];
          end;
          icon bg left
           figures
            text 'TF' 664 224 18 bold;
          end;
          implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
         AdHik1 664 368
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real COMdim[3,1] = [0.0; 0.00115; -0.01683];
          end;
          icon bg left
           figures
            text 'TF' 664 368 18 bold;
          end;
          implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
         EJS 728 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MGY
           ports
            power in p1 [6,1];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 0.877;
          end;
          icon bg top
           figures
            text 'MGY' 728 184 18 bold;
          end;
          implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
         Gravity 776 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Se
           ports
            power out p [6,1];
           restrictions
            causality fixed out p;
           parameters
            real m = 0.877;
          end;
          icon bg bottom
           figures
            text 'Se' 776 416 18 bold;
          end;
          implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
         Hij 816 496
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Gain
           ports
            signal in input [4,4];
            signal out output [4,4];
            signal out Hab [4,4];
           parameters
            real dim[3,1] = [0.0; 0.0; 0.096];
          end;
          icon bg bottom
           figures
            rectangle 800.1 480 831.9 512 fill 15132390;
            text 'H' 816 496 color 16711680 16 bold;
          end;
          implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
         InertialTensor 616 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type I
           ports
            power in p [6,1];
            signal out state [6,1];
           restrictions
            causality preferred in p;
           parameters
            real m = 1.0;
            real I[3,1] = [1.0; 1.0; 1.0];
          end;
          icon bg top
           figures
            text 'I' 616 184 18 bold;
          end;
          implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
         plug Hout 896 496;
         plug p1 904 304;
         plug Hin 592 496;
         plug p 592 304;
         Splitter1 664 496
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [4,4];
            signal knot in input [4,4];
          end;
          icon bg ellipse
           figures
            ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
            ellipse 659.7 491.7 668.3 500.3 color -1;
           terminals
            input 664 496 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Ta00 720 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 720 416 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Ta0i 664 304
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 664 304 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Ta0k 664 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 664 184 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         AdHik\p2 => Ta0k\p;
         Ta0i\p <= AdHik1\p1;
         AdHi0\p2 => AdHik1\p2;
         Gravity\p => Ta00\p;
         Ta0i\p => AdHik\p1;
         p <= Ta0i\p;
         Ta0i\p <= AdHij\p1;
         Ta0k\p => EJS\p1;
         p1 => AdHij\p2;
         Ta00\p => AdHi0\p1;
         Ta0k\p => InertialTensor\p;
         Hin -> Splitter1\input;
         Hij\output -> Hout;
         Splitter1\output -> Hij\input;
         Splitter1\output -> AdHi0\H;
         Hij\Hab -> AdHij\H;
        end;
        parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
        figures
         text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
       implementation_end;
      Link5 1168 504
       description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link.emx</LibraryPath>
 <TimeStamp>2011-1-18 16:36:40</TimeStamp>
   <Description>Base</Description>
</Description>';
       type Submodel
        ports
         power out p [6,1];
         signal in Hin [4,4];
         power in p1 [6,1];
         signal out Hout [4,4];
        parameters
         real I[3,1] = [1.0; 1.0; 1.0];
         real m = 1.121;
         real COMdim[3,1] = [0.0; 0.0; 0.001];
         real dim[3,1] = [0.0; 0.0; 0.034];
       end;
       icon bg bottom
        figures
         rectangle 1136 432 1200 576 fill 10025880;
         text 'Link' 1168 504;
        terminals
         p 1136 464 fixed;
         Hin 1136 544 fixed;
         p1 1200 464 fixed;
         Hout 1200 544 fixed;
       end;
       implementation bg
        submodels
         AdHi0 664 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power in p1 [6,1];
            power out p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg left
           figures
            text 'MTF' 664 416 18 bold;
          end;
          implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
         AdHij 816 304
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
            signal in H [4,4];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg top
           figures
            text 'MTF' 816 304 18 bold;
          end;
          implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
         AdHik 664 224
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1 [6,1];
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real COMdim[3,1] = [0.0; 0.0; 0.001];
          end;
          icon bg left
           figures
            text 'TF' 664 224 18 bold;
          end;
          implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
         AdHik1 664 368
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power out p1 [6,1];
            power in p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real COMdim[3,1] = [0.0; 0.0; 0.001];
          end;
          icon bg left
           figures
            text 'TF' 664 368 18 bold;
          end;
          implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
         EJS 728 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MGY
           ports
            power in p1 [6,1];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 1.121;
          end;
          icon bg top
           figures
            text 'MGY' 728 184 18 bold;
          end;
          implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
         Gravity 776 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Se
           ports
            power out p [6,1];
           restrictions
            causality fixed out p;
           parameters
            real m = 1.121;
          end;
          icon bg bottom
           figures
            text 'Se' 776 416 18 bold;
          end;
          implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
         Hij 816 496
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Gain
           ports
            signal in input [4,4];
            signal out output [4,4];
            signal out Hab [4,4];
           parameters
            real dim[3,1] = [0.0; 0.0; 0.034];
          end;
          icon bg bottom
           figures
            rectangle 800.1 480 831.9 512 fill 15132390;
            text 'H' 816 496 color 16711680 16 bold;
          end;
          implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
         InertialTensor 616 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type I
           ports
            power in p [6,1];
            signal out state [6,1];
           restrictions
            causality preferred in p;
           parameters
            real m = 1.0;
            real I[3,1] = [1.0; 1.0; 1.0];
          end;
          icon bg top
           figures
            text 'I' 616 184 18 bold;
          end;
          implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
         plug Hout 896 496;
         plug p1 904 304;
         plug Hin 592 496;
         plug p 592 304;
         Splitter1 664 496
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [4,4];
            signal knot in input [4,4];
          end;
          icon bg ellipse
           figures
            ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
            ellipse 659.7 491.7 668.3 500.3 color -1;
           terminals
            input 664 496 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         Ta00 720 416
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 720 416 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Ta0i 664 304
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg bottom
           figures
            text '1' 664 304 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         Ta0k 664 184
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg top
           figures
            text '1' 664 184 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
        end;
        connections
         AdHik\p2 => Ta0k\p;
         Gravity\p => Ta00\p;
         Ta0i\p => AdHik\p1;
         p <= Ta0i\p;
         Ta0i\p <= AdHij\p1;
         Ta0k\p => EJS\p1;
         p1 => AdHij\p2;
         Ta00\p => AdHi0\p1;
         Ta0k\p => InertialTensor\p;
         Ta0i\p <= AdHik1\p1;
         AdHi0\p2 => AdHik1\p2;
         Hin -> Splitter1\input;
         Hij\output -> Hout;
         Splitter1\output -> Hij\input;
         Splitter1\output -> AdHi0\H;
         Hij\Hab -> AdHij\H;
        end;
        parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
        figures
         text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
       implementation_end;
      MecanumWheels 271.9 504
       description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>MechanumWheels.emx</LibraryPath>
  <TimeStamp>2011-1-20 16:56:20</TimeStamp>
</Description>';
       type Submodel
        ports
         power in p [6,1];
         power in p1 [6,1];
         power in MotorRR;
         power in MotorLR;
         power in MotorLF;
         power in MotorRF;
         signal out Hout [4,4];
         signal in Hin [4,4];
        restrictions
         causality fixed in MotorLR;
         causality fixed in MotorLF;
         causality fixed in MotorRF;
         causality fixed in MotorRR;
        parameters
         real WheelRadius = 0.053;
         real WheelLFpos[2,1] = [0.215; -0.15];
         real WheelRFpos[2,1] = [0.215; 0.15];
         real WheelLRpos[2,1] = [-0.215; -0.15];
         real WheelRRpos[2,1] = [-0.215; 0.15];
         real Cfloor = 1.0e-4;
         real Rfloor = 1000.0;
         real init[4,4] = [1.0, 0.0, 0.0, 0.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];
         real Rwheel = 1.0;
       end;
       icon bg bottom
        figures
         rectangle 231.1 432.5 312.6 575.5 fill 16443110;
         text 'Mecanum 
 Wheels' 271.9 504 fill 16443110 16;
        terminals
         p 311.9 464 fixed;
         p1 232.4 463 fixed;
         MotorRR 295.9 432 fixed;
         MotorLR 279.9 432 fixed;
         MotorLF 247.9 432 fixed;
         MotorRF 263.9 432 fixed;
         Hout 311.9 544 fixed;
         Hin 231.9 544 fixed;
       end;
       implementation bg
        submodels
         Cfloor 864 656
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type C
           ports
            power in p [6,1];
            signal out state [6,1];
           restrictions
            causality preferred out p;
           parameters
            real Cfloor = 1.0e-4;
          end;
          icon bg bottom
           figures
            text 'C' 864 656 18 bold;
          end;
          implementation eq
equations
    state = int(p.f);
    p.e = [(1/Cfloor) * state[1];(1/Cfloor) * state[2];0;0;0;(1/Cfloor) * state[6]];
implementation_end;
         Integrate2 1032 624
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:3:23</TimeStamp>
</Description>';
          type Integrate
           ports
            signal in input [6,1];
            signal out output [4,4];
           parameters
            real init[4,4] = [1.0, 0.0, 0.0, 0.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];
          end;
          icon bg
           figures
            rectangle 1016 608 1048 640 fill 15132390;
            text 'ò' 1032 621.3 color 16711680 'SymbolProp BT' 21 symbol;
          end;
          implementation eq

variables
	real H[4,4];
	real dotH[4,4];
	real tildeT[4,4];
equations
	tildeT = tilde(input);
	dotH = H*tildeT;
	H = int(dotH,init);
	output = H;





     


	
     implementation_end;
         MatrixMul 1032 792
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Gain
           ports
            signal in input1 [4,4];
            signal out output [4,4];
            signal in input2 [4,4];
          end;
          icon bg bottom
           figures
            rectangle 1016.1 776 1047.9 808 fill 15132390;
            text 'X' 1032 792 color 16711680 16 bold;
          end;
          implementation eq
equations
	output = input2*input1;    implementation_end;
         MecanumWheelAnimation 1103.5 312
          description '<Description>
 <Version>4.0</Version>
 <LibraryPath>Template\Submodel-Equation.emx</LibraryPath>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <TimeStamp>2007-11-1 22:32:1</TimeStamp>
 <AllowLibraryUpdate>False</AllowLibraryUpdate>
</Description>';
          type 'Submodel-Equation'
           ports
            signal in Hbase0 [4,4];
            signal in vWheelLF;
            signal in vWheelRF;
            signal in vWheelLR;
            signal in vWheelRR;
           parameters
            real WheelLFpos[2,1] = [0.215; -0.15];
            real WheelRFpos[2,1] = [0.215; 0.15];
            real WheelLRpos[2,1] = [-0.215; -0.15];
            real WheelRRpos[2,1] = [-0.215; 0.15];
          end;
          icon bg
           figures
            rectangle 1055 272 1152 352 fill 14013909;
            text 'Mecanum
   Wheel
 Animation' 1104 312 16;
           terminals
            Hbase0 1104 352 fixed;
            vWheelLF 1056 288 fixed;
            vWheelRF 1056 304 fixed;
            vWheelLR 1056 320 fixed;
            vWheelRR 1056 336 fixed;
          end;
          implementation eq
parameters
	real rot = 1.57;
//end
variables
//t.b.v. animation of mecanum wheels
	real HLRrot[4,4], HLFrot[4,4], HRRrot[4,4], HRFrot[4,4];
	real RLRrot[3,3], RLFrot[3,3], RRRrot[3,3], RRFrot[3,3];
	real RLRbase[3,3], RLFbase[3,3], RRFbase[3,3], RRRbase[3,3];
	real HLRbase[4,4], HLFbase[4,4], HRFbase[4,4], HRRbase[4,4];
	real HLR0[4,4], HLF0[4,4], HRF0[4,4], HRR0[4,4];
	real pLRbase[3], pLFbase[3], pRFbase[3], pRRbase[3];

	real qWheelLF, qWheelRF,qWheelLR, qWheelRR;
//end
equations
	qWheelLF = int(vWheelLF);
	qWheelRF = int(vWheelRF);
	qWheelLR = int(vWheelLR);
	qWheelRR = int(vWheelRR);


//t.b.v. animation of mecanum wheel
	pLFbase = [WheelLFpos[1];WheelLFpos[2];0.05];
	pRFbase = [WheelRFpos[1];WheelRFpos[2];0.05];
	pLRbase = [WheelLRpos[1];WheelLRpos[2];0.05];
	pRRbase = [WheelRRpos[1];WheelRRpos[2];0.05];
	
	RLRbase = [
		1,	0,				0;
		0,	cos(rot),	-sin(rot);
		0, sin(rot),	cos(rot)
	];
		
	RLFbase = [
		1,	0,				0;
		0,	cos(rot),	-sin(rot);
		0, sin(rot),	cos(rot)
	];

	RRFbase = [
		1,	0,				0;
		0,	cos(rot),	-sin(rot);
		0, sin(rot),	cos(rot)
	];

	RRRbase = [
		1,	0,				0;
		0,	cos(rot),	-sin(rot);
		0, sin(rot),	cos(rot)
	];

	HLFbase = homogeneous(RLFbase, pLFbase);
	HLRbase = homogeneous(RLRbase, pLRbase);
	HRRbase = homogeneous(RRRbase, pRRbase);
	HRFbase = homogeneous(RRFbase, pRFbase);

	RLRrot = [
		cos(-qWheelLR),	-sin(-qWheelLR),	0;
		sin(-qWheelLR),	cos(-qWheelLR),	0;
		0,				0,				1
	];
		
	RLFrot = [
		cos(-qWheelLF),	-sin(-qWheelLF),	0;
		sin(-qWheelLF),	cos(-qWheelLF),	0;
		0,				0,				1
	];

	RRFrot = [
		cos(-qWheelRF),	-sin(-qWheelRF),	0;
		sin(-qWheelRF),	cos(-qWheelRF),	0;
		0,				0,				1
	];

	RRRrot = [
		cos(-qWheelRR),	-sin(-qWheelRR),	0;
		sin(-qWheelRR),	cos(-qWheelRR),	0;
		0,				0,				1
	];

	HLFrot = homogeneous(RLFrot,[0;0;0]);
	HRFrot = homogeneous(RRFrot,[0;0;0]);
	HLRrot = homogeneous(RLRrot,[0;0;0]);
	HRRrot = homogeneous(RRRrot,[0;0;0]);

	HLF0 = Hbase0*HLFbase*HLFrot;
	HRF0 = Hbase0*HRFbase*HRFrot;
	HLR0 = Hbase0*HLRbase*HLRrot;
	HRR0 = Hbase0*HRRbase*HRRrot;
//end
 implementation_end;
         plug MotorLR 912 240;
         plug MotorLF 720 240;
         plug Hout 1184 792;
         plug Hin 696 792;
         plug MotorRR 1008 240;
         plug p1 693 704;
         plug MotorRF 816 240;
         plug p 1168 704;
         OneJunction 920 624
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out flow [6,1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 920 624 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
         OneJunction2 1008 336
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [1];
            signal knot out flow [1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 1008 336 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction3 912 320
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [1];
            signal knot out flow [1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 912 320 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction4 720 288
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [1];
            signal knot out flow [1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 720 288 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         OneJunction5 816 304
          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
          knot OneJunction
           ports
            power knot duplicatable none p [1];
            signal knot out flow [1];
           restrictions
            causality constraint one_out p;
          end;
          icon bg
           figures
            text '1' 816 304 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
         Rfloor 840 624
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p [6,1];
           parameters
            real Rfloor = 1000.0;
          end;
          icon bg bottom
           figures
            text 'R' 840 624 18 bold;
          end;
          implementation eq
equations					
	p.e = [Rfloor * p.f[1];Rfloor * p.f[2];0;0;0;Rfloor * p.f[6]];
implementation_end;
         RwheelLF 672 288
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p;
           parameters
            real Rwheel = 1.0;
          end;
          icon bg bottom
           figures
            text 'R' 672 288 18 bold;
          end;
          implementation eq
equations					
	p.e = Rwheel * p.f;
implementation_end;
         RwheelLR 864 320
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p;
           parameters
            real Rwheel = 1.0;
          end;
          icon bg bottom
           figures
            text 'R' 864 320 18 bold;
          end;
          implementation eq
equations					
	p.e = Rwheel * p.f;
implementation_end;
         RwheelRF 768 304
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p;
           parameters
            real Rwheel = 1.0;
          end;
          icon bg bottom
           figures
            text 'R' 768 304 18 bold;
          end;
          implementation eq
equations					
	p.e = Rwheel * p.f;
implementation_end;
         RwheelRR 960 336
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type R
           ports
            power in p;
           parameters
            real Rwheel = 1.0;
          end;
          icon bg bottom
           figures
            text 'R' 960 336 18 bold;
          end;
          implementation eq
equations					
	p.e = Rwheel * p.f;
implementation_end;
         Splitter1 1104 792
          description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
          knot Splitter
           ports
            signal knot duplicatable out output [4,4];
            signal knot in input [4,4];
          end;
          icon bg ellipse
           figures
            ellipse 1100.8 788.8 1107.2 795.2 color -1 fill 0;
            ellipse 1099.7 787.7 1108.3 796.3 color -1;
           terminals
            input 1104 792 fixed;
          end;
          implementation eq
equations
    collect (output) = input;
implementation_end;
         TF_LF 720 504
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1 [3,1];
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real WheelLFpos[2,1] = [0.215; -0.15];
          end;
          icon bg bottom
           figures
            text 'TF' 720 504 18 bold;
          end;
          implementation eq
variables	
	real TFr[6,3];
	real transTFr[3,6];
equations
	TFr[1:3,1:3] = skew([WheelLFpos[1];WheelLFpos[2];0]);
	TFr[4:6,1:3] = eye(3); 

	transTFr[1:3,1:3] = -skew([WheelLFpos[1];WheelLFpos[2];0]);
	transTFr[1:3,4:6] = eye(3); 
	
	p2.e = TFr*p1.e;
	p1.f = transTFr*p2.f;
implementation_end;
         TF_LR 912 504
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1 [3,1];
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real WheelLRpos[2,1] = [-0.215; -0.15];
          end;
          icon bg bottom
           figures
            text 'TF' 912 504 18 bold;
          end;
          implementation eq
variables
	real TFr[6,3];
	real transTFr[3,6];
equations
	TFr[1:3,1:3] = skew([WheelLRpos[1];WheelLRpos[2];0]);
	TFr[4:6,1:3] = eye(3); 

	transTFr[1:3,1:3] = -skew([WheelLRpos[1];WheelLRpos[2];0]);
	transTFr[1:3,4:6] = eye(3); 
	
	p2.e = TFr*p1.e;
	p1.f = transTFr*p2.f;
implementation_end;
         TF_RF 816 504
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1 [3,1];
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real WheelRFpos[2,1] = [0.215; 0.15];
          end;
          icon bg bottom
           figures
            text 'TF' 816 504 18 bold;
          end;
          implementation eq
variables	
	real TFr[6,3];
	real transTFr[3,6];
equations
	TFr[1:3,1:3] = skew([WheelRFpos[1];WheelRFpos[2];0]);
	TFr[4:6,1:3] = eye(3); 

	transTFr[1:3,1:3] = -skew([WheelRFpos[1];WheelRFpos[2];0]);
	transTFr[1:3,4:6] = eye(3); 
	
	p2.e = TFr*p1.e;
	p1.f = transTFr*p2.f;
implementation_end;
         TF_RR 1008 504
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type TF
           ports
            power in p1 [3,1];
            power out p2 [6,1];
           restrictions
            causality constraint not_equal p1 p2;
           parameters
            real WheelRRpos[2,1] = [-0.215; 0.15];
          end;
          icon bg bottom
           figures
            text 'TF' 1008 504 18 bold;
          end;
          implementation eq
variables	
	real TFr[6,3];
	real transTFr[3,6];
equations
	TFr[1:3,1:3] = skew([WheelRRpos[1];WheelRRpos[2];0]);
	TFr[4:6,1:3] = eye(3); 

	transTFr[1:3,1:3] = -skew([WheelRRpos[1];WheelRRpos[2];0]);
	transTFr[1:3,4:6] = eye(3); 
	
	p2.e = TFr*p1.e;
	p1.f = transTFr*p2.f;
implementation_end;
         WheelLF 720 408
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>MecanumWheelB.emx</LibraryPath>
  <TimeStamp>2011-1-20 16:56:09</TimeStamp>
</Description>';
          type Submodel
           ports
            power in p;
            power out p2 [3,1];
           parameters
            real WheelRadius = 0.053;
          end;
          icon bg bottom
           figures
            rectangle 690 386 750 430 fill 16777152;
            text 'Mecanum 
wheel type B' 720 408;
          end;
          implementation bg
           submodels
            MotorTorgue 112 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg top
              figures
               text '0' 112 176 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            plug p 71 176;
            plug p2 457 176;
            TF1 240 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Transforms from the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the principal inertial frame of the robot body
to the the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'TF' 240 176 18 bold;
             end;
             implementation eq
//Standard rotation arboud z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(pi/4), 	-sin(pi/4), 	0;
			sin(pi/4), 	cos(pi/4),		0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
            TF2 304 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>This transformer represents the interchange of energy 
between the wheel and the floor. In the rolling direction 
there is no energy exchangem, in the siding direction there is.
In case of a type B mechanum wheel the rolling direction is 
the y direction of the frame oriented with the roller.</Description>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'TF' 304 176 18 bold;
             end;
             implementation eq
parameters
	real r[3,3] = [0,0,0;0,1,0;0,0,1];
equations
p2.e = transpose(r)*p1.e;
p1.f = r*p2.f;implementation_end;
            TF3 368 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Inverse of TF1: Transforms back.</Description>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'TF' 368 176 18 bold;
             end;
             implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;
			sin(-pi/4), 	cos(-pi/4),	0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
            WheelRadius 152 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real WheelRadius = 0.053;
             end;
             icon bg bottom
              figures
               text 'TF' 152 176 18 bold;
             end;
             implementation eq
equations					
	p2.e = [p1.e/WheelRadius;0;0];
	p1.f = p2.f[1]/WheelRadius;
implementation_end;
           end;
           connections
            WheelRadius\p2 => TF1\p1;
            MotorTorgue\p => WheelRadius\p1;
            TF1\p2 => TF2\p1;
            TF2\p2 => TF3\p1;
            p => MotorTorgue\p;
            TF3\p2 => p2;
           end;
           parameterrelations
WheelRadius\WheelRadius = WheelRadius;parameterrelations_end;
          implementation_end;
         WheelLR 912 408
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>MecanumWheelA.emx</LibraryPath>
 <TimeStamp>2011-1-18 13:53:24</TimeStamp>
</Description>';
          type Submodel
           ports
            power in p;
            power out p2 [3,1];
           parameters
            real WheelRadius = 0.053;
          end;
          icon bg bottom
           figures
            rectangle 882 386 942 430 fill 16777152;
            text 'Mecanum 
wheel type A' 912 408;
          end;
          implementation bg
           submodels
            MotorTorgue1 96 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg top
              figures
               text '0' 96 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            plug p 47 304;
            plug p2 401 304;
            TF1 200 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Transforms from the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the principal inertial frame of the robot body
to the the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'TF' 200 304 18 bold;
             end;
             implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(pi/4), 	-sin(pi/4), 	0;
			sin(pi/4), 	cos(pi/4),		0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
            TF2 256 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>This transformer represents the interchange of energy 
between the wheel and the floor. In the rolling direction 
there is no energy exchangem, in the siding direction there is.
In case of a type A mechanum wheel the rolling direction is 
the x direction of the frame oriented with the roller.</Description>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'TF' 256 304 18 bold;
             end;
             implementation eq
parameters
	real r[3,3] = [1,0,0;0,0,0;0,0,1];
equations
p2.e = transpose(r)*p1.e;
p1.f = r*p2.f;implementation_end;
            TF3 312 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Inverse of TF1: transforms back.</Description>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'TF' 312 304 18 bold;
             end;
             implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;
			sin(-pi/4), 	cos(-pi/4),	0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
            WheelRadius1 144 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real WheelRadius = 1.0;
             end;
             icon bg bottom
              figures
               text 'TF' 144 304 18 bold;
             end;
             implementation eq
equations					
	p2.e = [p1.e/WheelRadius;0;0];
	p1.f = p2.f[1]/WheelRadius;
implementation_end;
           end;
           connections
            WheelRadius1\p2 => TF1\p1;
            TF1\p2 => TF2\p1;
            MotorTorgue1\p => WheelRadius1\p1;
            TF2\p2 => TF3\p1;
            p => MotorTorgue1\p;
            TF3\p2 => p2;
           end;
           parameterrelations
WheelRadius\WheelRadius = WheelRadius;parameterrelations_end;
          implementation_end;
         WheelRF 816 408
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>MecanumWheelA.emx</LibraryPath>
  <TimeStamp>2011-1-20 16:33:00</TimeStamp>
</Description>';
          type Submodel
           ports
            power in p;
            power out p2 [3,1];
           parameters
            real WheelRadius = 0.053;
          end;
          icon bg bottom
           figures
            rectangle 786 386 846 430 fill 16777152;
            text 'Mecanum 
wheel type A' 816 408;
          end;
          implementation bg
           submodels
            MotorTorgue1 96 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg top
              figures
               text '0' 96 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            plug p 47 304;
            plug p2 401 304;
            TF1 200 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Transforms from the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the principal inertial frame of the robot body
to the the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'TF' 200 304 18 bold;
             end;
             implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(pi/4), 	-sin(pi/4), 	0;
			sin(pi/4), 	cos(pi/4),		0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
            TF2 256 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>This transformer represents the interchange of energy 
between the wheel and the floor. In the rolling direction 
there is no energy exchangem, in the siding direction there is.
In case of a type A mechanum wheel the rolling direction is 
the x direction of the frame oriented with the roller.</Description>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'TF' 256 304 18 bold;
             end;
             implementation eq
parameters
	real r[3,3] = [1,0,0;0,0,0;0,0,1];
equations
p2.e = transpose(r)*p1.e;
p1.f = r*p2.f;implementation_end;
            TF3 312 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Inverse of TF1: transforms back.</Description>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'TF' 312 304 18 bold;
             end;
             implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;
			sin(-pi/4), 	cos(-pi/4),	0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
            WheelRadius1 144 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real WheelRadius = 1.0;
             end;
             icon bg bottom
              figures
               text 'TF' 144 304 18 bold;
             end;
             implementation eq
equations					
	p2.e = [p1.e/WheelRadius;0;0];
	p1.f = p2.f[1]/WheelRadius;
implementation_end;
           end;
           connections
            WheelRadius1\p2 => TF1\p1;
            TF1\p2 => TF2\p1;
            MotorTorgue1\p => WheelRadius1\p1;
            TF2\p2 => TF3\p1;
            p => MotorTorgue1\p;
            TF3\p2 => p2;
           end;
           parameterrelations
WheelRadius\WheelRadius = WheelRadius;parameterrelations_end;
          implementation_end;
         WheelRR 1008 408
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>MecanumWheelB.emx</LibraryPath>
 <TimeStamp>2011-1-18 13:51:59</TimeStamp>
</Description>';
          type Submodel
           ports
            power in p;
            power out p2 [3,1];
           parameters
            real WheelRadius = 0.053;
          end;
          icon bg bottom
           figures
            rectangle 978 386 1038 430 fill 16777152;
            text 'Mecanum 
wheel type B' 1008 408;
          end;
          implementation bg
           submodels
            MotorTorgue 112 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg top
              figures
               text '0' 112 176 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            plug p 71 176;
            plug p2 457 176;
            TF1 240 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Transforms from the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the principal inertial frame of the robot body
to the the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'TF' 240 176 18 bold;
             end;
             implementation eq
//Standard rotation arboud z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(pi/4), 	-sin(pi/4), 	0;
			sin(pi/4), 	cos(pi/4),		0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
            TF2 304 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>This transformer represents the interchange of energy 
between the wheel and the floor. In the rolling direction 
there is no energy exchangem, in the siding direction there is.
In case of a type B mechanum wheel the rolling direction is 
the y direction of the frame oriented with the roller.</Description>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'TF' 304 176 18 bold;
             end;
             implementation eq
parameters
	real r[3,3] = [0,0,0;0,1,0;0,0,1];
equations
p2.e = transpose(r)*p1.e;
p1.f = r*p2.f;implementation_end;
            TF3 368 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Inverse of TF1: Transforms back.</Description>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'TF' 368 176 18 bold;
             end;
             implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;
			sin(-pi/4), 	cos(-pi/4),	0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
            WheelRadius 152 176
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [3,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real WheelRadius = 0.053;
             end;
             icon bg bottom
              figures
               text 'TF' 152 176 18 bold;
             end;
             implementation eq
equations					
	p2.e = [p1.e/WheelRadius;0;0];
	p1.f = p2.f[1]/WheelRadius;
implementation_end;
           end;
           connections
            WheelRadius\p2 => TF1\p1;
            MotorTorgue\p => WheelRadius\p1;
            TF1\p2 => TF2\p1;
            TF2\p2 => TF3\p1;
            p => MotorTorgue\p;
            TF3\p2 => p2;
           end;
           parameterrelations
WheelRadius\WheelRadius = WheelRadius;parameterrelations_end;
          implementation_end;
         ZeroJunction 920 704
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out effort [6,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg
           figures
            text '0' 920 704 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
        end;
        connections
         WheelLF\p2 => TF_LF\p1;
         OneJunction4\p => WheelLF\p;
         WheelRF\p2 => TF_RF\p1;
         TF_RR\p2 => OneJunction\p;
         OneJunction3\p => WheelLR\p;
         ZeroJunction\p => OneJunction\p;
         Rfloor\p <= OneJunction\p;
         WheelRR\p2 => TF_RR\p1;
         TF_LF\p2 => OneJunction\p;
         TF_RF\p2 => OneJunction\p;
         Cfloor\p <= OneJunction\p;
         MotorLR => OneJunction3\p;
         MotorLF => OneJunction4\p;
         MotorRF => OneJunction5\p;
         WheelLR\p2 => TF_LR\p1;
         p => ZeroJunction\p;
         p1 => ZeroJunction\p;
         MotorRR => OneJunction2\p;
         RwheelRR\p <= OneJunction2\p;
         RwheelLF\p <= OneJunction4\p;
         OneJunction5\p => WheelRF\p;
         RwheelRF\p <= OneJunction5\p;
         TF_LR\p2 => OneJunction\p;
         OneJunction2\p => WheelRR\p;
         RwheelLR\p <= OneJunction3\p;
         OneJunction\flow -> Integrate2\input;
         Splitter1\output -> Hout;
         Splitter1\output -> MecanumWheelAnimation\Hbase0;
         OneJunction4\flow -> MecanumWheelAnimation\vWheelLF;
         OneJunction5\flow -> MecanumWheelAnimation\vWheelRF;
         OneJunction3\flow -> MecanumWheelAnimation\vWheelLR;
         MecanumWheelAnimation\vWheelRR <- OneJunction2\flow;
         Integrate2\output -> MatrixMul\input1;
         Hin -> MatrixMul\input2;
         MatrixMul\output -> Splitter1\input;
        end;
        parameterrelations
WheelLF\WheelRadius = WheelRadius;
WheelRF\WheelRadius = WheelRadius;
WheelLR\WheelRadius = WheelRadius;
WheelRR\WheelRadius = WheelRadius;
Integrate2\init = init;
TF_LF\WheelLFpos = WheelLFpos;
TF_RF\WheelRFpos = WheelRFpos;
TF_LR\WheelLRpos = WheelLRpos;
TF_RR\WheelRRpos = WheelRRpos;
MecanumWheelAnimation\WheelLFpos = WheelLFpos;
MecanumWheelAnimation\WheelLRpos = WheelLRpos;
MecanumWheelAnimation\WheelRFpos = WheelRFpos;
MecanumWheelAnimation\WheelRRpos = WheelRRpos;
Rfloor\Rfloor = Rfloor;
Cfloor\Cfloor = Cfloor;
RwheelLF\Rwheel = Rwheel;
RwheelRF\Rwheel = Rwheel;
RwheelLR\Rwheel = Rwheel;
RwheelRR\Rwheel = Rwheel;parameterrelations_end;
       implementation_end;
      Mux 696 193
       description '<Description>
 <Version>4.0</Version>
 <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:32:54</TimeStamp>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type Submodel
        ports
         power in port [9,1];
         power out port1;
         power out port2;
         power out port3;
         power out port4;
         power out port5;
         power out port6;
         power out port7;
         power out port8;
         power out port9;
        restrictions
         causality fixed in port;
         causality fixed out port1;
         causality fixed out port2;
         causality fixed out port3;
         causality fixed out port4;
         causality fixed out port5;
         causality fixed out port6;
         causality fixed out port7;
         causality fixed out port8;
         causality fixed out port9;
       end;
       icon bg
        figures
         rectangle 616 178 776 208 fill 14013909;
         text 'Mux' 696 192 16;
        terminals
         port 696 176 fixed;
         port1 632 208 fixed;
         port2 648 208 fixed;
         port3 664 208 fixed;
         port4 680 208 fixed;
         port5 696 208 fixed;
         port6 712 208 fixed;
         port7 728 208 fixed;
         port8 744 208 fixed;
         port9 760 208 fixed;
       end;
       implementation eq
equations
	port1.e = port.e[1];
	port2.e = port.e[2];
	port3.e = port.e[3];
	port4.e = port.e[4];
	port5.e = port.e[5];
	port6.e = port.e[6];
	port7.e = port.e[7];
	port8.e = port.e[8];
	port9.e = port.e[9];
	
	port.f[1] = port1.f;
	port.f[2] = port2.f;
	port.f[3] = port3.f;
	port.f[4] = port4.f;
	port.f[5] = port5.f;
	port.f[6] = port6.f;
	port.f[7] = port7.f;
	port.f[8] = port8.f;
	port.f[9] = port9.f;implementation_end;
      plug q 592 800;
      plug joints 696 120;
      Splitter1 320 544
       description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       knot Splitter
        ports
         signal knot duplicatable out output [4,4];
         signal knot in input [4,4];
       end;
       icon bg ellipse
        figures
         ellipse 316.8 540.8 323.2 547.2 color -1 fill 0;
         ellipse 315.7 539.7 324.3 548.3 color -1;
        terminals
         input 320 544 fixed;
       end;
       implementation eq
equations
    collect (output) = input;
implementation_end;
      Submodel14 592 728
       description '<Description><Version>4.0</Version>
   <LibraryPath>Template\Submodel-Equation.emx</LibraryPath>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <TimeStamp>2007-11-1 22:32:1</TimeStamp>
   <AllowLibraryUpdate>False</AllowLibraryUpdate>
</Description>';
       type 'Submodel-Equation'
        ports
         signal out output [8,1];
         signal in port1;
         signal in port2;
         signal in port3;
         signal in port4;
         signal in port5;
         signal in H0 [4,4];
       end;
       implementation eq
/* Equation Submodel
Enter you equations here. You can use the Toolbar buttons at the left ( Add , f(x) etc. ).
*/
parameters
	real offset[3]=[0.143;  0;  0.046];

variables
	real H[4,4];
 real yaw,pitch;
equations
	H=H0*inverseH(homogeneous(eye(3),offset));
	pitch =  arcsin(limit(H[3,1],-1,1)); //m_el[2].x());
	yaw = atan2(H[2,1]/cos(pitch),H[1,1]/cos(pitch));
  // start typing here
	output[1]=yaw;
	output[2]=H[1,4];
	output[3]=H[2,4];//Href0[2,4];
  // start typing here
  	output[4] = port1;
	output[5] = port2;
	output[6] = port3;
	output[7] = port4;
	output[8] = port5;
 implementation_end;
      Tfloor0 200 464
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:35</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type Sf
        ports
         power out p [6,1];
        restrictions
         causality fixed in p;
       end;
       icon bg bottom
        figures
         text 'Sf' 200 464 18 bold;
       end;
       implementation eq
parameters
	real flow = 0;
variables
	real effort[6];
equations
	p.f = flow;
	effort = p.e;
implementation_end;
      Wtip0 1240 464
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type Se
        ports
         power out p [6,1];
        restrictions
         causality fixed out p;
       end;
       icon bg bottom
        figures
         text 'Se' 1240 464 18 bold;
       end;
       implementation eq
parameters
	real effort = 0;
variables
	real flow[6];
equations
	p.e = effort;
	flow = p.f;
implementation_end;
     end;
     connections
      MecanumWheels\MotorLF <= Mux\port1 256 240 632 240;
      Link3\p1 <= Joint34\p;
      Mux\port7 => Joint23\p1 736 256 776 256;
      Tfloor0\p => MecanumWheels\p1;
      MecanumWheels\p <= Base\p;
      Link3\p => Joint23\p2;
      Joint12\p => Link1\p1;
      Link2\p => Joint12\p2;
      Joint45\p => Link4\p1;
      Mux\port9 => Joint45\p1 760 224 1088 224;
      Link5\p => Joint45\p2;
      Link1\p => JointBase1\p2;
      Link5\p1 <= Wtip0\p;
      MecanumWheels\MotorLR <= Mux\port3 288 272 664 272;
      Mux\port <= joints;
      MecanumWheels\MotorRR <= Mux\port4 304 288 680 288;
      JointBase1\p1 <= Mux\port5 448 304 696 304;
      JointBase1\p => Base\p1;
      MecanumWheels\MotorRF <= Mux\port2 272 256 648 256;
      Joint23\p => Link2\p1;
      Joint12\p1 <= Mux\port6 608 320 712 320;
      Link4\p => Joint34\p2;
      Mux\port8 => Joint34\p1 744 240 928 240;
      MecanumWheels\Hout -> Splitter1\input;
      JointBase1\Hout -> Link1\Hin;
      Joint34\Hin <- Link3\Hout;
      Link5\Hin <- Joint45\Hout;
      Link5\Hout -> Htip0\input;
      Joint45\q -> Submodel14\port5;
      Joint34\q -> Submodel14\port4;
      Joint23\q -> Submodel14\port3;
      Joint12\q -> Submodel14\port2;
      JointBase1\q -> Submodel14\port1;
      Submodel14\output -> q;
      Link4\Hin <- Joint34\Hout;
      Joint45\Hin <- Link4\Hout;
      Joint12\Hout -> Link2\Hin;
      Joint23\Hin <- Link2\Hout;
      Splitter1\output -> Base\Hin;
      Splitter1\output -> Submodel14\H0 328 632;
      Hfloor0\output -> MecanumWheels\Hin;
      Base\Hout -> JointBase1\Hin;
      Link1\Hout -> Joint12\Hin;
      Link3\Hin <- Joint23\Hout 808 544;
     end;
     parameterrelations
MecanumWheels\WheelRadius = MecanumWheelRadius;
MecanumWheels\WheelLFpos = Wheelpos[1:2,1];
MecanumWheels\WheelRFpos = Wheelpos[1:2,2];
MecanumWheels\WheelLRpos = Wheelpos[1:2,3];
MecanumWheels\WheelRRpos = Wheelpos[1:2,4];
MecanumWheels\Cfloor = Cconstraint;
MecanumWheels\Rfloor = Rconstraint;
MecanumWheels\init = InitialBasePos;
MecanumWheels\Rwheel = Rwheel;

Base\I = LinkI[1:3,1];
Base\m = Linkm[1];
Base\COMdim = LinkCOMdim[1:3,1];
Base\dim = Linkdim[1:3,1];

Link1\I = LinkI[1:3,2];
Link1\m = Linkm[2];
Link1\COMdim = LinkCOMdim[1:3,2];
Link1\dim = Linkdim[1:3,2];

Link2\I = LinkI[1:3,3];
Link2\m = Linkm[3];
Link2\COMdim = LinkCOMdim[1:3,3];
Link2\dim = Linkdim[1:3,3];

Link3\I =LinkI[1:3,4];
Link3\m = Linkm[4];
Link3\COMdim = LinkCOMdim[1:3,4];
Link3\dim = Linkdim[1:3,4];

Link4\I = LinkI[1:3,5];
Link4\m = Linkm[5];
Link4\COMdim = LinkCOMdim[1:3,5];
Link4\dim = Linkdim[1:3,5];

Link5\I = LinkI[1:3,6];
Link5\m = Linkm[6];
Link5\COMdim = LinkCOMdim[1:3,6];
Link5\dim = Linkdim[1:3,6];

JointBase1\Rendstop = Rconstraint;
JointBase1\Cendstop = Cconstraint;
JointBase1\InitialPos = InitialJointPos[1];
JointBase1\MinEndstopPos = MinEndstopPos[1];
JointBase1\MaxEndstopPos = MaxEndstopPos[1];
JointBase1\Rconstraint = Rconstraint;
JointBase1\Cconstraint = Cconstraint;
JointBase1\Rjoint = Rjoint;

Joint12\Rendstop = Rconstraint;
Joint12\Cendstop = Cconstraint;
Joint12\InitialPos = InitialJointPos[2];
Joint12\MinEndstopPos = MinEndstopPos[2];
Joint12\MaxEndstopPos = MaxEndstopPos[2];
Joint12\Rconstraint = Rconstraint;
Joint12\Cconstraint = Cconstraint;
Joint12\Rjoint = Rjoint;

Joint23\Rendstop = Rconstraint;
Joint23\Cendstop = Cconstraint;
Joint23\InitialPos = InitialJointPos[3];
Joint23\MinEndstopPos = MinEndstopPos[3];
Joint23\MaxEndstopPos = MaxEndstopPos[3];
Joint23\Rconstraint = Rconstraint;
Joint23\Cconstraint = Cconstraint;
Joint23\Rjoint = Rjoint;

Joint34\Rendstop = Rconstraint;
Joint34\Cendstop = Cconstraint;
Joint34\InitialPos = InitialJointPos[4];
Joint34\MinEndstopPos = MinEndstopPos[4];
Joint34\MaxEndstopPos = MaxEndstopPos[4];
Joint34\Rconstraint = Rconstraint;
Joint34\Cconstraint = Cconstraint;
Joint34\Rjoint = Rjoint;

Joint45\Rendstop = Rconstraint;
Joint45\Cendstop = Cconstraint;
Joint45\InitialPos = InitialJointPos[5];
Joint45\MinEndstopPos = MinEndstopPos[5];
Joint45\MaxEndstopPos = MaxEndstopPos[5];
Joint45\Rconstraint = Rconstraint;
Joint45\Cconstraint = Cconstraint;
Joint45\Rjoint = Rjoint;

parameterrelations_end;
    implementation_end;
   SerialLinkToRobot 672 272
    description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
    type Submodel
     ports
      power in output1 [8,1];
      power out output2 [9,1];
      signal in actuatorControllable [9,1];
     parameters
      real Wheelpos[2,4] = [0.215, 0.215, -0.215, -0.215; -0.15, 0.15, -0.15, 0.15];
      real MecanumWheelRadius = 0.053;
    end;
    icon bg top
     figures
      text 'TF' 672 272 18 bold;
    end;
    implementation bg
     submodels
      Demux 176 488
       description '<Description>
 <Version>4.0</Version>
 <LibraryPath>Template\Submodel-Equation.emx</LibraryPath>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <TimeStamp>2007-11-1 22:32:1</TimeStamp>
 <AllowLibraryUpdate>False</AllowLibraryUpdate>
</Description>';
       type 'Submodel-Equation'
        ports
         power in input1 [4,1];
         power out output [9,1];
         power in input2 [5,1];
        restrictions
         causality fixed in input1;
         causality fixed in input2;
         causality fixed out output;
       end;
       implementation eq
/* Equation Submodel
Enter you equations here. You can use the Toolbar buttons at the left ( Add , f(x) etc. ).
*/
equations
  // start typing here
  	output.e[1:4] = input1.e;
	output.e[5:9] = input2.e;

	input1.f = output.f[1:4];
	input2.f = output.f[5:9];	
 implementation_end;
      MTF 128 376
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:3</TimeStamp>
</Description>';
       type MTF
        ports
         power in p1 [5,1];
         power out p2 [5,1];
         signal in actuatorControllable [5,1];
        restrictions
         causality constraint not_equal p1 p2;
       end;
       icon bg bottom
        figures
         text 'MTF' 128 376 18 bold;
       end;
       implementation eq
equations					
	p2.e = diag(actuatorControllable) * p1.e;
	p1.f = diag(actuatorControllable) * p2.f;
implementation_end;
      Mux 176 232
       description '<Description>
 <Version>4.0</Version>
 <LibraryPath>Template\Submodel-Equation.emx</LibraryPath>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <TimeStamp>2007-11-1 22:32:1</TimeStamp>
 <AllowLibraryUpdate>False</AllowLibraryUpdate>
</Description>';
       type 'Submodel-Equation'
        ports
         power out input1 [3,1];
         power in output [8,1];
         power out input2 [5,1];
        restrictions
         causality fixed in output;
         causality fixed out input2;
         causality fixed out input1;
       end;
       implementation eq
/* Equation Submodel
Enter you equations here. You can use the Toolbar buttons at the left ( Add , f(x) etc. ).
*/
equations
  // start typing here
  	output.f[1:3] = input1.f;
	output.f[4:8] = input2.f;

	input1.e = output.e[1:3];
	input2.e = output.e[4:8];	
 implementation_end;
      plug output1 176 136;
      plug output2 176 584;
      plug actuatorControllable 672 272;
      Splitter 288 264
       description '<Description>
 <Version>4.0</Version>
 <LibraryPath>Template\Submodel-Equation.emx</LibraryPath>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <TimeStamp>2007-11-1 22:32:1</TimeStamp>
 <AllowLibraryUpdate>False</AllowLibraryUpdate>
</Description>';
       type 'Submodel-Equation'
        ports
         signal out output1 [4,1];
         signal in input [9,1];
         signal out output2 [5,1];
       end;
       implementation eq
/* Equation Submodel
Enter you equations here. You can use the Toolbar buttons at the left ( Add , f(x) etc. ).
*/
equations
  // start typing here
  	output1 = input[1:4];
	output2 = input[5:9];	
 implementation_end;
      VirtualLinkMap 232 376
       description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>VirtualLinkMap.emx</LibraryPath>
 <TimeStamp>2010-11-23 11:48:20</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type MTF
        ports
         power in virtualJoints [3,1];
         power out motor [4,1];
         signal in actuatorsControllable [4,1];
        restrictions
         causality fixed in virtualJoints;
         causality fixed out motor;
        parameters
         real Wheelpos[2,4] = [0.215, 0.215, -0.215, -0.215; -0.15, 0.15, -0.15, 0.15];
         real MecanumWheelRadius = 0.053;
       end;
       icon bg bottom
        figures
         text 'TF' 232 376 18 bold;
       end;
       implementation eq
variables
	real r,x,y;
	real A[3,4];
	real actuatedA[3,4];
	real PseudoInverseA[4,3];
	real countOperationalWheels;
equations
	y = Wheelpos[2,2];
	x = Wheelpos[1,2];
	r = MecanumWheelRadius;
	
	countOperationalWheels = actuatorsControllable[1] + actuatorsControllable[2] + actuatorsControllable[3] + actuatorsControllable[4];

	/*
		A is a Jacobian matrix
	*/	
	A = (1/(2*r))*
	[ 	x+y 	,-(x+y)		,x+y	,-(x+y);
		1		, -1		,-1		, 1;
		1		, 1		,1		, 1];

	actuatedA = A * diag(actuatorsControllable);


	if (countOperationalWheels > 2) then
	/*
		Overdefined
	*/
		PseudoInverseA = transpose(actuatedA)*inverse(actuatedA*transpose(actuatedA));
	else
	/*
		Underdefined
	*/
		PseudoInverseA = 
		(
			inverse(
				(transpose(actuatedA)*actuatedA)+
					diag(abs(actuatorsControllable-1))
			)-
			diag(
				abs(actuatorsControllable-1)
			)
		)*
		transpose(actuatedA);
	end;

/*	PseudoInverseA2 = 0.5*[	r/(x+y), 	r,		r;
									-r/(x+y),	-r, 	r;
									r/(x+y),		-r, 	r;
									-r/(x+y),	r, 	r ];
*/
	
	motor.e = PseudoInverseA * virtualJoints.e;
	virtualJoints.f = transpose(PseudoInverseA)*motor.f;





implementation_end;
     end;
     connections
      Mux\input1 => VirtualLinkMap\virtualJoints;
      VirtualLinkMap\motor => Demux\input1;
      Mux\input2 => MTF\p1;
      output1 => Mux\output;
      Demux\output => output2;
      MTF\p2 => Demux\input2;
      Splitter\input <- actuatorControllable;
      Splitter\output2 -> MTF\actuatorControllable;
      Splitter\output1 -> VirtualLinkMap\actuatorsControllable;
     end;
     parameterrelations
VirtualLinkMap\MecanumWheelRadius = MecanumWheelRadius;
VirtualLinkMap\Wheelpos = Wheelpos;parameterrelations_end;
    implementation_end;
   Submodel3 656 128
    description '<Description>
 <Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:32:54</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
    type Submodel
     ports
      signal in control [8,1];
      signal out port2arm [5,1];
      signal out port2base [3,1];
    end;
    implementation eq
parameters
	real zero_angles[5]=[169.0;65.0;-146.0;102.5;167.5];
equations
port2arm=control[4:8]+zero_angles*pi/180;
port2base=control[1:3];implementation_end;
  end;
  connections
   SerialLinkToRobot\output2 => Plant\joints;
   Mux2\output => SerialLinkToRobot\output1;
   interaction_control\bond_to_base => Mux2\input1 472 264;
   interaction_control\bond_to_arm => Mux2\input2 472 296;
   Constant2\setPoint -> interaction_control\xyzypr;
   Constant\output -> SerialLinkToRobot\actuatorControllable;
   Plant\q -> Submodel3\control;
   Submodel3\port2base -> interaction_control\odometry_base 496 144;
   Submodel3\port2arm -> interaction_control\measured_angles_arm 504 176;
  end;
 implementation_end;
]]>
</Sidops>
 </Model>
 <Experiments>
     <DefaultExperiment><![CDATA[Experiment 1]]>
</DefaultExperiment>
  <Experiment>
    <Name>Experiment 1</Name>
    <CreatedBy></CreatedBy>
    <Info></Info>
<ExpData>
  <VersionNumber>4.1</VersionNumber>
  <ModelProperties>
    <ModelProperty section="CCodeDialog" entry="SubmodelName" value="interaction_control"/>
    <ModelProperty section="CCodeDialog" entry="TargetName" value="OROCOS Component"/>
  </ModelProperties>
  <Variables>
   <Constants>
   </Constants>
   <Parameters>
    <Variable>
     <Name>epsilon</Name>
     <Value>0</Value>
    </Variable>
   </Parameters>
   <Initials>
    <Variable>
     <Name>interaction_control\CtipControl\optimizationCriteria_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>interaction_control\C\sub_state_initial</Name>
     <Rows>3</Rows>
     <Columns>1</Columns>
     <Value>0 0 0</Value>
    </Variable>
    <Variable>
     <Name>interaction_control\filter\s1y_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>Plant\Base\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>Plant\Joint12\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>Plant\Joint12\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>Plant\Joint23\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>Plant\Joint23\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>Plant\Joint34\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>Plant\Joint34\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>Plant\Joint45\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>Plant\Joint45\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>Plant\JointBase1\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>Plant\JointBase1\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>Plant\Link1\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>Plant\Link2\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>Plant\Link3\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>Plant\Link4\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>Plant\Link5\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>Plant\MecanumWheels\Cfloor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>Plant\MecanumWheels\MecanumWheelAnimation\qWheelLF_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>Plant\MecanumWheels\MecanumWheelAnimation\qWheelLR_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>Plant\MecanumWheels\MecanumWheelAnimation\qWheelRF_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>Plant\MecanumWheels\MecanumWheelAnimation\qWheelRR_initial</Name>
     <Value>0</Value>
    </Variable>
   </Initials>
  </Variables>
  <PlotSpecs>
   <VarNames>
    <VarName>time</VarName>
    <VarName>Plant\Link2\Hin[1,4]</VarName>
    <VarName>Plant\Link2\Hin[2,4]</VarName>
    <VarName>Plant\Link2\Hin[3,4]</VarName>
    <VarName>Plant\Link2\Hin[1,3]</VarName>
    <VarName>Plant\Link2\Hin[2,3]</VarName>
    <VarName>Plant\Link2\Hin[3,3]</VarName>
    <VarName>Plant\Link2\Hin[1,2]</VarName>
    <VarName>Plant\Link2\Hin[2,2]</VarName>
    <VarName>Plant\Link2\Hin[3,2]</VarName>
    <VarName>Plant\Link3\Hin[1,4]</VarName>
    <VarName>Plant\Link3\Hin[2,4]</VarName>
    <VarName>Plant\Link3\Hin[3,4]</VarName>
    <VarName>Plant\Link3\Hin[1,3]</VarName>
    <VarName>Plant\Link3\Hin[2,3]</VarName>
    <VarName>Plant\Link3\Hin[3,3]</VarName>
    <VarName>Plant\Link3\Hin[1,2]</VarName>
    <VarName>Plant\Link3\Hin[2,2]</VarName>
    <VarName>Plant\Link3\Hin[3,2]</VarName>
    <VarName>Plant\Link1\Hin[1,4]</VarName>
    <VarName>Plant\Link1\Hin[2,4]</VarName>
    <VarName>Plant\Link1\Hin[3,4]</VarName>
    <VarName>Plant\Link1\Hin[1,3]</VarName>
    <VarName>Plant\Link1\Hin[2,3]</VarName>
    <VarName>Plant\Link1\Hin[3,3]</VarName>
    <VarName>Plant\Link1\Hin[1,2]</VarName>
    <VarName>Plant\Link1\Hin[2,2]</VarName>
    <VarName>Plant\Link1\Hin[3,2]</VarName>
    <VarName>Plant\Link4\Hin[1,4]</VarName>
    <VarName>Plant\Link4\Hin[2,4]</VarName>
    <VarName>Plant\Link4\Hin[3,4]</VarName>
    <VarName>Plant\Link4\Hin[1,3]</VarName>
    <VarName>Plant\Link4\Hin[2,3]</VarName>
    <VarName>Plant\Link4\Hin[3,3]</VarName>
    <VarName>Plant\Link4\Hin[1,2]</VarName>
    <VarName>Plant\Link4\Hin[2,2]</VarName>
    <VarName>Plant\Link4\Hin[3,2]</VarName>
    <VarName>Plant\Link5\Hin[1,4]</VarName>
    <VarName>Plant\Link5\Hin[2,4]</VarName>
    <VarName>Plant\Link5\Hin[3,4]</VarName>
    <VarName>Plant\Link5\Hin[1,3]</VarName>
    <VarName>Plant\Link5\Hin[2,3]</VarName>
    <VarName>Plant\Link5\Hin[3,3]</VarName>
    <VarName>Plant\Link5\Hin[1,2]</VarName>
    <VarName>Plant\Link5\Hin[2,2]</VarName>
    <VarName>Plant\Link5\Hin[3,2]</VarName>
    <VarName>Plant\Base\Hin[1,4]</VarName>
    <VarName>Plant\Base\Hin[2,4]</VarName>
    <VarName>Plant\Base\Hin[3,4]</VarName>
    <VarName>Plant\Base\Hin[1,3]</VarName>
    <VarName>Plant\Base\Hin[2,3]</VarName>
    <VarName>Plant\Base\Hin[3,3]</VarName>
    <VarName>Plant\Base\Hin[1,2]</VarName>
    <VarName>Plant\Base\Hin[2,2]</VarName>
    <VarName>Plant\Base\Hin[3,2]</VarName>
    <VarName>interaction_control\CalculateJ\Htip0[1,4]</VarName>
    <VarName>interaction_control\CalculateJ\Htip0[2,4]</VarName>
    <VarName>interaction_control\CalculateJ\Htip0[3,4]</VarName>
    <VarName>interaction_control\CalculateJ\Htip0[1,3]</VarName>
    <VarName>interaction_control\CalculateJ\Htip0[2,3]</VarName>
    <VarName>interaction_control\CalculateJ\Htip0[3,3]</VarName>
    <VarName>interaction_control\CalculateJ\Htip0[1,2]</VarName>
    <VarName>interaction_control\CalculateJ\Htip0[2,2]</VarName>
    <VarName>interaction_control\CalculateJ\Htip0[3,2]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,4]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,4]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,4]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,3]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,3]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,3]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,2]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,2]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,2]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,4]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,4]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,4]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,3]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,3]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,3]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,2]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,2]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,2]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,4]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,4]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,4]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,3]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,3]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,3]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,2]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,2]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,2]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,4]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,4]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,4]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,3]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,3]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,3]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,2]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,2]</VarName>
    <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,2]</VarName>
    <VarName>interaction_control\Gain\H[1,4]</VarName>
    <VarName>interaction_control\Gain\H[2,4]</VarName>
    <VarName>interaction_control\Gain\H[3,4]</VarName>
    <VarName>interaction_control\Gain\H[1,3]</VarName>
    <VarName>interaction_control\Gain\H[2,3]</VarName>
    <VarName>interaction_control\Gain\H[3,3]</VarName>
    <VarName>interaction_control\Gain\H[1,2]</VarName>
    <VarName>interaction_control\Gain\H[2,2]</VarName>
    <VarName>interaction_control\Gain\H[3,2]</VarName>
    <VarName>interaction_control\CalculateJ\H10[1,4]</VarName>
    <VarName>interaction_control\CalculateJ\H10[2,4]</VarName>
    <VarName>interaction_control\CalculateJ\H10[3,4]</VarName>
    <VarName>interaction_control\CalculateJ\H10[1,3]</VarName>
    <VarName>interaction_control\CalculateJ\H10[2,3]</VarName>
    <VarName>interaction_control\CalculateJ\H10[3,3]</VarName>
    <VarName>interaction_control\CalculateJ\H10[1,2]</VarName>
    <VarName>interaction_control\CalculateJ\H10[2,2]</VarName>
    <VarName>interaction_control\CalculateJ\H10[3,2]</VarName>
    <VarName>interaction_control\CalculateJ\H20[1,4]</VarName>
    <VarName>interaction_control\CalculateJ\H20[2,4]</VarName>
    <VarName>interaction_control\CalculateJ\H20[3,4]</VarName>
    <VarName>interaction_control\CalculateJ\H20[1,3]</VarName>
    <VarName>interaction_control\CalculateJ\H20[2,3]</VarName>
    <VarName>interaction_control\CalculateJ\H20[3,3]</VarName>
    <VarName>interaction_control\CalculateJ\H20[1,2]</VarName>
    <VarName>interaction_control\CalculateJ\H20[2,2]</VarName>
    <VarName>interaction_control\CalculateJ\H20[3,2]</VarName>
    <VarName>interaction_control\CalculateJ\H30[1,4]</VarName>
    <VarName>interaction_control\CalculateJ\H30[2,4]</VarName>
    <VarName>interaction_control\CalculateJ\H30[3,4]</VarName>
    <VarName>interaction_control\CalculateJ\H30[1,3]</VarName>
    <VarName>interaction_control\CalculateJ\H30[2,3]</VarName>
    <VarName>interaction_control\CalculateJ\H30[3,3]</VarName>
    <VarName>interaction_control\CalculateJ\H30[1,2]</VarName>
    <VarName>interaction_control\CalculateJ\H30[2,2]</VarName>
    <VarName>interaction_control\CalculateJ\H30[3,2]</VarName>
    <VarName>interaction_control\CalculateJ\H40[1,4]</VarName>
    <VarName>interaction_control\CalculateJ\H40[2,4]</VarName>
    <VarName>interaction_control\CalculateJ\H40[3,4]</VarName>
    <VarName>interaction_control\CalculateJ\H40[1,3]</VarName>
    <VarName>interaction_control\CalculateJ\H40[2,3]</VarName>
    <VarName>interaction_control\CalculateJ\H40[3,3]</VarName>
    <VarName>interaction_control\CalculateJ\H40[1,2]</VarName>
    <VarName>interaction_control\CalculateJ\H40[2,2]</VarName>
    <VarName>interaction_control\CalculateJ\H40[3,2]</VarName>
    <VarName>interaction_control\CalculateJ\H50[1,4]</VarName>
    <VarName>interaction_control\CalculateJ\H50[2,4]</VarName>
    <VarName>interaction_control\CalculateJ\H50[3,4]</VarName>
    <VarName>interaction_control\CalculateJ\H50[1,3]</VarName>
    <VarName>interaction_control\CalculateJ\H50[2,3]</VarName>
    <VarName>interaction_control\CalculateJ\H50[3,3]</VarName>
    <VarName>interaction_control\CalculateJ\H50[1,2]</VarName>
    <VarName>interaction_control\CalculateJ\H50[2,2]</VarName>
    <VarName>interaction_control\CalculateJ\H50[3,2]</VarName>
    <VarName>interaction_control\CtipControl\state[1,4]</VarName>
    <VarName>interaction_control\CtipControl\state[2,4]</VarName>
    <VarName>interaction_control\CtipControl\state[3,4]</VarName>
    <VarName>interaction_control\CtipControl\state[1,3]</VarName>
    <VarName>interaction_control\CtipControl\state[2,3]</VarName>
    <VarName>interaction_control\CtipControl\state[3,3]</VarName>
    <VarName>interaction_control\CtipControl\state[1,2]</VarName>
    <VarName>interaction_control\CtipControl\state[2,2]</VarName>
    <VarName>interaction_control\CtipControl\state[3,2]</VarName>
    <VarName>interaction_control\CtipControl\stenght</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint45\Hout[1,4]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint45\Hout[2,4]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint45\Hout[3,4]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint45\Hout[1,3]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint45\Hout[2,3]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint45\Hout[3,3]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint45\Hout[1,2]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint45\Hout[2,2]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint45\Hout[3,2]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint34\Hout[1,4]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint34\Hout[2,4]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint34\Hout[3,4]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint34\Hout[1,3]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint34\Hout[2,3]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint34\Hout[3,3]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint34\Hout[1,2]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint34\Hout[2,2]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint34\Hout[3,2]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint23\Hout[1,4]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint23\Hout[2,4]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint23\Hout[3,4]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint23\Hout[1,3]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint23\Hout[2,3]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint23\Hout[3,3]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint23\Hout[1,2]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint23\Hout[2,2]</VarName>
    <VarName>interaction_control\GravityCompensation1\Joint23\Hout[3,2]</VarName>
    <VarName>interaction_control\measered_angles[4]</VarName>
    <VarName>interaction_control\measered_angles[5]</VarName>
    <VarName>interaction_control\measered_angles[6]</VarName>
    <VarName>interaction_control\measered_angles[7]</VarName>
    <VarName>interaction_control\measered_angles[8]</VarName>
    <VarName>interaction_control\GravityCompensation\Link1\Hin[1,4]</VarName>
    <VarName>interaction_control\GravityCompensation\Link1\Hin[2,4]</VarName>
    <VarName>interaction_control\GravityCompensation\Link1\Hin[3,4]</VarName>
    <VarName>interaction_control\GravityCompensation\Link1\Hin[1,3]</VarName>
    <VarName>interaction_control\GravityCompensation\Link1\Hin[2,3]</VarName>
    <VarName>interaction_control\GravityCompensation\Link1\Hin[3,3]</VarName>
    <VarName>interaction_control\GravityCompensation\Link1\Hin[1,2]</VarName>
    <VarName>interaction_control\GravityCompensation\Link1\Hin[2,2]</VarName>
    <VarName>interaction_control\GravityCompensation\Link1\Hin[3,2]</VarName>
    <VarName>Submodel4\Href0[1,4]</VarName>
    <VarName>Submodel4\Href0[2,4]</VarName>
    <VarName>Submodel4\Href0[3,4]</VarName>
    <VarName>Submodel4\Href0[1,3]</VarName>
    <VarName>Submodel4\Href0[2,3]</VarName>
    <VarName>Submodel4\Href0[3,3]</VarName>
    <VarName>Submodel4\Href0[1,2]</VarName>
    <VarName>Submodel4\Href0[2,2]</VarName>
    <VarName>Submodel4\Href0[3,2]</VarName>
    <VarName>interaction_control\JointSoftLimits\state[1]</VarName>
    <VarName>interaction_control\JointSoftLimits\state[2]</VarName>
    <VarName>interaction_control\JointSoftLimits\state[3]</VarName>
    <VarName>interaction_control\JointSoftLimits\state[4]</VarName>
    <VarName>interaction_control\JointSoftLimits\state[5]</VarName>
    <VarName>interaction_control\JointSoftLimits\state[6]</VarName>
    <VarName>interaction_control\JointSoftLimits\state[7]</VarName>
    <VarName>interaction_control\JointSoftLimits\state[8]</VarName>
    <VarName>interaction_control\JointSoftLimits\p.e[1]</VarName>
    <VarName>interaction_control\JointSoftLimits\p.e[2]</VarName>
    <VarName>interaction_control\JointSoftLimits\p.e[3]</VarName>
    <VarName>interaction_control\JointSoftLimits\p.e[4]</VarName>
    <VarName>interaction_control\JointSoftLimits\p.e[5]</VarName>
    <VarName>interaction_control\JointSoftLimits\p.e[6]</VarName>
    <VarName>interaction_control\JointSoftLimits\p.e[7]</VarName>
    <VarName>interaction_control\JointSoftLimits\p.e[8]</VarName>
   </VarNames>
   <Plots>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <UseWindowsBGColor>true</UseWindowsBGColor>
       <BGColor>13160660</BGColor>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>true</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>model</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>40</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-5</Minimum>
       <Maximum>5</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>interaction_control\measered_angles[4]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>interaction_control\measered_angles[5]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>interaction_control\measered_angles[6]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>interaction_control\measered_angles[7]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>interaction_control\measered_angles[8]</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>65280</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>65280</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\measered_angles[4]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>0</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>0</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\measered_angles[5]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>10040319</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>10040319</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\measered_angles[6]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>16763904</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16763904</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\measered_angles[7]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>26367</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>26367</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\measered_angles[8]</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
     </Legenda>
     <StripChartPlots>
      <DistributState>2</DistributState>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
     </StripChartPlots>
    </Plot>
    <Plot>
     <PlotType>D3DPlot</PlotType>
     <BasePlot>
       <UseWindowsBGColor>true</UseWindowsBGColor>
       <BGColor>13160660</BGColor>
     </BasePlot>
     <RenderQuality>137</RenderQuality>
     <ShowGrid>true</ShowGrid>
     <BackgroundColor>4294967295</BackgroundColor>
     <FrameScale>1</FrameScale>
     <FrameThickness>1</FrameThickness>
     <MainFrame>
      <Frame>
       <ScaleValue>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </ScaleValue>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Reference Frame</Name>
       <Position>
       </Position>
       <Orientation>
        <Angles>
        </Angles>
        <OrientationType>Bryant</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
        <Frame>
         <ScaleValue>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <ShowReferenceFrame>false</ShowReferenceFrame>
         <Name>youBotAnimation</Name>
         <SceneryFileName>Z:\Users\yury\Dropbox\UT\BRICS\Workspace\modeling\Douwe\youBotAnimation.scn</SceneryFileName>
         <Position>
         </Position>
         <Orientation>
     <Angles>
     </Angles>
     <OrientationType>Bryant</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
     <Frame>
      <ScaleValue>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </ScaleValue>
      <ShowReferenceFrame>true</ShowReferenceFrame>
      <Name>Reference Frame</Name>
      <Position>
      </Position>
      <Orientation>
       <Angles>
       </Angles>
       <OrientationType>Bryant</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
       <Frame>
        <ScaleValue>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </ScaleValue>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>youbot as serial link_with base_withwheels</Name>
        <SceneryFileName>E:\My Dropbox\Studie en werk\UTwente\Master project\Interactive control\Models\youbot as serial link_with base_withwheels.scn</SceneryFileName>
        <Position>
        </Position>
        <Orientation>
         <Angles>
         </Angles>
         <OrientationType>Bryant</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
         <Frame>
     <ScaleValue>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </ScaleValue>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>Robot</Name>
     <Position>
     </Position>
     <Orientation>
      <Angles>
      </Angles>
      <OrientationType>Bryant</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
      <Cube>
       <Center>Bottom</Center>
       <RibLength>1</RibLength>
       <ShowInnerSide>true</ShowInnerSide>
       <Accuracy>4</Accuracy>
       <ScaleValue>
        <X>
         <Value>0.055</Value>
        </X>
        <Y>
         <Value>0.09</Value>
        </Y>
        <Z>
         <Value>0.155</Value>
        </Z>
       </ScaleValue>
       <OverrideColor>true</OverrideColor>
       <MeshColor>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>0.552941176470588</Value>
        </Y>
        <Z>
         <Value>0.109803921568627</Value>
        </Z>
       </MeshColor>
       <Alpha>1</Alpha>
       <MeshColorMultipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </MeshColorMultipliers>
       <MeshColorOffsets>
       </MeshColorOffsets>
       <Direct3DColorRange>true</Direct3DColorRange>
       <SpecularColor>
        <X>
         <Value>0.498039215686275</Value>
        </X>
        <Y>
         <Value>0.498039215686275</Value>
        </Y>
        <Z>
         <Value>0.498039215686275</Value>
        </Z>
       </SpecularColor>
       <EmissiveColor>
       </EmissiveColor>
       <ShininessPower>
        <Value>14.298713684082</Value>
       </ShininessPower>
       <OverrideQuality>false</OverrideQuality>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Link2</Name>
       <Position>
        <X>
         <VariableName>Plant\Link2\Hin[1,4]</VariableName>
         <Value>3.4132206202663</Value>
        </X>
        <Y>
         <VariableName>Plant\Link2\Hin[2,4]</VariableName>
         <Value>-3.22546553680795</Value>
        </Y>
        <Z>
         <VariableName>Plant\Link2\Hin[3,4]</VariableName>
         <Value>0.086802317949004</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <VariableName>Plant\Link2\Hin[1,3]</VariableName>
     <Value>-0.906042398363602</Value>
         </X>
         <Y>
     <VariableName>Plant\Link2\Hin[2,3]</VariableName>
     <Value>-0.00696250295452759</Value>
         </Y>
         <Z>
     <VariableName>Plant\Link2\Hin[3,3]</VariableName>
     <Value>0.423129644340998</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <X>
     <VariableName>Plant\Link2\Hin[1,2]</VariableName>
     <Value>-0.00785862380071481</Value>
         </X>
         <Y>
     <VariableName>Plant\Link2\Hin[2,2]</VariableName>
     <Value>0.999969050856561</Value>
         </Y>
         <Z>
     <VariableName>Plant\Link2\Hin[3,2]</VariableName>
     <Value>-0.000373310845327299</Value>
         </Z>
        </YAxis>
        <OrientationType>Matrix</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
      </Cube>
      <Cube>
       <Center>Bottom</Center>
       <RibLength>1</RibLength>
       <ShowInnerSide>true</ShowInnerSide>
       <Accuracy>4</Accuracy>
       <ScaleValue>
        <X>
         <Value>0.055</Value>
        </X>
        <Y>
         <Value>0.09</Value>
        </Y>
        <Z>
         <Value>0.135</Value>
        </Z>
       </ScaleValue>
       <OverrideColor>true</OverrideColor>
       <MeshColor>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>0.552941176470588</Value>
        </Y>
        <Z>
         <Value>0.109803921568627</Value>
        </Z>
       </MeshColor>
       <Alpha>1</Alpha>
       <MeshColorMultipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </MeshColorMultipliers>
       <MeshColorOffsets>
       </MeshColorOffsets>
       <Direct3DColorRange>true</Direct3DColorRange>
       <SpecularColor>
        <X>
         <Value>0.5</Value>
        </X>
        <Y>
         <Value>0.5</Value>
        </Y>
        <Z>
         <Value>0.5</Value>
        </Z>
       </SpecularColor>
       <EmissiveColor>
       </EmissiveColor>
       <ShininessPower>
        <Value>15</Value>
       </ShininessPower>
       <OverrideQuality>false</OverrideQuality>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Link3</Name>
       <Position>
        <X>
         <VariableName>Plant\Link3\Hin[1,4]</VariableName>
         <Value>3.27278403505541</Value>
        </X>
        <Y>
         <VariableName>Plant\Link3\Hin[2,4]</VariableName>
         <Value>-3.22654472486937</Value>
        </Y>
        <Z>
         <VariableName>Plant\Link3\Hin[3,4]</VariableName>
         <Value>0.152387419109913</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <VariableName>Plant\Link3\Hin[1,3]</VariableName>
     <Value>-0.992982568126772</Value>
         </X>
         <Y>
     <VariableName>Plant\Link3\Hin[2,3]</VariableName>
     <Value>-0.00775966137568332</Value>
         </Y>
         <Z>
     <VariableName>Plant\Link3\Hin[3,3]</VariableName>
     <Value>0.118005961932846</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <X>
     <VariableName>Plant\Link3\Hin[1,2]</VariableName>
     <Value>-0.00785862162876726</Value>
         </X>
         <Y>
     <VariableName>Plant\Link3\Hin[2,2]</VariableName>
     <Value>0.999969050873122</Value>
         </Y>
         <Z>
     <VariableName>Plant\Link3\Hin[3,2]</VariableName>
     <Value>-0.000373312205667201</Value>
         </Z>
        </YAxis>
        <OrientationType>Matrix</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
      </Cube>
      <Cylinder>
       <CircleElements>16</CircleElements>
       <LowerRadius>0.09</LowerRadius>
       <UpperRadius>0.09</UpperRadius>
       <Height>1</Height>
       <Closed>true</Closed>
       <LowerClosed>true</LowerClosed>
       <UpperClosed>true</UpperClosed>
       <CenterInOrigin>false</CenterInOrigin>
       <ShowInnerSide>false</ShowInnerSide>
       <ShowOuterSide>true</ShowOuterSide>
       <ScaleValue>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>0.075</Value>
        </Z>
       </ScaleValue>
       <OverrideColor>true</OverrideColor>
       <MeshColor>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>0.552941176470588</Value>
        </Y>
        <Z>
         <Value>0.109803921568627</Value>
        </Z>
       </MeshColor>
       <Alpha>1</Alpha>
       <MeshColorMultipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </MeshColorMultipliers>
       <MeshColorOffsets>
       </MeshColorOffsets>
       <Direct3DColorRange>true</Direct3DColorRange>
       <SpecularColor>
        <X>
         <Value>0.5</Value>
        </X>
        <Y>
         <Value>0.5</Value>
        </Y>
        <Z>
         <Value>0.5</Value>
        </Z>
       </SpecularColor>
       <EmissiveColor>
       </EmissiveColor>
       <ShininessPower>
        <Value>15</Value>
       </ShininessPower>
       <OverrideQuality>false</OverrideQuality>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Link1</Name>
       <Position>
        <X>
         <VariableName>Plant\Link1\Hin[1,4]</VariableName>
         <Value>3.38020214578449</Value>
        </X>
        <Y>
         <VariableName>Plant\Link1\Hin[2,4]</VariableName>
         <Value>-3.22573210481455</Value>
        </Y>
        <Z>
         <VariableName>Plant\Link1\Hin[3,4]</VariableName>
         <Value>0.06783630693206</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <VariableName>Plant\Link1\Hin[1,3]</VariableName>
     <Value>0.00102667400826956</Value>
         </X>
         <Y>
     <VariableName>Plant\Link1\Hin[2,3]</VariableName>
     <Value>0.00038138396362757</Value>
         </Y>
         <Z>
     <VariableName>Plant\Link1\Hin[3,3]</VariableName>
     <Value>0.999999400243197</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <X>
     <VariableName>Plant\Link1\Hin[1,2]</VariableName>
     <Value>-0.00785862062653473</Value>
         </X>
         <Y>
     <VariableName>Plant\Link1\Hin[2,2]</VariableName>
     <Value>0.999969050884009</Value>
         </Y>
         <Z>
     <VariableName>Plant\Link1\Hin[3,2]</VariableName>
     <Value>-0.000373304142484627</Value>
         </Z>
        </YAxis>
        <OrientationType>Matrix</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
      </Cylinder>
      <Cube>
       <Center>Bottom</Center>
       <RibLength>1</RibLength>
       <ShowInnerSide>true</ShowInnerSide>
       <Accuracy>4</Accuracy>
       <ScaleValue>
        <X>
         <Value>0.055</Value>
        </X>
        <Y>
         <Value>0.1</Value>
        </Y>
        <Z>
         <Value>0.081</Value>
        </Z>
       </ScaleValue>
       <OverrideColor>true</OverrideColor>
       <MeshColor>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>0.552941176470588</Value>
        </Y>
        <Z>
         <Value>0.109803921568627</Value>
        </Z>
       </MeshColor>
       <Alpha>1</Alpha>
       <MeshColorMultipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </MeshColorMultipliers>
       <MeshColorOffsets>
       </MeshColorOffsets>
       <Direct3DColorRange>true</Direct3DColorRange>
       <SpecularColor>
        <X>
         <Value>0.5</Value>
        </X>
        <Y>
         <Value>0.5</Value>
        </Y>
        <Z>
         <Value>0.5</Value>
        </Z>
       </SpecularColor>
       <EmissiveColor>
       </EmissiveColor>
       <ShininessPower>
        <Value>15</Value>
       </ShininessPower>
       <OverrideQuality>false</OverrideQuality>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Link4</Name>
       <Position>
        <X>
         <VariableName>Plant\Link4\Hin[1,4]</VariableName>
         <Value>3.13873137221723</Value>
        </X>
        <Y>
         <VariableName>Plant\Link4\Hin[2,4]</VariableName>
         <Value>-3.22759227928122</Value>
        </Y>
        <Z>
         <VariableName>Plant\Link4\Hin[3,4]</VariableName>
         <Value>0.16831822588905</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <VariableName>Plant\Link4\Hin[1,3]</VariableName>
     <Value>-0.999859984155619</Value>
         </X>
         <Y>
     <VariableName>Plant\Link4\Hin[2,3]</VariableName>
     <Value>-0.0078522471125845</Value>
         </Y>
         <Z>
     <VariableName>Plant\Link4\Hin[3,3]</VariableName>
     <Value>0.0147768162879397</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <X>
     <VariableName>Plant\Link4\Hin[1,2]</VariableName>
     <Value>-0.0078586207914617</Value>
         </X>
         <Y>
     <VariableName>Plant\Link4\Hin[2,2]</VariableName>
     <Value>0.999969050879659</Value>
         </Y>
         <Z>
     <VariableName>Plant\Link4\Hin[3,2]</VariableName>
     <Value>-0.000373312321460927</Value>
         </Z>
        </YAxis>
        <OrientationType>Matrix</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
      </Cube>
      <Cube>
       <Center>Bottom</Center>
       <RibLength>1</RibLength>
       <ShowInnerSide>true</ShowInnerSide>
       <Accuracy>4</Accuracy>
       <ScaleValue>
        <X>
         <Value>0.055</Value>
        </X>
        <Y>
         <Value>0.1</Value>
        </Y>
        <Z>
         <Value>0.137</Value>
        </Z>
       </ScaleValue>
       <OverrideColor>true</OverrideColor>
       <MeshColor>
        <X>
         <Value>0.501960784313725</Value>
        </X>
        <Y>
         <Value>0.501960784313725</Value>
        </Y>
        <Z>
         <Value>0.501960784313725</Value>
        </Z>
       </MeshColor>
       <Alpha>1</Alpha>
       <MeshColorMultipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </MeshColorMultipliers>
       <MeshColorOffsets>
       </MeshColorOffsets>
       <Direct3DColorRange>true</Direct3DColorRange>
       <SpecularColor>
        <X>
         <Value>0.5</Value>
        </X>
        <Y>
         <Value>0.5</Value>
        </Y>
        <Z>
         <Value>0.5</Value>
        </Z>
       </SpecularColor>
       <EmissiveColor>
       </EmissiveColor>
       <ShininessPower>
        <Value>15</Value>
       </ShininessPower>
       <OverrideQuality>false</OverrideQuality>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Link5</Name>
       <Position>
        <X>
         <VariableName>Plant\Link5\Hin[1,4]</VariableName>
         <Value>3.042744801867</Value>
        </X>
        <Y>
         <VariableName>Plant\Link5\Hin[2,4]</VariableName>
         <Value>-3.22834609509726</Value>
        </Y>
        <Z>
         <VariableName>Plant\Link5\Hin[3,4]</VariableName>
         <Value>0.169736800428137</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <VariableName>Plant\Link5\Hin[1,3]</VariableName>
     <Value>-0.999859984155619</Value>
         </X>
         <Y>
     <VariableName>Plant\Link5\Hin[2,3]</VariableName>
     <Value>-0.0078522471125845</Value>
         </Y>
         <Z>
     <VariableName>Plant\Link5\Hin[3,3]</VariableName>
     <Value>0.0147768162879397</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <X>
     <VariableName>Plant\Link5\Hin[1,2]</VariableName>
     <Value>0.00442319986235996</Value>
         </X>
         <Y>
     <VariableName>Plant\Link5\Hin[2,2]</VariableName>
     <Value>-0.975676132870774</Value>
         </Y>
         <Z>
     <VariableName>Plant\Link5\Hin[3,2]</VariableName>
     <Value>-0.219172350102171</Value>
         </Z>
        </YAxis>
        <OrientationType>Matrix</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
      </Cube>
      <Cube>
       <Center>Bottom</Center>
       <RibLength>1</RibLength>
       <ShowInnerSide>true</ShowInnerSide>
       <Accuracy>4</Accuracy>
       <ScaleValue>
        <X>
         <Value>0.53</Value>
        </X>
        <Y>
         <Value>0.36</Value>
        </Y>
        <Z>
         <Value>0.11</Value>
        </Z>
       </ScaleValue>
       <OverrideColor>true</OverrideColor>
       <MeshColor>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>0.541176470588235</Value>
        </Y>
        <Z>
         <Value>0.0980392156862745</Value>
        </Z>
       </MeshColor>
       <Alpha>1</Alpha>
       <MeshColorMultipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </MeshColorMultipliers>
       <MeshColorOffsets>
       </MeshColorOffsets>
       <Direct3DColorRange>true</Direct3DColorRange>
       <SpecularColor>
        <X>
         <Value>0.498039215686275</Value>
        </X>
        <Y>
         <Value>0.498039215686275</Value>
        </Y>
        <Z>
         <Value>0.498039215686275</Value>
        </Z>
       </SpecularColor>
       <EmissiveColor>
       </EmissiveColor>
       <ShininessPower>
        <Value>14.298713684082</Value>
       </ShininessPower>
       <OverrideQuality>false</OverrideQuality>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Base</Name>
       <Position>
        <X>
         <VariableName>Plant\Base\Hin[1,4]</VariableName>
         <Value>3.3561043237026</Value>
        </X>
        <Y>
         <VariableName>Plant\Base\Hin[2,4]</VariableName>
         <Value>-3.22595576178743</Value>
        </Y>
        <Z>
         <VariableName>Plant\Base\Hin[3,4]</VariableName>
         <Value>-0.0281389251060925</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <VariableName>Plant\Base\Hin[1,3]</VariableName>
     <Value>0.00102667400826956</Value>
         </X>
         <Y>
     <VariableName>Plant\Base\Hin[2,3]</VariableName>
     <Value>0.00038138396362757</Value>
         </Y>
         <Z>
     <VariableName>Plant\Base\Hin[3,3]</VariableName>
     <Value>0.999999400243197</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <X>
     <VariableName>Plant\Base\Hin[1,2]</VariableName>
     <Value>-0.00779389167090351</Value>
         </X>
         <Y>
     <VariableName>Plant\Base\Hin[2,2]</VariableName>
     <Value>0.999969557460063</Value>
         </Y>
         <Z>
     <VariableName>Plant\Base\Hin[3,2]</VariableName>
     <Value>-0.000373370791260913</Value>
         </Z>
        </YAxis>
        <OrientationType>Matrix</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
      </Cube>
      <Cylinder>
       <CircleElements>16</CircleElements>
       <LowerRadius>0.05</LowerRadius>
       <UpperRadius>0</UpperRadius>
       <Height>1</Height>
       <Closed>true</Closed>
       <LowerClosed>true</LowerClosed>
       <UpperClosed>true</UpperClosed>
       <CenterInOrigin>true</CenterInOrigin>
       <ShowInnerSide>false</ShowInnerSide>
       <ShowOuterSide>true</ShowOuterSide>
       <ScaleValue>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </ScaleValue>
       <OverrideColor>true</OverrideColor>
       <MeshColor>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>0</Value>
        </Y>
        <Z>
         <Value>0</Value>
        </Z>
       </MeshColor>
       <Alpha>0.21</Alpha>
       <MeshColorMultipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </MeshColorMultipliers>
       <MeshColorOffsets>
       </MeshColorOffsets>
       <Direct3DColorRange>true</Direct3DColorRange>
       <SpecularColor>
        <X>
         <Value>0.498039215686275</Value>
        </X>
        <Y>
         <Value>0.498039215686275</Value>
        </Y>
        <Z>
         <Value>0.498039215686275</Value>
        </Z>
       </SpecularColor>
       <EmissiveColor>
       </EmissiveColor>
       <ShininessPower>
        <Value>13.5413365364075</Value>
       </ShininessPower>
       <OverrideQuality>false</OverrideQuality>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Cylinder</Name>
       <Position>
        <X>
         <VariableName>interaction_control\CalculateJ\Htip0[1,4]</VariableName>
         <Value>3.00849894572213</Value>
        </X>
        <Y>
         <VariableName>interaction_control\CalculateJ\Htip0[2,4]</VariableName>
         <Value>-3.228706137642</Value>
        </Y>
        <Z>
         <VariableName>interaction_control\CalculateJ\Htip0[3,4]</VariableName>
         <Value>0.24402039020713</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <VariableName>interaction_control\CalculateJ\Htip0[1,3]</VariableName>
     <Value>-0.999874627908018</Value>
         </X>
         <Y>
     <VariableName>interaction_control\CalculateJ\Htip0[2,3]</VariableName>
     <Value>-0.00785749424490583</Value>
         </Y>
         <Z>
     <VariableName>interaction_control\CalculateJ\Htip0[3,3]</VariableName>
     <Value>0.0137472997346422</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <X>
     <VariableName>interaction_control\CalculateJ\Htip0[1,2]</VariableName>
     <Value>0.0046482152718366</Value>
         </X>
         <Y>
     <VariableName>interaction_control\CalculateJ\Htip0[2,2]</VariableName>
     <Value>-0.975592467369076</Value>
         </Y>
         <Z>
     <VariableName>interaction_control\CalculateJ\Htip0[3,2]</VariableName>
     <Value>-0.219539818045625</Value>
         </Z>
        </YAxis>
        <OrientationType>Matrix</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
      </Cylinder>
      <Cube>
       <Center>Center</Center>
       <RibLength>1</RibLength>
       <ShowInnerSide>true</ShowInnerSide>
       <Accuracy>4</Accuracy>
       <ScaleValue>
        <X>
         <Value>0.12</Value>
        </X>
        <Y>
         <Value>0.12</Value>
        </Y>
        <Z>
         <Value>0.07</Value>
        </Z>
       </ScaleValue>
       <OverrideColor>true</OverrideColor>
       <MeshColor>
        <X>
         <Value>0.403921568627451</Value>
        </X>
        <Y>
         <Value>0.403921568627451</Value>
        </Y>
        <Z>
         <Value>0.403921568627451</Value>
        </Z>
       </MeshColor>
       <Alpha>1</Alpha>
       <MeshColorMultipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </MeshColorMultipliers>
       <MeshColorOffsets>
       </MeshColorOffsets>
       <Direct3DColorRange>true</Direct3DColorRange>
       <SpecularColor>
        <X>
         <Value>0.498039215686275</Value>
        </X>
        <Y>
         <Value>0.498039215686275</Value>
        </Y>
        <Z>
         <Value>0.498039215686275</Value>
        </Z>
       </SpecularColor>
       <EmissiveColor>
       </EmissiveColor>
       <ShininessPower>
        <Value>14.298713684082</Value>
       </ShininessPower>
       <OverrideQuality>false</OverrideQuality>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>WheelLF</Name>
       <Position>
        <X>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,4]</VariableName>
         <Value>3.57231812446939</Value>
        </X>
        <Y>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,4]</VariableName>
         <Value>-3.37425654127396</Value>
        </Y>
        <Z>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,4]</VariableName>
         <Value>0.0216956878159401</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,3]</VariableName>
     <Value>0.00779470677589174</Value>
         </X>
         <Y>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,3]</VariableName>
     <Value>-0.999968936685795</Value>
         </Y>
         <Z>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,3]</VariableName>
     <Value>0.00116970498774925</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <X>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,2]</VariableName>
     <Value>0.214197361447124</Value>
         </X>
         <Y>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,2]</VariableName>
     <Value>0.0028122448526948</Value>
         </Y>
         <Z>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,2]</VariableName>
     <Value>0.97678635413686</Value>
         </Z>
        </YAxis>
        <OrientationType>Matrix</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
      </Cube>
      <Cube>
       <Center>Center</Center>
       <RibLength>1</RibLength>
       <ShowInnerSide>true</ShowInnerSide>
       <Accuracy>4</Accuracy>
       <ScaleValue>
        <X>
         <Value>0.12</Value>
        </X>
        <Y>
         <Value>0.12</Value>
        </Y>
        <Z>
         <Value>0.07</Value>
        </Z>
       </ScaleValue>
       <OverrideColor>true</OverrideColor>
       <MeshColor>
        <X>
         <Value>0.403921568627451</Value>
        </X>
        <Y>
         <Value>0.403921568627451</Value>
        </Y>
        <Z>
         <Value>0.403921568627451</Value>
        </Z>
       </MeshColor>
       <Alpha>1</Alpha>
       <MeshColorMultipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </MeshColorMultipliers>
       <MeshColorOffsets>
       </MeshColorOffsets>
       <Direct3DColorRange>true</Direct3DColorRange>
       <SpecularColor>
        <X>
         <Value>0.5</Value>
        </X>
        <Y>
         <Value>0.5</Value>
        </Y>
        <Z>
         <Value>0.5</Value>
        </Z>
       </SpecularColor>
       <EmissiveColor>
       </EmissiveColor>
       <ShininessPower>
        <Value>15</Value>
       </ShininessPower>
       <OverrideQuality>false</OverrideQuality>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>WheelRF</Name>
       <Position>
        <X>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,4]</VariableName>
         <Value>3.56997995667609</Value>
        </X>
        <Y>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,4]</VariableName>
         <Value>-3.07426563689121</Value>
        </Y>
        <Z>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,4]</VariableName>
         <Value>0.0215836741106079</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,3]</VariableName>
     <Value>0.00779470677589174</Value>
         </X>
         <Y>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,3]</VariableName>
     <Value>-0.999968936685795</Value>
         </Y>
         <Z>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,3]</VariableName>
     <Value>0.00116970498774925</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <X>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,2]</VariableName>
     <Value>-0.149930268509019</Value>
         </X>
         <Y>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,2]</VariableName>
     <Value>-0.00232521482397723</Value>
         </Y>
         <Z>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,2]</VariableName>
     <Value>-0.988693839346051</Value>
         </Z>
        </YAxis>
        <OrientationType>Matrix</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
      </Cube>
      <Cube>
       <Center>Center</Center>
       <RibLength>1</RibLength>
       <ShowInnerSide>true</ShowInnerSide>
       <Accuracy>4</Accuracy>
       <ScaleValue>
        <X>
         <Value>0.12</Value>
        </X>
        <Y>
         <Value>0.12</Value>
        </Y>
        <Z>
         <Value>0.07</Value>
        </Z>
       </ScaleValue>
       <OverrideColor>true</OverrideColor>
       <MeshColor>
        <X>
         <Value>0.403921568627451</Value>
        </X>
        <Y>
         <Value>0.403921568627451</Value>
        </Y>
        <Z>
         <Value>0.403921568627451</Value>
        </Z>
       </MeshColor>
       <Alpha>1</Alpha>
       <MeshColorMultipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </MeshColorMultipliers>
       <MeshColorOffsets>
       </MeshColorOffsets>
       <Direct3DColorRange>true</Direct3DColorRange>
       <SpecularColor>
        <X>
         <Value>0.5</Value>
        </X>
        <Y>
         <Value>0.5</Value>
        </Y>
        <Z>
         <Value>0.5</Value>
        </Z>
       </SpecularColor>
       <EmissiveColor>
       </EmissiveColor>
       <ShininessPower>
        <Value>15</Value>
       </ShininessPower>
       <OverrideQuality>false</OverrideQuality>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>WheelLR</Name>
       <Position>
        <X>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,4]</VariableName>
         <Value>3.14233135812996</Value>
        </X>
        <Y>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,4]</VariableName>
         <Value>-3.37760774828728</Value>
        </Y>
        <Z>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,4]</VariableName>
         <Value>0.0221384157108387</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,3]</VariableName>
     <Value>0.00779470677589174</Value>
         </X>
         <Y>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,3]</VariableName>
     <Value>-0.999968936685795</Value>
         </Y>
         <Z>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,3]</VariableName>
     <Value>0.00116970498774925</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <X>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,2]</VariableName>
     <Value>-0.152742285844975</Value>
         </X>
         <Y>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,2]</VariableName>
     <Value>-0.00234663069868882</Value>
         </Y>
         <Z>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,2]</VariableName>
     <Value>-0.98826326828392</Value>
         </Z>
        </YAxis>
        <OrientationType>Matrix</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
      </Cube>
      <Cube>
       <Center>Center</Center>
       <RibLength>1</RibLength>
       <ShowInnerSide>true</ShowInnerSide>
       <Accuracy>4</Accuracy>
       <ScaleValue>
        <X>
         <Value>0.12</Value>
        </X>
        <Y>
         <Value>0.12</Value>
        </Y>
        <Z>
         <Value>0.07</Value>
        </Z>
       </ScaleValue>
       <OverrideColor>true</OverrideColor>
       <MeshColor>
        <X>
         <Value>0.403921568627451</Value>
        </X>
        <Y>
         <Value>0.403921568627451</Value>
        </Y>
        <Z>
         <Value>0.403921568627451</Value>
        </Z>
       </MeshColor>
       <Alpha>1</Alpha>
       <MeshColorMultipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </MeshColorMultipliers>
       <MeshColorOffsets>
       </MeshColorOffsets>
       <Direct3DColorRange>true</Direct3DColorRange>
       <SpecularColor>
        <X>
         <Value>0.5</Value>
        </X>
        <Y>
         <Value>0.5</Value>
        </Y>
        <Z>
         <Value>0.5</Value>
        </Z>
       </SpecularColor>
       <EmissiveColor>
       </EmissiveColor>
       <ShininessPower>
        <Value>15</Value>
       </ShininessPower>
       <OverrideQuality>false</OverrideQuality>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>WheelRR</Name>
       <Position>
        <X>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,4]</VariableName>
         <Value>3.13999319033665</Value>
        </X>
        <Y>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,4]</VariableName>
         <Value>-3.07761684390453</Value>
        </Y>
        <Z>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,4]</VariableName>
         <Value>0.0220264020055065</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,3]</VariableName>
     <Value>0.00779470677589174</Value>
         </X>
         <Y>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,3]</VariableName>
     <Value>-0.999968936685795</Value>
         </Y>
         <Z>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,3]</VariableName>
     <Value>0.00116970498774925</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <X>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,2]</VariableName>
     <Value>0.161484694588293</Value>
         </X>
         <Y>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,2]</VariableName>
     <Value>0.00241315021579173</Value>
         </Y>
         <Z>
     <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,2]</VariableName>
     <Value>0.986872266364681</Value>
         </Z>
        </YAxis>
        <OrientationType>Matrix</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
      </Cube>
     </Childs>
         </Frame>
         <Camera>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>Camera</Name>
     <Position>
      <X>
       <Value>3.44639847712163</Value>
      </X>
      <Y>
       <Value>-0.921349476668757</Value>
      </Y>
      <Z>
       <Value>4.83059547868948</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <Value>-0.553817023995475</Value>
       </X>
       <Y>
        <Value>0.188801906556854</Value>
       </Y>
       <Z>
        <Value>-0.810950395531868</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <Value>-0.767572537023877</Value>
       </X>
       <Y>
        <Value>0.261673354432625</Value>
       </Y>
       <Z>
        <Value>0.585114908361347</Value>
       </Z>
      </YAxis>
      <OrientationType>Direct3D</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
     <FrontPlane>0.01</FrontPlane>
     <BackPlane>100</BackPlane>
     <Field>0.00392699081698724</Field>
     <Fieldy>45</Fieldy>
     <PlaneLeft>-10</PlaneLeft>
     <PlaneRight>10</PlaneRight>
     <PlaneTop>10</PlaneTop>
     <PlaneBottom>-10</PlaneBottom>
     <UseLookatPosition>true</UseLookatPosition>
     <LookatPosition>
      <X>
       <Value>0.123496333148812</Value>
      </X>
      <Y>
       <Value>0.211461962672356</Value>
      </Y>
      <Z>
       <Value>-0.0351068945016804</Value>
      </Z>
     </LookatPosition>
     <UseAlwaysLookUp>true</UseAlwaysLookUp>
     <LookUpVector>
      <Z>
       <Value>1</Value>
      </Z>
     </LookUpVector>
     <RightHand>true</RightHand>
     <Perspective>true</Perspective>
     <IsSelectedCamera>false</IsSelectedCamera>
         </Camera>
         <Light>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>Ambient</Name>
     <Position>
     </Position>
     <Orientation>
      <ZAxis>
       <Z>
        <Value>1</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <Y>
        <Value>1</Value>
       </Y>
      </YAxis>
      <OrientationType>Direct3D</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
     <LightType>0</LightType>
     <LightColor>
      <Color>
       <X>
        <Value>0.3</Value>
       </X>
       <Y>
        <Value>0.3</Value>
       </Y>
       <Z>
        <Value>0.3</Value>
       </Z>
      </Color>
      <Offset>
      </Offset>
      <Multipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </Multipliers>
      <Direct3DColorRange>true</Direct3DColorRange>
     </LightColor>
     <AmbientLight>
      <Color>
       <X>
        <Value>0.3</Value>
       </X>
       <Y>
        <Value>0.3</Value>
       </Y>
       <Z>
        <Value>0.3</Value>
       </Z>
      </Color>
      <Offset>
      </Offset>
      <Multipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </Multipliers>
      <Direct3DColorRange>true</Direct3DColorRange>
     </AmbientLight>
     <AmbientOn>true</AmbientOn>
     <DiffuseOn>false</DiffuseOn>
     <SpecularOn>false</SpecularOn>
         </Light>
         <Light>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>Parallel</Name>
     <Position>
      <X>
       <Value>-3</Value>
      </X>
      <Y>
       <Value>5</Value>
      </Y>
      <Z>
       <Value>3</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <Value>0.457495710997814</Value>
       </X>
       <Y>
        <Value>-0.762492851663023</Value>
       </Y>
       <Z>
        <Value>-0.457495710997814</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <Value>0.235379601434674</Value>
       </X>
       <Y>
        <Value>-0.392299335724456</Value>
       </Y>
       <Z>
        <Value>0.889211827642101</Value>
       </Z>
      </YAxis>
      <OrientationType>Direct3D</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
     <LightType>3</LightType>
     <LightColor>
      <Color>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </Color>
      <Offset>
      </Offset>
      <Multipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </Multipliers>
      <Direct3DColorRange>true</Direct3DColorRange>
     </LightColor>
     <Attenuation>
      <Constant>
       <Value>1</Value>
      </Constant>
      <Linear>
       <Value>0</Value>
      </Linear>
      <Quadratic>
       <Value>0</Value>
      </Quadratic>
     </Attenuation>
     <DiffuseLight>
      <Color>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </Color>
      <Offset>
      </Offset>
      <Multipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </Multipliers>
      <Direct3DColorRange>true</Direct3DColorRange>
     </DiffuseLight>
     <SpecularLight>
      <Color>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </Color>
      <Offset>
      </Offset>
      <Multipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </Multipliers>
      <Direct3DColorRange>true</Direct3DColorRange>
     </SpecularLight>
     <AmbientOn>false</AmbientOn>
     <DiffuseOn>true</DiffuseOn>
     <SpecularOn>true</SpecularOn>
         </Light>
         <Light>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>Spot Light 1</Name>
     <Position>
      <X>
       <Value>-3</Value>
      </X>
      <Y>
       <Value>-5</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <Value>0.50709255283711</Value>
       </X>
       <Y>
        <Value>0.845154254728517</Value>
       </Y>
       <Z>
        <Value>-0.169030850945703</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <Value>0.086965655347867</Value>
       </X>
       <Y>
        <Value>0.144942758913112</Value>
       </Y>
       <Z>
        <Value>0.985610760609162</Value>
       </Z>
      </YAxis>
      <OrientationType>Direct3D</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
     <LightType>2</LightType>
     <LightColor>
      <Color>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </Color>
      <Offset>
      </Offset>
      <Multipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </Multipliers>
      <Direct3DColorRange>true</Direct3DColorRange>
     </LightColor>
     <Attenuation>
      <Constant>
       <Value>1</Value>
      </Constant>
      <Linear>
       <Value>0.05</Value>
      </Linear>
      <Quadratic>
       <Value>0.05</Value>
      </Quadratic>
     </Attenuation>
     <Umbra>
      <Value>1.0471975511966</Value>
     </Umbra>
     <Penumbra>
      <Value>1.0471975511966</Value>
     </Penumbra>
     <DiffuseLight>
      <Color>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </Color>
      <Offset>
      </Offset>
      <Multipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </Multipliers>
      <Direct3DColorRange>true</Direct3DColorRange>
     </DiffuseLight>
     <SpecularLight>
      <Color>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </Color>
      <Offset>
      </Offset>
      <Multipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </Multipliers>
      <Direct3DColorRange>true</Direct3DColorRange>
     </SpecularLight>
     <AmbientOn>false</AmbientOn>
     <DiffuseOn>true</DiffuseOn>
     <SpecularOn>true</SpecularOn>
         </Light>
         <Light>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>Spot Light 2</Name>
     <Position>
      <X>
       <Value>2</Value>
      </X>
      <Y>
       <Value>-3</Value>
      </Y>
      <Z>
       <Value>-1</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <Value>-0.534522483824849</Value>
       </X>
       <Y>
        <Value>0.801783725737273</Value>
       </Y>
       <Z>
        <Value>0.267261241912424</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <Value>0.14824986333222</Value>
       </X>
       <Y>
        <Value>-0.22237479499833</Value>
       </Y>
       <Z>
        <Value>0.963624111659432</Value>
       </Z>
      </YAxis>
      <OrientationType>Direct3D</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
     <LightType>2</LightType>
     <LightColor>
      <Color>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </Color>
      <Offset>
      </Offset>
      <Multipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </Multipliers>
      <Direct3DColorRange>true</Direct3DColorRange>
     </LightColor>
     <Attenuation>
      <Constant>
       <Value>1</Value>
      </Constant>
      <Linear>
       <Value>0.05</Value>
      </Linear>
      <Quadratic>
       <Value>0.05</Value>
      </Quadratic>
     </Attenuation>
     <Umbra>
      <Value>1.5707963267949</Value>
     </Umbra>
     <Penumbra>
      <Value>1.5707963267949</Value>
     </Penumbra>
     <DiffuseLight>
      <Color>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </Color>
      <Offset>
      </Offset>
      <Multipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </Multipliers>
      <Direct3DColorRange>true</Direct3DColorRange>
     </DiffuseLight>
     <SpecularLight>
      <Color>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </Color>
      <Offset>
      </Offset>
      <Multipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </Multipliers>
      <Direct3DColorRange>true</Direct3DColorRange>
     </SpecularLight>
     <AmbientOn>false</AmbientOn>
     <DiffuseOn>true</DiffuseOn>
     <SpecularOn>true</SpecularOn>
         </Light>
         <Square>
     <CornerInOrigin>false</CornerInOrigin>
     <XLength>1</XLength>
     <YLength>1</YLength>
     <BothSides>true</BothSides>
     <Accuracy>4</Accuracy>
     <ScaleValue>
      <X>
       <Value>0.1</Value>
      </X>
      <Y>
       <Value>0.1</Value>
      </Y>
      <Z>
       <Value>0.1</Value>
      </Z>
     </ScaleValue>
     <OverrideColor>true</OverrideColor>
     <MeshColor>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColor>
     <Alpha>1</Alpha>
     <MeshColorMultipliers>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColorMultipliers>
     <MeshColorOffsets>
     </MeshColorOffsets>
     <Direct3DColorRange>true</Direct3DColorRange>
     <SpecularColor>
      <X>
       <Value>0.83921568627451</Value>
      </X>
      <Y>
       <Value>0.83921568627451</Value>
      </Y>
      <Z>
       <Value>0.83921568627451</Value>
      </Z>
     </SpecularColor>
     <EmissiveColor>
     </EmissiveColor>
     <ShininessPower>
      <Value>0</Value>
     </ShininessPower>
     <OverrideQuality>false</OverrideQuality>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>z</Name>
     <Position>
      <X>
       <VariableName>interaction_control\GravityCompensation\Link1\Hin[1,4]</VariableName>
       <Value>0.024</Value>
      </X>
      <Y>
       <VariableName>interaction_control\GravityCompensation\Link1\Hin[2,4]</VariableName>
       <Value>0</Value>
      </Y>
      <Z>
       <VariableName>interaction_control\GravityCompensation\Link1\Hin[3,4]</VariableName>
       <Value>0.096</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <VariableName>interaction_control\GravityCompensation\Link1\Hin[1,3]</VariableName>
        <Value>0</Value>
       </X>
       <Y>
        <VariableName>interaction_control\GravityCompensation\Link1\Hin[2,3]</VariableName>
        <Value>0</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\GravityCompensation\Link1\Hin[3,3]</VariableName>
        <Value>1</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <VariableName>interaction_control\GravityCompensation\Link1\Hin[1,2]</VariableName>
        <Value>-0.200245325562087</Value>
       </X>
       <Y>
        <VariableName>interaction_control\GravityCompensation\Link1\Hin[2,2]</VariableName>
        <Value>-0.979745788248428</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\GravityCompensation\Link1\Hin[3,2]</VariableName>
        <Value>0</Value>
       </Z>
      </YAxis>
      <OrientationType>Matrix</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
         </Square>
         <Cylinder>
     <CircleElements>16</CircleElements>
     <LowerRadius>0.01</LowerRadius>
     <UpperRadius>0</UpperRadius>
     <Height>1</Height>
     <Closed>true</Closed>
     <LowerClosed>true</LowerClosed>
     <UpperClosed>true</UpperClosed>
     <CenterInOrigin>false</CenterInOrigin>
     <ShowInnerSide>false</ShowInnerSide>
     <ShowOuterSide>true</ShowOuterSide>
     <ScaleValue>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </ScaleValue>
     <OverrideColor>true</OverrideColor>
     <MeshColor>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>0</Value>
      </Y>
      <Z>
       <Value>0</Value>
      </Z>
     </MeshColor>
     <Alpha>1</Alpha>
     <MeshColorMultipliers>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColorMultipliers>
     <MeshColorOffsets>
     </MeshColorOffsets>
     <Direct3DColorRange>true</Direct3DColorRange>
     <SpecularColor>
      <X>
       <Value>0.5</Value>
      </X>
      <Y>
       <Value>0.5</Value>
      </Y>
      <Z>
       <Value>0.5</Value>
      </Z>
     </SpecularColor>
     <EmissiveColor>
     </EmissiveColor>
     <ShininessPower>
      <Value>15</Value>
     </ShininessPower>
     <OverrideQuality>false</OverrideQuality>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>Cylinder</Name>
     <Position>
      <X>
       <VariableName>interaction_control\Gain\H[1,4]</VariableName>
       <Value>-0.0999999980761788</Value>
      </X>
      <Y>
       <VariableName>interaction_control\Gain\H[2,4]</VariableName>
       <Value>-0.0999999980761788</Value>
      </Y>
      <Z>
       <VariableName>interaction_control\Gain\H[3,4]</VariableName>
       <Value>0.400000011542927</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <VariableName>interaction_control\Gain\H[1,3]</VariableName>
        <Value>-0.400981654194886</Value>
       </X>
       <Y>
        <VariableName>interaction_control\Gain\H[2,3]</VariableName>
        <Value>-0.876160987941762</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\Gain\H[3,3]</VariableName>
        <Value>0.267498852722864</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <VariableName>interaction_control\Gain\H[1,2]</VariableName>
        <Value>0.909297442837521</Value>
       </X>
       <Y>
        <VariableName>interaction_control\Gain\H[2,2]</VariableName>
        <Value>-0.416146801560633</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\Gain\H[3,2]</VariableName>
        <Value>0</Value>
       </Z>
      </YAxis>
      <OrientationType>Matrix</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
         </Cylinder>
         <Sphere>
     <InsideOutside>0</InsideOutside>
     <Accuracy>30</Accuracy>
     <SphereAdvanced>false</SphereAdvanced>
     <ScaleValue>
      <X>
       <Value>0.1</Value>
      </X>
      <Y>
       <Value>0.1</Value>
      </Y>
      <Z>
       <Value>0.1</Value>
      </Z>
     </ScaleValue>
     <OverrideColor>true</OverrideColor>
     <MeshColor>
      <X>
       <Value>0</Value>
      </X>
      <Y>
       <Value>0</Value>
      </Y>
      <Z>
       <Value>0</Value>
      </Z>
     </MeshColor>
     <Alpha>1</Alpha>
     <MeshColorMultipliers>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColorMultipliers>
     <MeshColorOffsets>
     </MeshColorOffsets>
     <Direct3DColorRange>true</Direct3DColorRange>
     <SpecularColor>
      <X>
       <Value>0.5</Value>
      </X>
      <Y>
       <Value>0.5</Value>
      </Y>
      <Z>
       <Value>0.5</Value>
      </Z>
     </SpecularColor>
     <EmissiveColor>
     </EmissiveColor>
     <ShininessPower>
      <Value>15</Value>
     </ShininessPower>
     <OverrideQuality>false</OverrideQuality>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>H10</Name>
     <Position>
      <X>
       <VariableName>interaction_control\CalculateJ\H10[1,4]</VariableName>
       <Value>3.3800564258959</Value>
      </X>
      <Y>
       <VariableName>interaction_control\CalculateJ\H10[2,4]</VariableName>
       <Value>-3.22578626080881</Value>
      </Y>
      <Z>
       <VariableName>interaction_control\CalculateJ\H10[3,4]</VariableName>
       <Value>0.142</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <VariableName>interaction_control\CalculateJ\H10[1,3]</VariableName>
        <Value>0</Value>
       </X>
       <Y>
        <VariableName>interaction_control\CalculateJ\H10[2,3]</VariableName>
        <Value>0</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\CalculateJ\H10[3,3]</VariableName>
        <Value>1</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <VariableName>interaction_control\CalculateJ\H10[1,2]</VariableName>
        <Value>-0.00785823683720675</Value>
       </X>
       <Y>
        <VariableName>interaction_control\CalculateJ\H10[2,2]</VariableName>
        <Value>0.999969123580229</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\CalculateJ\H10[3,2]</VariableName>
        <Value>0</Value>
       </Z>
      </YAxis>
      <OrientationType>Matrix</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
         </Sphere>
         <Sphere>
     <InsideOutside>0</InsideOutside>
     <Accuracy>30</Accuracy>
     <SphereAdvanced>false</SphereAdvanced>
     <ScaleValue>
      <X>
       <Value>0.1</Value>
      </X>
      <Y>
       <Value>0.1</Value>
      </Y>
      <Z>
       <Value>0.1</Value>
      </Z>
     </ScaleValue>
     <OverrideColor>true</OverrideColor>
     <MeshColor>
      <X>
       <Value>0</Value>
      </X>
      <Y>
       <Value>0</Value>
      </Y>
      <Z>
       <Value>0</Value>
      </Z>
     </MeshColor>
     <Alpha>1</Alpha>
     <MeshColorMultipliers>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColorMultipliers>
     <MeshColorOffsets>
     </MeshColorOffsets>
     <Direct3DColorRange>true</Direct3DColorRange>
     <SpecularColor>
      <X>
       <Value>0.5</Value>
      </X>
      <Y>
       <Value>0.5</Value>
      </Y>
      <Z>
       <Value>0.5</Value>
      </Z>
     </SpecularColor>
     <EmissiveColor>
     </EmissiveColor>
     <ShininessPower>
      <Value>15</Value>
     </ShininessPower>
     <OverrideQuality>false</OverrideQuality>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>H20</Name>
     <Position>
      <X>
       <VariableName>interaction_control\CalculateJ\H20[1,4]</VariableName>
       <Value>3.41305540697404</Value>
      </X>
      <Y>
       <VariableName>interaction_control\CalculateJ\H20[2,4]</VariableName>
       <Value>-3.22552693899318</Value>
      </Y>
      <Z>
       <VariableName>interaction_control\CalculateJ\H20[3,4]</VariableName>
       <Value>0.161</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <VariableName>interaction_control\CalculateJ\H20[1,3]</VariableName>
        <Value>-0.9064763116505</Value>
       </X>
       <Y>
        <VariableName>interaction_control\CalculateJ\H20[2,3]</VariableName>
        <Value>-0.00712352549323065</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\CalculateJ\H20[3,3]</VariableName>
        <Value>0.422196579570527</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <VariableName>interaction_control\CalculateJ\H20[1,2]</VariableName>
        <Value>-0.00785823683720675</Value>
       </X>
       <Y>
        <VariableName>interaction_control\CalculateJ\H20[2,2]</VariableName>
        <Value>0.999969123580229</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\CalculateJ\H20[3,2]</VariableName>
        <Value>0</Value>
       </Z>
      </YAxis>
      <OrientationType>Matrix</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
         </Sphere>
         <Sphere>
     <InsideOutside>0</InsideOutside>
     <Accuracy>30</Accuracy>
     <SphereAdvanced>false</SphereAdvanced>
     <ScaleValue>
      <X>
       <Value>0.1</Value>
      </X>
      <Y>
       <Value>0.1</Value>
      </Y>
      <Z>
       <Value>0.1</Value>
      </Z>
     </ScaleValue>
     <OverrideColor>true</OverrideColor>
     <MeshColor>
      <X>
       <Value>0</Value>
      </X>
      <Y>
       <Value>0</Value>
      </Y>
      <Z>
       <Value>0</Value>
      </Z>
     </MeshColor>
     <Alpha>1</Alpha>
     <MeshColorMultipliers>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColorMultipliers>
     <MeshColorOffsets>
     </MeshColorOffsets>
     <Direct3DColorRange>true</Direct3DColorRange>
     <SpecularColor>
      <X>
       <Value>0.5</Value>
      </X>
      <Y>
       <Value>0.5</Value>
      </Y>
      <Z>
       <Value>0.5</Value>
      </Z>
     </SpecularColor>
     <EmissiveColor>
     </EmissiveColor>
     <ShininessPower>
      <Value>15</Value>
     </ShininessPower>
     <OverrideQuality>false</OverrideQuality>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>H30</Name>
     <Position>
      <X>
       <VariableName>interaction_control\CalculateJ\H30[1,4]</VariableName>
       <Value>3.27255157866822</Value>
      </X>
      <Y>
       <VariableName>interaction_control\CalculateJ\H30[2,4]</VariableName>
       <Value>-3.22663108544463</Value>
      </Y>
      <Z>
       <VariableName>interaction_control\CalculateJ\H30[3,4]</VariableName>
       <Value>0.226440469833432</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <VariableName>interaction_control\CalculateJ\H30[1,3]</VariableName>
        <Value>-0.993103194948442</Value>
       </X>
       <Y>
        <VariableName>interaction_control\CalculateJ\H30[2,3]</VariableName>
        <Value>-0.00780428107795013</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\CalculateJ\H30[3,3]</VariableName>
        <Value>0.116983491912552</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <VariableName>interaction_control\CalculateJ\H30[1,2]</VariableName>
        <Value>-0.00785823683720675</Value>
       </X>
       <Y>
        <VariableName>interaction_control\CalculateJ\H30[2,2]</VariableName>
        <Value>0.999969123580229</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\CalculateJ\H30[3,2]</VariableName>
        <Value>1.0842021724855e-019</Value>
       </Z>
      </YAxis>
      <OrientationType>Matrix</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
         </Sphere>
         <Sphere>
     <InsideOutside>0</InsideOutside>
     <Accuracy>30</Accuracy>
     <SphereAdvanced>false</SphereAdvanced>
     <ScaleValue>
      <X>
       <Value>0.1</Value>
      </X>
      <Y>
       <Value>0.1</Value>
      </Y>
      <Z>
       <Value>0.1</Value>
      </Z>
     </ScaleValue>
     <OverrideColor>true</OverrideColor>
     <MeshColor>
      <X>
       <Value>0</Value>
      </X>
      <Y>
       <Value>0</Value>
      </Y>
      <Z>
       <Value>0</Value>
      </Z>
     </MeshColor>
     <Alpha>1</Alpha>
     <MeshColorMultipliers>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColorMultipliers>
     <MeshColorOffsets>
     </MeshColorOffsets>
     <Direct3DColorRange>true</Direct3DColorRange>
     <SpecularColor>
      <X>
       <Value>0.5</Value>
      </X>
      <Y>
       <Value>0.5</Value>
      </Y>
      <Z>
       <Value>0.5</Value>
      </Z>
     </SpecularColor>
     <EmissiveColor>
     </EmissiveColor>
     <ShininessPower>
      <Value>15</Value>
     </ShininessPower>
     <OverrideQuality>false</OverrideQuality>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>H50</Name>
     <Position>
      <X>
       <VariableName>interaction_control\CalculateJ\H40[1,4]</VariableName>
       <Value>3.13848264735018</Value>
      </X>
      <Y>
       <VariableName>interaction_control\CalculateJ\H40[2,4]</VariableName>
       <Value>-3.22768466339016</Value>
      </Y>
      <Z>
       <VariableName>interaction_control\CalculateJ\H40[3,4]</VariableName>
       <Value>0.242233241241626</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <VariableName>interaction_control\CalculateJ\H40[1,3]</VariableName>
        <Value>-0.999874627908018</Value>
       </X>
       <Y>
        <VariableName>interaction_control\CalculateJ\H40[2,3]</VariableName>
        <Value>-0.00785749424490583</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\CalculateJ\H40[3,3]</VariableName>
        <Value>0.0137472997346422</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <VariableName>interaction_control\CalculateJ\H40[1,2]</VariableName>
        <Value>-0.00785823683720675</Value>
       </X>
       <Y>
        <VariableName>interaction_control\CalculateJ\H40[2,2]</VariableName>
        <Value>0.999969123580229</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\CalculateJ\H40[3,2]</VariableName>
        <Value>1.35525271560688e-020</Value>
       </Z>
      </YAxis>
      <OrientationType>Matrix</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
         </Sphere>
         <Sphere>
     <InsideOutside>0</InsideOutside>
     <Accuracy>30</Accuracy>
     <SphereAdvanced>false</SphereAdvanced>
     <ScaleValue>
      <X>
       <Value>0.1</Value>
      </X>
      <Y>
       <Value>0.1</Value>
      </Y>
      <Z>
       <Value>0.1</Value>
      </Z>
     </ScaleValue>
     <OverrideColor>true</OverrideColor>
     <MeshColor>
      <X>
       <Value>0</Value>
      </X>
      <Y>
       <Value>0</Value>
      </Y>
      <Z>
       <Value>0</Value>
      </Z>
     </MeshColor>
     <Alpha>1</Alpha>
     <MeshColorMultipliers>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColorMultipliers>
     <MeshColorOffsets>
     </MeshColorOffsets>
     <Direct3DColorRange>true</Direct3DColorRange>
     <SpecularColor>
      <X>
       <Value>0.5</Value>
      </X>
      <Y>
       <Value>0.5</Value>
      </Y>
      <Z>
       <Value>0.5</Value>
      </Z>
     </SpecularColor>
     <EmissiveColor>
     </EmissiveColor>
     <ShininessPower>
      <Value>15</Value>
     </ShininessPower>
     <OverrideQuality>false</OverrideQuality>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>H50</Name>
     <Position>
      <X>
       <VariableName>interaction_control\CalculateJ\H50[1,4]</VariableName>
       <Value>3.04249468307101</Value>
      </X>
      <Y>
       <VariableName>interaction_control\CalculateJ\H50[2,4]</VariableName>
       <Value>-3.22843898283767</Value>
      </Y>
      <Z>
       <VariableName>interaction_control\CalculateJ\H50[3,4]</VariableName>
       <Value>0.243552982016152</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <VariableName>interaction_control\CalculateJ\H50[1,3]</VariableName>
        <Value>-0.999874627908018</Value>
       </X>
       <Y>
        <VariableName>interaction_control\CalculateJ\H50[2,3]</VariableName>
        <Value>-0.00785749424490583</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\CalculateJ\H50[3,3]</VariableName>
        <Value>0.0137472997346422</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <VariableName>interaction_control\CalculateJ\H50[1,2]</VariableName>
        <Value>0.0046482152718366</Value>
       </X>
       <Y>
        <VariableName>interaction_control\CalculateJ\H50[2,2]</VariableName>
        <Value>-0.975592467369076</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\CalculateJ\H50[3,2]</VariableName>
        <Value>-0.219539818045625</Value>
       </Z>
      </YAxis>
      <OrientationType>Matrix</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
         </Sphere>
         <Sphere>
     <InsideOutside>0</InsideOutside>
     <Accuracy>30</Accuracy>
     <SphereAdvanced>false</SphereAdvanced>
     <ScaleValue>
      <X>
       <Value>0.1</Value>
      </X>
      <Y>
       <Value>0.1</Value>
      </Y>
      <Z>
       <Value>0.1</Value>
      </Z>
     </ScaleValue>
     <OverrideColor>true</OverrideColor>
     <MeshColor>
      <X>
       <Value>0</Value>
      </X>
      <Y>
       <Value>0</Value>
      </Y>
      <Z>
       <Value>0</Value>
      </Z>
     </MeshColor>
     <Alpha>1</Alpha>
     <MeshColorMultipliers>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColorMultipliers>
     <MeshColorOffsets>
     </MeshColorOffsets>
     <Direct3DColorRange>true</Direct3DColorRange>
     <SpecularColor>
      <X>
       <Value>0.5</Value>
      </X>
      <Y>
       <Value>0.5</Value>
      </Y>
      <Z>
       <Value>0.5</Value>
      </Z>
     </SpecularColor>
     <EmissiveColor>
     </EmissiveColor>
     <ShininessPower>
      <Value>15</Value>
     </ShininessPower>
     <OverrideQuality>false</OverrideQuality>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>Htip</Name>
     <Position>
      <X>
       <VariableName>interaction_control\CalculateJ\Htip0[1,4]</VariableName>
       <Value>3.00849894572213</Value>
      </X>
      <Y>
       <VariableName>interaction_control\CalculateJ\Htip0[2,4]</VariableName>
       <Value>-3.228706137642</Value>
      </Y>
      <Z>
       <VariableName>interaction_control\CalculateJ\Htip0[3,4]</VariableName>
       <Value>0.24402039020713</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <VariableName>interaction_control\CalculateJ\Htip0[1,3]</VariableName>
        <Value>-0.999874627908018</Value>
       </X>
       <Y>
        <VariableName>interaction_control\CalculateJ\Htip0[2,3]</VariableName>
        <Value>-0.00785749424490583</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\CalculateJ\Htip0[3,3]</VariableName>
        <Value>0.0137472997346422</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <VariableName>interaction_control\CalculateJ\Htip0[1,2]</VariableName>
        <Value>0.0046482152718366</Value>
       </X>
       <Y>
        <VariableName>interaction_control\CalculateJ\Htip0[2,2]</VariableName>
        <Value>-0.975592467369076</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\CalculateJ\Htip0[3,2]</VariableName>
        <Value>-0.219539818045625</Value>
       </Z>
      </YAxis>
      <OrientationType>Matrix</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
         </Sphere>
         <Sphere>
     <InsideOutside>0</InsideOutside>
     <Accuracy>30</Accuracy>
     <SphereAdvanced>false</SphereAdvanced>
     <ScaleValue>
      <X>
       <Value>0.1</Value>
      </X>
      <Y>
       <Value>0.1</Value>
      </Y>
      <Z>
       <Value>0.1</Value>
      </Z>
     </ScaleValue>
     <OverrideColor>true</OverrideColor>
     <MeshColor>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>0</Value>
      </Y>
      <Z>
       <Value>0.501960784313725</Value>
      </Z>
     </MeshColor>
     <Alpha>1</Alpha>
     <MeshColorMultipliers>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColorMultipliers>
     <MeshColorOffsets>
     </MeshColorOffsets>
     <Direct3DColorRange>true</Direct3DColorRange>
     <SpecularColor>
      <X>
       <Value>0.5</Value>
      </X>
      <Y>
       <Value>0.5</Value>
      </Y>
      <Z>
       <Value>0.5</Value>
      </Z>
     </SpecularColor>
     <EmissiveColor>
     </EmissiveColor>
     <ShininessPower>
      <Value>15</Value>
     </ShininessPower>
     <OverrideQuality>false</OverrideQuality>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>Href0</Name>
     <Position>
      <X>
       <VariableName>Submodel4\Href0[1,4]</VariableName>
       <Value>0.018031055956319</Value>
      </X>
      <Y>
       <VariableName>Submodel4\Href0[2,4]</VariableName>
       <Value>-0.000549216432658553</Value>
      </Y>
      <Z>
       <VariableName>Submodel4\Href0[3,4]</VariableName>
       <Value>0</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <VariableName>Submodel4\Href0[1,3]</VariableName>
        <Value>0</Value>
       </X>
       <Y>
        <VariableName>Submodel4\Href0[2,3]</VariableName>
        <Value>0</Value>
       </Y>
       <Z>
        <VariableName>Submodel4\Href0[3,3]</VariableName>
        <Value>1</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <VariableName>Submodel4\Href0[1,2]</VariableName>
        <Value>0.043585922672945</Value>
       </X>
       <Y>
        <VariableName>Submodel4\Href0[2,2]</VariableName>
        <Value>0.999049682120338</Value>
       </Y>
       <Z>
        <VariableName>Submodel4\Href0[3,2]</VariableName>
        <Value>-0</Value>
       </Z>
      </YAxis>
      <OrientationType>Matrix</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
         </Sphere>
         <Cube>
     <Center>Center</Center>
     <RibLength>0.1</RibLength>
     <ShowInnerSide>true</ShowInnerSide>
     <Accuracy>4</Accuracy>
     <ScaleValue>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </ScaleValue>
     <OverrideColor>true</OverrideColor>
     <MeshColor>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>0</Value>
      </Y>
      <Z>
       <Value>0</Value>
      </Z>
     </MeshColor>
     <Alpha>1</Alpha>
     <MeshColorMultipliers>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColorMultipliers>
     <MeshColorOffsets>
     </MeshColorOffsets>
     <Direct3DColorRange>true</Direct3DColorRange>
     <SpecularColor>
      <X>
       <Value>0.5</Value>
      </X>
      <Y>
       <Value>0.5</Value>
      </Y>
      <Z>
       <Value>0.5</Value>
      </Z>
     </SpecularColor>
     <EmissiveColor>
     </EmissiveColor>
     <ShininessPower>
      <Value>15</Value>
     </ShininessPower>
     <OverrideQuality>false</OverrideQuality>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>H45</Name>
     <Position>
      <X>
       <VariableName>interaction_control\GravityCompensation1\Joint45\Hout[1,4]</VariableName>
       <Value>-0.313572165137555</Value>
      </X>
      <Y>
       <VariableName>interaction_control\GravityCompensation1\Joint45\Hout[2,4]</VariableName>
       <Value>-2.18513744602432e-005</Value>
      </Y>
      <Z>
       <VariableName>interaction_control\GravityCompensation1\Joint45\Hout[3,4]</VariableName>
       <Value>0.197552982016152</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <VariableName>interaction_control\GravityCompensation1\Joint45\Hout[1,3]</VariableName>
        <Value>-0.99990549931516</Value>
       </X>
       <Y>
        <VariableName>interaction_control\GravityCompensation1\Joint45\Hout[2,3]</VariableName>
        <Value>-6.47248551476061e-005</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\GravityCompensation1\Joint45\Hout[3,3]</VariableName>
        <Value>0.0137472997346422</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <VariableName>interaction_control\GravityCompensation1\Joint45\Hout[1,2]</VariableName>
        <Value>-0.0029552134439127</Value>
       </X>
       <Y>
        <VariableName>interaction_control\GravityCompensation1\Joint45\Hout[2,2]</VariableName>
        <Value>-0.975599064680771</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\GravityCompensation1\Joint45\Hout[3,2]</VariableName>
        <Value>-0.219539818045625</Value>
       </Z>
      </YAxis>
      <OrientationType>Matrix</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
         </Cube>
         <Cube>
     <Center>Center</Center>
     <RibLength>0.1</RibLength>
     <ShowInnerSide>true</ShowInnerSide>
     <Accuracy>4</Accuracy>
     <ScaleValue>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </ScaleValue>
     <OverrideColor>true</OverrideColor>
     <MeshColor>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColor>
     <Alpha>1</Alpha>
     <MeshColorMultipliers>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColorMultipliers>
     <MeshColorOffsets>
     </MeshColorOffsets>
     <Direct3DColorRange>true</Direct3DColorRange>
     <SpecularColor>
      <X>
       <Value>0.5</Value>
      </X>
      <Y>
       <Value>0.5</Value>
      </Y>
      <Z>
       <Value>0.5</Value>
      </Z>
     </SpecularColor>
     <EmissiveColor>
     </EmissiveColor>
     <ShininessPower>
      <Value>15</Value>
     </ShininessPower>
     <OverrideQuality>false</OverrideQuality>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>H34</Name>
     <Position>
      <X>
       <VariableName>interaction_control\GravityCompensation1\Joint34\Hout[1,4]</VariableName>
       <Value>-0.217581237203299</Value>
      </X>
      <Y>
       <VariableName>interaction_control\GravityCompensation1\Joint34\Hout[2,4]</VariableName>
       <Value>-1.5637788366073e-005</Value>
      </Y>
      <Z>
       <VariableName>interaction_control\GravityCompensation1\Joint34\Hout[3,4]</VariableName>
       <Value>0.196233241241626</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <VariableName>interaction_control\GravityCompensation1\Joint34\Hout[1,3]</VariableName>
        <Value>-0.99990549931516</Value>
       </X>
       <Y>
        <VariableName>interaction_control\GravityCompensation1\Joint34\Hout[2,3]</VariableName>
        <Value>-6.47248551476061e-005</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\GravityCompensation1\Joint34\Hout[3,3]</VariableName>
        <Value>0.0137472997346422</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <VariableName>interaction_control\GravityCompensation1\Joint34\Hout[1,2]</VariableName>
        <Value>-6.47309721332013e-005</Value>
       </X>
       <Y>
        <VariableName>interaction_control\GravityCompensation1\Joint34\Hout[2,2]</VariableName>
        <Value>0.999999997904951</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\GravityCompensation1\Joint34\Hout[3,2]</VariableName>
        <Value>-2.11758236813575e-022</Value>
       </Z>
      </YAxis>
      <OrientationType>Matrix</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
         </Cube>
         <Cube>
     <Center>Center</Center>
     <RibLength>0.1</RibLength>
     <ShowInnerSide>true</ShowInnerSide>
     <Accuracy>4</Accuracy>
     <ScaleValue>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </ScaleValue>
     <OverrideColor>true</OverrideColor>
     <MeshColor>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColor>
     <Alpha>1</Alpha>
     <MeshColorMultipliers>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColorMultipliers>
     <MeshColorOffsets>
     </MeshColorOffsets>
     <Direct3DColorRange>true</Direct3DColorRange>
     <SpecularColor>
      <X>
       <Value>0.5</Value>
      </X>
      <Y>
       <Value>0.5</Value>
      </Y>
      <Z>
       <Value>0.5</Value>
      </Z>
     </SpecularColor>
     <EmissiveColor>
     </EmissiveColor>
     <ShininessPower>
      <Value>15</Value>
     </ShininessPower>
     <OverrideQuality>false</OverrideQuality>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>H23</Name>
     <Position>
      <X>
       <VariableName>interaction_control\GravityCompensation1\Joint23\Hout[1,4]</VariableName>
       <Value>-0.0835081664697288</Value>
      </X>
      <Y>
       <VariableName>interaction_control\GravityCompensation1\Joint23\Hout[2,4]</VariableName>
       <Value>-6.95910814242326e-006</Value>
      </Y>
      <Z>
       <VariableName>interaction_control\GravityCompensation1\Joint23\Hout[3,4]</VariableName>
       <Value>0.180440469833432</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <VariableName>interaction_control\GravityCompensation1\Joint23\Hout[1,3]</VariableName>
        <Value>-0.993133857285708</Value>
       </X>
       <Y>
        <VariableName>interaction_control\GravityCompensation1\Joint23\Hout[2,3]</VariableName>
        <Value>-6.42865201751833e-005</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\GravityCompensation1\Joint23\Hout[3,3]</VariableName>
        <Value>0.116983491912552</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <VariableName>interaction_control\GravityCompensation1\Joint23\Hout[1,2]</VariableName>
        <Value>-6.47309721332013e-005</Value>
       </X>
       <Y>
        <VariableName>interaction_control\GravityCompensation1\Joint23\Hout[2,2]</VariableName>
        <Value>0.999999997904951</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\GravityCompensation1\Joint23\Hout[3,2]</VariableName>
        <Value>-8.470329472543e-022</Value>
       </Z>
      </YAxis>
      <OrientationType>Matrix</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
         </Cube>
        </Childs>
       </Frame>
       <Camera>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Camera</Name>
        <Position>
         <X>
     <Value>2.7049253315468</Value>
         </X>
         <Y>
     <Value>1.58897461786434</Value>
         </Y>
         <Z>
     <Value>1.26380680729944</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <Value>-0.852664865338706</Value>
     </X>
     <Y>
      <Value>-0.39324239096776</Value>
     </Y>
     <Z>
      <Value>-0.343981175884503</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <Value>-0.312362076361878</Value>
     </X>
     <Y>
      <Value>-0.14405895534045</Value>
     </Y>
     <Z>
      <Value>0.938976544242248</Value>
     </Z>
         </YAxis>
         <OrientationType>Direct3D</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
        <FrontPlane>0.01</FrontPlane>
        <BackPlane>100</BackPlane>
        <Field>0.00392699081698724</Field>
        <Fieldy>45</Fieldy>
        <PlaneLeft>-10</PlaneLeft>
        <PlaneRight>10</PlaneRight>
        <PlaneTop>10</PlaneTop>
        <PlaneBottom>-10</PlaneBottom>
        <UseLookatPosition>true</UseLookatPosition>
        <LookatPosition>
         <X>
     <Value>-0.0606690461897726</Value>
         </X>
         <Y>
     <Value>0.313504043483261</Value>
         </Y>
         <Z>
     <Value>0.148113590955284</Value>
         </Z>
        </LookatPosition>
        <UseAlwaysLookUp>true</UseAlwaysLookUp>
        <LookUpVector>
         <Z>
     <Value>1</Value>
         </Z>
        </LookUpVector>
        <RightHand>true</RightHand>
        <Perspective>true</Perspective>
        <IsSelectedCamera>true</IsSelectedCamera>
       </Camera>
       <Frame>
        <ScaleValue>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </ScaleValue>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>default lights and camera</Name>
        <SceneryFileName>E:\My Dropbox\Studie en werk\UTwente\Master project\Modelling\Models\default lights and camera.scn</SceneryFileName>
        <Position>
        </Position>
        <Orientation>
         <Angles>
         </Angles>
         <OrientationType>Bryant</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
         <Frame>
     <ScaleValue>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </ScaleValue>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>Default Lights and Cameras</Name>
     <Position>
     </Position>
     <Orientation>
      <Angles>
      </Angles>
      <OrientationType>Bryant</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
      <Camera>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Camera Looking at Origin</Name>
       <Position>
        <X>
         <Value>7.08215008404679</Value>
        </X>
        <Y>
         <Value>6.6370422185346</Value>
        </Y>
        <Z>
         <Value>1.3389625746917</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <Value>-0.722818916155153</Value>
         </X>
         <Y>
     <Value>-0.67739028486331</Value>
         </Y>
         <Z>
     <Value>-0.136657295528245</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <X>
     <Value>-0.099713956242438</Value>
         </X>
         <Y>
     <Value>-0.0934470082537438</Value>
         </Y>
         <Z>
     <Value>0.99061838443414</Value>
         </Z>
        </YAxis>
        <OrientationType>Direct3D</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
       <FrontPlane>0.01</FrontPlane>
       <BackPlane>100</BackPlane>
       <Field>0.00392699081698724</Field>
       <Fieldy>45</Fieldy>
       <PlaneLeft>-10</PlaneLeft>
       <PlaneRight>10</PlaneRight>
       <PlaneTop>10</PlaneTop>
       <PlaneBottom>-10</PlaneBottom>
       <UseLookatPosition>true</UseLookatPosition>
       <LookatPosition>
       </LookatPosition>
       <UseAlwaysLookUp>true</UseAlwaysLookUp>
       <LookUpVector>
        <Z>
         <Value>1</Value>
        </Z>
       </LookUpVector>
       <RightHand>true</RightHand>
       <Perspective>true</Perspective>
       <IsSelectedCamera>false</IsSelectedCamera>
      </Camera>
      <Camera>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Front(XY)-Camera</Name>
       <Position>
        <Z>
         <Value>10</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <Z>
     <Value>-1</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <Y>
     <Value>1</Value>
         </Y>
        </YAxis>
        <OrientationType>Direct3D</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
       <FrontPlane>0.01</FrontPlane>
       <BackPlane>100</BackPlane>
       <Field>10</Field>
       <Fieldy>45</Fieldy>
       <PlaneLeft>-10</PlaneLeft>
       <PlaneRight>10</PlaneRight>
       <PlaneTop>10</PlaneTop>
       <PlaneBottom>-10</PlaneBottom>
       <UseLookatPosition>true</UseLookatPosition>
       <LookatPosition>
       </LookatPosition>
       <UseAlwaysLookUp>true</UseAlwaysLookUp>
       <LookUpVector>
        <Y>
         <Value>1</Value>
        </Y>
       </LookUpVector>
       <RightHand>true</RightHand>
       <Perspective>false</Perspective>
       <IsSelectedCamera>false</IsSelectedCamera>
      </Camera>
      <Camera>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Side(YZ)-Camera</Name>
       <Position>
        <X>
         <Value>10</Value>
        </X>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <Value>-1</Value>
         </X>
        </ZAxis>
        <YAxis>
         <Z>
     <Value>1</Value>
         </Z>
        </YAxis>
        <OrientationType>Direct3D</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
       <FrontPlane>0.01</FrontPlane>
       <BackPlane>100</BackPlane>
       <Field>10</Field>
       <Fieldy>45</Fieldy>
       <PlaneLeft>-10</PlaneLeft>
       <PlaneRight>10</PlaneRight>
       <PlaneTop>10</PlaneTop>
       <PlaneBottom>-10</PlaneBottom>
       <UseLookatPosition>true</UseLookatPosition>
       <LookatPosition>
       </LookatPosition>
       <UseAlwaysLookUp>true</UseAlwaysLookUp>
       <LookUpVector>
        <Z>
         <Value>1</Value>
        </Z>
       </LookUpVector>
       <RightHand>true</RightHand>
       <Perspective>false</Perspective>
       <IsSelectedCamera>false</IsSelectedCamera>
      </Camera>
      <Camera>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Top(XZ)-Camera</Name>
       <Position>
        <Y>
         <Value>10</Value>
        </Y>
       </Position>
       <Orientation>
        <ZAxis>
         <Y>
     <Value>-1</Value>
         </Y>
        </ZAxis>
        <YAxis>
         <X>
     <Value>1</Value>
         </X>
        </YAxis>
        <OrientationType>Direct3D</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
       </Childs>
       <FrontPlane>0.01</FrontPlane>
       <BackPlane>100</BackPlane>
       <Field>10</Field>
       <Fieldy>45</Fieldy>
       <PlaneLeft>-10</PlaneLeft>
       <PlaneRight>10</PlaneRight>
       <PlaneTop>10</PlaneTop>
       <PlaneBottom>-10</PlaneBottom>
       <UseLookatPosition>true</UseLookatPosition>
       <LookatPosition>
       </LookatPosition>
       <UseAlwaysLookUp>true</UseAlwaysLookUp>
       <LookUpVector>
        <X>
         <Value>1</Value>
        </X>
       </LookUpVector>
       <RightHand>true</RightHand>
       <Perspective>false</Perspective>
       <IsSelectedCamera>false</IsSelectedCamera>
      </Camera>
     </Childs>
         </Frame>
        </Childs>
       </Frame>
       <Frame>
        <ScaleValue>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </ScaleValue>
        <ShowReferenceFrame>true</ShowReferenceFrame>
        <Name>Reference Frame</Name>
        <Position>
         <X>
     <VariableName>interaction_control\Gain\H[1,4]</VariableName>
     <Value>-0.0999999980761788</Value>
         </X>
         <Y>
     <VariableName>interaction_control\Gain\H[2,4]</VariableName>
     <Value>-0.0999999980761788</Value>
         </Y>
         <Z>
     <VariableName>interaction_control\Gain\H[3,4]</VariableName>
     <Value>0.400000011542927</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <VariableName>interaction_control\Gain\H[1,3]</VariableName>
      <Value>-0.400981654194886</Value>
     </X>
     <Y>
      <VariableName>interaction_control\Gain\H[2,3]</VariableName>
      <Value>-0.876160987941762</Value>
     </Y>
     <Z>
      <VariableName>interaction_control\Gain\H[3,3]</VariableName>
      <Value>0.267498852722864</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <VariableName>interaction_control\Gain\H[1,2]</VariableName>
      <Value>0.909297442837521</Value>
     </X>
     <Y>
      <VariableName>interaction_control\Gain\H[2,2]</VariableName>
      <Value>-0.416146801560633</Value>
     </Y>
     <Z>
      <VariableName>interaction_control\Gain\H[3,2]</VariableName>
      <Value>0</Value>
     </Z>
         </YAxis>
         <OrientationType>Matrix</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
         <Cylinder>
     <CircleElements>16</CircleElements>
     <LowerRadius>0.1</LowerRadius>
     <UpperRadius>0.1</UpperRadius>
     <Height>1</Height>
     <Closed>true</Closed>
     <LowerClosed>true</LowerClosed>
     <UpperClosed>true</UpperClosed>
     <CenterInOrigin>false</CenterInOrigin>
     <ShowInnerSide>false</ShowInnerSide>
     <ShowOuterSide>true</ShowOuterSide>
     <ScaleValue>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <VariableName>interaction_control\CtipControl\stenght</VariableName>
       <Value>0.00441315051110022</Value>
      </Z>
     </ScaleValue>
     <OverrideColor>true</OverrideColor>
     <MeshColor>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColor>
     <Alpha>0</Alpha>
     <MeshColorMultipliers>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColorMultipliers>
     <MeshColorOffsets>
     </MeshColorOffsets>
     <Direct3DColorRange>true</Direct3DColorRange>
     <SpecularColor>
      <X>
       <Value>0.498039215686275</Value>
      </X>
      <Y>
       <Value>0.498039215686275</Value>
      </Y>
      <Z>
       <Value>0.498039215686275</Value>
      </Z>
     </SpecularColor>
     <EmissiveColor>
     </EmissiveColor>
     <ShininessPower>
      <Value>13.5413365364075</Value>
     </ShininessPower>
     <OverrideQuality>false</OverrideQuality>
     <ShowReferenceFrame>true</ShowReferenceFrame>
     <Name>Cylinder</Name>
     <Position>
      <X>
       <VariableName>interaction_control\CtipControl\state[1,4]</VariableName>
       <Value>0.565275130271858</Value>
      </X>
      <Y>
       <VariableName>interaction_control\CtipControl\state[2,4]</VariableName>
       <Value>4.12855119366237</Value>
      </Y>
      <Z>
       <VariableName>interaction_control\CtipControl\state[3,4]</VariableName>
       <Value>1.45307484391867</Value>
      </Z>
     </Position>
     <Orientation>
      <ZAxis>
       <X>
        <VariableName>interaction_control\CtipControl\state[1,3]</VariableName>
        <Value>0.0999697382660589</Value>
       </X>
       <Y>
        <VariableName>interaction_control\CtipControl\state[2,3]</VariableName>
        <Value>-0.90591357121658</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\CtipControl\state[3,3]</VariableName>
        <Value>0.41149319911347</Value>
       </Z>
      </ZAxis>
      <YAxis>
       <X>
        <VariableName>interaction_control\CtipControl\state[1,2]</VariableName>
        <Value>0.448321185105954</Value>
       </X>
       <Y>
        <VariableName>interaction_control\CtipControl\state[2,2]</VariableName>
        <Value>0.410216295182727</Value>
       </Y>
       <Z>
        <VariableName>interaction_control\CtipControl\state[3,2]</VariableName>
        <Value>0.794185561535685</Value>
       </Z>
      </YAxis>
      <OrientationType>Matrix</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
     </Childs>
         </Cylinder>
        </Childs>
       </Frame>
      </Childs>
     </Frame>
         </Childs>
        </Frame>
       </Childs>
      </Frame>
     </MainFrame>
    </Plot>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <UseWindowsBGColor>true</UseWindowsBGColor>
       <BGColor>13160660</BGColor>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>true</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>control forces</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>40</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-400</Minimum>
       <Maximum>100</Maximum>
       <Linear>true</Linear>
       <Scaling>0</Scaling>
       <Label>interaction_control\JointSoftLimits\p.e[1]</Label>
      </Axis>
      <Axis>
       <Minimum>-400</Minimum>
       <Maximum>100</Maximum>
       <Linear>true</Linear>
       <Scaling>0</Scaling>
       <Label>interaction_control\JointSoftLimits\p.e[2]</Label>
      </Axis>
      <Axis>
       <Minimum>-400</Minimum>
       <Maximum>100</Maximum>
       <Linear>true</Linear>
       <Scaling>0</Scaling>
       <Label>interaction_control\JointSoftLimits\p.e[3]</Label>
      </Axis>
      <Axis>
       <Minimum>-400</Minimum>
       <Maximum>100</Maximum>
       <Linear>true</Linear>
       <Scaling>0</Scaling>
       <Label>interaction_control\JointSoftLimits\p.e[4]</Label>
      </Axis>
      <Axis>
       <Minimum>-400</Minimum>
       <Maximum>100</Maximum>
       <Linear>true</Linear>
       <Scaling>0</Scaling>
       <Label>interaction_control\JointSoftLimits\p.e[5]</Label>
      </Axis>
      <Axis>
       <Minimum>-400</Minimum>
       <Maximum>100</Maximum>
       <Linear>true</Linear>
       <Scaling>0</Scaling>
       <Label>interaction_control\JointSoftLimits\p.e[6]</Label>
      </Axis>
      <Axis>
       <Minimum>-400</Minimum>
       <Maximum>100</Maximum>
       <Linear>true</Linear>
       <Scaling>0</Scaling>
       <Label>interaction_control\JointSoftLimits\p.e[7]</Label>
      </Axis>
      <Axis>
       <Minimum>-400</Minimum>
       <Maximum>100</Maximum>
       <Linear>true</Linear>
       <Scaling>0</Scaling>
       <Label>interaction_control\JointSoftLimits\p.e[8]</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>16711680</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16711680</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\p.e[1]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>16711935</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16711935</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\p.e[2]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>255</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>255</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\p.e[3]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>65280</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>65280</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\p.e[4]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>0</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>0</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\p.e[5]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>10040319</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>10040319</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\p.e[6]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>16763904</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16763904</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\p.e[7]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>26367</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>26367</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\p.e[8]</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
     </Legenda>
     <StripChartPlots>
      <DistributState>2</DistributState>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
     </StripChartPlots>
    </Plot>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <UseWindowsBGColor>true</UseWindowsBGColor>
       <BGColor>13160660</BGColor>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>true</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>state</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>40</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-5</Minimum>
       <Maximum>5</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label></Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>interaction_control\JointSoftLimits\state[2]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>interaction_control\JointSoftLimits\state[3]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>interaction_control\JointSoftLimits\state[4]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>interaction_control\JointSoftLimits\state[5]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>interaction_control\JointSoftLimits\state[6]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>interaction_control\JointSoftLimits\state[7]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>interaction_control\JointSoftLimits\state[8]</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>16711680</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16711680</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\state[1]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>16711935</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16711935</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\state[2]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>255</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>255</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\state[3]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>65280</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>65280</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\state[4]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>0</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>0</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\state[5]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>10040319</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>10040319</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\state[6]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>16763904</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16763904</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\state[7]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>26367</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>26367</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>interaction_control\JointSoftLimits\state[8]</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
     </Legenda>
     <StripChartPlots>
      <DistributState>2</DistributState>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
     </StripChartPlots>
    </Plot>
   </Plots>
   <WindowRectangles virtualDesktopWidth="1680" virtualDesktopHeight="1028">
     <WindowRectangle monitor="0" left="0" top="0" right="1680" bottom="1028">
0.202381 0.020428 0.47619 0.898833
     </WindowRectangle>
     <WindowRectangle monitor="0" left="0" top="0" right="1680" bottom="1028">
0.336905 0.25 1.13631 1.15564
     </WindowRectangle>
     <WindowRectangle monitor="0" left="0" top="0" right="1680" bottom="1028">
0.608333 0.0671206 0.9875 0.58463
     </WindowRectangle>
     <WindowRectangle monitor="0" left="0" top="0" right="1680" bottom="1028">
0.0880952 0.121595 0.653571 0.604086
     </WindowRectangle>
   </WindowRectangles>
  </PlotSpecs>
  <RunSpecs>
   <SimulatorSettings>
    <StartTime>0</StartTime>
    <FinishTime>40</FinishTime>
    <Warp>false</Warp>
    <UseOutputAfterEach>false</UseOutputAfterEach>
    <OutputAfterEach>0.1</OutputAfterEach>
    <EventEpsilon>1e-007</EventEpsilon>
    <AlgebraicTolerance>1e-007</AlgebraicTolerance>
    <SteadyStateAnalysis>false</SteadyStateAnalysis>
   </SimulatorSettings>
   <IntegrationMethods>
    <IntegrationMethod>
     <Name>Euler</Name>
     <StepSize>0.01</StepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>BackwardEuler</Name>
     <AbsoluteTolerance>1e-005</AbsoluteTolerance>
     <RelativeTolerance>1e-005</RelativeTolerance>
     <AlgebraicAbsoluteTolerance>1e-005</AlgebraicAbsoluteTolerance>
     <AlgebraicRelativeTolerance>1e-005</AlgebraicRelativeTolerance>
     <StepSize>0.01</StepSize>
     <Alpha>1</Alpha>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>AdamsBashforth</Name>
     <StepSize>0.01</StepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>RungeKutta2</Name>
     <StepSize>0.01</StepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>RungeKutta4</Name>
     <StepSize>0.001</StepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>RungeKutta8</Name>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0</MaximumStepSize>
     <AbsoluteTolerance>1e-006</AbsoluteTolerance>
     <RelativeTolerance>1e-006</RelativeTolerance>
     <SafetyFactor>0.9</SafetyFactor>
     <Factor1>0.33</Factor1>
     <Factor2>6</Factor2>
     <Beta>0</Beta>
     <UseMaxNrSteps>false</UseMaxNrSteps>
     <MaxNrSteps>100000</MaxNrSteps>
     <UseStiffDetection>false</UseStiffDetection>
     <MaxNrStiffnessSteps>1000</MaxNrStiffnessSteps>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>RungeKuttaFehlberg</Name>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0</MaximumStepSize>
     <AbsoluteTolerance>1e-006</AbsoluteTolerance>
     <RelativeTolerance>1e-006</RelativeTolerance>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>VodeAdams</Name>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0</MaximumStepSize>
     <AbsoluteTolerance>1e-006</AbsoluteTolerance>
     <RelativeTolerance>1e-006</RelativeTolerance>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>BDFMethod</Name>
     <AbsoluteTolerance>1e-005</AbsoluteTolerance>
     <RelativeTolerance>1e-005</RelativeTolerance>
     <AlgebraicAbsoluteTolerance>1e-005</AlgebraicAbsoluteTolerance>
     <AlgebraicRelativeTolerance>1e-005</AlgebraicRelativeTolerance>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0</MaximumStepSize>
     <UseFixedStepSize>false</UseFixedStepSize>
     <FixedStepSize>0</FixedStepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>MeBDFiMethod</Name>
     <AbsoluteTolerance>5e-006</AbsoluteTolerance>
     <RelativeTolerance>5e-006</RelativeTolerance>
     <AlgebraicAbsoluteTolerance>5e-006</AlgebraicAbsoluteTolerance>
     <AlgebraicRelativeTolerance>5e-006</AlgebraicRelativeTolerance>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0</MaximumStepSize>
     <UseFixedStepSize>false</UseFixedStepSize>
     <FixedStepSize>0</FixedStepSize>
    </IntegrationMethod>
    <SelectedIntegrationMethod>8</SelectedIntegrationMethod>
   </IntegrationMethods>
  </RunSpecs>
  <MultipleRun>
   <NrSteps>10</NrSteps>
   <CopyFromStates>false</CopyFromStates>
   <JoinParameterVariation>true</JoinParameterVariation>
   <ClearAfterRun>true</ClearAfterRun>
   <RedrawAfterRun>false</RedrawAfterRun>
   <DrawDuringSimulation>true</DrawDuringSimulation>
   <ActionBeforeOptimization>0</ActionBeforeOptimization>
   <CompareValue>0</CompareValue>
   <UseCompareValue>true</UseCompareValue>
   <MultipleRunType>MultipleRun</MultipleRunType>
   <Minimize>true</Minimize>
   <OptimizationVariable></OptimizationVariable>
   <ResulVarUsage>UseEndValue</ResulVarUsage>
   <Tolerance>0.001</Tolerance>
   <OptimizationMethod>BroydonFletcherGoldfarbShanno</OptimizationMethod>
   <MultipleRunVariables>
   </MultipleRunVariables>
  </MultipleRun>
  <ExportData>
   <WriteAsText>true</WriteAsText>
   <ReadAsText>true</ReadAsText>
   <WriteHeader>true</WriteHeader>
   <ReadHeader>true</ReadHeader>
   <ReadFilename></ReadFilename>
   <WriteFilename></WriteFilename>
   <DoWrite>false</DoWrite>
   <ExportVariables>
   </ExportVariables>
   <ImportVariables>
   </ImportVariables>
  </ExportData>
  <BreakPoints>
  </BreakPoints>
</ExpData>
  </Experiment>
</Experiments>
</Document>
