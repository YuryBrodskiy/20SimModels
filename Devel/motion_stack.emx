<?xml version="1.0" encoding="UTF-8"?>
<Document>
 <Model version="4.1" build="4.1.4.1">
    <Sidops>
<![CDATA[model 128 184 description '<Description>
   <Version>4.1</Version>
<IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Z:\Users\yury\workspaces\20SimModels\Devel\motion_stack.emx</LibraryPath>
  <TimeStamp>2012-11-26 13:52:24</TimeStamp>
</Description>'; type 'Mainmodel-ea9' end; implementation bg  submodels   Amcl 1392 888    description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Sources\Constant.emx</LibraryPath> <TimeStamp>2007-10-19 14:48:44</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Constant     ports      signal out H_odom_map [4,4];      signal in H_base_odom [4,4];    end;    icon bg bottom     figures      rectangle 1376.1 872 1407.9 904 fill 15132390;      line 1380.9 883.6 1402.9 883.6 color 16711680 width 2;      line 1378.2 894.7 1403.9 894.7;      line 1380.5 878.7 1380.5 897;    end;    implementation eqparameters 	//boolean vp_equal_to_tip=true;	real H_eye[4,4]= [ 1, 0, 0, 0;					  	  0, 1, 0, 0;					     0, 0, 1, 0 ;					     0, 0, 0, 1 ]; // latex notation H^{tip}_{cc}equations	H_odom_map=H_eye;implementation_end;   ArmJointActive 736 288    description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Sources\Constant.emx</LibraryPath> <TimeStamp>2007-10-19 14:48:44</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Constant     ports      signal out output [5,1];    end;    icon bg left     figures      rectangle 720.1 272 751.9 304 fill 15132390;      line 724.9 283.6 746.9 283.6 color 16711680 width 2;      line 722.2 294.7 747.9 294.7;      line 724.5 278.7 724.5 297;    end;    implementation eqparameters	real C[5] = [1;1;1;1;1];	// output valueequations	output = C;     implementation_end;   ArmPoseController 1328 466    description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Submodel     ports      signal in joints_torque [5,1];      signal in angles_setpoint [5,1];      signal in active_joint [5,1];      signal in joints_angle [5,1];      signal out joints_angle_output [5,1];      signal out Arm_torque [5,1];      signal in input_energy [2,1];      signal out output_energy [2,1];      signal out EnergyTank;    end;    icon bg     figures      rectangle 1264 402 1392 530 fill 14013909;      text 'name' 1328 458 16;     terminals      joints_torque 1264 450 fixed;      angles_setpoint 1304 402 fixed;      active_joint 1344 402 fixed;      joints_angle 1392 498 fixed;      joints_angle_output 1264 498 fixed;      Arm_torque 1392 450 fixed;    end;    implementation bg     submodels      EnergyEncoding 568 240       description '<Description>   <Version>4.1</Version>  <LibraryPath>EnergyEncodingR.emx</LibraryPath>  <TimeStamp>2012-10-30 18:54:40</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in inputMessage [2,1];         signal out inputEnergy;         signal out outputMessage [2,1];         signal in outputEnergy;       end;       icon bg        figures         rectangle 512 216 624 264 fill 14013909;         text 'name' 568 240 16;        terminals         inputMessage 536 216 fixed;         inputEnergy 536 264 fixed;         outputMessage 600 216 fixed;         outputEnergy 600 264 fixed;       end;       implementation eqparameters	real roundUp= 1000;	real MaxCounter=100;variables	real inputCount; // required to implement 'to zero' behaviour on input	real inputSum;	  // implements current state of all inputs by integraing all inputs 	real inputDiff;  // current  arrived message	real outputCount; // required to implement 'to zero' behaviour on output	real outputSum;	  // implements current state of all output by integraing all outputs 	real outputDiff;  // current  sent messageinitialequations	inputSum=0;	// initialize the input sum 	outputSum=0; 	// initialize the output sum code   // Compuation of incoming messages		//check if arrived message is less then  current input sum	if (inputMessage[1]+0.1*roundUp)<inputSum then		//if yes the input message was rounded up, thus roundup should be added to compute the increment properly		inputDiff=roundUp+inputMessage[1]-inputSum;	else		// if no the increment can be computed as simple difference		inputDiff=inputMessage[1]-inputSum;	end;	// This was a tested code; but I don't know the purose	//if inputMessage[1]==0 then	//	inputDiff=0;	//end;		// do round up and integrate	inputSum=(inputSum+inputDiff) mod roundUp;	inputEnergy=inputDiff;	 // Compuation of outgoing messages	outputCount=(previous(outputCount)+1) mod MaxCounter;	outputSum=(outputSum+outputEnergy) mod roundUp;	outputMessage[1]=outputSum;	outputMessage[2]=outputCount;implementation_end;      GravityCompensationModel 680 376       description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>youBot_GravityCompensation.emx</LibraryPath> <TimeStamp>2011-1-21 10:13:56</TimeStamp></Description>';       type Submodel        ports         signal out joints [5,1];         signal in jointPos [5,1];        parameters         real InitialJointPos[5,1] = [0.0; 0.0; 0.0; 0.0; 0.0];         real LinkCOMdim[3,6] = [0.01489, 0.10453, 0.001, 0.011, 0.0, 0.0; 0.00213, 0.0017, 0.0967, 0.05103, 0.00115, 0.0; 0.00213, -0.00297, 0.02107, -0.02319, -0.01683, 0.001];         real Linkdim[3,6] = [0.024, 0.033, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.096, 0.019, 0.155, 0.135, 0.096, 0.034];         real Linkm[6,1] = [20.0; 2.412; 1.155; 0.934; 0.877; 1.121];       end;       icon bg        figures         rectangle 625.5 337 734.5 415 fill 11206638;         text '     youBot     GravityCompensation' 678.5 377 16;       end;       implementation bg        submodels         Base 208 472          description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>Link_GravityCompensation.emx</LibraryPath>  <TimeStamp>2011-1-19 11:37:47</TimeStamp><Description>Base</Description></Description>';          type Submodel           ports            power out p [6,1];            signal in Hin [4,4];            power in p1 [6,1];            signal out Hout [4,4];           parameters            real m = 20.0;            real COMdim[3,1] = [0.01489; 0.00213; 0.00213];            real dim[3,1] = [0.024; 0.0; 0.096];          end;          icon bg bottom           figures            rectangle 176 400 240 544 fill 10025880;            text 'LinkGC' 208 472;           terminals            p 176 432 fixed;            Hin 176 512 fixed;            p1 240 432 fixed;            Hout 240 512 fixed;          end;          implementation bg           submodels            AdHi0 664 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power in p1 [6,1];               power out p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'MTF' 664 416 18 bold;             end;             implementation eqvariables 	real onlyRotH[4,4];code	//Only rotations with respect to the inertial system matter!	onlyRotH = H;	onlyRotH[1,4] = 0;	onlyRotH[2,4] = 0;	onlyRotH[3,4] = 0;							p2.e = transpose(Adjoint(onlyRotH)) * p1.e;	p1.f = Adjoint(onlyRotH) * p2.f;implementation_end;            AdHij 816 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg top              figures               text 'MTF' 816 304 18 bold;             end;             implementation eqequations	//Only rotations with respect to the inertial system matter!							p1.e = transpose(Adjoint(H)) * p2.e;	p2.f = Adjoint(H) * p1.f;implementation_end;            AdHik1 664 368             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power out p1 [6,1];               power in p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.01489; 0.00213; 0.00213];             end;             icon bg left              figures               text 'TF' 664 368 18 bold;             end;             implementation eq//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            Gravity 776 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Se.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:26</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Se              ports               power out p [6,1];              restrictions               causality fixed out p;              parameters               real m = 20.0;             end;             icon bg bottom              figures               text 'Se' 776 416 18 bold;             end;             implementation eqvariables	real effort[6];equations	effort = [0;0;0;0;0;-9.8*m];	p.e = effort;implementation_end;            Hij 816 496             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>H.emx</LibraryPath>  <TimeStamp>2010-9-21 15:03:50</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input [4,4];               signal out output [4,4];               signal out Hab [4,4];              parameters               real dim[3,1] = [0.024; 0.0; 0.096];             end;             icon bg bottom              figures               rectangle 800.1 480 831.9 512 fill 15132390;               text 'H' 816 496 color 16711680 16 bold;             end;             implementation eqequations	Hab = homogeneous(eye(3),dim);	output = input * Hab;    implementation_end;            plug Hin 592 496;            plug p1 904 304;            plug Hout 896 496;            plug p 592 304;            Splitter1 664 496             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;               ellipse 659.7 491.7 668.3 500.3 color -1;              terminals               input 664 496 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Ta00 720 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 720 416 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0i 664 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 664 304 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;           end;           connections            Ta0i\p <= AdHik1\p1;            AdHi0\p2 => AdHik1\p2;            Gravity\p => Ta00\p;            p <= Ta0i\p;            Ta0i\p <= AdHij\p1;            p1 => AdHij\p2;            Ta00\p => AdHi0\p1;            Hin -> Splitter1\input;            Hij\output -> Hout;            Splitter1\output -> Hij\input;            Splitter1\output -> AdHi0\H;            Hij\Hab -> AdHij\H;           end;           parameterrelationsAdHik1\COMdim = COMdim;Hij\dim = dim;Gravity\m=m;parameterrelations_end;           figures            text 'b = current link (body)a = previous link (body)i = Body fixed frame, fixed in joint with previous linkj = Body fixed frame, fixed in joint with next linkk = Body fixed frame, principal inertial frame0 = inertial system ' 416 376;          implementation_end;         EffortSensor1 536 56          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\EffortSensor.emx</LibraryPath>  <TimeStamp>2007-9-27 9:59:27</TimeStamp></Description>';          knot EffortSensor           ports            power knot in p1 [5,1];            power knot out p2 [5,1];            signal knot out effort [5,1];           restrictions            causality constraint not_equal p1 p2;          end;          icon bg ellipse           figures            ellipse 529.1 50.3 542.9 64.4 fill 16777215;            text 'e' 536.5 54.6;          end;          implementation eqequations	p2.e = p1.e;	p1.f = p2.f;	effort = p1.e;implementation_end;         Hfloor0 112 512          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Sources\Constant.emx</LibraryPath> <TimeStamp>2007-10-19 14:48:44</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Constant           ports            signal out output [4,4];          end;          icon bg bottom           figures            rectangle 96.1 496 127.9 528 fill 15132390;            line 100.9 507.6 122.9 507.6 color 16711680 width 2;            line 98.2 518.7 123.9 518.7;            line 100.5 502.7 100.5 521;          end;          implementation eqequations	output = eye(4);     implementation_end;         Htip0 1088 512          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\SignalMonitor.emx</LibraryPath> <TimeStamp>2007-9-26 12:14:4</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type SignalMonitor           ports            signal in input [4,4];          end;          icon bg bottom           figures            rectangle 1072 496 1104 528 fill 15132390;            rectangle 1077.7 501.8 1098.3 522.6 color 16711680 fill 11776947 width 2;            rectangle 1079.8 504.4 1095.9 520 color -1 fill 16777215;            line 1081.9 506.7 1081.9 518 fill 16777215;            line 1080 516.4 1092.5 516.4 fill 16777215;            line 1081.5 516.1 1094.4 509.7 color 255 fill 16777215;          end;          implementation eq   implementation_end;         Joint12 448.2 472          description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>Joint-roty_GravityCompensation.emx</LibraryPath>  <TimeStamp>2011-1-19 11:38:03</TimeStamp></Description>';          type 'Submodel-roty'           ports            power out p [6,1];            power in p1;            power in p2 [6,1];            signal in Hin [4,4];            signal out Hout [4,4];            signal in angle;           parameters            real InitialPos = 0.0;          end;          icon bg bottom           figures            rectangle 416.4 400 479.9 544 fill 14745599;            text 'Joint-roty   GC' 448.4 475 fill 14745599;           terminals            p 415.9 432 fixed;            p1 447.4 400 fixed;            p2 479.9 432 fixed;            Hin 415.9 512 fixed;            Hout 479.9 512 fixed;          end;          implementation bg           submodels            AdHji 424 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg bottom              figures               text 'MTF' 424 424 18 bold;             end;             implementation eqequations						p2.e = transpose(Adjoint(H)) * p1.e;	p1.f = Adjoint(H) * p2.f;implementation_end;            Integrate 320 336             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath> <TimeStamp>2007-9-26 12:3:23</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Integrate              ports               signal in input;               signal out output [4,4];              parameters               real init = 0.0;             end;             icon bg              figures               rectangle 304 320 336 352 fill 15132390;               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;             end;             implementation eqvariables	real R[3,3];	real p[3];	real q;equationsq = input;//int(input,init);R = [	cos(q),	0,	sin(q);			0,				1,	0;			-sin(q),	0,	cos(q)];p = [0;0;0];output = homogeneous(R,p);	     implementation_end;            MatrixMul 320 496             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath> <TimeStamp>2007-9-26 12:15:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input1 [4,4];               signal out output [4,4];               signal in input2 [4,4];             end;             icon bg bottom              figures               rectangle 304.1 480 335.9 512 fill 15132390;               text 'X' 320 496 color 16711680 16 bold;             end;             implementation eqequations	output = input2*input1;    implementation_end;            plug p1 240 56;            plug p2 496 424;            plug Hin 112 496;            plug Hout 504 496;            plug angle 320 208;            plug p 112 424;            OneJunction 240 272             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               power knot duplicatable none p [1];               signal knot out flow [1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 240 272 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Splitter2 320 368             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;               ellipse 315.7 363.7 324.3 372.3 color -1;              terminals               input 320 368 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Tbai 240 384             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg left              figures               text '1' 240 384 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            uTbai 240 328             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1;               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'TF' 240 328 18 bold;             end;             implementation eqequations	p2.f = [0;p1.f;0;0;0;0];	p1.e = p2.e[2];implementation_end;            Wbai 240 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:43</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [6,1];               signal knot out effort [6,1];              restrictions               causality constraint one_in p;             end;             icon bg bottom              figures               text '0' 240 424 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;            ZeroJunction 240 104             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:43</TimeStamp></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [1];               signal knot out effort [1];              restrictions               causality constraint one_in p;             end;             icon bg              figures               text '0' 240 104 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;           end;           connections            p1 => ZeroJunction\p;            uTbai\p2 => Tbai\p;            Tbai\p => Wbai\p;            p <= Wbai\p;            ZeroJunction\p => OneJunction\p;            OneJunction\p => uTbai\p1;            Wbai\p <= AdHji\p1;            p2 => AdHji\p2;            MatrixMul\output -> Hout;            Hin -> MatrixMul\input2;            Integrate\output -> Splitter2\input;            Splitter2\output -> MatrixMul\input1;            Splitter2\output -> AdHji\H 424 368;            angle -> Integrate\input;           end;           parameterrelationsIntegrate\init = InitialPos;parameterrelations_end;           figures            text 'b = next link (body)a = previous link (body)i = Frame fixed in previous body, fixed in jointj = Frame fixed in next body, fixed in joint ' 744 400;          implementation_end;         Joint23 608.2 472          description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>Joint-roty_GravityCompensation.emx</LibraryPath> <TimeStamp>2011-1-19 11:38:03</TimeStamp></Description>';          type 'Submodel-roty'           ports            power out p [6,1];            power in p1;            power in p2 [6,1];            signal in Hin [4,4];            signal out Hout [4,4];            signal in angle;           parameters            real InitialPos = 0.0;          end;          icon bg bottom           figures            rectangle 576.4 400 639.9 544 fill 14745599;            text 'Joint-roty   GC' 608.4 475 fill 14745599;           terminals            p 575.9 432 fixed;            p1 607.4 400 fixed;            p2 639.9 432 fixed;            Hin 575.9 512 fixed;            Hout 639.9 512 fixed;          end;          implementation bg           submodels            AdHji 424 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg bottom              figures               text 'MTF' 424 424 18 bold;             end;             implementation eqequations						p2.e = transpose(Adjoint(H)) * p1.e;	p1.f = Adjoint(H) * p2.f;implementation_end;            Integrate 320 336             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath> <TimeStamp>2007-9-26 12:3:23</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Integrate              ports               signal in input;               signal out output [4,4];              parameters               real init = 0.0;             end;             icon bg              figures               rectangle 304 320 336 352 fill 15132390;               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;             end;             implementation eqvariables	real R[3,3];	real p[3];	real q;equationsq = input;//int(input,init);R = [	cos(q),	0,	sin(q);			0,				1,	0;			-sin(q),	0,	cos(q)];p = [0;0;0];output = homogeneous(R,p);	     implementation_end;            MatrixMul 320 496             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath> <TimeStamp>2007-9-26 12:15:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input1 [4,4];               signal out output [4,4];               signal in input2 [4,4];             end;             icon bg bottom              figures               rectangle 304.1 480 335.9 512 fill 15132390;               text 'X' 320 496 color 16711680 16 bold;             end;             implementation eqequations	output = input2*input1;    implementation_end;            plug p1 240 56;            plug p2 496 424;            plug Hin 112 496;            plug Hout 504 496;            plug angle 352 216;            plug p 112 424;            OneJunction 240 272             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               power knot duplicatable none p [1];               signal knot out flow [1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 240 272 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Splitter2 320 368             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;               ellipse 315.7 363.7 324.3 372.3 color -1;              terminals               input 320 368 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Tbai 240 384             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg left              figures               text '1' 240 384 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            uTbai 240 328             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1;               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'TF' 240 328 18 bold;             end;             implementation eqequations	p2.f = [0;p1.f;0;0;0;0];	p1.e = p2.e[2];implementation_end;            Wbai 240 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:43</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [6,1];               signal knot out effort [6,1];              restrictions               causality constraint one_in p;             end;             icon bg bottom              figures               text '0' 240 424 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;            ZeroJunction 240 104             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:43</TimeStamp></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [1];               signal knot out effort [1];              restrictions               causality constraint one_in p;             end;             icon bg              figures               text '0' 240 104 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;           end;           connections            p1 => ZeroJunction\p;            uTbai\p2 => Tbai\p;            Tbai\p => Wbai\p;            p <= Wbai\p;            ZeroJunction\p => OneJunction\p;            OneJunction\p => uTbai\p1;            Wbai\p <= AdHji\p1;            p2 => AdHji\p2;            MatrixMul\output -> Hout;            Hin -> MatrixMul\input2;            Integrate\output -> Splitter2\input;            Splitter2\output -> MatrixMul\input1;            Splitter2\output -> AdHji\H 424 368;            angle -> Integrate\input;           end;           parameterrelationsIntegrate\init = InitialPos;parameterrelations_end;           figures            text 'b = next link (body)a = previous link (body)i = Frame fixed in previous body, fixed in jointj = Frame fixed in next body, fixed in joint ' 744 400;          implementation_end;         Joint34 768.2 472          description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>Joint-roty_GravityCompensation.emx</LibraryPath> <TimeStamp>2011-1-19 11:38:03</TimeStamp></Description>';          type 'Submodel-roty'           ports            power out p [6,1];            power in p1;            power in p2 [6,1];            signal in Hin [4,4];            signal out Hout [4,4];            signal in angle;           parameters            real InitialPos = 0.0;          end;          icon bg bottom           figures            rectangle 736.4 400 799.9 544 fill 14745599;            text 'Joint-roty   GC' 768.4 475 fill 14745599;           terminals            p 735.9 432 fixed;            p1 767.4 400 fixed;            p2 799.9 432 fixed;            Hin 735.9 512 fixed;            Hout 799.9 512 fixed;          end;          implementation bg           submodels            AdHji 424 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg bottom              figures               text 'MTF' 424 424 18 bold;             end;             implementation eqequations						p2.e = transpose(Adjoint(H)) * p1.e;	p1.f = Adjoint(H) * p2.f;implementation_end;            Integrate 320 336             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath> <TimeStamp>2007-9-26 12:3:23</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Integrate              ports               signal in input;               signal out output [4,4];              parameters               real init = 0.0;             end;             icon bg              figures               rectangle 304 320 336 352 fill 15132390;               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;             end;             implementation eqvariables	real R[3,3];	real p[3];	real q;equationsq = input;//int(input,init);R = [	cos(q),	0,	sin(q);			0,				1,	0;			-sin(q),	0,	cos(q)];p = [0;0;0];output = homogeneous(R,p);	     implementation_end;            MatrixMul 320 496             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath> <TimeStamp>2007-9-26 12:15:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input1 [4,4];               signal out output [4,4];               signal in input2 [4,4];             end;             icon bg bottom              figures               rectangle 304.1 480 335.9 512 fill 15132390;               text 'X' 320 496 color 16711680 16 bold;             end;             implementation eqequations	output = input2*input1;    implementation_end;            plug p1 240 56;            plug p2 496 424;            plug Hin 112 496;            plug Hout 504 496;            plug angle 336 216;            plug p 112 424;            OneJunction 240 272             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               power knot duplicatable none p [1];               signal knot out flow [1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 240 272 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Splitter2 320 368             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;               ellipse 315.7 363.7 324.3 372.3 color -1;              terminals               input 320 368 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Tbai 240 384             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg left              figures               text '1' 240 384 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            uTbai 240 328             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1;               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'TF' 240 328 18 bold;             end;             implementation eqequations	p2.f = [0;p1.f;0;0;0;0];	p1.e = p2.e[2];implementation_end;            Wbai 240 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:43</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [6,1];               signal knot out effort [6,1];              restrictions               causality constraint one_in p;             end;             icon bg bottom              figures               text '0' 240 424 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;            ZeroJunction 240 104             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:43</TimeStamp></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [1];               signal knot out effort [1];              restrictions               causality constraint one_in p;             end;             icon bg              figures               text '0' 240 104 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;           end;           connections            p1 => ZeroJunction\p;            uTbai\p2 => Tbai\p;            Tbai\p => Wbai\p;            p <= Wbai\p;            ZeroJunction\p => OneJunction\p;            OneJunction\p => uTbai\p1;            Wbai\p <= AdHji\p1;            p2 => AdHji\p2;            MatrixMul\output -> Hout;            Hin -> MatrixMul\input2;            Integrate\output -> Splitter2\input;            Splitter2\output -> MatrixMul\input1;            angle -> Integrate\input;            Splitter2\output -> AdHji\H 424 368;           end;           parameterrelationsIntegrate\init = InitialPos;parameterrelations_end;           figures            text 'b = next link (body)a = previous link (body)i = Frame fixed in previous body, fixed in jointj = Frame fixed in next body, fixed in joint ' 744 400;          implementation_end;         Joint45 928.2 472          description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>Joint-rotz_GravityCompensation.emx</LibraryPath> <TimeStamp>2011-1-19 11:37:54</TimeStamp></Description>';          type 'Submodel-rotz'           ports            power out p [6,1];            power in p1;            power in p2 [6,1];            signal in Hin [4,4];            signal out Hout [4,4];            signal in angle;           parameters            real InitialPos = 0.0;          end;          icon bg bottom           figures            rectangle 896.4 400 959.9 544 fill 14745599;            text 'Joint-rotz   GC' 928.4 475 fill 14745599;           terminals            p 895.9 432 fixed;            p1 927.4 400 fixed;            p2 959.9 432 fixed;            Hin 895.9 512 fixed;            Hout 959.9 512 fixed;          end;          implementation bg           submodels            AdHji 424 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg bottom              figures               text 'MTF' 424 424 18 bold;             end;             implementation eqequations						p2.e = transpose(Adjoint(H)) * p1.e;	p1.f = Adjoint(H) * p2.f;implementation_end;            Integrate 320 288             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath> <TimeStamp>2007-9-26 12:3:23</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Integrate              ports               signal in input;               signal out output [4,4];              parameters               real init = 0.0;             end;             icon bg              figures               rectangle 304 272 336 304 fill 15132390;               text 'ò' 320 285.3 color 16711680 'SymbolProp BT' 21 symbol;             end;             implementation eqvariables	real R[3,3];	real p[3];	real q;equationsq = input;//int(input,init);R = [	cos(-q),	-sin(-q),	0;			sin(-q),	cos(-q),	0;			0,				0,				1];p = [0;0;0];output = homogeneous(R,p);	     implementation_end;            MatrixMul 320 576             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath> <TimeStamp>2007-9-26 12:15:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input1 [4,4];               signal out output [4,4];               signal in input2 [4,4];             end;             icon bg bottom              figures               rectangle 304.1 560 335.9 592 fill 15132390;               text 'X' 320 576 color 16711680 16 bold;             end;             implementation eqequations	output = input2*input1;    implementation_end;            plug p1 240 40;            plug p2 496 424;            plug Hin 112 576;            plug Hout 504 576;            plug angle 336 184;            plug p 112 424;            OneJunction 240 288             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               mechanical knot duplicatable none p [1];               signal knot out flow [1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 240 288 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Splitter2 320 368             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;               ellipse 315.7 363.7 324.3 372.3 color -1;              terminals               input 320 368 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            uTbai 240 336             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1;               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;               causality fixed out p1;               causality fixed in p2;             end;             icon bg left              figures               text 'TF' 240 336 18 bold;             end;             implementation eqequations	p1.e = p2.e[3];	p2.f = [0;0;p1.f;0;0;0];implementation_end;            Wbai 240 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:43</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [6,1];               signal knot out effort [6,1];              restrictions               causality constraint one_in p;             end;             icon bg bottom              figures               text '0' 240 424 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;            ZeroJunction 240 104             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:43</TimeStamp></Description>';             knot ZeroJunction              ports               mechanical knot duplicatable none p [1];               signal knot out effort [1];              restrictions               causality constraint one_in p;             end;             icon bg              figures               text '0' 240 104 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;           end;           connections            uTbai\p1 <= OneJunction\p;            Wbai\p <= AdHji\p1;            p2 => AdHji\p2;            ZeroJunction\p => OneJunction\p;            p1 => ZeroJunction\p;            uTbai\p2 => Wbai\p;            p <= Wbai\p;            Splitter2\output -> AdHji\H 424 368;            MatrixMul\output -> Hout;            Hin -> MatrixMul\input2;            Integrate\output -> Splitter2\input;            Splitter2\output -> MatrixMul\input1;            angle -> Integrate\input;           end;           parameterrelationsIntegrate\init = InitialPos;parameterrelations_end;           figures            text 'b = next link (body)a = previous link (body)i = Frame fixed in previous body, fixed in jointj = Frame fixed in next body, fixed in joint ' 680 488;          implementation_end;         JointBase1 288.2 472          description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>Joint-rotz_GravityCompensation.emx</LibraryPath>  <TimeStamp>2011-1-21 10:09:48</TimeStamp></Description>';          type 'Submodel-rotz'           ports            power out p [6,1];            power in p1;            power in p2 [6,1];            signal in Hin [4,4];            signal out Hout [4,4];            signal in angle;           parameters            real InitialPos = 0.0;          end;          icon bg bottom           figures            rectangle 256.4 400 319.9 544 fill 14745599;            text 'Joint-rotz   GC' 288.4 475 fill 14745599;           terminals            p 255.9 432 fixed;            p1 287.4 400 fixed;            p2 319.9 432 fixed;            Hin 255.9 512 fixed;            Hout 319.9 512 fixed;          end;          implementation bg           submodels            AdHji 424 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg bottom              figures               text 'MTF' 424 424 18 bold;             end;             implementation eqequations						p2.e = transpose(Adjoint(H)) * p1.e;	p1.f = Adjoint(H) * p2.f;implementation_end;            Integrate 320 288             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath> <TimeStamp>2007-9-26 12:3:23</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Integrate              ports               signal in input;               signal out output [4,4];              parameters               real init = 0.0;             end;             icon bg              figures               rectangle 304 272 336 304 fill 15132390;               text 'ò' 320 285.3 color 16711680 'SymbolProp BT' 21 symbol;             end;             implementation eqvariables	real R[3,3];	real p[3];	real q;equationsq = input;//int(input,init);R = [	cos(-q),	-sin(-q),	0;			sin(-q),	cos(-q),	0;			0,				0,				1];p = [0;0;0];output = homogeneous(R,p);	     implementation_end;            MatrixMul 320 576             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath> <TimeStamp>2007-9-26 12:15:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input1 [4,4];               signal out output [4,4];               signal in input2 [4,4];             end;             icon bg bottom              figures               rectangle 304.1 560 335.9 592 fill 15132390;               text 'X' 320 576 color 16711680 16 bold;             end;             implementation eqequations	output = input2*input1;    implementation_end;            plug p1 240 40;            plug p2 496 424;            plug Hin 112 576;            plug Hout 504 576;            plug angle 320 216;            plug p 112 424;            OneJunction 240 288             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               mechanical knot duplicatable none p [1];               signal knot out flow [1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 240 288 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Splitter2 320 368             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;               ellipse 315.7 363.7 324.3 372.3 color -1;              terminals               input 320 368 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            uTbai 240 336             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1;               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;               causality fixed out p1;               causality fixed in p2;             end;             icon bg left              figures               text 'TF' 240 336 18 bold;             end;             implementation eqequations	p1.e = p2.e[3];	p2.f = [0;0;p1.f;0;0;0];implementation_end;            Wbai 240 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:43</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [6,1];               signal knot out effort [6,1];              restrictions               causality constraint one_in p;             end;             icon bg bottom              figures               text '0' 240 424 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;            ZeroJunction 240 104             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:43</TimeStamp></Description>';             knot ZeroJunction              ports               mechanical knot duplicatable none p [1];               signal knot out effort [1];              restrictions               causality constraint one_in p;             end;             icon bg              figures               text '0' 240 104 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;           end;           connections            uTbai\p1 <= OneJunction\p;            Wbai\p <= AdHji\p1;            p2 => AdHji\p2;            ZeroJunction\p => OneJunction\p;            p1 => ZeroJunction\p;            uTbai\p2 => Wbai\p;            p <= Wbai\p;            Splitter2\output -> AdHji\H 424 368;            MatrixMul\output -> Hout;            Hin -> MatrixMul\input2;            Integrate\output -> Splitter2\input;            Splitter2\output -> MatrixMul\input1;            angle -> Integrate\input;           end;           parameterrelationsIntegrate\init = InitialPos;parameterrelations_end;           figures            text 'b = next link (body)a = previous link (body)i = Frame fixed in previous body, fixed in jointj = Frame fixed in next body, fixed in joint ' 680 488;          implementation_end;         Link1 368 472          description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>Link_GravityCompensation.emx</LibraryPath> <TimeStamp>2011-1-19 11:37:47</TimeStamp>   <Description>Base</Description></Description>';          type Submodel           ports            power out p [6,1];            signal in Hin [4,4];            power in p1 [6,1];            signal out Hout [4,4];           parameters            real m = 2.412;            real COMdim[3,1] = [0.10453; 0.0017; -0.00297];            real dim[3,1] = [0.033; 0.0; 0.019];          end;          icon bg bottom           figures            rectangle 336 400 400 544 fill 10025880;            text 'LinkGC' 368 472;           terminals            p 336 432 fixed;            Hin 336 512 fixed;            p1 400 432 fixed;            Hout 400 512 fixed;          end;          implementation bg           submodels            AdHi0 664 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power in p1 [6,1];               power out p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'MTF' 664 416 18 bold;             end;             implementation eqvariables 	real onlyRotH[4,4];code	//Only rotations with respect to the inertial system matter!	onlyRotH = H;	onlyRotH[1,4] = 0;	onlyRotH[2,4] = 0;	onlyRotH[3,4] = 0;							p2.e = transpose(Adjoint(onlyRotH)) * p1.e;	p1.f = Adjoint(onlyRotH) * p2.f;implementation_end;            AdHij 816 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg top              figures               text 'MTF' 816 304 18 bold;             end;             implementation eqequations	//Only rotations with respect to the inertial system matter!							p1.e = transpose(Adjoint(H)) * p2.e;	p2.f = Adjoint(H) * p1.f;implementation_end;            AdHik1 664 368             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power out p1 [6,1];               power in p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.10453; 0.0017; -0.00297];             end;             icon bg left              figures               text 'TF' 664 368 18 bold;             end;             implementation eq//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            Gravity 776 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Se.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:26</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Se              ports               power out p [6,1];              restrictions               causality fixed out p;              parameters               real m = 2.412;             end;             icon bg bottom              figures               text 'Se' 776 416 18 bold;             end;             implementation eqvariables	real effort[6];equations	effort = [0;0;0;0;0;-9.8*m];	p.e = effort;implementation_end;            Hij 816 496             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>H.emx</LibraryPath>  <TimeStamp>2010-9-21 15:03:50</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input [4,4];               signal out output [4,4];               signal out Hab [4,4];              parameters               real dim[3,1] = [0.033; 0.0; 0.019];             end;             icon bg bottom              figures               rectangle 800.1 480 831.9 512 fill 15132390;               text 'H' 816 496 color 16711680 16 bold;             end;             implementation eqequations	Hab = homogeneous(eye(3),dim);	output = input * Hab;    implementation_end;            plug Hin 592 496;            plug p1 904 304;            plug Hout 896 496;            plug p 592 304;            Splitter1 664 496             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;               ellipse 659.7 491.7 668.3 500.3 color -1;              terminals               input 664 496 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Ta00 720 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 720 416 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0i 664 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 664 304 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;           end;           connections            Ta0i\p <= AdHik1\p1;            AdHi0\p2 => AdHik1\p2;            Gravity\p => Ta00\p;            p <= Ta0i\p;            Ta0i\p <= AdHij\p1;            p1 => AdHij\p2;            Ta00\p => AdHi0\p1;            Hin -> Splitter1\input;            Hij\output -> Hout;            Splitter1\output -> Hij\input;            Splitter1\output -> AdHi0\H;            Hij\Hab -> AdHij\H;           end;           parameterrelationsAdHik1\COMdim = COMdim;Hij\dim = dim;Gravity\m=m;parameterrelations_end;           figures            text 'b = current link (body)a = previous link (body)i = Body fixed frame, fixed in joint with previous linkj = Body fixed frame, fixed in joint with next linkk = Body fixed frame, principal inertial frame0 = inertial system ' 416 376;          implementation_end;         Link2 528 472          description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>Link_GravityCompensation.emx</LibraryPath> <TimeStamp>2011-1-19 11:37:47</TimeStamp>   <Description>Base</Description></Description>';          type Submodel           ports            power out p [6,1];            signal in Hin [4,4];            power in p1 [6,1];            signal out Hout [4,4];           parameters            real m = 1.155;            real COMdim[3,1] = [0.001; 0.0967; 0.02107];            real dim[3,1] = [0.0; 0.0; 0.155];          end;          icon bg bottom           figures            rectangle 496 400 560 544 fill 10025880;            text 'LinkGC' 528 472;           terminals            p 496 432 fixed;            Hin 496 512 fixed;            p1 560 432 fixed;            Hout 560 512 fixed;          end;          implementation bg           submodels            AdHi0 664 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power in p1 [6,1];               power out p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'MTF' 664 416 18 bold;             end;             implementation eqvariables 	real onlyRotH[4,4];code	//Only rotations with respect to the inertial system matter!	onlyRotH = H;	onlyRotH[1,4] = 0;	onlyRotH[2,4] = 0;	onlyRotH[3,4] = 0;							p2.e = transpose(Adjoint(onlyRotH)) * p1.e;	p1.f = Adjoint(onlyRotH) * p2.f;implementation_end;            AdHij 816 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg top              figures               text 'MTF' 816 304 18 bold;             end;             implementation eqequations	//Only rotations with respect to the inertial system matter!							p1.e = transpose(Adjoint(H)) * p2.e;	p2.f = Adjoint(H) * p1.f;implementation_end;            AdHik1 664 368             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power out p1 [6,1];               power in p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.001; 0.0967; 0.02107];             end;             icon bg left              figures               text 'TF' 664 368 18 bold;             end;             implementation eq//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            Gravity 776 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Se.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:26</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Se              ports               power out p [6,1];              restrictions               causality fixed out p;              parameters               real m = 1.155;             end;             icon bg bottom              figures               text 'Se' 776 416 18 bold;             end;             implementation eqvariables	real effort[6];equations	effort = [0;0;0;0;0;-9.8*m];	p.e = effort;implementation_end;            Hij 816 496             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>H.emx</LibraryPath>  <TimeStamp>2010-9-21 15:03:50</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input [4,4];               signal out output [4,4];               signal out Hab [4,4];              parameters               real dim[3,1] = [0.0; 0.0; 0.155];             end;             icon bg bottom              figures               rectangle 800.1 480 831.9 512 fill 15132390;               text 'H' 816 496 color 16711680 16 bold;             end;             implementation eqequations	Hab = homogeneous(eye(3),dim);	output = input * Hab;    implementation_end;            plug Hin 592 496;            plug p1 904 304;            plug Hout 896 496;            plug p 592 304;            Splitter1 664 496             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;               ellipse 659.7 491.7 668.3 500.3 color -1;              terminals               input 664 496 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Ta00 720 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 720 416 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0i 664 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 664 304 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;           end;           connections            Ta0i\p <= AdHik1\p1;            AdHi0\p2 => AdHik1\p2;            Gravity\p => Ta00\p;            p <= Ta0i\p;            Ta0i\p <= AdHij\p1;            p1 => AdHij\p2;            Ta00\p => AdHi0\p1;            Hin -> Splitter1\input;            Hij\output -> Hout;            Splitter1\output -> Hij\input;            Splitter1\output -> AdHi0\H;            Hij\Hab -> AdHij\H;           end;           parameterrelationsAdHik1\COMdim = COMdim;Hij\dim = dim;Gravity\m=m;parameterrelations_end;           figures            text 'b = current link (body)a = previous link (body)i = Body fixed frame, fixed in joint with previous linkj = Body fixed frame, fixed in joint with next linkk = Body fixed frame, principal inertial frame0 = inertial system ' 416 376;          implementation_end;         Link3 688 472          description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>Link_GravityCompensation.emx</LibraryPath> <TimeStamp>2011-1-19 11:37:47</TimeStamp>   <Description>Base</Description></Description>';          type Submodel           ports            power out p [6,1];            signal in Hin [4,4];            power in p1 [6,1];            signal out Hout [4,4];           parameters            real m = 0.934;            real COMdim[3,1] = [0.011; 0.05103; -0.02319];            real dim[3,1] = [0.0; 0.0; 0.135];          end;          icon bg bottom           figures            rectangle 656 400 720 544 fill 10025880;            text 'LinkGC' 688 472;           terminals            p 656 432 fixed;            Hin 656 512 fixed;            p1 720 432 fixed;            Hout 720 512 fixed;          end;          implementation bg           submodels            AdHi0 664 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power in p1 [6,1];               power out p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'MTF' 664 416 18 bold;             end;             implementation eqvariables 	real onlyRotH[4,4];code	//Only rotations with respect to the inertial system matter!	onlyRotH = H;	onlyRotH[1,4] = 0;	onlyRotH[2,4] = 0;	onlyRotH[3,4] = 0;							p2.e = transpose(Adjoint(onlyRotH)) * p1.e;	p1.f = Adjoint(onlyRotH) * p2.f;implementation_end;            AdHij 816 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg top              figures               text 'MTF' 816 304 18 bold;             end;             implementation eqequations	//Only rotations with respect to the inertial system matter!							p1.e = transpose(Adjoint(H)) * p2.e;	p2.f = Adjoint(H) * p1.f;implementation_end;            AdHik1 664 368             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power out p1 [6,1];               power in p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.011; 0.05103; -0.02319];             end;             icon bg left              figures               text 'TF' 664 368 18 bold;             end;             implementation eq//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            Gravity 776 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Se.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:26</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Se              ports               power out p [6,1];              restrictions               causality fixed out p;              parameters               real m = 0.934;             end;             icon bg bottom              figures               text 'Se' 776 416 18 bold;             end;             implementation eqvariables	real effort[6];equations	effort = [0;0;0;0;0;-9.8*m];	p.e = effort;implementation_end;            Hij 816 496             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>H.emx</LibraryPath>  <TimeStamp>2010-9-21 15:03:50</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input [4,4];               signal out output [4,4];               signal out Hab [4,4];              parameters               real dim[3,1] = [0.0; 0.0; 0.135];             end;             icon bg bottom              figures               rectangle 800.1 480 831.9 512 fill 15132390;               text 'H' 816 496 color 16711680 16 bold;             end;             implementation eqequations	Hab = homogeneous(eye(3),dim);	output = input * Hab;    implementation_end;            plug Hin 592 496;            plug p1 904 304;            plug Hout 896 496;            plug p 592 304;            Splitter1 664 496             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;               ellipse 659.7 491.7 668.3 500.3 color -1;              terminals               input 664 496 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Ta00 720 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 720 416 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0i 664 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 664 304 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;           end;           connections            Ta0i\p <= AdHik1\p1;            AdHi0\p2 => AdHik1\p2;            Gravity\p => Ta00\p;            p <= Ta0i\p;            Ta0i\p <= AdHij\p1;            p1 => AdHij\p2;            Ta00\p => AdHi0\p1;            Hin -> Splitter1\input;            Hij\output -> Hout;            Splitter1\output -> Hij\input;            Splitter1\output -> AdHi0\H;            Hij\Hab -> AdHij\H;           end;           parameterrelationsAdHik1\COMdim = COMdim;Hij\dim = dim;Gravity\m=m;parameterrelations_end;           figures            text 'b = current link (body)a = previous link (body)i = Body fixed frame, fixed in joint with previous linkj = Body fixed frame, fixed in joint with next linkk = Body fixed frame, principal inertial frame0 = inertial system ' 416 376;          implementation_end;         Link4 848 472          description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>Link_GravityCompensation.emx</LibraryPath> <TimeStamp>2011-1-19 11:37:47</TimeStamp>   <Description>Base</Description></Description>';          type Submodel           ports            power out p [6,1];            signal in Hin [4,4];            power in p1 [6,1];            signal out Hout [4,4];           parameters            real m = 0.877;            real COMdim[3,1] = [0.0; 0.00115; -0.01683];            real dim[3,1] = [0.0; 0.0; 0.096];          end;          icon bg bottom           figures            rectangle 816 400 880 544 fill 10025880;            text 'LinkGC' 848 472;           terminals            p 816 432 fixed;            Hin 816 512 fixed;            p1 880 432 fixed;            Hout 880 512 fixed;          end;          implementation bg           submodels            AdHi0 664 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power in p1 [6,1];               power out p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'MTF' 664 416 18 bold;             end;             implementation eqvariables 	real onlyRotH[4,4];code	//Only rotations with respect to the inertial system matter!	onlyRotH = H;	onlyRotH[1,4] = 0;	onlyRotH[2,4] = 0;	onlyRotH[3,4] = 0;							p2.e = transpose(Adjoint(onlyRotH)) * p1.e;	p1.f = Adjoint(onlyRotH) * p2.f;implementation_end;            AdHij 816 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg top              figures               text 'MTF' 816 304 18 bold;             end;             implementation eqequations	//Only rotations with respect to the inertial system matter!							p1.e = transpose(Adjoint(H)) * p2.e;	p2.f = Adjoint(H) * p1.f;implementation_end;            AdHik1 664 368             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power out p1 [6,1];               power in p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.0; 0.00115; -0.01683];             end;             icon bg left              figures               text 'TF' 664 368 18 bold;             end;             implementation eq//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            Gravity 776 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Se.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:26</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Se              ports               power out p [6,1];              restrictions               causality fixed out p;              parameters               real m = 0.877;             end;             icon bg bottom              figures               text 'Se' 776 416 18 bold;             end;             implementation eqvariables	real effort[6];equations	effort = [0;0;0;0;0;-9.8*m];	p.e = effort;implementation_end;            Hij 816 496             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>H.emx</LibraryPath>  <TimeStamp>2010-9-21 15:03:50</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input [4,4];               signal out output [4,4];               signal out Hab [4,4];              parameters               real dim[3,1] = [0.0; 0.0; 0.096];             end;             icon bg bottom              figures               rectangle 800.1 480 831.9 512 fill 15132390;               text 'H' 816 496 color 16711680 16 bold;             end;             implementation eqequations	Hab = homogeneous(eye(3),dim);	output = input * Hab;    implementation_end;            plug Hin 592 496;            plug p1 904 304;            plug Hout 896 496;            plug p 592 304;            Splitter1 664 496             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;               ellipse 659.7 491.7 668.3 500.3 color -1;              terminals               input 664 496 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Ta00 720 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 720 416 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0i 664 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 664 304 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;           end;           connections            Ta0i\p <= AdHik1\p1;            AdHi0\p2 => AdHik1\p2;            Gravity\p => Ta00\p;            p <= Ta0i\p;            Ta0i\p <= AdHij\p1;            p1 => AdHij\p2;            Ta00\p => AdHi0\p1;            Hin -> Splitter1\input;            Hij\output -> Hout;            Splitter1\output -> Hij\input;            Splitter1\output -> AdHi0\H;            Hij\Hab -> AdHij\H;           end;           parameterrelationsAdHik1\COMdim = COMdim;Hij\dim = dim;Gravity\m=m;parameterrelations_end;           figures            text 'b = current link (body)a = previous link (body)i = Body fixed frame, fixed in joint with previous linkj = Body fixed frame, fixed in joint with next linkk = Body fixed frame, principal inertial frame0 = inertial system ' 416 376;          implementation_end;         Link5 1008 472          description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>Link_GravityCompensation.emx</LibraryPath> <TimeStamp>2011-1-19 11:37:47</TimeStamp>   <Description>Base</Description></Description>';          type Submodel           ports            power out p [6,1];            signal in Hin [4,4];            power in p1 [6,1];            signal out Hout [4,4];           parameters            real m = 1.121;            real COMdim[3,1] = [0.0; 0.0; 0.001];            real dim[3,1] = [0.0; 0.0; 0.034];          end;          icon bg bottom           figures            rectangle 976 400 1040 544 fill 10025880;            text 'LinkGC' 1008 472;           terminals            p 976 432 fixed;            Hin 976 512 fixed;            p1 1040 432 fixed;            Hout 1040 512 fixed;          end;          implementation bg           submodels            AdHi0 664 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power in p1 [6,1];               power out p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'MTF' 664 416 18 bold;             end;             implementation eqvariables 	real onlyRotH[4,4];code	//Only rotations with respect to the inertial system matter!	onlyRotH = H;	onlyRotH[1,4] = 0;	onlyRotH[2,4] = 0;	onlyRotH[3,4] = 0;							p2.e = transpose(Adjoint(onlyRotH)) * p1.e;	p1.f = Adjoint(onlyRotH) * p2.f;implementation_end;            AdHij 816 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg top              figures               text 'MTF' 816 304 18 bold;             end;             implementation eqequations	//Only rotations with respect to the inertial system matter!							p1.e = transpose(Adjoint(H)) * p2.e;	p2.f = Adjoint(H) * p1.f;implementation_end;            AdHik1 664 368             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power out p1 [6,1];               power in p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.0; 0.0; 0.001];             end;             icon bg left              figures               text 'TF' 664 368 18 bold;             end;             implementation eq//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            Gravity 776 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Se.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:26</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Se              ports               power out p [6,1];              restrictions               causality fixed out p;              parameters               real m = 1.121;             end;             icon bg bottom              figures               text 'Se' 776 416 18 bold;             end;             implementation eqvariables	real effort[6];equations	effort = [0;0;0;0;0;-9.8*m];	p.e = effort;implementation_end;            Hij 816 496             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>H.emx</LibraryPath>  <TimeStamp>2010-9-21 15:03:50</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input [4,4];               signal out output [4,4];               signal out Hab [4,4];              parameters               real dim[3,1] = [0.0; 0.0; 0.034];             end;             icon bg bottom              figures               rectangle 800.1 480 831.9 512 fill 15132390;               text 'H' 816 496 color 16711680 16 bold;             end;             implementation eqequations	Hab = homogeneous(eye(3),dim);	output = input * Hab;    implementation_end;            plug Hin 592 496;            plug p1 904 304;            plug Hout 896 496;            plug p 592 304;            Splitter1 664 496             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;               ellipse 659.7 491.7 668.3 500.3 color -1;              terminals               input 664 496 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Ta00 720 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 720 416 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0i 664 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 664 304 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;           end;           connections            Ta0i\p <= AdHik1\p1;            AdHi0\p2 => AdHik1\p2;            Gravity\p => Ta00\p;            p <= Ta0i\p;            Ta0i\p <= AdHij\p1;            p1 => AdHij\p2;            Ta00\p => AdHi0\p1;            Hin -> Splitter1\input;            Hij\output -> Hout;            Splitter1\output -> Hij\input;            Splitter1\output -> AdHi0\H;            Hij\Hab -> AdHij\H;           end;           parameterrelationsAdHik1\COMdim = COMdim;Hij\dim = dim;Gravity\m=m;parameterrelations_end;           figures            text 'b = current link (body)a = previous link (body)i = Body fixed frame, fixed in joint with previous linkj = Body fixed frame, fixed in joint with next linkk = Body fixed frame, principal inertial frame0 = inertial system ' 416 376;          implementation_end;         Mux 536 161          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            power out port [5,1];            power out port5;            power out port6;            power out port7;            power out port8;            power out port9;           restrictions            causality fixed in port8;            causality fixed in port9;            causality fixed in port6;            causality fixed in port7;            causality fixed in port5;            causality fixed out port;          end;          icon bg           figures            rectangle 456 146 616 176 fill 14013909;            text 'Mux' 536 160 16;           terminals            port 536 144 fixed;            port5 536 176 fixed;            port6 552 176 fixed;            port7 568 176 fixed;            port8 584 176 fixed;            port9 600 176 fixed;          end;          implementation eqparameters	real calibartion=1;equations	port.e[1] = port5.e*calibartion;	port.e[2] = port6.e*calibartion;	port.e[3] = port7.e*calibartion;	port.e[4] = port8.e*calibartion;	port.e[5] = port9.e*calibartion;		port5.f = port.f[1];	port6.f = port.f[2];	port7.f = port.f[3];	port8.f = port.f[4];	port9.f = port.f[5];implementation_end;         plug jointPos 80 648;         plug joints 72 56;         Submodel13 608 648          description '<Description> <Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>  <TimeStamp>2007-10-31 11:32:54</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          type Submodel           ports            signal in jointPos [5,1];            signal out port1;            signal out port2;            signal out port3;            signal out port4;            signal out port5;          end;          implementation eqequationsport1=jointPos[1];port2=jointPos[2];port3=jointPos[3];port4=jointPos[4];port5=jointPos[5];implementation_end;         Wtip0 1080 432          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Se.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:26</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Se           ports            power out p [6,1];           restrictions            causality fixed out p;          end;          icon bg bottom           figures            text 'Se' 1080 432 18 bold;          end;          implementation eqparameters	real effort = 0;variables	real flow[6];equations	p.e = effort;	flow = p.f;implementation_end;         ZeroJunction 112 432          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:43</TimeStamp></Description>';          knot ZeroJunction           ports            power knot duplicatable none p [6,1];            signal knot out effort [6,1];           restrictions            causality constraint one_in p;          end;          icon bg           figures            text '0' 112 432 18 bold;          end;          implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;         ZeroJunction1 656 56          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:43</TimeStamp></Description>';          knot ZeroJunction           ports            power knot duplicatable none p [5,1];            signal knot out effort [5,1];           restrictions            causality constraint one_in p;          end;          icon bg           figures            text '0' 656 56 18 bold;          end;          implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;        end;        connections         Base\p => ZeroJunction\p;         Mux\port8 => Joint34\p1 584 208 768 208;         Mux\port9 => Joint45\p1 600 192 928 192;         JointBase1\p2 <= Link1\p;         Joint12\p => Link1\p1;         Joint12\p2 <= Link2\p;         Joint23\p => Link2\p1;         Joint23\p2 <= Link3\p;         Joint34\p => Link3\p1;         Link4\p => Joint34\p2;         Joint45\p => Link4\p1;         Mux\port => EffortSensor1\p1;         Link5\p => Joint45\p2;         JointBase1\p1 <= Mux\port5 288 272 536 272;         EffortSensor1\p2 => ZeroJunction1\p;         Joint12\p1 <= Mux\port6 448 288 552 288;         JointBase1\p => Base\p1;         Wtip0\p => Link5\p1;         Mux\port7 => Joint23\p1 568 224 608 224;         Hfloor0\output -> Base\Hin;         Link1\Hin <- JointBase1\Hout;         Joint45\Hout -> Link5\Hin;         Joint45\Hin <- Link4\Hout;         jointPos -> Submodel13\jointPos;         Submodel13\port1 -> JointBase1\angle 288 608;         Submodel13\port2 -> Joint12\angle 448 592;         Submodel13\port3 -> Joint23\angle;         Submodel13\port4 -> Joint34\angle 768 600;         Submodel13\port5 -> Joint45\angle 928 608;         Joint34\Hout -> Link4\Hin;         Joint34\Hin <- Link3\Hout;         Link3\Hin <- Joint23\Hout;         Link2\Hout -> Joint23\Hin;         EffortSensor1\effort -> joints;         Link2\Hin <- Joint12\Hout;         Joint12\Hin <- Link1\Hout;         Base\Hout -> JointBase1\Hin;         Htip0\input <- Link5\Hout;        end;        parameterrelationsBase\m = Linkm[1];Base\COMdim = LinkCOMdim[1:3,1];Base\dim = Linkdim[1:3,1];Link1\m = Linkm[2];Link1\COMdim = LinkCOMdim[1:3,2];Link1\dim = Linkdim[1:3,2];Link2\m = Linkm[3];Link2\COMdim = LinkCOMdim[1:3,3];Link2\dim = Linkdim[1:3,3];Link3\m = Linkm[4];Link3\COMdim = LinkCOMdim[1:3,4];Link3\dim = Linkdim[1:3,4];Link4\m = Linkm[5];Link4\COMdim = LinkCOMdim[1:3,5];Link4\dim = Linkdim[1:3,5];Link5\m = Linkm[6];Link5\COMdim = LinkCOMdim[1:3,6];Link5\dim = Linkdim[1:3,6];JointBase1\InitialPos = InitialJointPos[1];Joint12\InitialPos = InitialJointPos[2];Joint23\InitialPos = InitialJointPos[3];Joint34\InitialPos = InitialJointPos[4];Joint45\InitialPos = InitialJointPos[5];parameterrelations_end;       implementation_end;      JointInitialStateOffset 504 464       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in input [5,1];         signal out output [5,1];       end;       icon bg        figures         rectangle 495 457 513 471 fill 14013909;       end;       implementation eqparameters	real joints_initial_states[5]=[-2.9496; -1.13; 2.5482; -1.789; -2.9234];equations	output=joints_initial_states+input;implementation_end;      JointInitialStateOffset1 680 440       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in input [5,1];         signal out output [5,1];       end;       icon bg        figures         rectangle 671 433 689 447 fill 14013909;       end;       implementation eqparameters	real joints_initial_states[5]=[-2.9496; -1.13; 2.5482; -1.789; -2.9234];equations	output=joints_initial_states+input;implementation_end;      JointSoftLimits 472 376       description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Control\PID Control\Continuous\P.emx</LibraryPath> <TimeStamp>2008-1-17 10:48:8</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type P        ports         signal in error [5,1];         signal out output [5,1];       end;       icon bg        figures         text 'P' 472.5 376.1 color 16711680 18 bold;         group          rectangle 456 360 488 392 fill 15132390;          line 460.5 375.9 485 375.9 fill 15132390;          line 472.2 363 472.2 388.7 fill 15132390;          spline 479.1 369.9 465.4 381.9 color 16711680 fill 15132390 width 2;          spline 466.2 381.3 465.8 389.9 color 16711680 fill 15132390 width 2;          spline 479.6 363 479.1 369.9 color 16711680 fill 15132390 width 2;         end;       end;       implementation eqparameters 	real c[5]= [50.0;50.0;50.0;50.0;50.0];	real limits_low[5]= [ -2.9395 ; -1.1244 ; -2.4733;  -1.7668 ; -2.8127];  	real limits_high[5]= [ 2.8847   ;1.4809  ; 2.5325  ; 1.6368 ;  2.7125];	real working_range= 0.95;variables	real substate[5];	real angle_limits_low[5];	real angle_limits_high[5];code  angle_limits_low=working_range*limits_low;  angle_limits_high=working_range*limits_high;  substate[1]=(limit(error[1]-angle_limits_high[1],0,10))+(limit(error[1]-angle_limits_low[1],-10,0));  substate[2]=(limit(error[2]-angle_limits_high[2],0,10))+(limit(error[2]-angle_limits_low[2],-10,0));  substate[3]=(limit(error[3]-angle_limits_high[3],0,10))+(limit(error[3]-angle_limits_low[3],-10,0));  substate[4]=(limit(error[4]-angle_limits_high[4],0,10))+(limit(error[4]-angle_limits_low[4],-10,0));  substate[5]=(limit(error[5]-angle_limits_high[5],0,10))+(limit(error[5]-angle_limits_low[5],-10,0));    output = -diag(c)*(exp(substate)-1);implementation_end;      JointSpaceController 376 376       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal out torque_cmd [5,1];         signal in angles_measured [5,1];         signal in angles_setpoint [5,1];         signal in active_joint [5,1];       end;       icon bg        figures         rectangle 339 354 413 398 fill 14013909;         text 'name' 376 376 13;       end;       implementation bg        submodels         Demux 176 120          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal out port1;            signal out port2;            signal out port3;            signal out port4;            signal in input [5,1];            signal out port5;          end;          icon bg           figures            rectangle 167 76 185 164 fill 14013909;          end;          implementation eqequationsport1=input[1];port2=input[2];port3=input[3];port4=input[4];port5=input[5];implementation_end;         Demux1 392 128          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in port1;            signal in port2;            signal in port3;            signal in port4;            signal out output [5,1];            signal in port5;          end;          icon bg           figures            rectangle 383 84 401 172 fill 14013909;          end;          implementation eqequationsoutput[1]=port1;output[2]=port2;output[3]=port3;output[4]=port4;output[5]=port5;implementation_end;         plug torque_cmd 496 128;         plug angles_measured 120 32;         plug angles_setpoint 48 120;         plug active_joint 424 64;         PD_Joint1 264 48          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Control\PID Control\Discrete\PD.emx</LibraryPath> <TimeStamp>2007-9-27 14:50:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type PD           ports            signal in error;            signal out output;          end;          icon bg bottom           figures            rectangle 248 32 280 64 fill 15132390;            text 'PD' 264 47.5 color 1336868 18 bold;          end;          implementation eqparameters	real kp = 30.0 {};			// Proportional gain 30 - nice slow move	real tauD = 1.0 {s};		// Derivative time constant: tauD > 0	real beta = 0.01 {};		// Tameness constant: 0 < beta << 1variables	real hidden factor,uD;equations	factor = 1 / ( sampletime + tauD * beta );	uD = factor * ( tauD * previous ( uD ) * beta + tauD * kp * ( error - previous ( error )) + sampletime * kp * error );	output = uD;implementation_end;         PD_Joint2 264 104          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Control\PID Control\Discrete\PD.emx</LibraryPath> <TimeStamp>2007-9-27 14:50:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type PD           ports            signal in error;            signal out output;          end;          icon bg bottom           figures            rectangle 248 88 280 120 fill 15132390;            text 'PD' 264 103.5 color 1336868 18 bold;          end;          implementation eqparameters	real kp = 30.0 {};			// Proportional gain 30 - nice slow move	real tauD = 1.0 {s};		// Derivative time constant: tauD > 0	real beta = 0.01 {};		// Tameness constant: 0 < beta << 1variables	real hidden factor,uD;equations	factor = 1 / ( sampletime + tauD * beta );	uD = factor * ( tauD * previous ( uD ) * beta + tauD * kp * ( error - previous ( error )) + sampletime * kp * error );	output = uD;implementation_end;         PD_Joint3 264 160          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Control\PID Control\Discrete\PD.emx</LibraryPath> <TimeStamp>2007-9-27 14:50:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type PD           ports            signal in error;            signal out output;          end;          icon bg bottom           figures            rectangle 248 144 280 176 fill 15132390;            text 'PD' 264 159.5 color 1336868 18 bold;          end;          implementation eqparameters	real kp = 30.0 {};			// Proportional gain 30 - nice slow move	real tauD = 1.0 {s};		// Derivative time constant: tauD > 0	real beta = 0.01 {};		// Tameness constant: 0 < beta << 1variables	real hidden factor,uD;equations	factor = 1 / ( sampletime + tauD * beta );	uD = factor * ( tauD * previous ( uD ) * beta + tauD * kp * ( error - previous ( error )) + sampletime * kp * error );	output = uD;implementation_end;         PD_Joint4 264 216          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Control\PID Control\Discrete\PD.emx</LibraryPath> <TimeStamp>2007-9-27 14:50:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type PD           ports            signal in error;            signal out output;          end;          icon bg bottom           figures            rectangle 248 200 280 232 fill 15132390;            text 'PD' 264 215.5 color 1336868 18 bold;          end;          implementation eqparameters	real kp = 30.0 {};			// Proportional gain 30 - nice slow move	real tauD = 1.0 {s};		// Derivative time constant: tauD > 0	real beta = 0.01 {};		// Tameness constant: 0 < beta << 1variables	real hidden factor,uD;equations	factor = 1 / ( sampletime + tauD * beta );	uD = factor * ( tauD * previous ( uD ) * beta + tauD * kp * ( error - previous ( error )) + sampletime * kp * error );	output = uD;implementation_end;         PD_Joint5 264 288          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Control\PID Control\Discrete\PD.emx</LibraryPath> <TimeStamp>2007-9-27 14:50:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type PD           ports            signal in error;            signal out output;          end;          icon bg bottom           figures            rectangle 248 272 280 304 fill 15132390;            text 'PD' 264 287.5 color 1336868 18 bold;          end;          implementation eqparameters	real kp = 30.0 {};			// Proportional gain 30 - nice slow move	real tauD = 1.0 {s};		// Derivative time constant: tauD > 0	real beta = 0.01 {};		// Tameness constant: 0 < beta << 1variables	real hidden factor,uD;equations	factor = 1 / ( sampletime + tauD * beta );	uD = factor * ( tauD * previous ( uD ) * beta + tauD * kp * ( error - previous ( error )) + sampletime * kp * error );	output = uD;implementation_end;         PlusMinus1 120 120          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>  <TimeStamp>2007-9-27 10:15:13</TimeStamp></Description>';          knot PlusMinus           ports            signal knot duplicatable in plus [5,1];            signal knot duplicatable in minus [5,1];            signal knot out output [5,1];          end;          icon bg ellipse           figures            ellipse 112 112 128 128 fill 16777215;          end;          implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;         Submodel3 424 128          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in input [5,1];            signal in active [5,1];            signal out cmd [5,1];          end;          icon bg           figures            rectangle 419 121 429 135 fill 14013909;          end;          implementation eqequations	cmd=diag(abs(sign(active)))*input;implementation_end;        end;        connections         Demux\port1 -> PD_Joint1\error;         PD_Joint4\output -> Demux1\port4;         PD_Joint5\output -> Demux1\port5;         Demux1\output -> Submodel3\input;         PlusMinus1\output -> Demux\input;         angles_setpoint -> PlusMinus1\plus;         Submodel3\cmd -> torque_cmd;         active_joint -> Submodel3\active;         angles_measured -> PlusMinus1\minus;         Demux\port2 -> PD_Joint2\error;         Demux\port3 -> PD_Joint3\error;         Demux\port4 -> PD_Joint4\error;         Demux\port5 -> PD_Joint5\error;         PD_Joint1\output -> Demux1\port1;         PD_Joint2\output -> Demux1\port2;         PD_Joint3\output -> Demux1\port3;        end;       implementation_end;      plug Arm_torque 776 312;      plug input_energy 520 160;      plug EnergyTank 592 352;      plug joints_angle_output 135 448;      plug joints_angle 856 464;      plug joints_torque 103 312;      plug active_joint 183.9 339.1;      plug angles_setpoint 183.9 376;      plug output_energy 640 176;      PassivityLayer 560 312       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in force [5,1];         signal in sensor [5,1];         signal out adjusted_force [5,1];         signal in input_energy;         signal out output_energy;         signal out EnergyTank;       end;       icon bg        figures         rectangle 512 289 608 335 fill 14013909;         text 'name' 560 311 16;       end;       implementation bg        submodels         EnergyTankBlock 496 376          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal out energyState;            signal in energyQuanta;          end;          implementation eqparameters	real InitialEnegyState =10{J};variables	real EnergyState;initialequations	EnergyState=InitialEnegyState;code	EnergyState=EnergyState+energyQuanta;	energyState=EnergyState;implementation_end;         EnergyTankControl 392 208          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in controlForce [5,1];            signal out adjustedForce [5,1];            signal in energyState;            signal in sensorValue [5,1];          end;          implementation eq/*  Tank level controller via dumping injection*/parameters	integer hidden n=5; //actuator array size needed for block reuse , only need to alter size of the inputs and this number	real DumpingInjectionTreshold = 5{J};  //minimal enrgy level to activet dumpling injection	real RecoveryMultiplier[n] = [10;10;10;10;10] {s/m^2};	 //variable friction co efficnet  based on energy level	real MaxmimDampingConstant[n] = [0.01;0.01;0.01;0.01;0.01]{N/t}; 	//maxmum dumping injection  force it is sampletime dependent !!!	boolean TCLactive=false;variables	real DumpingInjectionForce[n];//recovery torque	real dSensorValue[n];	real SensorSpeed[n];	real MaxmimDumping[n];	real energyStateError;	integer hidden i; // counterinitialequations	adjustedForce=0;code	// Compute speed  for damping injection ( it is possible to use more fancy ways of doing it)	dSensorValue=sensorValue-previous(sensorValue);	SensorSpeed=dSensorValue/sampletime;	// Based on the second order mass model maximum energy extartion occures if F_{damp}=\frac{m_{obj}* \dot x}{\Delta T}	// if F_{damp}>2\frac{m_{obj}* \dot x}{\Delta T} then damping injection fails  thus it is required to estimate the inertia parameters of the system 	// in here a simple limit is implementted to prevent active behaviour if sampletime has been increesed	MaxmimDumping=MaxmimDampingConstant/(sampletime);	// compute recovery mulpler	energyStateError=DumpingInjectionTreshold-energyState;	if energyStateError<=0 then		DumpingInjectionForce=0;	else		DumpingInjectionForce=-diag(RecoveryMultiplier)*energyStateError*SensorSpeed;	end;	//avoiding bug in limit computation during code generaion in 20-sim version 4.1.4.1	for i=1 to n do		DumpingInjectionForce[i]=limit(DumpingInjectionForce[i],-MaxmimDumping[i],MaxmimDumping[i]);	end;	if TCLactive then		adjustedForce=controlForce +DumpingInjectionForce;	else		adjustedForce=controlForce;	end;implementation_end;         plug force 48 208;         plug sensor 832 416;         plug adjusted_force 760 208;         plug input_energy 440 256;         plug output_energy 544 256;         plug EnergyTank 432 400;         PassiveSampling 664 376          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in adjustedForce [5,1];            signal in sensorValue [5,1];            signal out energyQuanta;          end;          implementation eq/*  	Passive sampling based on the Franken  Control of haptic interaction*/parameters	 integer hidden n=5; //actuator array size needed for block reuse , only need to alter size of the inputs and this numbervariables	real dSensorValue[n];code	// following compute energy exchange between sampe times is force is held constant over time sample period	// \Delta x=\int{\dot x}= x(k)-x(k-1)	dSensorValue=sensorValue-previous(sensorValue);	//\Delta H= - {\Delta x}^{T} F 	energyQuanta=-transpose(adjustedForce)*dSensorValue;implementation_end;         PassiveZOH 264 208          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in controlForce [5,1];            signal out adjustedForce [5,1];            signal in energyState;            signal in sensorValue [5,1];          end;          implementation eq/* nD Passive Zero Order Hold	it prevent system from using more energy then available	- Saturation functions			-maximum kinetic energy extracted in next time step			-maximum potentional energy state based on linear spring			-maximum of device outputThe optimization method blow work olny with in Phase 2 barier method thus for any energy level belowin the controller below kinetic energy zero forces will be provided*/parameters	integer hidden n=5; //actuator array size needed for block reuse , only need to alter size of the inputs and this number	real SpringConstant[n] = 1;//[10.0;10.0;10.0;10.0;10.0] {N/m}; 		 // Spring Constant to determine maximum torque base of linear spring staturation function  //the number is arbitary. it will affect system performance in serach of energietic minimum. 	real MaximumActuatorForce[n]=[10;10;10;10;10] {N};		 // Force saturation value based on actuator physical limit	boolean PassivityLayerActive= true;	real MassConstant[n]=1;	real eps =1e-4; //presision of opimization value does not affet the passivity since any torques in the feasble set are passive	real betaLine =0.5; // line search decerement	real betaBarrier1=1.5; //barrier standart increment	real betaBarrier2=5; // barrier exception incerement	integer maxNumIter=1000;//upperbound on the allowed search iterations	real Channelweights[n]=[1;1;1;1;1]; //actuation imporantce deterimnes which actuation channel is more importantvariables	real dSensorValue[n];	real SensorSpeed[n];	real ForceSaturationArray[n,3]; //	1.device output,2.Optimized energy barrier,3.desired force	real SaturatedForce[n];	real i;//counter	real aldo; //temporal compuation // optimization variables	real xd[n];real A[n,n];	real B1[n,n];	real B2[n,n];	real B3[n,n];	real a[n];	real b;	real xcl[n];	real dx[n];	real dObjective[n];	real HObjective[n,n];	real lamda2;	real t;	integer numIter;	//line search tempoerals	real obj;	real objAldo;	real xAldo[n];	real stepSize;initialequations	adjustedForce=0;	//energy barrrier parameters	A=diag(Channelweights);	// following computes the parameters of energy barrier	// F'*(dT^2*inv(M') +inv(K'))*F+dT*(F'*inv(M')*M*dx+dx'*F)+dx'*M*dx -2*H<0	B1=sampletime^2*inverse(	diag(MassConstant))+inverse(	diag(SpringConstant));	//dT*(F'*inv(M')*M*dx+dx'*F) simpifing eye~ transpose(inverse(MassConstant))*MassConstantsince it is symertical	B2=2*sampletime*eye(n);	B3=diag(MassConstant);	numIter=0;	aldo=0;code	//Fill in Force staturation Array 	ForceSaturationArray[:,1]=MaximumActuatorForce;		// Compute maximum alowed energy exchange	dSensorValue=sensorValue-previous(sensorValue);	SensorSpeed=dSensorValue/sampletime;	//energy berrier initial states	b=2*energyState;	a=SensorSpeed;	xd=controlForce;			numIter=0;	if b>0 and b-transpose(a)*B3*a>0 then		// there is enough energy to do control		//warning(' there is enough energy to do control',false);		xcl=controlForce;		numIter=0;		if  (b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a<0) then			warning(' there is enough energy to do control3',true);			// there is enough energy to do control as required following will commute the minimum effect alteration of control torques			xcl=0; // zero is strictly feaseble since b-transpose(a)*B3*a>0			lamda2=1; //temporal value for prescision calcuation			numIter=0; // tracking upper bound			lamda2=1;			t=1;			while (sqrt(lamda2)/t>eps and numIter<maxNumIter)  do// stop condition   		 	numIter=numIter+1;// count number of iterations     			t=t*betaBarrier1; // constrain relaxation process				dObjective=t*(A+transpose(A))*(xd-xcl)-1/(b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a)*(-(B1+transpose(B1))*xcl-B2*a); 				HObjective=-t*(A+transpose(A))-1/(b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a)^2*(-(B1+transpose(B1))*xcl-B2*a)*transpose(-(B1+transpose(B1))*xcl-B2*a)-1/(b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a)*(B1+transpose(B1)); 				dx=-inverse(HObjective)*dObjective;				lamda2=abs(transpose(dObjective)*dx);				// line search				obj=t*transpose(xd-xcl)*A*(xd-xcl)-log(b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a);     			stepSize=1;     			objAldo=obj;     			xAldo=xcl;     			while (obj<=objAldo and stepSize>eps^3) do         		stepSize=betaLine*stepSize;         		xAldo=xcl+dx*stepSize;         		if (b-transpose(xAldo)*(B1)*xAldo-transpose(a)*B2*xAldo-transpose(a)*B3*a>0) then             		objAldo=t*transpose(xd-xAldo)*A*(xd-xAldo)-log(b-transpose(xAldo)*(B1)*xAldo-transpose(a)*B2*xAldo-transpose(a)*B3*a);         		end;					if (stepSize<eps^3) then             		warning('had to intreupt',true);            		t=t*betaBarrier2;             		xAldo=xcl;         		end;     			end;     			// x update     			xcl=xAldo;			end;		else			// there is enough energy to do control as required			//warning(' there is enough energy to do control2',false);			xcl=controlForce;		end;	else		// there is not enough energy to do control		xcl=0;	end;	ForceSaturationArray[:,2]=xcl;	ForceSaturationArray[:,3]=controlForce;	for i =1 to n do		SaturatedForce[i]=sign(controlForce[i])*min(abs(ForceSaturationArray[i,:]));	end;	if PassivityLayerActive then		adjustedForce=SaturatedForce;	else		adjustedForce=controlForce;	end;implementation_end;         PlusMinus1 576 376          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>  <TimeStamp>2007-9-27 10:15:13</TimeStamp></Description>';          knot PlusMinus           ports            signal knot duplicatable in plus [1];            signal knot duplicatable in minus [1];            signal knot out output [1];          end;          icon bg ellipse           figures            ellipse 568 368 584 384 fill 16777215;          end;          implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;         SETP 496 312          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in energyState;            signal out energyQuanta;            signal out outputPackage;            signal in inputPackage;          end;          implementation eqparameters	real CommunicationTreshold=10 {J};	real SendoutPercent=0.01; //%initialequations	outputPackage=0;	energyQuanta=0;codeif CommunicationTreshold>energyState then	outputPackage=0;	energyQuanta=inputPackage;else	outputPackage=-(CommunicationTreshold-energyState)*SendoutPercent;	energyQuanta=inputPackage-outputPackage;end;implementation_end;         Splitter1 392 376          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [1];            signal knot in input [1];          end;          icon bg ellipse           figures            ellipse 388.8 372.8 395.2 379.2 color -1 fill 0;            ellipse 387.7 371.7 396.3 380.3 color -1;           terminals            input 392 376 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;         Splitter2 664 416          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [5,1];            signal knot in input [5,1];          end;          icon bg ellipse           figures            ellipse 660.8 412.8 667.2 419.2 color -1 fill 0;            ellipse 659.7 411.7 668.3 420.3 color -1;           terminals            input 664 416 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;         Splitter3 664 208          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [5,1];            signal knot in input [5,1];          end;          icon bg ellipse           figures            ellipse 660.8 204.8 667.2 211.2 color -1 fill 0;            ellipse 659.7 203.7 668.3 212.3 color -1;           terminals            input 664 208 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;         Splitter4 392 416          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [5,1];            signal knot in input [5,1];          end;          icon bg ellipse           figures            ellipse 388.8 412.8 395.2 419.2 color -1 fill 0;            ellipse 387.7 411.7 396.3 420.3 color -1;           terminals            input 392 416 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;         Splitter5 432 376          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [1];            signal knot in input [1];          end;          icon bg ellipse           figures            ellipse 428.8 372.8 435.2 379.2 color -1 fill 0;            ellipse 427.7 371.7 436.3 380.3 color -1;           terminals            input 432 376 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;        end;        connections         sensor -> Splitter2\input;         EnergyTankBlock\energyState -> Splitter5\input;         SETP\inputPackage <- input_energy 440 288;         PlusMinus1\output -> EnergyTankBlock\energyQuanta;         Splitter4\output -> EnergyTankControl\sensorValue 392 416;         PassiveZOH\adjustedForce -> EnergyTankControl\controlForce;         Splitter1\output -> EnergyTankControl\energyState;         PassiveSampling\energyQuanta -> PlusMinus1\plus;         Splitter5\output -> Splitter1\input;         Splitter2\output -> PassiveSampling\sensorValue;         Splitter5\output -> SETP\energyState 432 312;         Splitter3\output -> adjusted_force;         SETP\energyQuanta -> PlusMinus1\plus 576 312;         output_energy <- SETP\outputPackage 544 288;         force -> PassiveZOH\controlForce;         Splitter1\output -> PassiveZOH\energyState 264 376;         Splitter2\output -> Splitter4\input;         Splitter4\output -> PassiveZOH\sensorValue 264 416;         EnergyTankControl\adjustedForce -> Splitter3\input;         Splitter3\output -> PassiveSampling\adjustedForce;         Splitter5\output -> EnergyTank;        end;       implementation_end;      PlusMinus1 680 312       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>  <TimeStamp>2007-9-27 10:15:13</TimeStamp></Description>';       knot PlusMinus        ports         signal knot duplicatable in plus [5,1];         signal knot duplicatable in minus [5,1];         signal knot out output [5,1];       end;       icon bg ellipse        figures         ellipse 672 304 688 320 fill 16777215;       end;       implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;      PlusMinus2 472 312       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>  <TimeStamp>2007-9-27 10:15:13</TimeStamp></Description>';       knot PlusMinus        ports         signal knot duplicatable in plus [5,1];         signal knot duplicatable in minus [5,1];         signal knot out output [5,1];       end;       icon bg ellipse        figures         ellipse 464 304 480 320 fill 16777215;       end;       implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;      PlusMinus3 376 312       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>  <TimeStamp>2007-9-27 10:15:13</TimeStamp></Description>';       knot PlusMinus        ports         signal knot duplicatable in plus [5,1];         signal knot duplicatable in minus [5,1];         signal knot out output [5,1];       end;       icon bg ellipse        figures         ellipse 368 304 384 320 fill 16777215;       end;       implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;      Splitter1 680 464       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [5,1];         signal knot in input [5,1];       end;       icon bg ellipse        figures         ellipse 676.8 460.8 683.2 467.2 color -1 fill 0;         ellipse 675.7 459.7 684.3 468.3 color -1;        terminals         input 680 464 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Splitter4 472 464       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [5,1];         signal knot in input [5,1];       end;       icon bg ellipse        figures         ellipse 468.8 460.8 475.2 467.2 color -1 fill 0;         ellipse 467.7 459.7 476.3 468.3 color -1;        terminals         input 472 464 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Splitter6 376 448       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [5,1];         signal knot in input [5,1];       end;       icon bg ellipse        figures         ellipse 372.8 444.8 379.2 451.2 color -1 fill 0;         ellipse 371.7 443.7 380.3 452.3 color -1;        terminals         input 376 448 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Splitter7 560 464       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [5,1];         signal knot in input [5,1];       end;       icon bg ellipse        figures         ellipse 556.8 460.8 563.2 467.2 color -1 fill 0;         ellipse 555.7 459.7 564.3 468.3 color -1;        terminals         input 560 464 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;     end;     connections      JointInitialStateOffset\output -> Splitter4\input;      EnergyEncoding\outputMessage -> output_energy;      Splitter7\output -> PassivityLayer\sensor;      joints_angle -> Splitter1\input;      Splitter7\output -> JointInitialStateOffset\input;      PassivityLayer\input_energy <- EnergyEncoding\inputEnergy;      PlusMinus2\plus <- PlusMinus3\output;      JointSoftLimits\output -> PlusMinus2\plus;      input_energy -> EnergyEncoding\inputMessage;      active_joint -> JointSpaceController\active_joint;      joints_torque -> PlusMinus3\plus;      PassivityLayer\adjusted_force -> PlusMinus1\plus;      Splitter6\output -> JointSpaceController\angles_measured;      PlusMinus3\plus <- JointSpaceController\torque_cmd;      PassivityLayer\output_energy -> EnergyEncoding\outputEnergy;      GravityCompensationModel\joints -> PlusMinus1\plus;      angles_setpoint -> JointSpaceController\angles_setpoint;      Splitter1\output -> Splitter7\input;      PassivityLayer\EnergyTank -> EnergyTank;      PlusMinus1\output -> Arm_torque;      JointInitialStateOffset1\output -> GravityCompensationModel\jointPos;      Splitter1\output -> JointInitialStateOffset1\input;      Splitter4\output -> Splitter6\input 376 464;      Splitter4\output -> JointSoftLimits\error;      PlusMinus2\output -> PassivityLayer\force;      Splitter6\output -> joints_angle_output;     end;     figures      rectangle 280 280 776 488 fill 15658671;    implementation_end;   BaseJointActive 704 760    description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Sources\Constant.emx</LibraryPath> <TimeStamp>2007-10-19 14:48:44</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Constant     ports      signal out output [3,1];    end;    icon bg left     figures      rectangle 688.1 744 719.9 776 fill 15132390;      line 692.9 755.6 714.9 755.6 color 16711680 width 2;      line 690.2 766.7 715.9 766.7;      line 692.5 750.7 692.5 769;    end;    implementation eqparameters	real C[3] = 1;//[0;0;0];	// output valueequations	output = C;     implementation_end;   BasePoseController 1328 610    description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Submodel     ports      signal in H_base_0 [4,4];      signal in W_base_00 [6,1];      signal in Base_wheels_angle [4,1];      signal in H_vp_0 [4,4];      signal in active_joint [3,1];      signal out H_base_0_output [4,4];      signal out T_base_00 [6,1];      signal out Base_torque [4,1];      signal in input_energy [2,1];      signal out output_energy [2,1];      signal out EnergyTank;    end;    icon bg     figures      rectangle 1264 554 1392 666 fill 14013909;      text 'name' 1328 610 16;     terminals      H_base_0 1360 666 fixed;      W_base_00 1264 634 fixed;      Base_wheels_angle 1392 634 fixed;      H_vp_0 1320 666 fixed;      active_joint 1288 666 fixed;      H_base_0_output 1264 586 fixed;      T_base_00 1384 666 fixed;      Base_torque 1392 586 fixed;    end;    implementation bg     submodels      BasePositionController 680 504       description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in H_vp_0 [4,4];         signal in H_base_0 [4,4];         signal out W_base_base0 [6,1];         signal in active_joint [3,1];       end;       icon bg        figures         rectangle 643 482 717 526 fill 14013909;         text 'Controller' 680 504 15;       end;       implementation bg        submodels         dHToErrors 240 104          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in H_vp_0 [4,4];            signal in H_base_0 [4,4];            signal out angle_error;            signal out x_error;            signal out y_error;          end;          implementation eqvariables	real H_vp_base[4,4];	real aldo;// temporal variable to resolve numerical round up errors	real theta;// angle of rotation	real norm_omega[3]; //normolized vector of rotation	real omega[3]; //vector of rotationcode	// compute realtive pose	H_vp_base=inverseH(H_vp_0)*H_base_0;	aldo =(trace(H_vp_base[1:3,1:3])-1)/2;	// numerical errors resolution	if (aldo < -1) then aldo = -1; end;	if (aldo > 1) then aldo = 1; end;	theta= arccos(aldo);	if (theta==0) then 		norm_omega=0;	else		norm_omega = (1/(2*sin(theta)))*[	H_vp_base[3,2] - H_vp_base[2,3];											H_vp_base[1,3] - H_vp_base[3,1];											H_vp_base[2,1] - H_vp_base[1,2]];	end;	omega=theta*norm_omega;		x_error=-H_vp_base[1,4];	y_error=-H_vp_base[2,4];	angle_error=-omega[3];implementation_end;         ErrorsToW 504 104          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in torque_z;            signal in force_x;            signal in force_y;            signal out W_base_base0 [6,1];          end;          implementation eqequations	W_base_base0=[0;0;torque_z;force_x;force_y;0];implementation_end;         plug H_vp_0 120 104;         plug H_base_0 240 32;         plug W_base_base0 656 104;         plug active_joint 576 40;         PD_BaseAngle 376 40          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Control\PID Control\Discrete\PD.emx</LibraryPath> <TimeStamp>2007-9-27 14:50:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type PD           ports            signal in error;            signal out output;          end;          icon bg bottom           figures            rectangle 360 24 392 56 fill 15132390;            text 'PD' 376 39.5 color 1336868 18 bold;          end;          implementation eqparameters	real kp = 100.0 {};			// Proportional gain	real tauD = 1.0 {s};		// Derivative time constant: tauD > 0	real beta = 0.1 {};		// Tameness constant: 0 < beta << 1variables	real hidden factor,uD;equations	factor = 1 / ( sampletime + tauD * beta );	uD = factor * ( tauD * previous ( uD ) * beta + tauD * kp * ( error - previous ( error )) + sampletime * kp * error );	output = uD;implementation_end;         PD_BaseX 376 104          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Control\PID Control\Discrete\PD.emx</LibraryPath> <TimeStamp>2007-9-27 14:50:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type PD           ports            signal in error;            signal out output;          end;          icon bg bottom           figures            rectangle 360 88 392 120 fill 15132390;            text 'PD' 376 103.5 color 1336868 18 bold;          end;          implementation eqparameters	real kp = 300.0 {};			// Proportional gain	real tauD = 1.0 {s};		// Derivative time constant: tauD > 0	real beta = 0.1 {};		// Tameness constant: 0 < beta << 1variables	real hidden factor,uD;equations	factor = 1 / ( sampletime + tauD * beta );	uD = factor * ( tauD * previous ( uD ) * beta + tauD * kp * ( error - previous ( error )) + sampletime * kp * error );	output = uD;implementation_end;         PD_BaseY 376 160          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Control\PID Control\Discrete\PD.emx</LibraryPath> <TimeStamp>2007-9-27 14:50:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type PD           ports            signal in error;            signal out output;          end;          icon bg bottom           figures            rectangle 360 144 392 176 fill 15132390;            text 'PD' 376 159.5 color 1336868 18 bold;          end;          implementation eqparameters	real kp = 300.0 {};			// Proportional gain	real tauD = 1.0 {s};		// Derivative time constant: tauD > 0	real beta = 0.1 {};		// Tameness constant: 0 < beta << 1variables	real hidden factor,uD;equations	factor = 1 / ( sampletime + tauD * beta );	uD = factor * ( tauD * previous ( uD ) * beta + tauD * kp * ( error - previous ( error )) + sampletime * kp * error );	output = uD;implementation_end;         Submodel3 576 104          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in input [6,1];            signal in active [3,1];            signal out cmd [6,1];          end;          icon bg           figures            rectangle 571 97 581 111 fill 14013909;          end;          implementation eqvariables	real aldo[6];equations	aldo=[1;1;active[1];active[2];active[3];1];	cmd=diag(abs(sign(aldo)))*input;implementation_end;        end;        connections         dHToErrors\angle_error -> PD_BaseAngle\error;         H_base_0 -> dHToErrors\H_base_0;         Submodel3\cmd -> W_base_base0;         ErrorsToW\W_base_base0 -> Submodel3\input;         active_joint -> Submodel3\active;         dHToErrors\x_error -> PD_BaseX\error;         dHToErrors\y_error -> PD_BaseY\error;         PD_BaseY\output -> ErrorsToW\force_y;         PD_BaseAngle\output -> ErrorsToW\torque_z;         PD_BaseX\output -> ErrorsToW\force_x;         H_vp_0 -> dHToErrors\H_vp_0;        end;       implementation_end;      BaseTF 816 448       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in Base_joint_velocity [4,1];         signal out Twist [6,1];         signal in H_base_0 [4,4];         signal out Virtual_joint_states [3,1];         signal in W_base_base0 [6,1];         signal out Base_torque [4,1];       end;       icon bg        figures         rectangle 779 426 853 470 fill 14013909;         text 'name' 816 448 16;        terminals         Base_joint_velocity 840 472 fixed;         Twist 816 472 fixed;         H_base_0 792 472 fixed;         W_base_base0 776 448 fixed;       end;       implementation eqparameters	real r = 0.0475; //radius of the wheels	real x = 0.235;  // lateral distance from center of mass to wheel contact point	real y = 0.15;   // longitudinal  distance from center of mass to wheel contact pointvariables	real A[3,4];	real PseudoInverseA[4,3];	real virtual_velocities[3];//	real W_base_base0[6]; initialequations	Twist=0;	Virtual_joint_states=0;	Base_torque=0;code	// Relation between motor torques and linear velicites of the base	A=(1/(r))*	[ 	x+y 	,x+y	,x+y	,x+y;		-1		, 1	,-1	, 1;		1		, 1	,-1	,- 1];	//find inverse relation 	PseudoInverseA = transpose(A)*inverse(A*transpose(A));	//twist must be in coordinate frame of the base	//W_base_base0=transpose(Adjoint(H_base_0))*W_base_00;	Base_torque=PseudoInverseA*W_base_base0[3:5];	//By power continuetly relation for vlocities as follows	virtual_velocities=transpose(PseudoInverseA)*Base_joint_velocity; 	// the integration is made time step independent usinf finite twist 	Twist=[0; 0; virtual_velocities[1]; virtual_velocities[2]; virtual_velocities[3]; 0];	// decompose into virtual joints	Virtual_joint_states[1]=atan2(H_base_0[2,1],H_base_0[1,1]);	Virtual_joint_states[2]=H_base_0[1,4];	Virtual_joint_states[3]=H_base_0[2,4];	/* controllerH_{base}^{pose}=H_{base}^{0}*H_{0}^{pose} \\H_{base^{-1}}^{pose^{-1}}=H_{base^{-1}}^{0}*H_{0}^{pose^{-1}} \\W_{base}^{base,pose}=K_{p}*Ad_{pose}^{0}*log^{\vee}(H_{base}^{pose})+K_{d}*Ad_{pose^{-1}}^{0}*log^{\vee}(H_{base^{-1}}^{pose^{-1}})*/implementation_end;      DiscreteDifferential 880 512       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Discrete\DiscreteDifferential.emx</LibraryPath>  <TimeStamp>2007-9-27 15:21:20</TimeStamp></Description>';       type DiscreteDifferential        ports         signal in input [4,1];         signal out output [4,1];       end;       icon bg        figures         rectangle 864 494.9 896 527.5 fill 15132390;         text '-1' 889.3 517.2 color 16711680 fill 15132390 10;         text 'z' 882.7 521 color 16711680 13;         group          text 'd' 874.2 503.9 color 16711680 14;          text 'dt' 874.2 517 color 16711680 14;          line 868.2 510.5 879 510.5 color 16711680;         end;       end;       implementation eqparameters	real initial = 0.0;  	// initial output valuevariables	real hidden initial_input[4];	boolean hidden initialized;initialequations	initialized = false;equations	if not initialized then 		initial_input = initial - input/sampletime; 		initialized = true;	else		initial_input = 0;	end;	output = (input - previous (input))/sampletime + initial_input;implementation_end;      EnergyEncoding 1032 368       description '<Description>   <Version>4.1</Version>  <LibraryPath>EnergyEncodingR.emx</LibraryPath>  <TimeStamp>2012-10-30 18:54:40</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in inputMessage [2,1];         signal out inputEnergy;         signal out outputMessage [2,1];         signal in outputEnergy;       end;       icon bg        figures         rectangle 976 344 1088 392 fill 14013909;         text 'name' 1032 368 16;        terminals         inputMessage 1000 344 fixed;         inputEnergy 1000 392 fixed;         outputMessage 1064 344 fixed;         outputEnergy 1064 392 fixed;       end;       implementation eqparameters	real roundUp= 1000;	real MaxCounter=100;variables	real inputCount; // required to implement 'to zero' behaviour on input	real inputSum;	  // implements current state of all inputs by integraing all inputs 	real inputDiff;  // current  arrived message	real outputCount; // required to implement 'to zero' behaviour on output	real outputSum;	  // implements current state of all output by integraing all outputs 	real outputDiff;  // current  sent messageinitialequations	inputSum=0;	// initialize the input sum 	outputSum=0; 	// initialize the output sum code   // Compuation of incoming messages		//check if arrived message is less then  current input sum	if (inputMessage[1]+0.1*roundUp)<inputSum then		//if yes the input message was rounded up, thus roundup should be added to compute the increment properly		inputDiff=roundUp+inputMessage[1]-inputSum;	else		// if no the increment can be computed as simple difference		inputDiff=inputMessage[1]-inputSum;	end;	// This was a tested code; but I don't know the purose	//if inputMessage[1]==0 then	//	inputDiff=0;	//end;		// do round up and integrate	inputSum=(inputSum+inputDiff) mod roundUp;	inputEnergy=inputDiff;	 // Compuation of outgoing messages	outputCount=(previous(outputCount)+1) mod MaxCounter;	outputSum=(outputSum+outputEnergy) mod roundUp;	outputMessage[1]=outputSum;	outputMessage[2]=outputCount;implementation_end;      FilterBaseJointVelocities1 968 512       description '<Description>   <Version>4.1</Version>  <LibraryPath>BWFilterDigital.emx</LibraryPath>  <TimeStamp>2012-6-20 16:15:49</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in input [4,1];         signal out output [4,1];       end;       icon bg bottom        figures         rectangle 939.7 504.5 996.2 519.5 fill 14013909;       end;       implementation eqparameters// Gains for 2nd order low-pass Butterworth filter	real  FilterGain[2,3] = [0.0675, 0.1349, 0.0675; 1.143, -0.4128,0];				// Cut-off frequency 100 Hz   //real  FilterGain[2,3] = [0.0201, 0.0402, 0.0201; 1.561, -0.6414,0]; 		//Cut-off 50 Hz	//real  FilterGain[2,3] = [0.0055, 0.0111, 0.0055; 1.7786, -0.8008,0];			// Cut-off frequency  25 Hz	//real  FilterGain[2,3] = [2.414e-4, 4.827e-4, 2.414e-4; 1.9556, -0.9565,0];	// Cut-off frequency   5 Hz	integer num=4;//number of the inputsvariables	real InputMemory[3,num];	real InputUpdate[3,3];	real State[3,num];	real A[3,3];	real B[3,3];initialequations InputUpdate=[0,0,0;					1,0,0;					0,1,0]; //downshift InputMemory=0; State=0; A[1,:]=FilterGain[2,:]; A[2:3,:]=[1,0,0;			  0,1,0]; B[1,:] =FilterGain[1,:]; B[2:3,:]=0;code	InputMemory=InputUpdate*InputMemory+[1;0;0]*transpose(input);	State=A*State+B*InputMemory;	output=transpose([1,0,0]*State);		implementation_end;      plug active_joint 544 488;      plug H_base_0_output 456 600;      plug T_base_00 816 648;      plug input_energy 992 304;      plug output_energy 1072 304;      plug EnergyTank 1128 392;      plug H_vp_0 544 520;      plug Base_wheels_angle 1144 512;      plug W_base_00 487 448;      plug Base_torque 1144 448;      plug H_base_0 792 656;      PassivityLayer 1040 448       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in force [4,1];         signal in sensor [4,1];         signal out adjusted_force [4,1];         signal in input_energy;         signal out output_energy;         signal out EnergyTank;       end;       icon bg        figures         rectangle 992 425 1088 471 fill 14013909;         text 'name' 1040 447 16;       end;       implementation bg        submodels         EnergyTankBlock 496 376          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal out energyState;            signal in energyQuanta;          end;          implementation eqparameters	real InitialEnergyState =10{J};variables	real EnergyState;initialequations	EnergyState=InitialEnergyState;code	EnergyState=EnergyState+energyQuanta;	energyState=EnergyState;implementation_end;         EnergyTankControl 392 208          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in controlForce [4,1];            signal out adjustedForce [4,1];            signal in energyState;            signal in sensorValue [4,1];          end;          implementation eq/*  Tank level controller via dumping injection*/parameters	integer hidden n=4; //actuator array size needed for block reuse , only need to alter size of the inputs and this number	real DumpingInjectionTreshold = 5{J};  //minimal enrgy level to activet dumpling injection	real RecoveryMultiplier[n] = 10 {s/m^2};	 //variable friction co efficnet  based on energy level	real MaxmimDampingConstant[n] = 0.01{N/t}; 	//maxmum dumping injection  force it is sampletime dependent !!!	boolean TCLactive=false;variables	real DumpingInjectionForce[n];//recovery torque	real dSensorValue[n];	real SensorSpeed[n];	real MaxmimDumping[n];	real energyStateError;	integer hidden i; // counterinitialequations	adjustedForce=0;code	// Compute speed  for damping injection ( it is possible to use more fancy ways of doing it)	dSensorValue=sensorValue-previous(sensorValue);	SensorSpeed=dSensorValue/sampletime;	// Based on the second order mass model maximum energy extartion occures if F_{damp}=\frac{m_{obj}* \dot x}{\Delta T}	// if F_{damp}>2\frac{m_{obj}* \dot x}{\Delta T} then damping injection fails  thus it is required to estimate the inertia parameters of the system 	// in here a simple limit is implementted to prevent active behaviour if sampletime has been increesed	MaxmimDumping=MaxmimDampingConstant/(sampletime);	// compute recovery mulpler	energyStateError=DumpingInjectionTreshold-energyState;	if energyStateError<=0 then		DumpingInjectionForce=0;	else		DumpingInjectionForce=-diag(RecoveryMultiplier)*energyStateError*SensorSpeed;	end;	//avoiding bug in limit computation during code generaion in 20-sim version 4.1.4.1	for i=1 to n do		DumpingInjectionForce[i]=limit(DumpingInjectionForce[i],-MaxmimDumping[i],MaxmimDumping[i]);	end;	if TCLactive then		adjustedForce=controlForce +DumpingInjectionForce;	else		adjustedForce=controlForce;	end;implementation_end;         plug force 48 208;         plug sensor 832 416;         plug adjusted_force 840 208;         plug input_energy 440 256;         plug output_energy 544 256;         plug EnergyTank 432 400;         PassiveSampling 664 376          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in adjustedForce [4,1];            signal in sensorValue [4,1];            signal out energyQuanta;          end;          implementation eq/*  	Passive sampling based on the Franken  Control of haptic interaction*/parameters	 integer hidden n=4; //actuator array size needed for block reuse , only need to alter size of the inputs and this numbervariables	real dSensorValue[n];code	// following compute energy exchange between sampe times is force is held constant over time sample period	// \Delta x=\int{\dot x}= x(k)-x(k-1)	dSensorValue=sensorValue-previous(sensorValue);	//\Delta H= - {\Delta x}^{T} F 	energyQuanta=-transpose(adjustedForce)*dSensorValue;implementation_end;         PassiveZOH 264 208          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in controlForce [4,1];            signal out adjustedForce [4,1];            signal in energyState;            signal in sensorValue [4,1];          end;          implementation eq/* nD Passive Zero Order Hold	it prevent system from using more energy then available	- Saturation functions			-maximum kinetic energy extracted in next time step			-maximum potentional energy state based on linear spring			-maximum of device outputThe optimization method blow work olny with in Phase 2 barier method thus for any energy level belowin the controller below kinetic energy zero forces will be provided*/parameters	integer hidden n=4; //actuator array size needed for block reuse , only need to alter size of the inputs and this number	real SpringConstant[n] = 1;//[10.0;10.0;10.0;10.0;10.0] {N/m}; 		 // Spring Constant to determine maximum torque base of linear spring staturation function  //the number is arbitary. it will affect system performance in serach of energietic minimum. 	real MaximumActuatorForce[n]=10 {N};		 // Force saturation value based on actuator physical limit	boolean PassivityLayerActive= true;	real MassConstant[n]=1;	real eps =1e-4; //presision of opimization value does not affet the passivity since any torques in the feasble set are passive	real betaLine =0.5; // line search decerement	real betaBarrier1=1.5; //barrier standart increment	real betaBarrier2=5; // barrier exception incerement	integer maxNumIter=1000;//upperbound on the allowed search iterations	real Channelweights[n]=1; //actuation imporantce deterimnes which actuation channel is more importantvariables	real dSensorValue[n];	real SensorSpeed[n];	real ForceSaturationArray[n,3]; //	1.device output,2.Optimized energy barrier,3.desired force	real SaturatedForce[n];	real i;//counter	real aldo; //temporal compuation // optimization variables	real xd[n];real A[n,n];	real B1[n,n];	real B2[n,n];	real B3[n,n];	real a[n];	real b;	real xcl[n];	real dx[n];	real dObjective[n];	real HObjective[n,n];	real lamda2;	real t;	integer numIter;	//line search tempoerals	real obj;	real objAldo;	real xAldo[n];	real stepSize;initialequations	adjustedForce=0;	//energy barrrier parameters	A=diag(Channelweights);	// following computes the parameters of energy barrier	// F'*(dT^2*inv(M') +inv(K'))*F+dT*(F'*inv(M')*M*dx+dx'*F)+dx'*M*dx -2*H<0	B1=sampletime^2*inverse(	diag(MassConstant))+inverse(	diag(SpringConstant));	//dT*(F'*inv(M')*M*dx+dx'*F) simpifing eye~ transpose(inverse(MassConstant))*MassConstantsince it is symertical	B2=2*sampletime*eye(n);	B3=diag(MassConstant);	numIter=0;	aldo=0;code	//Fill in Force staturation Array 	ForceSaturationArray[:,1]=MaximumActuatorForce;		// Compute maximum alowed energy exchange	dSensorValue=sensorValue-previous(sensorValue);	SensorSpeed=dSensorValue/sampletime;	//energy berrier initial states	b=2*energyState;	a=SensorSpeed;	xd=controlForce;			numIter=0;	if b>0 and b-transpose(a)*B3*a>0 then		// there is enough energy to do control		//warning(' there is enough energy to do control',false);		xcl=controlForce;		numIter=0;		if  (b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a<0) then			warning(' there is enough energy to do control3',true);			// there is enough energy to do control as required following will commute the minimum effect alteration of control torques			xcl=0; // zero is strictly feaseble since b-transpose(a)*B3*a>0			lamda2=1; //temporal value for prescision calcuation			numIter=0; // tracking upper bound			lamda2=1;			t=1;			while (sqrt(lamda2)/t>eps and numIter<maxNumIter)  do// stop condition   		 	numIter=numIter+1;// count number of iterations     			t=t*betaBarrier1; // constrain relaxation process				dObjective=t*(A+transpose(A))*(xd-xcl)-1/(b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a)*(-(B1+transpose(B1))*xcl-B2*a); 				HObjective=-t*(A+transpose(A))-1/(b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a)^2*(-(B1+transpose(B1))*xcl-B2*a)*transpose(-(B1+transpose(B1))*xcl-B2*a)-1/(b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a)*(B1+transpose(B1)); 				dx=-inverse(HObjective)*dObjective;				lamda2=abs(transpose(dObjective)*dx);				// line search				obj=t*transpose(xd-xcl)*A*(xd-xcl)-log(b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a);     			stepSize=1;     			objAldo=obj;     			xAldo=xcl;     			while (obj<=objAldo and stepSize>eps^3) do         		stepSize=betaLine*stepSize;         		xAldo=xcl+dx*stepSize;         		if (b-transpose(xAldo)*(B1)*xAldo-transpose(a)*B2*xAldo-transpose(a)*B3*a>0) then             		objAldo=t*transpose(xd-xAldo)*A*(xd-xAldo)-log(b-transpose(xAldo)*(B1)*xAldo-transpose(a)*B2*xAldo-transpose(a)*B3*a);         		end;					if (stepSize<eps^3) then             		warning('had to intreupt',true);            		t=t*betaBarrier2;             		xAldo=xcl;         		end;     			end;     			// x update     			xcl=xAldo;			end;		else			// there is enough energy to do control as required			//warning(' there is enough energy to do control2',false);			xcl=controlForce;		end;	else		// there is not enough energy to do control		xcl=0;	end;	ForceSaturationArray[:,2]=xcl;	ForceSaturationArray[:,3]=controlForce;	for i =1 to n do		SaturatedForce[i]=sign(controlForce[i])*min(abs(ForceSaturationArray[i,:]));	end;	if PassivityLayerActive then		adjustedForce=SaturatedForce;	else		adjustedForce=controlForce;	end;implementation_end;         PlusMinus1 576 376          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>  <TimeStamp>2007-9-27 10:15:13</TimeStamp></Description>';          knot PlusMinus           ports            signal knot duplicatable in plus [1];            signal knot duplicatable in minus [1];            signal knot out output [1];          end;          icon bg ellipse           figures            ellipse 568 368 584 384 fill 16777215;          end;          implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;         SETP 496 312          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in energyState;            signal out energyQuanta;            signal out outputPackage;            signal in inputPackage;          end;          implementation eqparameters	real CommunicationTreshold=10 {J};	real SendoutPercent=0.01; //10%initialequations	outputPackage=0;	energyQuanta=0;codeif CommunicationTreshold>energyState then	outputPackage=0;	energyQuanta=inputPackage;else	outputPackage=-(CommunicationTreshold-energyState)*SendoutPercent;	energyQuanta=inputPackage-outputPackage;end;implementation_end;         Splitter1 392 376          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [1];            signal knot in input [1];          end;          icon bg ellipse           figures            ellipse 388.8 372.8 395.2 379.2 color -1 fill 0;            ellipse 387.7 371.7 396.3 380.3 color -1;           terminals            input 392 376 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;         Splitter2 664 416          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [4,1];            signal knot in input [4,1];          end;          icon bg ellipse           figures            ellipse 660.8 412.8 667.2 419.2 color -1 fill 0;            ellipse 659.7 411.7 668.3 420.3 color -1;           terminals            input 664 416 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;         Splitter3 664 208          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [4,1];            signal knot in input [4,1];          end;          icon bg ellipse           figures            ellipse 660.8 204.8 667.2 211.2 color -1 fill 0;            ellipse 659.7 203.7 668.3 212.3 color -1;           terminals            input 664 208 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;         Splitter4 392 416          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [4,1];            signal knot in input [4,1];          end;          icon bg ellipse           figures            ellipse 388.8 412.8 395.2 419.2 color -1 fill 0;            ellipse 387.7 411.7 396.3 420.3 color -1;           terminals            input 392 416 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;         Splitter5 432 376          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [1];            signal knot in input [1];          end;          icon bg ellipse           figures            ellipse 428.8 372.8 435.2 379.2 color -1 fill 0;            ellipse 427.7 371.7 436.3 380.3 color -1;           terminals            input 432 376 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;        end;        connections         sensor -> Splitter2\input;         Splitter4\output -> PassiveZOH\sensorValue 264 416;         Splitter5\output -> SETP\energyState 432 312;         EnergyTankControl\adjustedForce -> Splitter3\input;         SETP\energyQuanta -> PlusMinus1\plus 576 312;         output_energy <- SETP\outputPackage 544 288;         force -> PassiveZOH\controlForce;         Splitter1\output -> PassiveZOH\energyState 264 376;         Splitter2\output -> PassiveSampling\sensorValue;         Splitter2\output -> Splitter4\input;         Splitter3\output -> adjusted_force;         EnergyTankBlock\energyState -> Splitter5\input;         Splitter3\output -> PassiveSampling\adjustedForce;         SETP\inputPackage <- input_energy 440 288;         PlusMinus1\output -> EnergyTankBlock\energyQuanta;         Splitter4\output -> EnergyTankControl\sensorValue;         PassiveZOH\adjustedForce -> EnergyTankControl\controlForce;         Splitter1\output -> EnergyTankControl\energyState;         PassiveSampling\energyQuanta -> PlusMinus1\plus;         Splitter5\output -> Splitter1\input;         Splitter5\output -> EnergyTank;        end;       implementation_end;      PlusMinus4 680 448       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>  <TimeStamp>2007-9-27 10:15:13</TimeStamp></Description>';       knot PlusMinus        ports         signal knot duplicatable in plus [6,1];         signal knot duplicatable in minus [6,1];         signal knot out output [6,1];       end;       icon bg ellipse        figures         ellipse 672 440 688 456 fill 16777215;       end;       implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;      Splitter3 1040 512       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [4,1];         signal knot in input [4,1];       end;       icon bg ellipse        figures         ellipse 1036.8 508.8 1043.2 515.2 color -1 fill 0;         ellipse 1035.7 507.7 1044.3 516.3 color -1;        terminals         input 1040 512 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Splitter5 792 600       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [4,4];         signal knot in input [4,4];       end;       icon bg ellipse        figures         ellipse 788.8 596.8 795.2 603.2 color -1 fill 0;         ellipse 787.7 595.7 796.3 604.3 color -1;        terminals         input 792 600 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Splitter7 680 600       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [4,4];         signal knot in input [4,4];       end;       icon bg ellipse        figures         ellipse 676.8 596.8 683.2 603.2 color -1 fill 0;         ellipse 675.7 595.7 684.3 604.3 color -1;        terminals         input 680 600 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;     end;     connections      Splitter7\output -> BasePositionController\H_base_0;      Splitter7\output -> H_base_0_output;      W_base_00 -> PlusMinus4\plus;      DiscreteDifferential\output -> BaseTF\Base_joint_velocity;      H_base_0 -> Splitter5\input;      PassivityLayer\adjusted_force -> Base_torque;      EnergyEncoding\inputEnergy -> PassivityLayer\input_energy;      Splitter3\output -> PassivityLayer\sensor;      Splitter3\output -> FilterBaseJointVelocities1\input;      Splitter5\output -> Splitter7\input;      input_energy -> EnergyEncoding\inputMessage;      PassivityLayer\output_energy -> EnergyEncoding\outputEnergy;      output_energy <- EnergyEncoding\outputMessage;      BaseTF\Twist -> T_base_00;      active_joint -> BasePositionController\active_joint;      Base_wheels_angle -> Splitter3\input;      PassivityLayer\EnergyTank -> EnergyTank;      H_vp_0 -> BasePositionController\H_vp_0;      BaseTF\Base_torque -> PassivityLayer\force;      BasePositionController\W_base_base0 -> PlusMinus4\plus;      FilterBaseJointVelocities1\output -> DiscreteDifferential\input;      PlusMinus4\output -> BaseTF\W_base_base0;      Splitter5\output -> BaseTF\H_base_0;     end;     figures      rectangle 616 408 1120 640 fill 15658671;    implementation_end;   CartesianController 896 546    description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Submodel     ports      signal in T_tooltip_00 [6,1];      signal in Hvp0 [4,4];      signal in Htip0 [4,4];      signal in StiffnessCC [9,1];      signal in HtipCC [4,4];      signal out W_tooltip_00 [6,1];      signal in CartesianDamping [6,1];    end;    icon bg bottom     figures      rectangle 832 514.5 960 577.5 fill 14013909;      text 'name' 896 546.5 16;     terminals      T_tooltip_00 960 554 fixed;      Hvp0 832 546 fixed;      Htip0 960 570 fixed;      StiffnessCC 832 522 fixed;      HtipCC 832 570 fixed;      W_tooltip_00 960 530 fixed;    end;    implementation bg     submodels      CartesianSpaceStiffness 328 360       description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>CartesianSpaceStiffness.emx</LibraryPath> <TimeStamp>2012-6-20 15:50:10</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type P        ports         signal out effort [6,1];         signal in Hvp0 [4,4];         signal in Htip0 [4,4];         signal in cart_stiffness [9,1];         signal in HtipCC [4,4];       end;       icon bg bottom        figures         rectangle 296 328 360 392 fill 15132390;         text 'CartesianSpace Stiffness' 328 362 color 16711680 15;        terminals         effort 360 344 fixed;         Hvp0 296 360 fixed;         Htip0 360 384 fixed;         cart_stiffness 296 344 fixed;         HtipCC 296 376 fixed;       end;       implementation eqvariables	real Kt[3];	real Kr[3];	real Kc[3];	real Kcc[ 6, 6 ];	real Ktip[6,6];	real H1_0[4,4];	real costiffness1[ 3, 3 ], costiffness2[ 3, 3 ], costiffness3[ 3, 3 ],		dummy1[ 3, 3 ], dummy2[ 3, 3 ], dummy3[ 3, 3 ], dummy4[ 3, 3 ], dummy5[ 3, 3 ],		pose21[ 4, 4 ], skew21[ 3, 3 ], orientation21[ 3, 3 ];initialequations	effort=0;equations	Kt = cart_stiffness[1:3];	Kr = cart_stiffness[4:6];	Kc = cart_stiffness[7:9];	H1_0 =(inverseH(Hvp0*HtipCC)*Htip0*HtipCC);// inverseH(Htip0)*Hvp0_temp;// =H0tip*Hvp0 int (H_dot1_0, H1_0_initial);	Kcc[1:3,1:3] = diag(Kr);	Kcc[1:3,4:6] = diag(Kc);	Kcc[4:6,1:3] = transpose(diag(Kc)); // is it correct of it should be negative	Kcc[4:6,4:6] = diag(Kt); 	Ktip=	Kcc;// doesn't work (transpose(Adjoint(HtipCC))*Kcc*(Adjoint((HtipCC))));//latex noation K_{tip}=(Ad_{H^{tip}_{cc}})^{T}*K_{cc}*Ad_{H^{tip}_{cc}}	dummy1 = Ktip[ 1 : 3, 1 : 3 ];	dummy2 = Ktip[ 1 : 3, 4 : 6 ];	dummy3 = Ktip[ 4 : 6, 4 : 6 ];	costiffness1 = 0.5 * trace( dummy1 ) * eye( 3 ) - dummy1;	costiffness2 = 0.5 * trace( dummy2 ) * eye( 3 ) - dummy2;	costiffness3 = 0.5 * trace( dummy3 ) * eye( 3 ) - dummy3;	"create T_tilde from the twist T1_00 of body 1 in coordinates of body 0 with respect to body 0"//	T1_00 = tilde (p.f);		"create the H_dot matrix for calculation of the transformation matrix H from body 1 to body 0"//	H_dot1_0 = T1_00 * H1_0;		pose21 = H1_0;	skew21 = skew( pose21[ 1 : 3, 4 ] );	orientation21 = pose21[ 1 : 3, 1 : 3 ];	dummy4 = 2 * antisym( costiffness1 * orientation21 ) + antisym( costiffness3 * transpose( orientation21 ) * skew21 * skew21 * orientation21 ) + 2 * antisym( costiffness2 * skew21 * orientation21 );	dummy5 = transpose( orientation21 ) * antisym( costiffness3 * skew21 ) * orientation21 + antisym( costiffness3 * transpose( orientation21 ) * skew21 * orientation21 ) + 2 * antisym( costiffness2 * orientation21 );	effort= -transpose(Adjoint(inverseH(Htip0*HtipCC)))* [ dummy4[ 3, 2 ]; dummy4[ 1, 3 ]; dummy4[ 2, 1 ]; dummy5[ 3, 2 ]; dummy5[ 1, 3 ]; dummy5[ 2, 1 ] ];implementation_end;      Damping 392 272       description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath> <TimeStamp>2007-9-26 12:15:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Gain        ports         signal in input [6,1];         signal out output [6,1];         signal in Damping [6,1];       end;       icon bg bottom        figures         rectangle 376.1 256 407.9 288 fill 15132390;         text 'K' 392 272 color 16711680 16 bold;       end;       implementation eqparameters	real K = 0;		// gainequations	output = diag(Damping) * input;    implementation_end;      Delay 192 200       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Discrete\Delay.emx</LibraryPath>  <TimeStamp>2007-9-27 15:17:3</TimeStamp></Description>';       type Delay        ports         signal in input [4,4];         signal out output [4,4];       end;       icon bg bottom        figures         rectangle 176 184 208 216 fill 15132390;         text 'Z' 190.7 200 color 16711680 14 bold;         text '-1' 198.4 193 color 16711680 10 bold;       end;       implementation eqequations	output = previous (input);   implementation_end;      dHToErrors1 288 200       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in H_vp_0 [4,4];         signal in H_base_0 [4,4];         signal out Twist [6,1];       end;       implementation eqvariables	real H_vp_base[4,4];	real aldo;// temporal variable to resolve numerical round up errors	real theta;// angle of rotation	real norm_omega[3]; //normolized vector of rotation	real omega[3]; //vector of rotationcode	// compute realtive pose	H_vp_base=inverseH(H_vp_0)*H_base_0;	aldo =(trace(H_vp_base[1:3,1:3])-1)/2;	// numerical errors resolution	if (aldo < -1) then aldo = -1; end;	if (aldo > 1) then aldo = 1; end;	theta= arccos(aldo);	if (theta==0) then 		norm_omega=0;	else		norm_omega = (1/(2*sin(theta)))*[	H_vp_base[3,2] - H_vp_base[2,3];											H_vp_base[1,3] - H_vp_base[3,1];											H_vp_base[2,1] - H_vp_base[1,2]];	end;	omega=theta*norm_omega;		Twist[1:3]=-H_vp_base[1:3,4]/sampletime;	Twist[4:6]=-omega[3]/sampletime;	implementation_end;      plug Hvp0 176.5 360;      plug Htip0 480 384;      plug StiffnessCC 176 344;      plug HtipCC 176 376;      plug W_tooltip_00 592 328;      plug CartesianDamping 496 272;      plug T_tooltip_00 392 160;      PlusMinus2 392 200       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>  <TimeStamp>2007-9-27 10:15:13</TimeStamp></Description>';       knot PlusMinus        ports         signal knot duplicatable in plus [6,1];         signal knot duplicatable in minus [6,1];         signal knot out output [6,1];       end;       icon bg ellipse        figures         ellipse 384 192 400 208 fill 16777215;       end;       implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;      PlusMinus5 392 328       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>  <TimeStamp>2007-9-27 10:15:13</TimeStamp></Description>';       knot PlusMinus        ports         signal knot duplicatable in plus [6,1];         signal knot duplicatable in minus [6,1];         signal knot out output [6,1];       end;       icon bg ellipse        figures         ellipse 384 320 400 336 fill 16777215;       end;       implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;      Splitter1 248 360       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [4,4];         signal knot in input [4,4];       end;       icon bg ellipse        figures         ellipse 244.8 356.8 251.2 363.2 color -1 fill 0;         ellipse 243.7 355.7 252.3 364.3 color -1;        terminals         input 248 360 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;     end;     connections      Damping\output -> PlusMinus5\minus;      Delay\output -> dHToErrors1\H_base_0;      Splitter1\output -> dHToErrors1\H_vp_0;      PlusMinus2\output -> Damping\input;      dHToErrors1\Twist -> PlusMinus2\minus;      CartesianSpaceStiffness\effort -> PlusMinus5\plus;      CartesianDamping -> Damping\Damping;      T_tooltip_00 -> PlusMinus2\plus;      Hvp0 -> Splitter1\input;      Htip0 -> CartesianSpaceStiffness\Htip0;      StiffnessCC -> CartesianSpaceStiffness\cart_stiffness;      HtipCC -> CartesianSpaceStiffness\HtipCC;      PlusMinus5\output -> W_tooltip_00;      Splitter1\output -> CartesianSpaceStiffness\Hvp0;      Splitter1\output -> Delay\input;     end;    implementation_end;   CartesianDamping 728 472    description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Sources\Constant.emx</LibraryPath> <TimeStamp>2007-10-19 14:48:44</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Constant     ports      signal out output [6,1];    end;    icon bg top     figures      rectangle 712.1 456 743.9 488 fill 15132390;      line 716.9 467.6 738.9 467.6 color 16711680 width 2;      line 714.2 478.7 739.9 478.7;      line 716.5 462.7 716.5 481;    end;    implementation eqparameters	real Kt[3] = [0;0;0];		// output value	real Kr[3] = [0;0;0];		// output valueequations	output[1:3] = Kt;	output[4:6] = Kr;     implementation_end;   CartesianSpaceStiffness2 200 680    description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Sources\Constant.emx</LibraryPath> <TimeStamp>2007-10-19 14:48:44</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Constant     ports      signal out output [9,1];    end;    icon bg     figures      rectangle 184.1 664 215.9 696 fill 15132390;      line 188.9 675.6 210.9 675.6 color 16711680 width 2;      line 186.2 686.7 211.9 686.7;      line 188.5 670.7 188.5 689;    end;    implementation eqparameters	real Kt[3] = [50;50;50];		// output value	real Kr[3] = [0;0;0];		// output value	real Kc[3] = [0;0;0];		// output valueequations	output[1:3] = Kt;	output[4:6] = Kr;	output[7:9] = Kc;     implementation_end;   CartesianStiffnessSetpoint 733 522    description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Sources\Constant.emx</LibraryPath> <TimeStamp>2007-10-19 14:48:44</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Constant     ports      signal out output [9,1];    end;    icon bg top     figures      rectangle 717.1 506 748.9 538 fill 15132390;      line 721.9 517.6 743.9 517.6 color 16711680 width 2;      line 719.2 528.7 744.9 528.7;      line 721.5 512.7 721.5 531;    end;    implementation eqparameters	real Kt[3] = 000;//[0;0;0];		// output value	real Kr[3] = 0;//[0;0;0];		// output value	real Kc[3] = [0;0;0];		// output valueequations	output[1:3] = Kt;	output[4:6] = Kr;	output[7:9] = Kc;     implementation_end;   Constant 1648 672    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Sources\Constant.emx</LibraryPath>  <TimeStamp>2007-10-19 14:48:44</TimeStamp></Description>';    type Constant     ports      signal out output [3,1];    end;    icon bg bottom     figures      rectangle 1632.1 656 1663.9 688 fill 15132390;      line 1636.9 667.6 1658.9 667.6 color 16711680 width 2;      line 1634.2 678.7 1659.9 678.7;      line 1636.5 662.7 1636.5 681;    end;    implementation eqparameters	real C = 1.0;		// output valueequations	output = C;     implementation_end;   Delay1 504 648    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Discrete\Delay.emx</LibraryPath>  <TimeStamp>2007-9-27 15:17:3</TimeStamp></Description>';    type Delay     ports      signal in input [2,1];      signal out output [2,1];    end;    icon bg     figures      rectangle 488 632 520 664 fill 15132390;      text 'Z' 502.7 648 color 16711680 14 bold;      text '-1' 510.4 641 color 16711680 10 bold;    end;    implementation eqequations	output = previous (input);   implementation_end;   Delay10 1192 680    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Discrete\Delay.emx</LibraryPath>  <TimeStamp>2007-9-27 15:17:3</TimeStamp></Description>';    type Delay     ports      signal in input [2,1];      signal out output [2,1];    end;    icon bg     figures      rectangle 1176 664 1208 696 fill 15132390;      text 'Z' 1190.7 680 color 16711680 14 bold;      text '-1' 1198.4 673 color 16711680 10 bold;    end;    implementation eqequations	output = previous (input);   implementation_end;   Delay3 840 664    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Discrete\Delay.emx</LibraryPath>  <TimeStamp>2007-9-27 15:17:3</TimeStamp></Description>';    type Delay     ports      signal in input [2,1];      signal out output [2,1];    end;    icon bg     figures      rectangle 824 648 856 680 fill 15132390;      text 'Z' 838.7 664 color 16711680 14 bold;      text '-1' 846.4 657 color 16711680 10 bold;    end;    implementation eqequations	output = previous (input);   implementation_end;   Delay4 552 592    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Discrete\Delay.emx</LibraryPath>  <TimeStamp>2007-9-27 15:17:3</TimeStamp></Description>';    type Delay     ports      signal in input [4,4];      signal out output [4,4];    end;    icon bg     figures      rectangle 536 576 568 608 fill 15132390;      text 'Z' 550.7 592 color 16711680 14 bold;      text '-1' 558.4 585 color 16711680 10 bold;    end;    implementation eqequations	output = previous (input);   implementation_end;   Delay5 552 552    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Discrete\Delay.emx</LibraryPath>  <TimeStamp>2007-9-27 15:17:3</TimeStamp></Description>';    type Delay     ports      signal in input [4,4];      signal out output [4,4];    end;    icon bg     figures      rectangle 536 536 568 568 fill 15132390;      text 'Z' 550.7 552 color 16711680 14 bold;      text '-1' 558.4 545 color 16711680 10 bold;    end;    implementation eqequations	output = previous (input);   implementation_end;   Delay6 720 624    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Discrete\Delay.emx</LibraryPath>  <TimeStamp>2007-9-27 15:17:3</TimeStamp></Description>';    type Delay     ports      signal in input [2,1];      signal out output [2,1];    end;    icon bg     figures      rectangle 704 608 736 640 fill 15132390;      text 'Z' 718.7 624 color 16711680 14 bold;      text '-1' 726.4 617 color 16711680 10 bold;    end;    implementation eqequations	output = previous (input);   implementation_end;   Delay7 1208 392    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Discrete\Delay.emx</LibraryPath>  <TimeStamp>2007-9-27 15:17:3</TimeStamp></Description>';    type Delay     ports      signal in input [2,1];      signal out output [2,1];    end;    icon bg     figures      rectangle 1192 376 1224 408 fill 15132390;      text 'Z' 1206.7 392 color 16711680 14 bold;      text '-1' 1214.4 385 color 16711680 10 bold;    end;    implementation eqequations	output = previous (input);   implementation_end;   Delay8 1104 368    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Discrete\Delay.emx</LibraryPath>  <TimeStamp>2007-9-27 15:17:3</TimeStamp></Description>';    type Delay     ports      signal in input [2,1];      signal out output [2,1];    end;    icon bg     figures      rectangle 1088 352 1120 384 fill 15132390;      text 'Z' 1102.7 368 color 16711680 14 bold;      text '-1' 1110.4 361 color 16711680 10 bold;    end;    implementation eqequations	output = previous (input);   implementation_end;   Delay9 1104 696    description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Discrete\Delay.emx</LibraryPath>  <TimeStamp>2007-9-27 15:17:3</TimeStamp></Description>';    type Delay     ports      signal in input [2,1];      signal out output [2,1];    end;    icon bg     figures      rectangle 1088 680 1120 712 fill 15132390;      text 'Z' 1102.7 696 color 16711680 14 bold;      text '-1' 1110.4 689 color 16711680 10 bold;    end;    implementation eqequations	output = previous (input);   implementation_end;   EnergyButtonStub 192 744    description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\Constant.emx</LibraryPath>
 <TimeStamp>2007-10-19 14:48:44</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';    type Constant     ports      signal out output [2,1];    end;    icon bg     figures      rectangle 176.1 728 207.9 760 fill 15132390;      line 180.9 739.6 202.9 739.6 color 16711680 width 2;      line 178.2 750.7 203.9 750.7;      line 180.5 734.7 180.5 753;    end;    implementation eqequations	output=0;implementation_end;   HapticMaster 360 600    description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Submodel     ports      signal in Htip0 [4,4];      signal out effort [6,1];      signal in JoyTwist [6,1];      signal out HJoy0 [4,4];      signal out Hout0 [4,4];      signal in Hytip0 [4,4];      signal in HJoym [4,4];      signal out output_energy [2,1];      signal in input_energy [2,1];      signal out EnergyTank;      signal out JointSetpoint [5,1];      signal in CartSpaceStiffness [9,1];      signal in PhantomJointState [6,1];      signal out H_base_0 [4,4];      signal in input_energy_button [2,1];    end;    icon bg     figures      rectangle 273 512 447 688 fill 14013909;      text 'name' 360 600;     terminals      Htip0 272 632 fixed;      effort 272 616 fixed;      JoyTwist 392 512 fixed;      HJoy0 304 536 fixed;      Hout0 448 552 fixed;      Hytip0 448 592 fixed;      HJoym 328 512 fixed;      output_energy 448 664 fixed;      input_energy 448 624 fixed;      EnergyTank 312 688 fixed;      JointSetpoint 448 528 fixed;      CartSpaceStiffness 272 664 fixed;      PhantomJointState 272 576 fixed;    end;    implementation bg     submodels      CartesianSpaceStiffness 320 320       description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Control\PID Control\Continuous\P.emx</LibraryPath> <TimeStamp>2008-1-17 10:48:8</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type P        ports         signal out effort [6,1];         signal in Htip0 [4,4];         signal in H [4,4];         signal in CartSpaceStiffness [9,1];       end;       icon bg        figures         rectangle 288 288 352 352 fill 15132390;         text 'CartesianSpace Stiffness' 320 322 color 16711680 15;        terminals         effort 320 352 fixed;         Htip0 352 304 fixed;       end;       implementation eqparameters 	//boolean vp_equal_to_tip=true;	real HtipCC[4,4]= [			1, 0, 0, 0;			0, 1, 0, 0;			0, 0, 1, 0;			0, 0, 0, 1]; // latex notation H^{tip}_{cc}	real Hvp0[4,4]= [ 1, 0, 0, 0;					  	  0, 1, 0, 0;					     0, 0, 1, 0 ;					     0, 0, 0, 1 ]; // latex notation H^{tip}_{cc}	real H1_0_initial[4,4]=[ 1, 0, 0, 0;					  	  			0, 1, 0, 0;					     			0, 0, 1, 0 ;					     			0, 0, 0, 1 ]; // latex notation H^{tip}_{cc}variables	real Kt[3];	real Kr[3];	real Kc[3];	real Kcc[ 6, 6 ];	real Ktip[6,6];	real T1_00 [4,4], H_dot1_0[4,4],	H1_0[4,4], H1_00[4,4];	real costiffness1[ 3, 3 ], costiffness2[ 3, 3 ], costiffness3[ 3, 3 ],		dummy1[ 3, 3 ], dummy2[ 3, 3 ], dummy3[ 3, 3 ], dummy4[ 3, 3 ], dummy5[ 3, 3 ],		pose21[ 4, 4 ], skew21[ 3, 3 ], orientation21[ 3, 3 ];	real Hvp0_temp[4,4];	boolean vp_equal_to_tip;initialequations	Hvp0_temp=eye(4);	vp_equal_to_tip=true;equations	Kt = CartSpaceStiffness[1:3];	Kr =  CartSpaceStiffness[4:6];	Kc = CartSpaceStiffness[7:9];	H1_0 =inverseH(H)*Htip0;// inverseH(Htip0)*Hvp0_temp;// =H0tip*Hvp0 int (H_dot1_0, H1_0_initial);		Kcc[1:3,1:3] = diag(Kr);	Kcc[1:3,4:6] = diag(Kc);	Kcc[4:6,1:3] = transpose(diag(Kc)); // is it correct of it should be negative	Kcc[4:6,4:6] = diag(Kt); 	Ktip=transpose(Adjoint(HtipCC))*Kcc*Adjoint(HtipCC);//latex noation K_{tip}=(Ad_{H^{tip}_{cc}})^{T}*K_{cc}*Ad_{H^{tip}_{cc}}	dummy1 = Ktip[ 1 : 3, 1 : 3 ];	dummy2 = Ktip[ 1 : 3, 4 : 6 ];	dummy3 = Ktip[ 4 : 6, 4 : 6 ];	costiffness1 = 0.5 * trace( dummy1 ) * eye( 3 ) - dummy1;	costiffness2 = 0.5 * trace( dummy2 ) * eye( 3 ) - dummy2;	costiffness3 = 0.5 * trace( dummy3 ) * eye( 3 ) - dummy3;	"create T_tilde from the twist T1_00 of body 1 in coordinates of body 0 with respect to body 0"//	T1_00 = tilde (p.f);		"create the H_dot matrix for calculation of the transformation matrix H from body 1 to body 0"//	H_dot1_0 = T1_00 * H1_0;		pose21 = H1_0;	skew21 = skew( pose21[ 1 : 3, 4 ] );	orientation21 = pose21[ 1 : 3, 1 : 3 ];	dummy4 = 2 * antisym( costiffness1 * orientation21 ) + antisym( costiffness3 * transpose( orientation21 ) * skew21 * skew21 * orientation21 ) + 2 * antisym( costiffness2 * skew21 * orientation21 );	dummy5 = transpose( orientation21 ) * antisym( costiffness3 * skew21 ) * orientation21 + antisym( costiffness3 * transpose( orientation21 ) * skew21 * orientation21 ) + 2 * antisym( costiffness2 * orientation21 );	effort=- transpose(Adjoint(inverseH(Htip0)))* [ dummy4[ 3, 2 ]; dummy4[ 1, 3 ]; dummy4[ 2, 1 ]; dummy5[ 3, 2 ]; dummy5[ 1, 3 ]; dummy5[ 2, 1 ] ];	implementation_end;      EnergyEncoding 152 456       description '<Description>   <Version>4.1</Version>  <LibraryPath>EnergyEncodingR.emx</LibraryPath>  <TimeStamp>2012-10-30 18:54:40</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in inputMessage [2,1];         signal out inputEnergy;         signal out outputMessage [2,1];         signal in outputEnergy;       end;       icon bg        figures         rectangle 96 432 208 480 fill 14013909;         text 'name' 152 456 16;        terminals         inputMessage 120 432 fixed;         inputEnergy 208 448 fixed;         outputMessage 184 432 fixed;         outputEnergy 208 464 fixed;       end;       implementation eqparameters	real roundUp= 1000;	real MaxCounter=100;variables	real inputCount; // required to implement 'to zero' behaviour on input	real inputSum;	  // implements current state of all inputs by integraing all inputs 	real inputDiff;  // current  arrived message	real outputCount; // required to implement 'to zero' behaviour on output	real outputSum;	  // implements current state of all output by integraing all outputs 	real outputDiff;  // current  sent messageinitialequations	inputSum=0;	// initialize the input sum 	outputSum=0; 	// initialize the output sum code   // Compuation of incoming messages		//check if arrived message is less then  current input sum	if (inputMessage[1]+0.1*roundUp)<inputSum then		//if yes the input message was rounded up, thus roundup should be added to compute the increment properly		inputDiff=roundUp+inputMessage[1]-inputSum;	else		// if no the increment can be computed as simple difference		inputDiff=inputMessage[1]-inputSum;	end;	// This was a tested code; but I don't know the purose	//if inputMessage[1]==0 then	//	inputDiff=0;	//end;		// do round up and integrate	inputSum=(inputSum+inputDiff) mod roundUp;	inputEnergy=inputDiff;	 // Compuation of outgoing messages	outputCount=(previous(outputCount)+1) mod MaxCounter;	outputSum=(outputSum+outputEnergy) mod roundUp;	outputMessage[1]=outputSum;	outputMessage[2]=outputCount;implementation_end;      EnergyEncodingButton 152 552       description '<Description>
 <Version>4.1</Version>
 <LibraryPath>EnergyEncodingSimple.emx</LibraryPath>
 <TimeStamp>2012-10-30 16:29:39</TimeStamp>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';       type Submodel        ports         signal in inputMessage [2,1];         signal out inputEnergy;         signal out outputMessage [2,1];         signal in outputEnergy;       end;       icon bg bottom        figures         rectangle 96 529 208 575 fill 14013909;         text 'name' 152 553 16;        terminals         inputMessage 120 528 fixed;         inputEnergy 120 576 fixed;         outputMessage 184 528 fixed;         outputEnergy 184 576 fixed;       end;       implementation eq/* this block implements impulse behavior of the input/outputif signal haven't arrived the input set to zero;all messages that are delayed are droped*/parameters	real roundUp= 1000; 	real counter;initialequations	counter=0;code  	counter=(counter+1) mod roundUp;	if (inputMessage[2]==previous(inputMessage[2]) )then		inputEnergy=0;	else		inputEnergy=inputMessage[1]; 	end;	outputMessage[1]=outputEnergy;	outputMessage[2]=counter;	implementation_end;      Initializer 320 104       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in input [4,4];         signal out output [4,4];       end;       icon bg        figures         rectangle 289 101 351 107 fill 14013909;       end;       implementation eqparameters	real initial_value[4,4] = [1,0,0,0;0,1,0,0;0,0,1,0;0,0,0,1];		// gainvariables	boolean initialized;initialequations	initialized=false;equations	if initialized then		output = input;	else		if input[4,4]==1 then			initialized=true;			output = input;		else			output=initial_value;		end;	end;implementation_end;      Initializer1 688 104       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in input [4,4];         signal out output [4,4];       end;       icon bg        figures         rectangle 685 73 691 135 fill 14013909;       end;       implementation eqparameters	real initial_value[4,4] = [1,0,0,0;0,1,0,0;0,0,1,0;0,0,0,1];		// gainvariables	boolean initialized;initialequations	initialized=false;equations	if initialized then		output = input;	else		if input[4,4]==1 then			initialized=true;			output = input;		else			output=initial_value;		end;	end;implementation_end;      JointSpace 704 248       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in H [4,4];         signal out JointSetpoint [5,1];         signal in JointStates [6,1];       end;       implementation eqinitialequations	JointSetpoint=0;equations	JointSetpoint[1:4] = 0;	JointSetpoint[5]=-(JointStates[6]+pi);	implementation_end;      JoyRate 688 200       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in Twist [6,1];         signal out Hjoy0 [4,4];         signal out dEnergy;       end;       implementation eqparameters	real i[6]=50;variables	real H[4,4];	real dotH[4,4];	real init[4,4];initialequations	H=eye(4);	init=eye(4);	dotH=0;equations	dotH=H*tilde(Twist);	H=H + dotH*sampletime;	Hjoy0=H;	dEnergy=transpose(Twist)*diag(i)*Twist*sampletime;implementation_end;      Negate 552 160       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\Negate.emx</LibraryPath>  <TimeStamp>2007-9-26 12:14:11</TimeStamp></Description>';       type Negate        ports         signal in input [4,4];         signal out output [4,4];       end;       icon bg bottom        figures         rectangle 536 144 568 176 fill 15132390;         text '-1' 552 160 color 16711680 16 bold;       end;       implementation eqequations	output = inverseH(input);     implementation_end;      plug output_energy 184 360;      plug input_energy 120 360;      plug EnergyTank 272 512;      plug CartSpaceStiffness 168 320;      plug PhantomJointState 704 312;      plug H_base_0 728 336;      plug Hytip0 320 72;      plug Hout0 512 64;      plug HJoy0 744 152;      plug JoyTwist 776 200;      plug effort 320 576;      plug Htip0 512 552;      plug HJoym 728 104;      plug JointSetpoint 800 248;      plug input_energy_button 80 496;      OutputEnergyToButton 208 680       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\Constant.emx</LibraryPath>
 <TimeStamp>2007-10-19 14:48:44</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';       type Constant        ports         signal out output;       end;       icon bg        figures         rectangle 192.1 664 223.9 696 fill 15132390;         line 196.9 675.6 218.9 675.6 color 16711680 width 2;         line 194.2 686.7 219.9 686.7;         line 196.5 670.7 196.5 689;       end;       implementation eqequations	output=0;implementation_end;      PassivityLayerW 320 456       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in wrench [6,1];         signal in sensor [4,4];         signal out adjusted_wrench [6,1];         signal in input_energy;         signal out output_energy;         signal out EnergyTank;       end;       icon bg        figures         rectangle 272 433 368 479 fill 14013909;         text 'name' 320 455 16;       end;       implementation bg        submodels         EnergyTankBlock 496 376          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal out energyState;            signal in energyQuanta;          end;          implementation eqparameters	real InitialEnergyState =1{J};variables	real EnergyState;initialequations	EnergyState=InitialEnergyState;code	EnergyState=EnergyState+energyQuanta;	energyState=EnergyState;implementation_end;         EnergyTankControl 216 208          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in controlForce [6,1];            signal out adjustedForce [6,1];            signal in energyState;            signal in dSensorValue [6,1];          end;          implementation eq/*  Tank level controller via dumping injection*/parameters	integer hidden n=6; //actuator array size needed for block reuse , only need to alter size of the inputs and this number	real DumpingInjectionTreshold = 5{J};  //minimal enrgy level to activet dumpling injection	real RecoveryMultiplier[n] = 10 {s/m^2};	 //variable friction co efficnet  based on energy level	real MaxmimDampingConstant[n] = 0.01{N/t}; 	//maxmum dumping injection  force it is sampletime dependent !!!	boolean TCLactive=false;variables	real DumpingInjectionForce[n];//recovery torque	//real dSensorValue[n];	real SensorSpeed[n];	real MaxmimDumping[n];	real energyStateError;	integer hidden i; // counterinitialequations	adjustedForce=0;code	// Compute speed  for damping injection ( it is possible to use more fancy ways of doing it)	//dSensorValue=sensorValue-previous(sensorValue);	SensorSpeed=dSensorValue/sampletime;	// Based on the second order mass model maximum energy extartion occures if F_{damp}=\frac{m_{obj}* \dot x}{\Delta T}	// if F_{damp}>2\frac{m_{obj}* \dot x}{\Delta T} then damping injection fails  thus it is required to estimate the inertia parameters of the system 	// in here a simple limit is implementted to prevent active behaviour if sampletime has been increesed	MaxmimDumping=MaxmimDampingConstant/(sampletime);	// compute recovery mulpler	energyStateError=DumpingInjectionTreshold-energyState;	if energyStateError<=0 then		DumpingInjectionForce=0;	else		DumpingInjectionForce=-diag(RecoveryMultiplier)*energyStateError*SensorSpeed;	end;	//avoiding bug in limit computation during code generaion in 20-sim version 4.1.4.1	for i=1 to n do		DumpingInjectionForce[i]=limit(DumpingInjectionForce[i],-MaxmimDumping[i],MaxmimDumping[i]);	end;	if TCLactive then		adjustedForce=controlForce +DumpingInjectionForce;	else		adjustedForce=controlForce;	end;implementation_end;         FilterButterworth1 536 424          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in input [6,1];            signal out output [6,1];          end;          implementation eqparameters// Gains for 2nd order low-pass Butterworth filter	//real  FilterGain[2,3] = [0.0675, 0.1349, 0.0675; 1.143, -0.4128,0];				// Cut-off frequency 100 Hz   //real  FilterGain[2,3] = [0.0201, 0.0402, 0.0201; 1.561, -0.6414,0]; 		//Cut-off 50 Hz	real  FilterGain[2,3] = [0.0055, 0.0111, 0.0055; 1.7786, -0.8008,0];			// Cut-off frequency  25 Hz	//real  FilterGain[2,3] = [2.414e-4, 4.827e-4, 2.414e-4;1.9556, -0.9565, 0.0];	// Cut-off frequency   5 Hz	variables	real InputMemory[3,6];	real InputUpdate[3,3];	real State[3,6];	real A[3,3];	real B[3,3];initialequations InputUpdate=[0,0,0;					1,0,0;					0,1,0]; //downshift InputMemory=0; State=0; A[1,:]=FilterGain[2,:]; A[2:3,:]=[1,0,0;			  0,1,0]; B[1,:] =FilterGain[1,:]; B[2:3,:]=0;code	InputMemory=InputUpdate*InputMemory+[1;0;0]*transpose(input);	State=A*State+B*InputMemory;	output=transpose([1,0,0]*State);		implementation_end;         HToTwist 736 424          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in H_t1_0 [4,4];            signal out Twist [6,1];          end;          implementation eqvariables	real H_t1_t0[4,4];	real H_t0_0[4,4];	real aldo;// temporal variable to resolve numerical round up errors	real theta;// angle of rotation	real norm_omega[3]; //normolized vector of rotation	real omega[3]; //vector of rotationcode	// compute realtive pose	H_t0_0=previous(H_t1_0);	H_t1_t0=inverseH(H_t1_0)*H_t0_0;	aldo =(trace(H_t1_t0[1:3,1:3])-1)/2;	// numerical errors resolution	if (aldo < -1) then aldo = -1; end;	if (aldo > 1) then aldo = 1; end;	theta= arccos(aldo);	if (theta==0) then 		norm_omega=0;	else		norm_omega = (1/(2*sin(theta)))*[	H_t1_t0[3,2] - H_t1_t0[2,3];											H_t1_t0[1,3] - H_t1_t0[3,1];											H_t1_t0[2,1] - H_t1_t0[1,2]];	end;	omega=theta*norm_omega;		Twist[1:3]=-H_t1_t0[1:3,4];	Twist[4:6]=-omega[3];	implementation_end;         plug sensor 840 424;         plug adjusted_wrench 840 208;         plug input_energy 440 256;         plug output_energy 544 256;         plug EnergyTank 432 408;         plug wrench 48 208;         PassiveSampling 664 376          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in adjustedForce [6,1];            signal in dSensorValue [6,1];            signal out energyQuanta;          end;          implementation eq/*  	Passive sampling based on the Franken  Control of haptic interaction*/parameters	 integer hidden n=6; //actuator array size needed for block reuse , only need to alter size of the inputs and this numbercode	// following compute energy exchange between sampe times is force is held constant over time sample period	// \Delta x=\int{\dot x}= x(k)-x(k-1)	//	dSensorValue=sensorValue-previous(sensorValue);	//\Delta H= - {\Delta x}^{T} F 	energyQuanta=-transpose(adjustedForce)*dSensorValue;implementation_end;         PassiveZOH 360 208          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in controlForce [6,1];            signal out adjustedForce [6,1];            signal in energyState;            signal in sensorValue [6,1];          end;          implementation eq/* nD Passive Zero Order Hold	it prevent system from using more energy then available	- Saturation functions			-maximum kinetic energy extracted in next time step			-maximum potentional energy state based on linear spring			-maximum of device outputThe optimization method blow work olny with in Phase 2 barier method thus for any energy level belowin the controller below kinetic energy zero forces will be provided*/parameters	integer hidden n=6; //actuator array size needed for block reuse , only need to alter size of the inputs and this number	real SpringConstant[n] = 1;//[10.0;10.0;10.0;10.0;10.0] {N/m}; 		 // Spring Constant to determine maximum torque base of linear spring staturation function  //the number is arbitary. it will affect system performance in serach of energietic minimum. 	real MaximumActuatorForce[n]=[10;10;10;10;10;10] {N};		 // Force saturation value based on actuator physical limit	boolean PassivityLayerActive= true;	real MassConstant[n]=1;	real eps =1e-4; //presision of opimization value does not affet the passivity since any torques in the feasble set are passive	real betaLine =0.5; // line search decerement	real betaBarrier1=1.5; //barrier standart increment	real betaBarrier2=5; // barrier exception incerement	integer maxNumIter=1000;//upperbound on the allowed search iterations	real Channelweights[n]=[1;1;1;1;1;1]; //actuation imporantce deterimnes which actuation channel is more importantvariables	real dSensorValue[n];	real SensorSpeed[n];	real ForceSaturationArray[n,3]; //	1.device output,2.Optimized energy barrier,3.desired force	real SaturatedForce[n];	real i;//counter	real aldo; //temporal compuation // optimization variables	real xd[n];real A[n,n];	real B1[n,n];	real B2[n,n];	real B3[n,n];	real a[n];	real b;	real xcl[n];	real dx[n];	real dObjective[n];	real HObjective[n,n];	real lamda2;	real t;	integer numIter;	//line search tempoerals	real obj;	real objAldo;	real xAldo[n];	real stepSize;initialequations	adjustedForce=0;	//energy barrrier parameters	A=diag(Channelweights);	// following computes the parameters of energy barrier	// F'*(dT^2*inv(M') +inv(K'))*F+dT*(F'*inv(M')*M*dx+dx'*F)+dx'*M*dx -2*H<0	B1=sampletime^2*inverse(	diag(MassConstant))+inverse(	diag(SpringConstant));	//dT*(F'*inv(M')*M*dx+dx'*F) simpifing eye~ transpose(inverse(MassConstant))*MassConstantsince it is symertical	B2=2*sampletime*eye(n);	B3=diag(MassConstant);	numIter=0;	aldo=0;code	//Fill in Force staturation Array 	ForceSaturationArray[:,1]=MaximumActuatorForce;		// Compute maximum alowed energy exchange	dSensorValue=sensorValue-previous(sensorValue);	SensorSpeed=dSensorValue/sampletime;	//energy berrier initial states	b=2*energyState;	a=SensorSpeed;	xd=controlForce;			numIter=0;	if b>0 and b-transpose(a)*B3*a>0 then		// there is enough energy to do control		//warning(' there is enough energy to do control',false);		xcl=controlForce;		numIter=0;		if  (b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a<0) then			warning(' there is enough energy to do control3',true);			// there is enough energy to do control as required following will commute the minimum effect alteration of control torques			xcl=0; // zero is strictly feaseble since b-transpose(a)*B3*a>0			lamda2=1; //temporal value for prescision calcuation			numIter=0; // tracking upper bound			lamda2=1;			t=1;			while (sqrt(lamda2)/t>eps and numIter<maxNumIter)  do// stop condition   		 	numIter=numIter+1;// count number of iterations     			t=t*betaBarrier1; // constrain relaxation process				dObjective=t*(A+transpose(A))*(xd-xcl)-1/(b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a)*(-(B1+transpose(B1))*xcl-B2*a); 				HObjective=-t*(A+transpose(A))-1/(b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a)^2*(-(B1+transpose(B1))*xcl-B2*a)*transpose(-(B1+transpose(B1))*xcl-B2*a)-1/(b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a)*(B1+transpose(B1)); 				dx=-inverse(HObjective)*dObjective;				lamda2=abs(transpose(dObjective)*dx);				// line search				obj=t*transpose(xd-xcl)*A*(xd-xcl)-log(b-transpose(xcl)*(B1)*xcl-transpose(a)*B2*xcl-transpose(a)*B3*a);     			stepSize=1;     			objAldo=obj;     			xAldo=xcl;     			while (obj<=objAldo and stepSize>eps^3) do         		stepSize=betaLine*stepSize;         		xAldo=xcl+dx*stepSize;         		if (b-transpose(xAldo)*(B1)*xAldo-transpose(a)*B2*xAldo-transpose(a)*B3*a>0) then             		objAldo=t*transpose(xd-xAldo)*A*(xd-xAldo)-log(b-transpose(xAldo)*(B1)*xAldo-transpose(a)*B2*xAldo-transpose(a)*B3*a);         		end;					if (stepSize<eps^3) then             		warning('had to intreupt',true);            		t=t*betaBarrier2;             		xAldo=xcl;         		end;     			end;     			// x update     			xcl=xAldo;			end;		else			// there is enough energy to do control as required			//warning(' there is enough energy to do control2',false);			xcl=controlForce;		end;	else		// there is not enough energy to do control		xcl=0;	end;	ForceSaturationArray[:,2]=xcl;	ForceSaturationArray[:,3]=controlForce;	for i =1 to n do		SaturatedForce[i]=sign(controlForce[i])*min(abs(ForceSaturationArray[i,:]));	end;	if PassivityLayerActive then		adjustedForce=SaturatedForce;	else		adjustedForce=controlForce;	end;implementation_end;         PlusMinus1 576 376          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>  <TimeStamp>2007-9-27 10:15:13</TimeStamp></Description>';          knot PlusMinus           ports            signal knot duplicatable in plus [1];            signal knot duplicatable in minus [1];            signal knot out output [1];          end;          icon bg ellipse           figures            ellipse 568 368 584 384 fill 16777215;          end;          implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;         SETP 496 312          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in energyState;            signal out energyQuanta;            signal out outputPackage;            signal in inputPackage;          end;          implementation eqparameters	real CommunicationTreshold= 3.0 {J};	real SendoutPercent=0.1; //10%initialequations	outputPackage=0;	energyQuanta=0;codeif CommunicationTreshold>energyState then	outputPackage=0;	energyQuanta=inputPackage;else	outputPackage=-(CommunicationTreshold-energyState)*SendoutPercent;	energyQuanta=inputPackage-outputPackage;end;implementation_end;         Splitter1 360 424          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [6,1];            signal knot in input [6,1];          end;          icon bg ellipse           figures            ellipse 356.8 420.8 363.2 427.2 color -1 fill 0;            ellipse 355.7 419.7 364.3 428.3 color -1;           terminals            input 360 424 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;         Splitter2 664 208          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [6,1];            signal knot in input [6,1];          end;          icon bg ellipse           figures            ellipse 660.8 204.8 667.2 211.2 color -1 fill 0;            ellipse 659.7 203.7 668.3 212.3 color -1;           terminals            input 664 208 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;         Splitter5 432 376          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [1];            signal knot in input [1];          end;          icon bg ellipse           figures            ellipse 428.8 372.8 435.2 379.2 color -1 fill 0;            ellipse 427.7 371.7 436.3 380.3 color -1;           terminals            input 432 376 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;         Splitter6 664 424          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [6,1];            signal knot in input [6,1];          end;          icon bg ellipse           figures            ellipse 660.8 420.8 667.2 427.2 color -1 fill 0;            ellipse 659.7 419.7 668.3 428.3 color -1;           terminals            input 664 424 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;         Splitter8 360 376          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [1];            signal knot in input [1];          end;          icon bg ellipse           figures            ellipse 356.8 372.8 363.2 379.2 color -1 fill 0;            ellipse 355.7 371.7 364.3 380.3 color -1;           terminals            input 360 376 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;        end;        connections         HToTwist\Twist -> Splitter6\input;         wrench -> EnergyTankControl\controlForce;         Splitter5\output -> EnergyTank;         SETP\energyQuanta -> PlusMinus1\plus 576 312;         EnergyTankBlock\energyState -> Splitter5\input;         SETP\inputPackage <- input_energy 440 288;         PlusMinus1\output -> EnergyTankBlock\energyQuanta;         Splitter6\output -> FilterButterworth1\input;         Splitter5\output -> SETP\energyState 432 312;         PassiveZOH\adjustedForce -> Splitter2\input;         Splitter1\output -> EnergyTankControl\dSensorValue 216 424;         PassiveSampling\energyQuanta -> PlusMinus1\plus;         Splitter6\output -> PassiveSampling\dSensorValue 664 424;         Splitter5\output -> Splitter8\input;         Splitter2\output -> adjusted_wrench;         Splitter8\output -> PassiveZOH\energyState;         EnergyTankControl\adjustedForce -> PassiveZOH\controlForce;         output_energy <- SETP\outputPackage 544 288;         Splitter8\output -> EnergyTankControl\energyState 216 376;         Splitter2\output -> PassiveSampling\adjustedForce;         sensor -> HToTwist\H_t1_0;         FilterButterworth1\output -> Splitter1\input;         Splitter1\output -> PassiveZOH\sensorValue;        end;       implementation_end;      PlusMinus1 240 448       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>  <TimeStamp>2007-9-27 10:15:13</TimeStamp></Description>';       knot PlusMinus        ports         signal knot duplicatable in plus [1];         signal knot duplicatable in minus [1];         signal knot out output [1];       end;       icon bg ellipse        figures         ellipse 232 440 248 456 fill 16777215;       end;       implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;      Rate_control 584 256       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in Hinput [4,4];         signal out Houtput [4,4];       end;       implementation eqparameters	real R[3]= [0.08;0.1;0.1]; //ellipsoid dimentions	real E0[3]= [-0.15;0.0;0.1];//ellipsoid offset	real speed=0.1; //rate multipliervariables	real H[4,4];	real dH[4,4];	real dotH[4,4];	real T[6];	real init[4,4];	real snorm;	real Rnorm;	real enorm;initialequations	H=eye(4);	init=eye(4);	dotH=0;equations	snorm=norm(Hinput[1:3,4]);	enorm=norm((Hinput[1:3,4]-E0)./R);	Rnorm=norm(R);	if enorm>1 then		T[4:6]=(Hinput[1:3,4]-E0)*speed;		T[1:3]=0;	else		T=0;	end;	dotH=tilde(T)*H;	H=H +dotH*sampletime;//int(dotH,init);	Houtput=H;implementation_end;      RotAdjstment 512 344       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal out output [4,4];         signal in input [4,4];       end;       implementation eqvariables	real angle;	real H10[4,4];	real R10[3,3];	real H02[4,4];	real R02[3,3];initialequations	angle=pi; equations	R10=[cos(angle), -sin(angle), 0; 		  sin(angle), cos(angle), 	0;		     0, 				0, 		1];	H10=homogeneous(R10,[0;0;0]);	R02=[cos(angle), -sin(angle), 0; 		  sin(angle), cos(angle), 	0;		     0, 				0, 		1];	H02=homogeneous(R02,[0;0;0]);	output=H10*input*H02;implementation_end;      Splitter1 512 256       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [4,4];         signal knot in input [4,4];       end;       icon bg ellipse        figures         ellipse 508.8 252.8 515.2 259.2 color -1 fill 0;         ellipse 507.7 251.7 516.3 260.3 color -1;        terminals         input 512 256 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Splitter10 640 200       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [4,4];         signal knot in input [4,4];       end;       icon bg ellipse        figures         ellipse 636.8 196.8 643.2 203.2 color -1 fill 0;         ellipse 635.7 195.7 644.3 204.3 color -1;        terminals         input 640 200 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Splitter11 512 456       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [4,4];         signal knot in input [4,4];       end;       icon bg ellipse        figures         ellipse 508.8 452.8 515.2 459.2 color -1 fill 0;         ellipse 507.7 451.7 516.3 460.3 color -1;        terminals         input 512 456 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Splitter2 584 152       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [4,4];         signal knot in input [4,4];       end;       icon bg ellipse        figures         ellipse 580.8 148.8 587.2 155.2 color -1 fill 0;         ellipse 579.7 147.7 588.3 156.3 color -1;        terminals         input 584 152 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Splitter4 552 104       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [4,4];         signal knot in input [4,4];       end;       icon bg ellipse        figures         ellipse 548.8 100.8 555.2 107.2 color -1 fill 0;         ellipse 547.7 99.7 556.3 108.3 color -1;        terminals         input 552 104 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Splitter5 512 304       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [4,4];         signal knot in input [4,4];       end;       icon bg ellipse        figures         ellipse 508.8 300.8 515.2 307.2 color -1 fill 0;         ellipse 507.7 299.7 516.3 308.3 color -1;        terminals         input 512 304 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Splitter7 640 248       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [4,4];         signal knot in input [4,4];       end;       icon bg ellipse        figures         ellipse 636.8 244.8 643.2 251.2 color -1 fill 0;         ellipse 635.7 243.7 644.3 252.3 color -1;        terminals         input 640 248 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Submodel1 584 104       description '<Description> <Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>  <TimeStamp>2007-10-31 11:32:54</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       type Submodel        ports         signal in Input1 [4,4];         signal in Input2 [4,4];         signal out Output [4,4];       end;       icon bg ellipse        figures         ellipse 576 97 592 113 fill 16777215;         text '+' 584 104 20;       end;       implementation eqequations	Output=Input1*Input2;implementation_end;      Submodel16 320 384       description '<Description> <Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>  <TimeStamp>2007-10-31 11:32:54</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       type Submodel        ports         signal in input [6,1];         signal out output [6,1];       end;       implementation eqvariables	real angle;	real H[4,4];	real Rot[3,3];initialequations	angle=pi; equations	Rot=[cos(angle), -sin(angle), 0; 		  sin(angle), cos(angle), 	0;		     0, 				0, 		1];	H=homogeneous(Rot,[0;0;0]);	output=Adjoint(H)*input;implementation_end;      Submodel2 512 104       description '<Description> <Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>  <TimeStamp>2007-10-31 11:32:54</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       type Submodel        ports         signal in Input1 [4,4];         signal in Input2 [4,4];         signal out Output [4,4];       end;       icon bg ellipse        figures         ellipse 504 97 520 113 fill 16777215;         text '+' 512 104 20;       end;       implementation eqequations	Output=Input1*Input2;implementation_end;      Submodel3 584 200       description '<Description> <Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>  <TimeStamp>2007-10-31 11:32:54</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       type Submodel        ports         signal in Input1 [4,4];         signal in Input2 [4,4];         signal out Output [4,4];       end;       icon bg ellipse        figures         ellipse 576 193 592 209 fill 16777215;         text '+' 584 200 20;       end;       implementation eqequations	Output=Input1*Input2;implementation_end;      Submodel4 320 160       description '<Description> <Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>  <TimeStamp>2007-10-31 11:32:54</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       type Submodel        ports         signal in Input1 [4,4];         signal in Input2 [4,4];         signal out Output [4,4];       end;       icon bg ellipse        figures         ellipse 312 153 328 169 fill 16777215;         text '+' 320 160 20;       end;       implementation eqequations	Output=Input1*Input2;implementation_end;     end;     connections      PhantomJointState -> JointSpace\JointStates;      Splitter1\output -> Submodel2\Input2;      Splitter10\output -> Submodel3\Input1;      PassivityLayerW\output_energy -> EnergyEncoding\outputEnergy;      Splitter5\output -> CartesianSpaceStiffness\Htip0;      JointSpace\JointSetpoint -> JointSetpoint;      Splitter10\output -> Splitter7\input;      Submodel2\Output -> Hout0;      RotAdjstment\output -> Splitter5\input;      Splitter7\output -> H_base_0 640 336;      input_energy -> EnergyEncoding\inputMessage;      Submodel4\Output -> CartesianSpaceStiffness\H;      EnergyEncoding\inputEnergy -> PlusMinus1\plus;      Rate_control\Houtput -> Submodel3\Input2;      JoyRate\Hjoy0 -> Splitter10\input;      PassivityLayerW\input_energy <- PlusMinus1\output;      JoyRate\dEnergy -> PlusMinus1\plus 784 176 784 32 240 32;      Splitter4\output -> Submodel2\Input1;      CartesianSpaceStiffness\effort -> Submodel16\input;      Initializer\output -> Submodel4\Input2;      Splitter11\output -> RotAdjstment\input;      Splitter5\output -> Splitter1\input;      Splitter4\output -> Negate\input;      PassivityLayerW\adjusted_wrench -> effort;      Splitter2\output -> HJoy0 584 151.5;      CartSpaceStiffness -> CartesianSpaceStiffness\CartSpaceStiffness;      HJoym -> Initializer1\input;      Hytip0 -> Initializer\input;      Splitter11\output -> PassivityLayerW\sensor;      Negate\output -> Submodel4\Input1;      output_energy <- EnergyEncoding\outputMessage;      Initializer1\output -> Submodel1\Input2;      Submodel16\output -> PassivityLayerW\wrench;      Splitter2\output -> Submodel1\Input1;      Splitter7\output -> JointSpace\H 640 248;      Htip0 -> Splitter11\input;      EnergyEncodingButton\inputEnergy -> PlusMinus1\plus;      input_energy_button -> EnergyEncodingButton\inputMessage;      OutputEnergyToButton\output -> EnergyEncodingButton\outputEnergy;      JoyTwist -> JoyRate\Twist;      Submodel1\Output -> Splitter4\input;      PassivityLayerW\EnergyTank -> EnergyTank;      Submodel3\Output -> Splitter2\input;      Splitter1\output -> Rate_control\Hinput;     end;    implementation_end;   HoldArmJointsTorque 1520 450    description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Discrete\Hold.emx</LibraryPath> <TimeStamp>2007-9-27 15:20:15</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Hold     ports      signal in input [5,1];      signal out output [5,1];    end;    icon bg     figures      rectangle 1504 434 1536 466 fill 15132390;      text 'ZOH' 1521.1 448.9 color 16711680 14;    end;    implementation eqparameters	real initial = 0;equations	output = hold (input, initial);         implementation_end;   HoldBaseWheelsTorque 1521 586    description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Discrete\Hold.emx</LibraryPath> <TimeStamp>2007-9-27 15:20:15</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Hold     ports      signal in input [4,1];      signal out output [4,1];    end;    icon bg     figures      rectangle 1505 570 1537 602 fill 15132390;      text 'ZOH' 1522.1 584.9 color 16711680 14;    end;    implementation eqparameters	real initial = 0;equations	output = hold (input, initial);         implementation_end;   HtipCC 735 570    description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Sources\Constant.emx</LibraryPath> <TimeStamp>2007-10-19 14:48:44</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Constant     ports      signal out output [4,4];    end;    icon bg bottom     figures      rectangle 719.1 554 750.9 586 fill 15132390;      line 723.9 565.6 745.9 565.6 color 16711680 width 2;      line 721.2 576.7 746.9 576.7;      line 723.5 560.7 723.5 579;    end;    implementation eqparameters 	//boolean vp_equal_to_tip=true;	real H_eye[4,4]= [ 1, 0, 0, 0;					  	  0, 1, 0, 0;					     0, 0, 1, 0 ;					     0, 0, 0, 1 ]; // latex notation H^{tip}_{cc}equations	output=H_eye;implementation_end;   InteractiveMarker1 320 472    description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Submodel     ports      signal out HJoym [4,4];    end;    implementation eqparameters//	real p[3] = [0;0;0];//	real omega[3] = [0;1;0];//	real theta = 1.57;	real HJoym_setp[4,4] = [ 1, 0, 0, 0;					  	  0, 1, 0, 0;					     0, 0, 1, 1 ;					     0, 0, 0, 1 ]; // latex notation H^{tip}_{cc}//variables//	real R[3,3];equations//Rodrigues formula	//R = eye(3) + skew(omega)*sin(theta) + skew(omega)*skew(omega)*(1-cos(theta));	//HJoym = homogeneous(R,p);	HJoym = HJoym_setp;     implementation_end;   Joystick2 400 472    description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Submodel     ports      signal out port1 [6,1];    end;    implementation eqequationsport1=[0;0;(sign(sin(time*2))-1);(sign(cos(time*2))-1);0;0];implementation_end;   MockupPhantom1 208 624    description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Submodel     ports      signal out Hpos0 [4,4];      signal in W [6,1];      signal out joint_space [6,1];    end;    icon bg     figures      rectangle 178 602 238 646 fill 14013909;      text 'name' 208 624;     terminals      Hpos0 240 632 fixed;      W 240 616 fixed;    end;    implementation eqparameters	real I[6]=[1,1,1,1,1,1];variables	real T[6];	real P[6];	real dotH[4,4],H[4,4];	real init[4,4];initialequations	init=eye(4);	P=[1;1;1;1;1;1];	H=eye(4);	dotH=0;equations	P=previous(P)+W*sampletime-T*0.1;//int(W);//+[1;-1;1;1;-1;1];	T=inverse(diag(I))*P;	dotH=tilde(T)*H;	H=H+dotH*sampletime;//int(dotH,init);	Hpos0=H;	joint_space=0;implementation_end;   Odometry 1392 712    description '<Description> <Version>4.1</Version> <LibraryPath>FiniteTwist.emx</LibraryPath> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <TimeStamp>2012-6-20 16:17:43</TimeStamp> <AllowLibraryUpdate>False</AllowLibraryUpdate></Description>';    type 'Submodel-Equation'     ports      signal in T_base_00 [6,1];      signal out H_base_map [4,4];      signal in H_odom_map [4,4];      signal out H_base_odom [4,4];    end;    icon bg     figures      rectangle 1355 690 1429 734 fill 14013909;      text 'name' 1392 712 16;     terminals      T_base_00 1384 688 fixed;      H_base_map 1360 688 fixed;    end;    implementation eqvariables	real R[3,3]; 	real omega[3];	real v[3];	real omega_norm;	real omega_temp[3];	real H[4,4];	real dotH[4,4];	real aldo[4,4]; //20sim bug	real aldoH_odom_map[4,4]; //safety	real H_base_baseprev[4,4];initialequations	H_base_odom=eye(4);	H=eye(4);	aldo=eye(4); 	H_base_baseprev=eye(4);	aldoH_odom_map=eye(4);code	omega=T_base_00[1:3]*sampletime;	//input velocity from any where	v=T_base_00[4:6]*sampletime;  omega_norm=norm(omega);//Finite twistif (omega_norm==0) then	H=tilde(T_base_00)+eye(4);else	omega_temp=omega/omega_norm;	R=eye(3)+skew(omega_temp)*sin(omega_norm)+skew(omega_temp)*skew(omega_temp)*(1-cos(omega_norm));	H[1:3,1:3]=R;	H[1:3,4]=((eye(3)-R)*(skew(omega)*v)+transpose(omega)*v*omega)/omega_norm^2;	H[4,4]=1;	H[4,1:3]=0;end;// integration  	aldo=H_base_odom*H; // aldo bug in code generation	H_base_odom=aldo;		// amcl update	if H_odom_map[4,4]==1 then		aldoH_odom_map =H_odom_map;	end;	H_base_map=(aldoH_odom_map)*H_base_odom;/*	dotH=H*tilde(T);	H=H + dotH*sampletime;	H_base_0=H; */implementation_end;   SampleArmJonitsAngle 1520 498    description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Discrete\Sample.emx</LibraryPath> <TimeStamp>2007-9-27 15:20:31</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Sample     ports      signal in input [5,1];      signal out output [5,1];    end;    icon bg     figures      rectangle 1504 482 1536 514 fill 15132390;      line 1506.3 488.8 1509.2 488.8 1509.2 484.9 1513.3 484.9 1513.3 488.8 1517.2 488.8 1517.2 484.9 1519.1 484.9 color 16711680 fill 15132390;      line 1519.5 490.4 1521.7 490.4 1521.7 496.4 1522.6 494.9 fill 15132390;      line 1521 495.1 1521.7 496.4 fill 15132390;      line 1507.9 501.9 1515.9 501.9 1528 498 fill 15132390 width 2;    end;    implementation eqequations	output = sample (input);      implementation_end;   SampleBaseWheelsAngle 1521 634    description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Discrete\Sample.emx</LibraryPath> <TimeStamp>2007-9-27 15:20:31</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Sample     ports      signal in input [4,1];      signal out output [4,1];    end;    icon bg     figures      rectangle 1505 618 1537 650 fill 15132390;      line 1507.3 624.8 1510.2 624.8 1510.2 620.9 1514.3 620.9 1514.3 624.8 1518.2 624.8 1518.2 620.9 1520.1 620.9 color 16711680 fill 15132390;      line 1520.5 626.4 1522.7 626.4 1522.7 632.4 1523.6 630.9 fill 15132390;      line 1522 631.1 1522.7 632.4 fill 15132390;      line 1508.9 637.9 1516.9 637.9 1529 634 fill 15132390 width 2;    end;    implementation eqequations	output = sample (input);      implementation_end;   SimpleEnergySupply 616 680    description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Submodel     ports      signal in input_energy [2,1];      signal out output_energy [2,1];      signal out EnergyTank;    end;    implementation bg     submodels      EnergyEncoding1 483 181       description '<Description>   <Version>4.1</Version>  <LibraryPath>EnergyEncodingR.emx</LibraryPath>  <TimeStamp>2012-10-30 18:54:40</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in inputMessage [2,1];         signal out inputEnergy;         signal out outputMessage [2,1];         signal in outputEnergy;       end;       icon bg        figures         rectangle 427 157 539 205 fill 14013909;         text 'name' 483 181 16;        terminals         inputMessage 451 157 fixed;         inputEnergy 451 205 fixed;         outputMessage 515 157 fixed;         outputEnergy 515 205 fixed;       end;       implementation eqparameters	real roundUp= 1000;	real MaxCounter=100;variables	real inputCount; // required to implement 'to zero' behaviour on input	real inputSum;	  // implements current state of all inputs by integraing all inputs 	real inputDiff;  // current  arrived message	real outputCount; // required to implement 'to zero' behaviour on output	real outputSum;	  // implements current state of all output by integraing all outputs 	real outputDiff;  // current  sent messageinitialequations	inputSum=0;	// initialize the input sum 	outputSum=0; 	// initialize the output sum code   // Compuation of incoming messages		//check if arrived message is less then  current input sum	if (inputMessage[1]+0.1*roundUp)<inputSum then		//if yes the input message was rounded up, thus roundup should be added to compute the increment properly		inputDiff=roundUp+inputMessage[1]-inputSum;	else		// if no the increment can be computed as simple difference		inputDiff=inputMessage[1]-inputSum;	end;	// This was a tested code; but I don't know the purose	//if inputMessage[1]==0 then	//	inputDiff=0;	//end;		// do round up and integrate	inputSum=(inputSum+inputDiff) mod roundUp;	inputEnergy=inputDiff;	 // Compuation of outgoing messages	outputCount=(previous(outputCount)+1) mod MaxCounter;	outputSum=(outputSum+outputEnergy) mod roundUp;	outputMessage[1]=outputSum;	outputMessage[2]=outputCount;implementation_end;      EnergyTankBlock 504 384       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal out energyState;         signal in energyQuanta;       end;       implementation eqparameters	real InitialEnegyState =10{J};	real supply=10;	real rate=0.01;variables	real EnergyState;initialequations	EnergyState=InitialEnegyState;code	EnergyState=EnergyState+energyQuanta;	EnergyState=(1-rate)*EnergyState+(rate)*supply;	energyState=EnergyState;implementation_end;      plug input_energy 360 72;      plug output_energy 624 88;      plug EnergyTank 296 384;      PlusMinus1 584 384       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>  <TimeStamp>2007-9-27 10:15:13</TimeStamp></Description>';       knot PlusMinus        ports         signal knot duplicatable in plus [1];         signal knot duplicatable in minus [1];         signal knot out output [1];       end;       icon bg ellipse        figures         ellipse 576 376 592 392 fill 16777215;       end;       implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;      SETP 504 320       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in energyState;         signal out energyQuanta;         signal out outputPackage;         signal in inputPackage;       end;       implementation eqparameters	real CommunicationTreshold=0 {J};	real SendoutPercent=0.01; //%initialequations	outputPackage=0;	energyQuanta=0;codeif CommunicationTreshold>energyState then	outputPackage=0;	energyQuanta=inputPackage;else	outputPackage=-(CommunicationTreshold-energyState)*SendoutPercent;	energyQuanta=inputPackage-outputPackage;end;implementation_end;      Splitter1 424 384       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [1];         signal knot in input [1];       end;       icon bg ellipse        figures         ellipse 420.8 380.8 427.2 387.2 color -1 fill 0;         ellipse 419.7 379.7 428.3 388.3 color -1;        terminals         input 424 384 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;     end;     connections      SETP\energyQuanta -> PlusMinus1\plus 584 320;      PlusMinus1\output -> EnergyTankBlock\energyQuanta;      EnergyTankBlock\energyState -> Splitter1\input;      SETP\inputPackage <- EnergyEncoding1\inputEnergy;      SETP\outputPackage -> EnergyEncoding1\outputEnergy;      EnergyEncoding1\inputMessage <- input_energy;      output_energy <- EnergyEncoding1\outputMessage;      Splitter1\output -> SETP\energyState 424 384 424 320;      EnergyTank <- Splitter1\output;     end;    implementation_end;   Splitter1 1000 568    description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';    knot Splitter     ports      signal knot duplicatable out output [4,4];      signal knot in input [4,4];    end;    icon bg ellipse     figures      ellipse 996.8 564.8 1003.2 571.2 color -1 fill 0;      ellipse 995.7 563.7 1004.3 572.3 color -1;     terminals      input 1000 568 fixed;    end;    implementation eqequations    collect (output) = input;implementation_end;   YouBotKinematics 1104.5 536    description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Submodel     ports      signal in H_base_0 [4,4];      signal out W_base_00 [6,1];      signal in angles_measured [5,1];      signal out torques_cmd [5,1];      signal in W_tooltip_00 [6,1];      signal out H_tooltip_0 [4,4];      signal out T_tooltip_00 [6,1];      signal in input_energy_spring [2,1];      signal out output_energy_spring [2,1];      signal in input_energy_base [2,1];      signal out output_energy_base [2,1];      signal in input_energy_arm [2,1];      signal out output_energy_arm [2,1];      signal out EnergyTank;    end;    icon bg     figures      rectangle 1044.9 410 1163.1 662 fill 14013909;      text 'name' 1107.1 526 16;     terminals      H_base_0 1160 584 fixed;      W_base_00 1160 632 fixed;      angles_measured 1160 496 fixed;      torques_cmd 1160 448 fixed;      W_tooltip_00 1048 528 fixed;      H_tooltip_0 1048 568 fixed;      T_tooltip_00 1048 552 fixed;      input_energy_spring 1048 656 fixed;      output_energy_spring 1048 616 fixed;    end;    implementation bg     submodels      AntiBug 488 280       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in port1 [6,1];         signal in port2;       end;       implementation eqvariables	real aldo;equationsaldo=port2+port1[1];implementation_end;      CalculateJ 376 128       description '<Description> <Version>4.1</Version> <LibraryPath>CalculateYoubotJ.emx</LibraryPath> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <TimeStamp>2011-1-19 15:06:55</TimeStamp> <AllowLibraryUpdate>False</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in jointVelocities [8,1];         signal out controllableJ [6,8];         signal out Htip0 [4,4];        parameters         real InitialJointPos[5,1] = [1.0; 1.0; 1.0; 1.0; 1.0];         real Linkdim[3,6] = [0.024, 0.033, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.096, 0.019, 0.155, 0.135, 0.096, 0.034];         real InitialBasePos[4,4] = [1.0, 0.0, 0.0, 1.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];       end;       icon bg top        figures         rectangle 339 106 413 150 fill 11206627;         text 'CalculateYouBot J' 376 128 16;        terminals         jointVelocities 416 128 fixed;         Htip0 336 128 fixed;       end;       implementation eqparameters	real baseoffset[3]=[0.143;  0;  0.046]; //coordinates of joint_1 constants		real hidden vx[3] = [1;0;0];	real hidden vy[3] = [0;1;0];	real hidden omegaz[3] = [0;0;1];	real hidden omega1[3] = [0;0;-1]; 	real hidden omega2[3] = [0;1;0]; 	real hidden omega3[3] = [0;1;0]; 	real hidden omega4[3] = [0;1;0]; 	real hidden omega5[3] = [0;0;-1];	variables	real uTrzrefref[6];	real uTryrefref[6];	real uTrxrefref[6];	real uTr1refref[6];	real uTr211[6];		real uTr322[6];		real uTr433[6];	real uTr544[6];	real 					R1Rot[3,3], 	R21[3,3], 	R32[3,3], 	R43[3,3], 	R54[3,3], 	Rtip5[3,3];	real 					p1Rot[3], 		p21[3], 		p32[3], 		p43[3], 		p54[3], 		ptip5[3];	real 					HrefTrans[4,4],HTransRot[4,4],	H1Rot[4,4], 	H21[4,4], 	H32[4,4], 	H43[4,4], 	H54[4,4], 	Htip5[4,4];	real 					HRot0[4,4],H10[4,4],		H20[4,4],	H30[4,4],	H40[4,4],	H50[4,4];	real  Href0[4,4],H1ref[4,4], R1ref[3,3],p1ref[3];	real base_offset_H[4,4];	real q[8];/*	real T[6];	real tildeT[4,4];	real dotH[4,4];*/	real initialq[8];real Rz[3,3];/*code	T = [0;0;jointVelocities[1];jointVelocities[3];jointVelocities[2];0];		tildeT = tilde(T);	dotH = Href0*tildeT;	Href0 = int(dotH,InitialBasePos);*/initialequations	initialq = [0;0;0;InitialJointPos[1];InitialJointPos[2];InitialJointPos[3];InitialJointPos[4];InitialJointPos[5]];equations	base_offset_H=homogeneous(eye(3),baseoffset);	q =jointVelocities;// int(jointVelocities,initialq);	Rz=[cos(q[1]), -sin(q[1]), 0; 		sin(q[1]), cos(q[1]), 	0;		 0, 					0, 					1];Href0 =homogeneous(Rz,[q[2];q[3];0])*base_offset_H;//Calculate relative positions of the jointsR1ref = [	cos(-q[4]),	-sin(-q[4]),	0;			sin(-q[4]),	cos(-q[4]),	0;			0,				0,				1];p1ref = Linkdim[1:3,1];H1ref = homogeneous(R1ref,p1ref);R21 = [	cos(q[5]),	0,	sin(q[5]);			0,				1,	0;			-sin(q[5]),	0,	cos(q[5])];p21 = Linkdim[1:3,2];H21 = homogeneous(R21,p21);R32 = [	cos(q[6]),	0,	sin(q[6]);			0,				1,	0;			-sin(q[6]),	0,	cos(q[6])];p32 = Linkdim[1:3,3];H32 = homogeneous(R32,p32);R43 = [	cos(q[7]),	0,	sin(q[7]);			0,				1,	0;			-sin(q[7]),	0,	cos(q[7])];p43 = Linkdim[1:3,4];H43 = homogeneous(R43,p43);R54 = [	cos(-q[8]),	-sin(-q[8]),	0;			sin(-q[8]),	cos(-q[8]),	0;			0,				0,				1];p54 = Linkdim[1:3,5];H54 = homogeneous(R54,p54);Rtip5 = eye(3);ptip5 = Linkdim[1:3,6];Htip5 = homogeneous(Rtip5,ptip5);//calculate position of the joints with respect to inertial frameH10 = Href0 * H1ref;H20 = H10 * H21;H30 = H20 * H32;H40 = H30 * H43;H50 = H40 * H54;Htip0 = H50 * Htip5;uTrzrefref[1:3] = omegaz; uTrzrefref[4:6] = 0;uTryrefref[1:3] = 0;uTryrefref[4:6] = vy;uTrxrefref[1:3] = 0;uTrxrefref[4:6] = vx;uTr1refref[1:3] = omega1;uTr1refref[4:6] = skew(Linkdim[1:3,1])*omega1;uTr211[1:3] = omega2;uTr211[4:6] = skew(Linkdim[1:3,2])*omega2;uTr322[1:3] = omega3;uTr322[4:6] = skew(Linkdim[1:3,3])*omega3;uTr433[1:3] = omega4;uTr433[4:6] = skew(Linkdim[1:3,4])*omega4;uTr544[1:3] = omega5;uTr544[4:6] = skew(Linkdim[1:3,5])*omega5;//Construct Geometric JacobiancontrollableJ[1:6,1] = Adjoint(Href0)*uTrzrefref;controllableJ[1:6,3] = Adjoint(Href0)*uTryrefref;controllableJ[1:6,2] = Adjoint(Href0)*uTrxrefref;controllableJ[1:6,4] = Adjoint(Href0)*uTr1refref;controllableJ[1:6,5] = Adjoint(H10)*uTr211;controllableJ[1:6,6] = Adjoint(H20)*uTr322;controllableJ[1:6,7] = Adjoint(H30)*uTr433;controllableJ[1:6,8] = Adjoint(H40)*uTr544;/*	base_offset_H=homogeneous(eye(3),baseoffset);	q =jointVelocities;// int(jointVelocities,initialq);		Rz=[cos(q[1]), -sin(q[1]), 0; 		sin(q[1]), cos(q[1]), 	0;		 0, 					0, 					1];HrefTrans =homogeneous(eye(3),[q[2];q[3];0]);HTransRot=homogeneous(Rz,[0;0;0])*base_offset_H;//Calculate relative positions of the jointsR1Rot = [	cos(-q[4]),	-sin(-q[4]),	0;			sin(-q[4]),	cos(-q[4]),	0;			0,				0,				1];p1Rot = Linkdim[1:3,1];H1Rot = homogeneous(R1Rot,p1Rot);R21 = [	cos(q[5]),	0,	sin(q[5]);			0,				1,	0;			-sin(q[5]),	0,	cos(q[5])];p21 = Linkdim[1:3,2];H21 = homogeneous(R21,p21);R32 = [	cos(q[6]),	0,	sin(q[6]);			0,				1,	0;			-sin(q[6]),	0,	cos(q[6])];p32 = Linkdim[1:3,3];H32 = homogeneous(R32,p32);R43 = [	cos(q[7]),	0,	sin(q[7]);			0,				1,	0;			-sin(q[7]),	0,	cos(q[7])];p43 = Linkdim[1:3,4];H43 = homogeneous(R43,p43);R54 = [	cos(-q[8]),	-sin(-q[8]),	0;			sin(-q[8]),	cos(-q[8]),	0;			0,				0,				1];p54 = Linkdim[1:3,5];H54 = homogeneous(R54,p54);Rtip5 = eye(3);ptip5 = Linkdim[1:3,6];Htip5 = homogeneous(Rtip5,ptip5);//calculate position of the joints with respect to inertial frameHRot0=HrefTrans*HTransRot;H10 = HRot0 * H1Rot;H20 = H10 * H21;H30 = H20 * H32;H40 = H30 * H43;H50 = H40 * H54;Htip0 = H50 * Htip5;uTrzrefref[1:3] = omegaz; uTrzrefref[4:6] = 0;uTryrefref[1:3] = 0;uTryrefref[4:6] = vy;uTrxrefref[1:3] = 0;uTrxrefref[4:6] = vx;uTr1refref[1:3] = omega1;uTr1refref[4:6] = skew(Linkdim[1:3,1])*omega1;uTr211[1:3] = omega2;uTr211[4:6] = skew(Linkdim[1:3,2])*omega2;uTr322[1:3] = omega3;uTr322[4:6] = skew(Linkdim[1:3,3])*omega3;uTr433[1:3] = omega4;uTr433[4:6] = skew(Linkdim[1:3,4])*omega4;uTr544[1:3] = omega5;uTr544[4:6] = skew(Linkdim[1:3,5])*omega5;//Construct Geometric JacobiancontrollableJ[1:6,1] = Adjoint(HrefTrans)*uTrzrefref;controllableJ[1:6,3] = Adjoint(HrefTrans)*uTryrefref;controllableJ[1:6,2] = Adjoint(HrefTrans)*uTrxrefref;controllableJ[1:6,4] = Adjoint(HRot0)*uTr1refref;controllableJ[1:6,5] = Adjoint(H10)*uTr211;controllableJ[1:6,6] = Adjoint(H20)*uTr322;controllableJ[1:6,7] = Adjoint(H30)*uTr433;controllableJ[1:6,8] = Adjoint(H40)*uTr544;*/implementation_end;      CmdDemux 560 232       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal out arm_torque [5,1];         signal out W_base_00 [6,1];         signal in effort [8,1];       end;       icon bg        figures         rectangle 544 209 576 255 fill 14013909;         text 'Mux' 560 231 16;       end;       implementation eqequations	W_base_00=[0;0;effort[1];effort[2];effort[3];0];	arm_torque=effort[4:8];implementation_end;      DiscreteDifferential 448 176       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Discrete\DiscreteDifferential.emx</LibraryPath>  <TimeStamp>2007-9-27 15:21:20</TimeStamp></Description>';       type DiscreteDifferential        ports         signal in input [8,1];         signal out output [8,1];       end;       icon bg bottom        figures         rectangle 432 158.9 464 191.5 fill 15132390;         text '-1' 457.3 181.2 color 16711680 fill 15132390 10;         text 'z' 450.7 185 color 16711680 13;         group          text 'd' 442.2 167.9 color 16711680 14;          text 'dt' 442.2 181 color 16711680 14;          line 436.2 174.5 447 174.5 color 16711680;         end;       end;       implementation eqparameters	real initial[8] = 0.0;  	// initial output valuevariables	real hidden initial_input[8];	boolean hidden initialized;initialequations	initialized = false;equations	if not initialized then 		initial_input = initial - input/sampletime; 		initialized = true;	else		initial_input = 0;	end;	output = (input - previous (input))/sampletime + initial_input;implementation_end;      EnergyEncodingArm 616 344       description '<Description>   <Version>4.1</Version>  <LibraryPath>EnergyEncodingR.emx</LibraryPath>  <TimeStamp>2012-10-30 18:54:40</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in inputMessage [2,1];         signal out inputEnergy;         signal out outputMessage [2,1];         signal in outputEnergy;       end;       icon bg        figures         rectangle 560 320 672 368 fill 14013909;         text 'name' 616 344 16;        terminals         inputMessage 672 352 fixed;         inputEnergy 560 336 fixed;         outputMessage 672 336 fixed;         outputEnergy 560 352 fixed;       end;       implementation eqparameters	real roundUp= 1000;	real MaxCounter=100;variables	real inputCount; // required to implement 'to zero' behaviour on input	real inputSum;	  // implements current state of all inputs by integraing all inputs 	real inputDiff;  // current  arrived message	real outputCount; // required to implement 'to zero' behaviour on output	real outputSum;	  // implements current state of all output by integraing all outputs 	real outputDiff;  // current  sent messageinitialequations	inputSum=0;	// initialize the input sum 	outputSum=0; 	// initialize the output sum code   // Compuation of incoming messages		//check if arrived message is less then  current input sum	if (inputMessage[1]+0.1*roundUp)<inputSum then		//if yes the input message was rounded up, thus roundup should be added to compute the increment properly		inputDiff=roundUp+inputMessage[1]-inputSum;	else		// if no the increment can be computed as simple difference		inputDiff=inputMessage[1]-inputSum;	end;	// This was a tested code; but I don't know the purose	//if inputMessage[1]==0 then	//	inputDiff=0;	//end;		// do round up and integrate	inputSum=(inputSum+inputDiff) mod roundUp;	inputEnergy=inputDiff;	 // Compuation of outgoing messages	outputCount=(previous(outputCount)+1) mod MaxCounter;	outputSum=(outputSum+outputEnergy) mod roundUp;	outputMessage[1]=outputSum;	outputMessage[2]=outputCount;implementation_end;      EnergyEncodingBase 616 416       description '<Description>   <Version>4.1</Version>  <LibraryPath>EnergyEncodingR.emx</LibraryPath>  <TimeStamp>2012-10-30 18:54:40</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in inputMessage [2,1];         signal out inputEnergy;         signal out outputMessage [2,1];         signal in outputEnergy;       end;       icon bg        figures         rectangle 560 392 672 440 fill 14013909;         text 'name' 616 416 16;        terminals         inputMessage 672 424 fixed;         inputEnergy 560 408 fixed;         outputMessage 672 408 fixed;         outputEnergy 560 424 fixed;       end;       implementation eqparameters	real roundUp= 1000;	real MaxCounter=100;variables	real inputCount; // required to implement 'to zero' behaviour on input	real inputSum;	  // implements current state of all inputs by integraing all inputs 	real inputDiff;  // current  arrived message	real outputCount; // required to implement 'to zero' behaviour on output	real outputSum;	  // implements current state of all output by integraing all outputs 	real outputDiff;  // current  sent messageinitialequations	inputSum=0;	// initialize the input sum 	outputSum=0; 	// initialize the output sum code   // Compuation of incoming messages		//check if arrived message is less then  current input sum	if (inputMessage[1]+0.1*roundUp)<inputSum then		//if yes the input message was rounded up, thus roundup should be added to compute the increment properly		inputDiff=roundUp+inputMessage[1]-inputSum;	else		// if no the increment can be computed as simple difference		inputDiff=inputMessage[1]-inputSum;	end;	// This was a tested code; but I don't know the purose	//if inputMessage[1]==0 then	//	inputDiff=0;	//end;		// do round up and integrate	inputSum=(inputSum+inputDiff) mod roundUp;	inputEnergy=inputDiff;	 // Compuation of outgoing messages	outputCount=(previous(outputCount)+1) mod MaxCounter;	outputSum=(outputSum+outputEnergy) mod roundUp;	outputMessage[1]=outputSum;	outputMessage[2]=outputCount;implementation_end;      EnergyEncodingSpring 264 384       description '<Description>   <Version>4.1</Version>  <LibraryPath>EnergyEncodingR.emx</LibraryPath>  <TimeStamp>2012-10-30 18:54:40</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in inputMessage [2,1];         signal out inputEnergy;         signal out outputMessage [2,1];         signal in outputEnergy;       end;       icon bg        figures         rectangle 208 360 320 408 fill 14013909;         text 'name' 264 384 16;        terminals         inputMessage 208 392 fixed;         inputEnergy 320 376 fixed;         outputMessage 208 376 fixed;         outputEnergy 320 392 fixed;       end;       implementation eqparameters	real roundUp= 1000;	real MaxCounter=100;variables	real inputCount; // required to implement 'to zero' behaviour on input	real inputSum;	  // implements current state of all inputs by integraing all inputs 	real inputDiff;  // current  arrived message	real outputCount; // required to implement 'to zero' behaviour on output	real outputSum;	  // implements current state of all output by integraing all outputs 	real outputDiff;  // current  sent messageinitialequations	inputSum=0;	// initialize the input sum 	outputSum=0; 	// initialize the output sum code   // Compuation of incoming messages		//check if arrived message is less then  current input sum	if (inputMessage[1]+0.1*roundUp)<inputSum then		//if yes the input message was rounded up, thus roundup should be added to compute the increment properly		inputDiff=roundUp+inputMessage[1]-inputSum;	else		// if no the increment can be computed as simple difference		inputDiff=inputMessage[1]-inputSum;	end;	// This was a tested code; but I don't know the purose	//if inputMessage[1]==0 then	//	inputDiff=0;	//end;		// do round up and integrate	inputSum=(inputSum+inputDiff) mod roundUp;	inputEnergy=inputDiff;	 // Compuation of outgoing messages	outputCount=(previous(outputCount)+1) mod MaxCounter;	outputSum=(outputSum+outputEnergy) mod roundUp;	outputMessage[1]=outputSum;	outputMessage[2]=outputCount;implementation_end;      HToAngles 624 96       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in H_vp_0 [4,4];         signal out pose [3,1];       end;       icon bg        figures         rectangle 608 80 640 112 fill 14013909;         text 'TF' 624 96 16;       end;       implementation eqvariables	real H_vp_base[4,4];	real aldo;// temporal variable to resolve numerical round up errors	real theta;// angle of rotation	real norm_omega[3]; //normolized vector of rotation	real omega[3]; //vector of rotationcode	// compute realtive pose	H_vp_base=H_vp_0;	aldo =(trace(H_vp_base[1:3,1:3])-1)/2;	// numerical errors resolution	if (aldo < -1) then aldo = -1; end;	if (aldo > 1) then aldo = 1; end;	theta= arccos(aldo);	if (theta==0) then 		norm_omega=0;	else		norm_omega = (1/(2*sin(theta)))*[	H_vp_base[3,2] - H_vp_base[2,3];											H_vp_base[1,3] - H_vp_base[3,1];											H_vp_base[2,1] - H_vp_base[1,2]];	end;	omega=theta*norm_omega;		pose[1]=omega[3];		pose[2]=H_vp_base[1,4];	pose[3]=H_vp_base[2,4];	implementation_end;      plug input_energy_spring 128 392;      plug output_energy_spring 120 376;      plug input_energy_base 768 424;      plug input_energy_arm 776 352;      plug output_energy_arm 784 336;      plug EnergyTank 448 472;      plug H_base_0 712 72;      plug T_tooltip_00 224 272;      plug H_tooltip_0 232 128;      plug W_tooltip_00 224 232;      plug torques_cmd 648 208;      plug angles_measured 672 152;      plug W_base_00 648 272;      plug output_energy_base 776 408;      PassivityLayer 448 384       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in input_energy_spring;         signal out output_energy_spring;         signal in input_energy_base;         signal out output_energy_base;         signal in input_energy_arm;         signal out output_energy_arm;         signal out EnergyTank;       end;       icon bg        figures         rectangle 406.5 324 494.5 444 fill 14013909;         text 'name' 446.5 388 16;        terminals         input_energy_spring 406.5 380 fixed;         output_energy_spring 406.5 396 fixed;         input_energy_base 494.5 396 fixed;         output_energy_base 494.5 412 fixed;         input_energy_arm 494.5 348 fixed;         output_energy_arm 494.5 364 fixed;       end;       implementation bg        submodels         EnergyTankBlock 448 160          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal out energyState;            signal in energyQuanta;          end;          implementation eqparameters	real InitialEnergyState =1{J};variables	real EnergyState;initialequations	EnergyState=InitialEnergyState;code	EnergyState=EnergyState+energyQuanta;	energyState=EnergyState;implementation_end;         Gain 448 216          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>  <TimeStamp>2007-9-26 12:15:12</TimeStamp></Description>';          type Gain           ports            signal in input;            signal out output;          end;          icon bg bottom           figures            rectangle 432.1 200 463.9 232 fill 15132390;            text 'K' 448 216 color 16711680 16 bold;          end;          implementation eqparameters	real K = 3;		// divide by number of consumersequations	output =  input/3;    implementation_end;         plug output_energy_spring 45 90;         plug input_energy_base 45 135;         plug output_energy_base 45 180;         plug input_energy_arm 72 240;         plug output_energy_arm 72 272;         plug EnergyTank 536 192;         plug input_energy_spring 45 45;         PlusMinus1 336 160          description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>  <TimeStamp>2007-9-27 10:15:13</TimeStamp></Description>';          knot PlusMinus           ports            signal knot duplicatable in plus [1];            signal knot duplicatable in minus [1];            signal knot out output [1];          end;          icon bg ellipse           figures            ellipse 328 152 344 168 fill 16777215;          end;          implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;         SETP1 216 256          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in energyState;            signal out energyQuanta;            signal out outputPackage;            signal in inputPackage;          end;          implementation eqparameters	real CommunicationTreshold=0 {J};	real SendoutPercent=0.1; //10%initialequations	outputPackage=0;	energyQuanta=0;codeif CommunicationTreshold>energyState then	outputPackage=0;	energyQuanta=inputPackage;else	outputPackage=-(CommunicationTreshold-energyState)*SendoutPercent;	energyQuanta=inputPackage-outputPackage;end;implementation_end;         SETP2 216 160          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in energyState;            signal out energyQuanta;            signal out outputPackage;            signal in inputPackage;          end;          implementation eqparameters	real CommunicationTreshold=0 {J};	real SendoutPercent=0.1; //10%initialequations	outputPackage=0;	energyQuanta=0;codeif CommunicationTreshold>energyState then	outputPackage=0;	energyQuanta=inputPackage;else	outputPackage=-(CommunicationTreshold-energyState)*SendoutPercent;	energyQuanta=inputPackage-outputPackage;end;implementation_end;         SETP3 216 64          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            signal in energyState;            signal out energyQuanta;            signal out outputPackage;            signal in inputPackage;          end;          implementation eqparameters	real CommunicationTreshold=0 {J};	real SendoutPercent=0.1; //10%initialequations	outputPackage=0;	energyQuanta=0;codeif CommunicationTreshold>energyState then	outputPackage=0;	energyQuanta=inputPackage;else	outputPackage=-(CommunicationTreshold-energyState)*SendoutPercent;	energyQuanta=inputPackage-outputPackage;end;implementation_end;         Splitter1 336 192          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [1];            signal knot in input [1];          end;          icon bg ellipse           figures            ellipse 332.8 188.8 339.2 195.2 color -1 fill 0;            ellipse 331.7 187.7 340.3 196.3 color -1;           terminals            input 336 192 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;         Splitter2 448 192          description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';          knot Splitter           ports            signal knot duplicatable out output [1];            signal knot in input [1];          end;          icon bg ellipse           figures            ellipse 444.8 188.8 451.2 195.2 color -1 fill 0;            ellipse 443.7 187.7 452.3 196.3 color -1;           terminals            input 448 192 fixed;          end;          implementation eqequations    collect (output) = input;implementation_end;        end;        connections         output_energy_arm <- SETP1\outputPackage;         input_energy_arm -> SETP1\inputPackage;         input_energy_base -> SETP2\inputPackage;         SETP2\outputPackage -> output_energy_base;         input_energy_spring -> SETP3\inputPackage;         SETP3\outputPackage -> output_energy_spring;         EnergyTankBlock\energyQuanta <- PlusMinus1\output;         Splitter2\output -> Gain\input;         Splitter2\output -> EnergyTank;         SETP3\energyQuanta -> PlusMinus1\plus;         SETP1\energyQuanta -> PlusMinus1\plus;         SETP2\energyQuanta -> PlusMinus1\plus;         EnergyTankBlock\energyState -> Splitter2\input;         Gain\output -> Splitter1\input;         Splitter1\output -> SETP1\energyState;         Splitter1\output -> SETP2\energyState;         Splitter1\output -> SETP3\energyState;        end;       implementation_end;      Splitter1 504 128       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [8,1];         signal knot in input [8,1];       end;       icon bg ellipse        figures         ellipse 500.8 124.8 507.2 131.2 color -1 fill 0;         ellipse 499.7 123.7 508.3 132.3 color -1;        terminals         input 504 128 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Splitter2 528 336       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [1];         signal knot in input [1];       end;       icon bg ellipse        figures         ellipse 524.8 332.8 531.2 339.2 color -1 fill 0;         ellipse 523.7 331.7 532.3 340.3 color -1;        terminals         input 528 336 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Splitter3 440 232       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [8,1];         signal knot in input [8,1];       end;       icon bg ellipse        figures         ellipse 436.8 228.8 443.2 235.2 color -1 fill 0;         ellipse 435.7 227.7 444.3 236.3 color -1;        terminals         input 440 232 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      Splitter4 336 264       description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';       knot Splitter        ports         signal knot duplicatable out output [6,1];         signal knot in input [6,1];       end;       icon bg ellipse        figures         ellipse 332.8 260.8 339.2 267.2 color -1 fill 0;         ellipse 331.7 259.7 340.3 268.3 color -1;        terminals         input 336 264 fixed;       end;       implementation eqequations    collect (output) = input;implementation_end;      StateMux 560 128       description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Submodel        ports         signal in arm_angles [5,1];         signal in base_pose [3,1];         signal out measured_angles [8,1];       end;       icon bg        figures         rectangle 544 105 576 151 fill 14013909;         text 'Mux' 560 127 16;       end;       implementation eqequationsmeasured_angles[1:3]=base_pose;measured_angles[4:8]=arm_angles;implementation_end;      TF 376 232       description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath> <TimeStamp>2007-9-26 12:15:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';       type Gain        ports         signal in Jacobian [6,8];         signal out joints_e [8,1];         signal in tip_e [6,1];         signal in joints_f [8,1];         signal out tip_f [6,1];       end;       icon bg bottom        figures         rectangle 360.1 216 391.9 248 fill 15132390;         text 'TF' 376 232 color 16711680 16 bold;       end;       implementation eqequations	joints_e= transpose(Jacobian)*tip_e;	tip_f= (Jacobian)*joints_f;	implementation_end;     end;     connections      H_base_0 -> HToAngles\H_vp_0;      HToAngles\pose -> StateMux\base_pose;      CmdDemux\W_base_00 -> W_base_00;      PassivityLayer\EnergyTank -> EnergyTank;      CalculateJ\controllableJ -> TF\Jacobian;      Splitter1\output -> DiscreteDifferential\input;      TF\tip_f -> Splitter4\input;      input_energy_spring -> EnergyEncodingSpring\inputMessage;      output_energy_spring <- EnergyEncodingSpring\outputMessage;      EnergyEncodingSpring\inputEnergy -> PassivityLayer\input_energy_spring;      angles_measured -> StateMux\arm_angles;      Splitter4\output -> T_tooltip_00 328 272;      input_energy_arm -> EnergyEncodingArm\inputMessage;      W_tooltip_00 -> TF\tip_e;      Splitter4\output -> AntiBug\port1;      StateMux\measured_angles -> Splitter1\input;      EnergyEncodingBase\outputEnergy <- PassivityLayer\output_energy_base;      Splitter1\output -> CalculateJ\jointVelocities;      CalculateJ\Htip0 -> H_tooltip_0;      EnergyEncodingBase\inputEnergy -> PassivityLayer\input_energy_base;      EnergyEncodingArm\outputMessage -> output_energy_arm;      EnergyEncodingBase\inputMessage <- input_energy_base;      Splitter2\output -> AntiBug\port2;      output_energy_base <- EnergyEncodingBase\outputMessage;      Splitter3\output -> CmdDemux\effort;      Splitter2\input <- EnergyEncodingArm\inputEnergy;      DiscreteDifferential\output -> TF\joints_f;      EnergyEncodingArm\outputEnergy <- PassivityLayer\output_energy_arm;      EnergyEncodingSpring\outputEnergy <- PassivityLayer\output_energy_spring;      PassivityLayer\input_energy_arm <- Splitter2\output;      TF\joints_e -> Splitter3\input;      CmdDemux\arm_torque -> torques_cmd;     end;    implementation_end;   YouBotModel 1648 536    description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';    type Submodel     ports      signal in Base_twist_cmd [3,1];      signal in Arm1_joint_cmd [5,1];      signal out Arm1_joint_states [5,1];      signal out Base_odometry_state [3,1];      signal out Arm1_joint_velocities [5,1];      signal out Base_joint_velocities [4,1];      signal out Base_joint_states [4,1];      signal in Base_joint_cmd [4,1];    end;    icon bg     figures      rectangle 1608.1 465.6 1687.9 606.4 fill 14013909;      text 'name' 1647.6 484.1;     terminals      Arm1_joint_cmd 1608 480 fixed;      Arm1_joint_states 1608 504 fixed;      Base_joint_states 1608 592 fixed;      Base_joint_cmd 1608 568 fixed;    end;    implementation bg     submodels      plug Base_twist_cmd 288 280;      plug Arm1_joint_cmd 288 264;      plug Arm1_joint_states 288 200;      plug Base_odometry_state 288 184;      plug Arm1_joint_velocities 288 232;      plug Base_joint_velocities 288 216;      plug Base_joint_states 288 248;      plug Base_joint_cmd 304 296;      OneJunction1 520 232       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';       knot OneJunction        ports         power knot duplicatable none p [9,1];         signal knot out flow [9,1];        restrictions         causality constraint one_out p;       end;       icon bg        figures         text '1' 520 232 18 bold;       end;       implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;      Plant 584 232       description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>youBot.emx</LibraryPath> <TimeStamp>2011-1-21 10:28:22</TimeStamp></Description>';       type Submodel        ports         power in joints [9,1];        parameters         real Rconstraint = 1000.0;         real Cconstraint = 1.0e-4;         real Rjoint = 0.1;         real InitialJointPos[5,1] = [-2.9496; -1.13; 2.5482; -1.789; -2.9234];         real InitialBasePos[4,4] = [1.0, 0.0, 0.0, 0.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];         real LinkI[3,6] = [20.0, 1.0, 1.0, 1.0, 1.0, 1.0; 20.0, 1.0, 1.0, 1.0, 1.0, 1.0; 20.0, 1.0, 1.0, 1.0, 1.0, 1.0];         real LinkCOMdim[3,6] = [0.01489, 0.10453, 0.001, 0.011, 0.0, 0.0; 0.00213, 0.0017, 0.0967, 0.05103, 0.00115, 0.0; 0.00213, -0.00297, 0.02107, -0.02319, -0.01683, 0.001];         real Linkdim[3,6] = [0.024, 0.033, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.096, 0.019, 0.155, 0.135, 0.096, 0.034];         real Linkm[6,1] = [20.0; 2.412; 1.155; 0.934; 0.877; 1.121];         real MinEndstopPos[5,1] = [-2.95; -1.131; -2.64; -1.79; -2.94];         real MaxEndstopPos[5,1] = [2.95; 1.57; 2.55; 1.79; 2.92];         real Wheelpos[2,4] = [0.235, 0.235, -0.235, -0.235; 0.15, -0.15, 0.15, -0.15]; "[1:2,1] = LF, [1:2,2] = RF, [1:2,3] = LR, [1:2,4] = RR "         real MecanumWheelRadius = 0.0475;         real Rwheel = 0.1;       end;       icon bg bottom        figures         rectangle 547 210 621 254 fill 11206638;         text 'youBot' 584 232 16;       end;       implementation bg        submodels         Base 368 504          description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>Link.emx</LibraryPath>  <TimeStamp>2011-1-18 16:36:40</TimeStamp><Description>Base</Description></Description>';          type Submodel           ports            power out p [6,1];            signal in Hin [4,4];            power in p1 [6,1];            signal out Hout [4,4];           parameters            real I[3,1] = [20.0; 20.0; 20.0];            real m = 20.0;            real COMdim[3,1] = [0.01489; 0.00213; 0.00213];            real dim[3,1] = [0.024; 0.0; 0.096];          end;          icon bg bottom           figures            rectangle 336 432 400 576 fill 10025880;            text 'Link' 368 504;           terminals            p 336 464 fixed;            Hin 336 544 fixed;            p1 400 464 fixed;            Hout 400 544 fixed;          end;          implementation bg           submodels            AdHi0 664 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power in p1 [6,1];               power out p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'MTF' 664 416 18 bold;             end;             implementation eqvariables 	real onlyRotH[4,4];code	//Only rotations with respect to the inertial system matter!	onlyRotH = H;	onlyRotH[1,4] = 0;	onlyRotH[2,4] = 0;	onlyRotH[3,4] = 0;							p2.e = transpose(Adjoint(onlyRotH)) * p1.e;	p1.f = Adjoint(onlyRotH) * p2.f;implementation_end;            AdHij 816 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg top              figures               text 'MTF' 816 304 18 bold;             end;             implementation eqequations	//Only rotations with respect to the inertial system matter!							p1.e = transpose(Adjoint(H)) * p2.e;	p2.f = Adjoint(H) * p1.f;implementation_end;            AdHik 664 224             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1 [6,1];               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.01489; 0.00213; 0.00213];             end;             icon bg left              figures               text 'TF' 664 224 18 bold;             end;             implementation eq//Frame in joint connected to port 1//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            AdHik1 664 368             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power out p1 [6,1];               power in p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.01489; 0.00213; 0.00213];             end;             icon bg left              figures               text 'TF' 664 368 18 bold;             end;             implementation eq//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            EJS 728 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MGY.emx</LibraryPath> <TimeStamp>2007-10-31 11:43:6</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MGY              ports               power in p1 [6,1];              parameters               real I[3,1] = [20.0; 20.0; 20.0];               real m = 20.0;             end;             icon bg top              figures               text 'MGY' 728 184 18 bold;             end;             implementation eq//EJS / Gyroscopic effectsvariables	real II[6,6]; //Inertial tensor	real Q[6,6];	real QI[6,6];	real v[3];	real omega[3];equations	II = [	I[1],0,	0,	0,	0,	0;			0,	I[2],0,	0,	0,	0;			0,	0,	I[3],0,	0,	0;			0,	0,	0,	m,	0,	0;			0,	0,	0,	0,	m,	0;			0,	0,	0,	0,	0,	m];	v[1:3] = p1.f[4:6];	omega[1:3] = p1.f[1:3];	Q[1:3,1:3] = -skew(omega);	Q[1:3,4:6] = -skew(v);	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros	Q[4:6,4:6] = -skew(omega);	QI = Q*II;	p1.e = QI*p1.f;implementation_end;            Gravity 776 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Se.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:26</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Se              ports               power out p [6,1];              restrictions               causality fixed out p;              parameters               real m = 20.0;             end;             icon bg bottom              figures               text 'Se' 776 416 18 bold;             end;             implementation eqvariables	real effort[6];equations	effort = [0;0;0;0;0;-9.8*m];	p.e = effort;implementation_end;            Hij 816 496             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>H.emx</LibraryPath>  <TimeStamp>2010-9-21 15:03:50</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input [4,4];               signal out output [4,4];               signal out Hab [4,4];              parameters               real dim[3,1] = [0.024; 0.0; 0.096];             end;             icon bg bottom              figures               rectangle 800.1 480 831.9 512 fill 15132390;               text 'H' 816 496 color 16711680 16 bold;             end;             implementation eqparameters	real baseoffset[3]=[0.143;  0;  0.046]; //coordinates of joint_1 equations	Hab = homogeneous(eye(3),dim+baseoffset);	output = input * Hab;    implementation_end;            InertialTensor 616 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\I.emx</LibraryPath> <TimeStamp>2007-9-25 12:2:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type I              ports               power in p [6,1];               signal out state [6,1];              restrictions               causality preferred in p;              parameters               real m = 1.0;               real I[3,1] = [20.0; 20.0; 20.0];             end;             icon bg top              figures               text 'I' 616 184 18 bold;             end;             implementation eqvariables	real II[6,6]; //Inertial tensorequations	II = [I[1],0,	0,	0,	0,	0;			0,	I[2],0,	0,	0,	0;			0,	0,	I[3],0,	0,	0;			0,	0,	0,	m,	0,	0;			0,	0,	0,	0,	m,	0;			0,	0,	0,	0,	0,	m];    state = int(p.e); //state = generalized momentum    p.f = inverse(II)*state;implementation_end;            plug Hout 896 496;            plug p1 904 304;            plug Hin 592 496;            plug p 592 304;            Splitter1 664 496             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;               ellipse 659.7 491.7 668.3 500.3 color -1;              terminals               input 664 496 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Ta00 720 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 720 416 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0i 664 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 664 304 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0k 664 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg top              figures               text '1' 664 184 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;           end;           connections            AdHik\p2 => Ta0k\p;            Ta00\p => AdHi0\p1;            Ta0k\p => InertialTensor\p;            Ta0i\p <= AdHik1\p1;            AdHi0\p2 => AdHik1\p2;            Gravity\p => Ta00\p;            Ta0i\p => AdHik\p1;            p <= Ta0i\p;            Ta0i\p <= AdHij\p1;            Ta0k\p => EJS\p1;            p1 => AdHij\p2;            Hin -> Splitter1\input;            Hij\output -> Hout;            Splitter1\output -> Hij\input;            Splitter1\output -> AdHi0\H;            Hij\Hab -> AdHij\H;           end;           parameterrelationsInertialTensor\I = I;InterialTensor\m = m;EJS\I = I;EJS\m = m;AdHik\COMdim = COMdim;AdHik1\COMdim = COMdim;Hij\dim = dim;Gravity\m=m;parameterrelations_end;           figures            text 'b = current link (body)a = previous link (body)i = Body fixed frame, fixed in joint with previous linkj = Body fixed frame, fixed in joint with next linkk = Body fixed frame, principal inertial frame0 = inertial system ' 352 296;          implementation_end;         Hfloor0 208 544          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Sources\Constant.emx</LibraryPath> <TimeStamp>2007-10-19 14:48:44</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Constant           ports            signal out output [4,4];          end;          icon bg bottom           figures            rectangle 192.1 528 223.9 560 fill 15132390;            line 196.9 539.6 218.9 539.6 color 16711680 width 2;            line 194.2 550.7 219.9 550.7;            line 196.5 534.7 196.5 553;          end;          implementation eqequations	output = eye(4);     implementation_end;         Htip0 1248 544          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\SignalMonitor.emx</LibraryPath> <TimeStamp>2007-9-26 12:14:4</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type SignalMonitor           ports            signal in input [4,4];          end;          icon bg bottom           figures            rectangle 1232 528 1264 560 fill 15132390;            rectangle 1237.7 533.8 1258.3 554.6 color 16711680 fill 11776947 width 2;            rectangle 1239.8 536.4 1255.9 552 color -1 fill 16777215;            line 1241.9 538.7 1241.9 550 fill 16777215;            line 1240 548.4 1252.5 548.4 fill 16777215;            line 1241.5 548.1 1254.4 541.7 color 255 fill 16777215;          end;          implementation eq   implementation_end;         Joint12 608.2 504          description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>Joint-roty.emx</LibraryPath>  <TimeStamp>2011-1-18 17:30:05</TimeStamp></Description>';          type 'Submodel-roty'           ports            power out p [6,1];            power in p1;            power in p2 [6,1];            signal in Hin [4,4];            signal out Hout [4,4];           parameters            real Rconstraint = 1000.0;            real Cconstraint = 1.0e-4;            real Rendstop = 1000.0;            real Cendstop = 1.0e-4;            real InitialPos = -1.13;            real MaxEndstopPos = 1.57;            real MinEndstopPos = -1.131;            real Rjoint = 0.1;          end;          icon bg bottom           figures            rectangle 576.4 432 639.9 576 fill 14745599;            text 'Joint-roty' 608.4 507 fill 14745599;           terminals            p 575.9 464 fixed;            p1 607.4 432 fixed;            p2 639.9 464 fixed;            Hin 575.9 544 fixed;            Hout 639.9 544 fixed;          end;          implementation bg           submodels            AdHji 424 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg bottom              figures               text 'MTF' 424 424 18 bold;             end;             implementation eqequations						p2.e = transpose(Adjoint(H)) * p1.e;	p1.f = Adjoint(H) * p2.f;implementation_end;            EndstopMax 471 217             description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Submodel              ports               power out p2;               signal boolean out collision;              parameters               real Rendstop = 1000.0;               real Cendstop = 1.0e-4;               real InitialPos = -1.13;               real EndstopPos = 1.57;             end;             icon bg bottom              figures               rectangle 422 194 520 240 fill 14013909;               text 'EndstopMax' 472 216 16;              terminals               p2 472 240 fixed;             end;             implementation bg              submodels               Cendstop 704 144                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\C.emx</LibraryPath> <TimeStamp>2007-10-31 10:43:59</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type C                 ports                  power in p;                  signal out state;                 restrictions                  causality preferred out p;                 parameters                  real Cendstop = 1.0e-4;                end;                icon bg right                 figures                  text 'C' 704 144 18 bold;                end;                implementation eqequations    state = int(p.f);    p.e = state / Cendstop;implementation_end;               Collision 704 216                description '<Description> <Version>No Version Info</Version> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type X0e                 ports                  power in p1;                  power out p2;                  power out p12;                  signal boolean out Collision;                 restrictions                  causality fixed in p12;                  causality fixed out p2;                  causality fixed out p1;                 parameters                  real InitialPos = -1.13;                  real EndstopPos = 1.57;                end;                icon bg                 figures                  text 'X0e' 704 216 18 bold;                end;                implementation bg                 submodels                  Condition1 224.9 231.5                   type Condition                    ports                     signal in dx;                     signal boolean out contact;                   end;                   icon bg                    figures                     rectangle 197.2 215 252.6 248 fill 15132390;                     text 'Condition' 224 231.5;                    terminals                     dx 224 248 fixed;                     contact 224 215 fixed;                   end;                   implementation eqparameters	real global epsilon;variables	boolean bounce;equations	contact = if dx - epsilon  < 0 then true else false end;	bounce = event (dx - epsilon);implementation_end;                  plug p1 96 176;                  plug p2 352 176;                  plug p12 224 64;                  plug Collision 408 192;                  Splitter1 224 200                   description '<Description><Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>  <TimeStamp>2007-10-31 11:27:48</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot Splitter                    ports                     signal knot boolean duplicatable out output [1];                     signal knot boolean in input [1];                   end;                   icon bg ellipse                    figures                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;                     ellipse 219.7 195.7 228.3 204.3 color -1;                    terminals                     input 224 200 fixed;                   end;                   implementation eqequations    collect (output) = input;implementation_end;                  v1 160 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 160 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v12 224 120                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg right                    figures                     text '1' 224 120 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v2 296 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 296 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  X0 224 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type X0                    ports                     mechanical in p1;                     mechanical out p2;                     mechanical out p12;                     signal boolean in condition;                    restrictions                     causality fixed out p1;                     causality fixed out p2;                     causality fixed in p12;                   end;                   icon bg                    figures                     text 'X0' 224 176 color 8388608 18 bold;                   end;                   implementation eqequations	p1.e = if condition then p12.e else 0 end;	p2.e = p1.e;	p12.f = if condition then p1.f-p2.f else 0 end; implementation_end;                  x1 160 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = 1.57;                   end;                   icon bg left                    figures                     rectangle 145 289 175 319 fill 15132390;                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                  x12 224 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot PlusMinus                    ports                     signal knot duplicatable in plus [1];                     signal knot duplicatable in minus [1];                     signal knot out output [1];                   end;                   icon bg ellipse bottom                    figures                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;                   end;                   implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;                  x2 296 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = -1.13;                   end;                   icon bg right                    figures                     rectangle 281 289 311 319 fill 15132390;                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                 end;                 connections                  v1\p => X0\p1;                  X0\p2 => v2\p;                  X0\p12 => v12\p;                  v2\p => p2;                  v12\p => p12;                  p1 => v1\p;                  v1\flow -> x1\input;                  x1\output -> x12\plus;                  v2\flow -> x2\input;                  x2\output -> x12\minus;                  x12\output -> Condition1\dx;                  Condition1\contact -> Splitter1\input;                  Splitter1\output -> X0\condition;                  Splitter1\output -> Collision;                 end;                 parameterrelationsx1\Initial = EndstopPos;x2\Initial = InitialPos;parameterrelations_end;                implementation_end;               plug p2 648 216;               plug collision 800 216;               OneJunction5 704 176                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';                knot OneJunction                 ports                  mechanical knot duplicatable none p [1];                  signal knot out flow [1];                 restrictions                  causality constraint one_out p;                end;                icon bg                 figures                  text '1' 704 176 18 bold;                end;                implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;               Rendstop 736 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type R                 ports                  power in p;                 parameters                  real Rendstop = 1000.0;                end;                icon bg bottom                 figures                  text 'R' 736 176 18 bold;                end;                implementation eqequations						p.e = Rendstop * p.f;implementation_end;               Sf1 704 264                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>  <TimeStamp>2007-9-25 12:3:35</TimeStamp></Description>';                type Sf                 ports                  power out p;                 restrictions                  causality fixed in p;                end;                icon bg bottom                 figures                  text 'Sf' 704 264 18 bold;                end;                implementation eqparameters	real flow = 0.0;variables	real effort;equations	p.f = flow;	effort = p.e;implementation_end;              end;              connections               OneJunction5\p => Cendstop\p;               Collision\p12 => OneJunction5\p;               Sf1\p => Collision\p1;               OneJunction5\p => Rendstop\p;               Collision\p2 => p2;               Collision\Collision -> collision;              end;              parameterrelationsCollision\InitialPos = InitialPos;Collision\EndstopPos = EndstopPos;Rendstop\Rendstop = Rendstop;Cendstop\Cendstop = Cendstop;parameterrelations_end;             implementation_end;            EndstopMin 312 216             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>EndstopMin.emx</LibraryPath>  <TimeStamp>2011-1-18 14:37:57</TimeStamp></Description>';             type Submodel              ports               power out p2;               signal boolean out collision;              parameters               real Cendstop = 1.0e-4;               real Rendstop = 1000.0;               real InitialPos = -1.13;               real EndstopPos = -1.131;             end;             icon bg bottom              figures               rectangle 263 193 361 239 fill 14013909;               text 'EndstopMin' 313 215 16;             end;             implementation bg              submodels               Cendstop 248 208                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\C.emx</LibraryPath> <TimeStamp>2007-10-31 10:43:59</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type C                 ports                  power in p;                  signal out state;                 restrictions                  causality preferred out p;                 parameters                  real Cendstop = 1.0e-4;                end;                icon bg right                 figures                  text 'C' 248 208 18 bold;                end;                implementation eqequations    state = int(p.f);    p.e = state / Cendstop;implementation_end;               Collision 248 120                description '<Description> <Version>No Version Info</Version> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type X0e                 ports                  power in p1;                  power out p2;                  power out p12;                  signal boolean out collision;                 restrictions                  causality fixed out p1;                  causality fixed out p2;                  causality fixed in p12;                 parameters                  real InitialPos = -1.13;                  real EndstopLocation = -1.131;                end;                icon bg                 figures                  text 'X0e' 248 120 18 bold;                end;                implementation bg                 submodels                  Condition1 224.9 231.5                   type Condition                    ports                     signal in dx;                     signal boolean out contact;                   end;                   icon bg                    figures                     rectangle 197.2 215 252.6 248 fill 15132390;                     text 'Condition' 224 231.5;                    terminals                     dx 224 248 fixed;                     contact 224 215 fixed;                   end;                   implementation eqparameters	real global epsilon;variables	boolean bounce;equations	contact = if dx - epsilon  > 0 then true else false end;	bounce = event (dx - epsilon);implementation_end;                  plug p1 96 176;                  plug p2 352 176;                  plug p12 224 64;                  plug collision 400 200;                  Splitter1 224 200                   description '<Description><Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>  <TimeStamp>2007-10-31 11:27:48</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot Splitter                    ports                     signal knot boolean duplicatable out output [1];                     signal knot boolean in input [1];                   end;                   icon bg ellipse                    figures                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;                     ellipse 219.7 195.7 228.3 204.3 color -1;                    terminals                     input 224 200 fixed;                   end;                   implementation eqequations    collect (output) = input;implementation_end;                  v1 160 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 160 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v12 224 120                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg right                    figures                     text '1' 224 120 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v2 296 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 296 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  X0 224 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type X0                    ports                     power in p1;                     power out p2;                     power out p12;                     signal boolean in condition;                    restrictions                     causality fixed out p1;                     causality fixed out p2;                     causality fixed in p12;                   end;                   icon bg                    figures                     text 'X0' 224 176 color 8388608 18 bold;                   end;                   implementation eqequations	p1.e = if condition then p12.e else 0 end;	p2.e = p1.e;	p12.f = if condition then p1.f-p2.f else 0 end; implementation_end;                  x1 160 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = -1.131;                   end;                   icon bg left                    figures                     rectangle 145 289 175 319 fill 15132390;                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                  x12 224 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot PlusMinus                    ports                     signal knot duplicatable in plus [1];                     signal knot duplicatable in minus [1];                     signal knot out output [1];                   end;                   icon bg ellipse bottom                    figures                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;                   end;                   implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;                  x2 296 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = -1.13;                   end;                   icon bg right                    figures                     rectangle 281 289 311 319 fill 15132390;                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                 end;                 connections                  v1\p => X0\p1;                  X0\p2 => v2\p;                  X0\p12 => v12\p;                  v2\p => p2;                  v12\p => p12;                  p1 => v1\p;                  v1\flow -> x1\input;                  x1\output -> x12\plus;                  v2\flow -> x2\input;                  x2\output -> x12\minus;                  x12\output -> Condition1\dx;                  Condition1\contact -> Splitter1\input;                  Splitter1\output -> X0\condition;                  Splitter1\output -> collision;                 end;                 parameterrelationsx1\Initial = EndstopLocation;x2\Initial = InitialPos;parameterrelations_end;                implementation_end;               plug p2 152 120;               plug collision 360 120;               OneJunction 248 160                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';                knot OneJunction                 ports                  power knot duplicatable none p [1];                  signal knot out flow [1];                 restrictions                  causality constraint one_out p;                end;                icon bg                 figures                  text '1' 248 160 18 bold;                end;                implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;               Rendstop 288 160                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type R                 ports                  power in p;                 parameters                  real Rendstop = 1000.0;                end;                icon bg bottom                 figures                  text 'R' 288 160 18 bold;                end;                implementation eqequations						p.e = Rendstop * p.f;implementation_end;               Sf2 248 64                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>  <TimeStamp>2007-9-25 12:3:35</TimeStamp></Description>';                type Sf                 ports                  power out p;                 restrictions                  causality fixed in p;                end;                icon bg bottom                 figures                  text 'Sf' 248 64 18 bold;                end;                implementation eqparameters	real flow = 0.0;variables	real effort;equations	p.f = flow;	effort = p.e;implementation_end;              end;              connections               Collision\p12 => OneJunction\p;               OneJunction\p => Rendstop\p;               OneJunction\p => Cendstop\p;               Sf2\p => Collision\p1;               Collision\p2 => p2;               Collision\collision -> collision;              end;              parameterrelationsCendstop\Cendstop = Cendstop;Rendstop\Rendstop = Rendstop;Collision\InitialPos = InitialPos;Collision\EndstopLocation = EndstopPos;parameterrelations_end;             implementation_end;            Integrate 320 336             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath> <TimeStamp>2007-9-26 12:3:23</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Integrate              ports               signal in input;               signal out output [4,4];              parameters               real init = -1.13;             end;             icon bg              figures               rectangle 304 320 336 352 fill 15132390;               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;             end;             implementation eqvariables	real R[3,3];	real p[3];	real q;equationsq = int(input,init);R = [	cos(q),	0,	sin(q);			0,				1,	0;			-sin(q),	0,	cos(q)];p = [0;0;0];output = homogeneous(R,p);	     implementation_end;            MatrixMul 320 496             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath> <TimeStamp>2007-9-26 12:15:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input1 [4,4];               signal out output [4,4];               signal in input2 [4,4];             end;             icon bg bottom              figures               rectangle 304.1 480 335.9 512 fill 15132390;               text 'X' 320 496 color 16711680 16 bold;             end;             implementation eqequations	output = input2*input1;    implementation_end;            plug p1 240 56;            plug p2 496 424;            plug Hin 112 496;            plug Hout 504 496;            plug p 112 424;            OneJunction 240 272             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               power knot duplicatable none p [1];               signal knot out flow [1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 240 272 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Or 392 216             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>  <TimeStamp>2007-12-18 23:20:57</TimeStamp></Description>';             type 'Or-Or'              ports               signal boolean in input1;               signal boolean out output;               signal boolean in input2;             end;             icon bg bottom              figures               rectangle 376.1 200 407.9 232 fill 15132390;               group                line 378.3 209.3 388.8 209.3 color 16711680 fill 16711680;                line 378.3 223.1 388.8 223.1 color 16711680 fill 16711680;               end;               spline 387.9 204.8 389.9 216.5 387.9 227.7 color 16711680 fill 16711680;               line 396.7 216 405.5 216 color 16711680 fill 16711680;               spline 387.7 204.3 393.9 206.6 396.8 216.4 393.6 225.4 387.7 227.7 color 16711680 fill 15132390;             end;             implementation eqequations	output = if input1 or input2 then 		true	else		false	end;      implementation_end;            Rjoint 192 272             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type R              ports               power in p;              parameters               real Rjoint = 0.1;             end;             icon bg bottom              figures               text 'R' 192 272 18 bold;             end;             implementation eqequations						p.e = Rjoint * p.f;implementation_end;            Splitter2 320 368             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;               ellipse 315.7 363.7 324.3 372.3 color -1;              terminals               input 320 368 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Tbai 240 384             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg left              figures               text '1' 240 384 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            uTbai 240 328             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1;               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real Rconstraint = 1000.0;               real Cconstraint = 1.0e-4;             end;             icon bg left              figures               text 'TF' 240 328 18 bold;             end;             implementation eqequations	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);	p2.e[2] = p1.e;	p2.e[3] = (Rconstraint*-p2.f[3] + int(-p2.f[3])/Cconstraint);	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);	p1.f = p2.f[2];implementation_end;            Wbai 240 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:43</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [6,1];               signal knot out effort [6,1];              restrictions               causality constraint one_in p;             end;             icon bg bottom              figures               text '0' 240 424 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;            ZeroJunction 240 104             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:43</TimeStamp></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [1];               signal knot out effort [1];              restrictions               causality constraint one_in p;             end;             icon bg              figures               text '0' 240 104 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;           end;           connections            p1 => ZeroJunction\p;            OneJunction\p <= EndstopMin\p2;            p2 => AdHji\p2;            OneJunction\p <= EndstopMax\p2;            OneJunction\p => Rjoint\p;            uTbai\p2 => Tbai\p;            Tbai\p => Wbai\p;            p <= Wbai\p;            ZeroJunction\p => OneJunction\p;            OneJunction\p => uTbai\p1;            Wbai\p <= AdHji\p1;            EndstopMin\collision -> Or\input2;            Hin -> MatrixMul\input2;            Integrate\output -> Splitter2\input;            Splitter2\output -> MatrixMul\input1;            EndstopMax\collision -> Or\input1;            OneJunction\flow -> Integrate\input 320 272;            Splitter2\output -> AdHji\H 424 368;            MatrixMul\output -> Hout;           end;           parameterrelationsEndstopMin\Rendstop = Rendstop;EndstopMin\Cendstop = Cendstop;EndstopMin\InitialPos = InitialPos;EndstopMin\EndstopPos = MinEndstopPos;EndstopMax\Rendstop = Rendstop;EndstopMax\Cendstop = Cendstop;EndstopMax\InitialPos = InitialPos;EndstopMax\EndstopPos = MaxEndstopPos;Rjoint\Rjoint= Rjoint;Integrate\init = InitialPos;uTbai\Rconstraint = Rconstraint;uTbai\Cconstraint = Cconstraint;parameterrelations_end;           figures            text 'b = next link (body)a = previous link (body)i = Frame fixed in previous body, fixed in jointj = Frame fixed in next body, fixed in joint ' 744 400;          implementation_end;         Joint23 768.2 504          description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>Joint-roty.emx</LibraryPath> <TimeStamp>2011-1-18 17:30:05</TimeStamp></Description>';          type 'Submodel-roty'           ports            power out p [6,1];            power in p1;            power in p2 [6,1];            signal in Hin [4,4];            signal out Hout [4,4];           parameters            real Rconstraint = 1000.0;            real Cconstraint = 1.0e-4;            real Rendstop = 1000.0;            real Cendstop = 1.0e-4;            real InitialPos = 2.5482;            real MaxEndstopPos = 2.55;            real MinEndstopPos = -2.64;            real Rjoint = 0.1;          end;          icon bg bottom           figures            rectangle 736.4 432 799.9 576 fill 14745599;            text 'Joint-roty' 768.4 507 fill 14745599;           terminals            p 735.9 464 fixed;            p1 767.4 432 fixed;            p2 799.9 464 fixed;            Hin 735.9 544 fixed;            Hout 799.9 544 fixed;          end;          implementation bg           submodels            AdHji 424 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg bottom              figures               text 'MTF' 424 424 18 bold;             end;             implementation eqequations						p2.e = transpose(Adjoint(H)) * p1.e;	p1.f = Adjoint(H) * p2.f;implementation_end;            EndstopMax 471 217             description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Submodel              ports               power out p2;               signal boolean out collision;              parameters               real Rendstop = 1000.0;               real Cendstop = 1.0e-4;               real InitialPos = 2.5482;               real EndstopPos = 2.55;             end;             icon bg bottom              figures               rectangle 422 194 520 240 fill 14013909;               text 'EndstopMax' 472 216 16;              terminals               p2 472 240 fixed;             end;             implementation bg              submodels               Cendstop 704 144                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\C.emx</LibraryPath> <TimeStamp>2007-10-31 10:43:59</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type C                 ports                  power in p;                  signal out state;                 restrictions                  causality preferred out p;                 parameters                  real Cendstop = 1.0e-4;                end;                icon bg right                 figures                  text 'C' 704 144 18 bold;                end;                implementation eqequations    state = int(p.f);    p.e = state / Cendstop;implementation_end;               Collision 704 216                description '<Description> <Version>No Version Info</Version> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type X0e                 ports                  power in p1;                  power out p2;                  power out p12;                  signal boolean out Collision;                 restrictions                  causality fixed in p12;                  causality fixed out p2;                  causality fixed out p1;                 parameters                  real InitialPos = 2.5482;                  real EndstopPos = 2.55;                end;                icon bg                 figures                  text 'X0e' 704 216 18 bold;                end;                implementation bg                 submodels                  Condition1 224.9 231.5                   type Condition                    ports                     signal in dx;                     signal boolean out contact;                   end;                   icon bg                    figures                     rectangle 197.2 215 252.6 248 fill 15132390;                     text 'Condition' 224 231.5;                    terminals                     dx 224 248 fixed;                     contact 224 215 fixed;                   end;                   implementation eqparameters	real global epsilon;variables	boolean bounce;equations	contact = if dx - epsilon  < 0 then true else false end;	bounce = event (dx - epsilon);implementation_end;                  plug p1 96 176;                  plug p2 352 176;                  plug p12 224 64;                  plug Collision 408 192;                  Splitter1 224 200                   description '<Description><Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>  <TimeStamp>2007-10-31 11:27:48</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot Splitter                    ports                     signal knot boolean duplicatable out output [1];                     signal knot boolean in input [1];                   end;                   icon bg ellipse                    figures                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;                     ellipse 219.7 195.7 228.3 204.3 color -1;                    terminals                     input 224 200 fixed;                   end;                   implementation eqequations    collect (output) = input;implementation_end;                  v1 160 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 160 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v12 224 120                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg right                    figures                     text '1' 224 120 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v2 296 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 296 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  X0 224 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type X0                    ports                     mechanical in p1;                     mechanical out p2;                     mechanical out p12;                     signal boolean in condition;                    restrictions                     causality fixed out p1;                     causality fixed out p2;                     causality fixed in p12;                   end;                   icon bg                    figures                     text 'X0' 224 176 color 8388608 18 bold;                   end;                   implementation eqequations	p1.e = if condition then p12.e else 0 end;	p2.e = p1.e;	p12.f = if condition then p1.f-p2.f else 0 end; implementation_end;                  x1 160 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = 2.55;                   end;                   icon bg left                    figures                     rectangle 145 289 175 319 fill 15132390;                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                  x12 224 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot PlusMinus                    ports                     signal knot duplicatable in plus [1];                     signal knot duplicatable in minus [1];                     signal knot out output [1];                   end;                   icon bg ellipse bottom                    figures                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;                   end;                   implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;                  x2 296 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = 2.5482;                   end;                   icon bg right                    figures                     rectangle 281 289 311 319 fill 15132390;                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                 end;                 connections                  v1\p => X0\p1;                  X0\p2 => v2\p;                  X0\p12 => v12\p;                  v2\p => p2;                  v12\p => p12;                  p1 => v1\p;                  v1\flow -> x1\input;                  x1\output -> x12\plus;                  v2\flow -> x2\input;                  x2\output -> x12\minus;                  x12\output -> Condition1\dx;                  Condition1\contact -> Splitter1\input;                  Splitter1\output -> X0\condition;                  Splitter1\output -> Collision;                 end;                 parameterrelationsx1\Initial = EndstopPos;x2\Initial = InitialPos;parameterrelations_end;                implementation_end;               plug p2 648 216;               plug collision 800 216;               OneJunction5 704 176                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';                knot OneJunction                 ports                  mechanical knot duplicatable none p [1];                  signal knot out flow [1];                 restrictions                  causality constraint one_out p;                end;                icon bg                 figures                  text '1' 704 176 18 bold;                end;                implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;               Rendstop 736 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type R                 ports                  power in p;                 parameters                  real Rendstop = 1000.0;                end;                icon bg bottom                 figures                  text 'R' 736 176 18 bold;                end;                implementation eqequations						p.e = Rendstop * p.f;implementation_end;               Sf1 704 264                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>  <TimeStamp>2007-9-25 12:3:35</TimeStamp></Description>';                type Sf                 ports                  power out p;                 restrictions                  causality fixed in p;                end;                icon bg bottom                 figures                  text 'Sf' 704 264 18 bold;                end;                implementation eqparameters	real flow = 0.0;variables	real effort;equations	p.f = flow;	effort = p.e;implementation_end;              end;              connections               OneJunction5\p => Cendstop\p;               Collision\p12 => OneJunction5\p;               Sf1\p => Collision\p1;               OneJunction5\p => Rendstop\p;               Collision\p2 => p2;               Collision\Collision -> collision;              end;              parameterrelationsCollision\InitialPos = InitialPos;Collision\EndstopPos = EndstopPos;Rendstop\Rendstop = Rendstop;Cendstop\Cendstop = Cendstop;parameterrelations_end;             implementation_end;            EndstopMin 312 216             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>EndstopMin.emx</LibraryPath>  <TimeStamp>2011-1-18 14:37:57</TimeStamp></Description>';             type Submodel              ports               power out p2;               signal boolean out collision;              parameters               real Cendstop = 1.0e-4;               real Rendstop = 1000.0;               real InitialPos = 2.5482;               real EndstopPos = -2.64;             end;             icon bg bottom              figures               rectangle 263 193 361 239 fill 14013909;               text 'EndstopMin' 313 215 16;             end;             implementation bg              submodels               Cendstop 248 208                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\C.emx</LibraryPath> <TimeStamp>2007-10-31 10:43:59</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type C                 ports                  power in p;                  signal out state;                 restrictions                  causality preferred out p;                 parameters                  real Cendstop = 1.0e-4;                end;                icon bg right                 figures                  text 'C' 248 208 18 bold;                end;                implementation eqequations    state = int(p.f);    p.e = state / Cendstop;implementation_end;               Collision 248 120                description '<Description> <Version>No Version Info</Version> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type X0e                 ports                  power in p1;                  power out p2;                  power out p12;                  signal boolean out collision;                 restrictions                  causality fixed out p1;                  causality fixed out p2;                  causality fixed in p12;                 parameters                  real InitialPos = 2.5482;                  real EndstopLocation = -2.64;                end;                icon bg                 figures                  text 'X0e' 248 120 18 bold;                end;                implementation bg                 submodels                  Condition1 224.9 231.5                   type Condition                    ports                     signal in dx;                     signal boolean out contact;                   end;                   icon bg                    figures                     rectangle 197.2 215 252.6 248 fill 15132390;                     text 'Condition' 224 231.5;                    terminals                     dx 224 248 fixed;                     contact 224 215 fixed;                   end;                   implementation eqparameters	real global epsilon;variables	boolean bounce;equations	contact = if dx - epsilon  > 0 then true else false end;	bounce = event (dx - epsilon);implementation_end;                  plug p1 96 176;                  plug p2 352 176;                  plug p12 224 64;                  plug collision 400 200;                  Splitter1 224 200                   description '<Description><Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>  <TimeStamp>2007-10-31 11:27:48</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot Splitter                    ports                     signal knot boolean duplicatable out output [1];                     signal knot boolean in input [1];                   end;                   icon bg ellipse                    figures                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;                     ellipse 219.7 195.7 228.3 204.3 color -1;                    terminals                     input 224 200 fixed;                   end;                   implementation eqequations    collect (output) = input;implementation_end;                  v1 160 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 160 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v12 224 120                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg right                    figures                     text '1' 224 120 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v2 296 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 296 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  X0 224 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type X0                    ports                     power in p1;                     power out p2;                     power out p12;                     signal boolean in condition;                    restrictions                     causality fixed out p1;                     causality fixed out p2;                     causality fixed in p12;                   end;                   icon bg                    figures                     text 'X0' 224 176 color 8388608 18 bold;                   end;                   implementation eqequations	p1.e = if condition then p12.e else 0 end;	p2.e = p1.e;	p12.f = if condition then p1.f-p2.f else 0 end; implementation_end;                  x1 160 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = -2.64;                   end;                   icon bg left                    figures                     rectangle 145 289 175 319 fill 15132390;                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                  x12 224 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot PlusMinus                    ports                     signal knot duplicatable in plus [1];                     signal knot duplicatable in minus [1];                     signal knot out output [1];                   end;                   icon bg ellipse bottom                    figures                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;                   end;                   implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;                  x2 296 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = 2.5482;                   end;                   icon bg right                    figures                     rectangle 281 289 311 319 fill 15132390;                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                 end;                 connections                  v1\p => X0\p1;                  X0\p2 => v2\p;                  X0\p12 => v12\p;                  v2\p => p2;                  v12\p => p12;                  p1 => v1\p;                  v1\flow -> x1\input;                  x1\output -> x12\plus;                  v2\flow -> x2\input;                  x2\output -> x12\minus;                  x12\output -> Condition1\dx;                  Condition1\contact -> Splitter1\input;                  Splitter1\output -> X0\condition;                  Splitter1\output -> collision;                 end;                 parameterrelationsx1\Initial = EndstopLocation;x2\Initial = InitialPos;parameterrelations_end;                implementation_end;               plug p2 152 120;               plug collision 360 120;               OneJunction 248 160                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';                knot OneJunction                 ports                  power knot duplicatable none p [1];                  signal knot out flow [1];                 restrictions                  causality constraint one_out p;                end;                icon bg                 figures                  text '1' 248 160 18 bold;                end;                implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;               Rendstop 288 160                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type R                 ports                  power in p;                 parameters                  real Rendstop = 1000.0;                end;                icon bg bottom                 figures                  text 'R' 288 160 18 bold;                end;                implementation eqequations						p.e = Rendstop * p.f;implementation_end;               Sf2 248 64                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>  <TimeStamp>2007-9-25 12:3:35</TimeStamp></Description>';                type Sf                 ports                  power out p;                 restrictions                  causality fixed in p;                end;                icon bg bottom                 figures                  text 'Sf' 248 64 18 bold;                end;                implementation eqparameters	real flow = 0.0;variables	real effort;equations	p.f = flow;	effort = p.e;implementation_end;              end;              connections               Collision\p12 => OneJunction\p;               OneJunction\p => Rendstop\p;               OneJunction\p => Cendstop\p;               Sf2\p => Collision\p1;               Collision\p2 => p2;               Collision\collision -> collision;              end;              parameterrelationsCendstop\Cendstop = Cendstop;Rendstop\Rendstop = Rendstop;Collision\InitialPos = InitialPos;Collision\EndstopLocation = EndstopPos;parameterrelations_end;             implementation_end;            Integrate 320 336             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath> <TimeStamp>2007-9-26 12:3:23</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Integrate              ports               signal in input;               signal out output [4,4];              parameters               real init = 2.5482;             end;             icon bg              figures               rectangle 304 320 336 352 fill 15132390;               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;             end;             implementation eqvariables	real R[3,3];	real p[3];	real q;equationsq = int(input,init);R = [	cos(q),	0,	sin(q);			0,				1,	0;			-sin(q),	0,	cos(q)];p = [0;0;0];output = homogeneous(R,p);	     implementation_end;            MatrixMul 320 496             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath> <TimeStamp>2007-9-26 12:15:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input1 [4,4];               signal out output [4,4];               signal in input2 [4,4];             end;             icon bg bottom              figures               rectangle 304.1 480 335.9 512 fill 15132390;               text 'X' 320 496 color 16711680 16 bold;             end;             implementation eqequations	output = input2*input1;    implementation_end;            plug p1 240 56;            plug p2 496 424;            plug Hin 112 496;            plug Hout 504 496;            plug p 112 424;            OneJunction 240 272             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               power knot duplicatable none p [1];               signal knot out flow [1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 240 272 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Or 392 216             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>  <TimeStamp>2007-12-18 23:20:57</TimeStamp></Description>';             type 'Or-Or'              ports               signal boolean in input1;               signal boolean out output;               signal boolean in input2;             end;             icon bg bottom              figures               rectangle 376.1 200 407.9 232 fill 15132390;               group                line 378.3 209.3 388.8 209.3 color 16711680 fill 16711680;                line 378.3 223.1 388.8 223.1 color 16711680 fill 16711680;               end;               spline 387.9 204.8 389.9 216.5 387.9 227.7 color 16711680 fill 16711680;               line 396.7 216 405.5 216 color 16711680 fill 16711680;               spline 387.7 204.3 393.9 206.6 396.8 216.4 393.6 225.4 387.7 227.7 color 16711680 fill 15132390;             end;             implementation eqequations	output = if input1 or input2 then 		true	else		false	end;      implementation_end;            Rjoint 192 272             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type R              ports               power in p;              parameters               real Rjoint = 0.1;             end;             icon bg bottom              figures               text 'R' 192 272 18 bold;             end;             implementation eqequations						p.e = Rjoint * p.f;implementation_end;            Splitter2 320 368             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;               ellipse 315.7 363.7 324.3 372.3 color -1;              terminals               input 320 368 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Tbai 240 384             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg left              figures               text '1' 240 384 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            uTbai 240 328             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1;               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real Rconstraint = 1000.0;               real Cconstraint = 1.0e-4;             end;             icon bg left              figures               text 'TF' 240 328 18 bold;             end;             implementation eqequations	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);	p2.e[2] = p1.e;	p2.e[3] = (Rconstraint*-p2.f[3] + int(-p2.f[3])/Cconstraint);	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);	p1.f = p2.f[2];implementation_end;            Wbai 240 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:43</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [6,1];               signal knot out effort [6,1];              restrictions               causality constraint one_in p;             end;             icon bg bottom              figures               text '0' 240 424 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;            ZeroJunction 240 104             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:43</TimeStamp></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [1];               signal knot out effort [1];              restrictions               causality constraint one_in p;             end;             icon bg              figures               text '0' 240 104 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;           end;           connections            p1 => ZeroJunction\p;            OneJunction\p => uTbai\p1;            Wbai\p <= AdHji\p1;            OneJunction\p <= EndstopMin\p2;            p2 => AdHji\p2;            OneJunction\p <= EndstopMax\p2;            OneJunction\p => Rjoint\p;            uTbai\p2 => Tbai\p;            Tbai\p => Wbai\p;            p <= Wbai\p;            ZeroJunction\p => OneJunction\p;            EndstopMin\collision -> Or\input2;            MatrixMul\output -> Hout;            Hin -> MatrixMul\input2;            Integrate\output -> Splitter2\input;            Splitter2\output -> MatrixMul\input1;            EndstopMax\collision -> Or\input1;            OneJunction\flow -> Integrate\input 320 272;            Splitter2\output -> AdHji\H 424 368;           end;           parameterrelationsEndstopMin\Rendstop = Rendstop;EndstopMin\Cendstop = Cendstop;EndstopMin\InitialPos = InitialPos;EndstopMin\EndstopPos = MinEndstopPos;EndstopMax\Rendstop = Rendstop;EndstopMax\Cendstop = Cendstop;EndstopMax\InitialPos = InitialPos;EndstopMax\EndstopPos = MaxEndstopPos;Rjoint\Rjoint= Rjoint;Integrate\init = InitialPos;uTbai\Rconstraint = Rconstraint;uTbai\Cconstraint = Cconstraint;parameterrelations_end;           figures            text 'b = next link (body)a = previous link (body)i = Frame fixed in previous body, fixed in jointj = Frame fixed in next body, fixed in joint ' 744 400;          implementation_end;         Joint34 928.2 504          description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>Joint-roty.emx</LibraryPath> <TimeStamp>2011-1-18 17:30:05</TimeStamp></Description>';          type 'Submodel-roty'           ports            power out p [6,1];            power in p1;            power in p2 [6,1];            signal in Hin [4,4];            signal out Hout [4,4];           parameters            real Rconstraint = 1000.0;            real Cconstraint = 1.0e-4;            real Rendstop = 1000.0;            real Cendstop = 1.0e-4;            real InitialPos = -1.789;            real MaxEndstopPos = 1.79;            real MinEndstopPos = -1.79;            real Rjoint = 0.1;          end;          icon bg bottom           figures            rectangle 896.4 432 959.9 576 fill 14745599;            text 'Joint-roty' 928.4 507 fill 14745599;           terminals            p 895.9 464 fixed;            p1 927.4 432 fixed;            p2 959.9 464 fixed;            Hin 895.9 544 fixed;            Hout 959.9 544 fixed;          end;          implementation bg           submodels            AdHji 424 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg bottom              figures               text 'MTF' 424 424 18 bold;             end;             implementation eqequations						p2.e = transpose(Adjoint(H)) * p1.e;	p1.f = Adjoint(H) * p2.f;implementation_end;            EndstopMax 471 217             description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Submodel              ports               power out p2;               signal boolean out collision;              parameters               real Rendstop = 1000.0;               real Cendstop = 1.0e-4;               real InitialPos = -1.789;               real EndstopPos = 1.79;             end;             icon bg bottom              figures               rectangle 422 194 520 240 fill 14013909;               text 'EndstopMax' 472 216 16;              terminals               p2 472 240 fixed;             end;             implementation bg              submodels               Cendstop 704 144                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\C.emx</LibraryPath> <TimeStamp>2007-10-31 10:43:59</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type C                 ports                  power in p;                  signal out state;                 restrictions                  causality preferred out p;                 parameters                  real Cendstop = 1.0e-4;                end;                icon bg right                 figures                  text 'C' 704 144 18 bold;                end;                implementation eqequations    state = int(p.f);    p.e = state / Cendstop;implementation_end;               Collision 704 216                description '<Description> <Version>No Version Info</Version> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type X0e                 ports                  power in p1;                  power out p2;                  power out p12;                  signal boolean out Collision;                 restrictions                  causality fixed in p12;                  causality fixed out p2;                  causality fixed out p1;                 parameters                  real InitialPos = -1.789;                  real EndstopPos = 1.79;                end;                icon bg                 figures                  text 'X0e' 704 216 18 bold;                end;                implementation bg                 submodels                  Condition1 224.9 231.5                   type Condition                    ports                     signal in dx;                     signal boolean out contact;                   end;                   icon bg                    figures                     rectangle 197.2 215 252.6 248 fill 15132390;                     text 'Condition' 224 231.5;                    terminals                     dx 224 248 fixed;                     contact 224 215 fixed;                   end;                   implementation eqparameters	real global epsilon;variables	boolean bounce;equations	contact = if dx - epsilon  < 0 then true else false end;	bounce = event (dx - epsilon);implementation_end;                  plug p1 96 176;                  plug p2 352 176;                  plug p12 224 64;                  plug Collision 408 192;                  Splitter1 224 200                   description '<Description><Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>  <TimeStamp>2007-10-31 11:27:48</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot Splitter                    ports                     signal knot boolean duplicatable out output [1];                     signal knot boolean in input [1];                   end;                   icon bg ellipse                    figures                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;                     ellipse 219.7 195.7 228.3 204.3 color -1;                    terminals                     input 224 200 fixed;                   end;                   implementation eqequations    collect (output) = input;implementation_end;                  v1 160 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 160 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v12 224 120                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg right                    figures                     text '1' 224 120 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v2 296 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 296 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  X0 224 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type X0                    ports                     mechanical in p1;                     mechanical out p2;                     mechanical out p12;                     signal boolean in condition;                    restrictions                     causality fixed out p1;                     causality fixed out p2;                     causality fixed in p12;                   end;                   icon bg                    figures                     text 'X0' 224 176 color 8388608 18 bold;                   end;                   implementation eqequations	p1.e = if condition then p12.e else 0 end;	p2.e = p1.e;	p12.f = if condition then p1.f-p2.f else 0 end; implementation_end;                  x1 160 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = 1.79;                   end;                   icon bg left                    figures                     rectangle 145 289 175 319 fill 15132390;                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                  x12 224 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot PlusMinus                    ports                     signal knot duplicatable in plus [1];                     signal knot duplicatable in minus [1];                     signal knot out output [1];                   end;                   icon bg ellipse bottom                    figures                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;                   end;                   implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;                  x2 296 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = -1.789;                   end;                   icon bg right                    figures                     rectangle 281 289 311 319 fill 15132390;                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                 end;                 connections                  v1\p => X0\p1;                  X0\p2 => v2\p;                  X0\p12 => v12\p;                  v2\p => p2;                  v12\p => p12;                  p1 => v1\p;                  v1\flow -> x1\input;                  x1\output -> x12\plus;                  v2\flow -> x2\input;                  x2\output -> x12\minus;                  x12\output -> Condition1\dx;                  Condition1\contact -> Splitter1\input;                  Splitter1\output -> X0\condition;                  Splitter1\output -> Collision;                 end;                 parameterrelationsx1\Initial = EndstopPos;x2\Initial = InitialPos;parameterrelations_end;                implementation_end;               plug p2 648 216;               plug collision 800 216;               OneJunction5 704 176                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';                knot OneJunction                 ports                  mechanical knot duplicatable none p [1];                  signal knot out flow [1];                 restrictions                  causality constraint one_out p;                end;                icon bg                 figures                  text '1' 704 176 18 bold;                end;                implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;               Rendstop 736 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type R                 ports                  power in p;                 parameters                  real Rendstop = 1000.0;                end;                icon bg bottom                 figures                  text 'R' 736 176 18 bold;                end;                implementation eqequations						p.e = Rendstop * p.f;implementation_end;               Sf1 704 264                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>  <TimeStamp>2007-9-25 12:3:35</TimeStamp></Description>';                type Sf                 ports                  power out p;                 restrictions                  causality fixed in p;                end;                icon bg bottom                 figures                  text 'Sf' 704 264 18 bold;                end;                implementation eqparameters	real flow = 0.0;variables	real effort;equations	p.f = flow;	effort = p.e;implementation_end;              end;              connections               OneJunction5\p => Cendstop\p;               Collision\p12 => OneJunction5\p;               Sf1\p => Collision\p1;               OneJunction5\p => Rendstop\p;               Collision\p2 => p2;               Collision\Collision -> collision;              end;              parameterrelationsCollision\InitialPos = InitialPos;Collision\EndstopPos = EndstopPos;Rendstop\Rendstop = Rendstop;Cendstop\Cendstop = Cendstop;parameterrelations_end;             implementation_end;            EndstopMin 312 216             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>EndstopMin.emx</LibraryPath>  <TimeStamp>2011-1-18 14:37:57</TimeStamp></Description>';             type Submodel              ports               power out p2;               signal boolean out collision;              parameters               real Cendstop = 1.0e-4;               real Rendstop = 1000.0;               real InitialPos = -1.789;               real EndstopPos = -1.79;             end;             icon bg bottom              figures               rectangle 263 193 361 239 fill 14013909;               text 'EndstopMin' 313 215 16;             end;             implementation bg              submodels               Cendstop 248 208                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\C.emx</LibraryPath> <TimeStamp>2007-10-31 10:43:59</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type C                 ports                  power in p;                  signal out state;                 restrictions                  causality preferred out p;                 parameters                  real Cendstop = 1.0e-4;                end;                icon bg right                 figures                  text 'C' 248 208 18 bold;                end;                implementation eqequations    state = int(p.f);    p.e = state / Cendstop;implementation_end;               Collision 248 120                description '<Description> <Version>No Version Info</Version> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type X0e                 ports                  power in p1;                  power out p2;                  power out p12;                  signal boolean out collision;                 restrictions                  causality fixed out p1;                  causality fixed out p2;                  causality fixed in p12;                 parameters                  real InitialPos = -1.789;                  real EndstopLocation = -1.79;                end;                icon bg                 figures                  text 'X0e' 248 120 18 bold;                end;                implementation bg                 submodels                  Condition1 224.9 231.5                   type Condition                    ports                     signal in dx;                     signal boolean out contact;                   end;                   icon bg                    figures                     rectangle 197.2 215 252.6 248 fill 15132390;                     text 'Condition' 224 231.5;                    terminals                     dx 224 248 fixed;                     contact 224 215 fixed;                   end;                   implementation eqparameters	real global epsilon;variables	boolean bounce;equations	contact = if dx - epsilon  > 0 then true else false end;	bounce = event (dx - epsilon);implementation_end;                  plug p1 96 176;                  plug p2 352 176;                  plug p12 224 64;                  plug collision 400 200;                  Splitter1 224 200                   description '<Description><Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>  <TimeStamp>2007-10-31 11:27:48</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot Splitter                    ports                     signal knot boolean duplicatable out output [1];                     signal knot boolean in input [1];                   end;                   icon bg ellipse                    figures                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;                     ellipse 219.7 195.7 228.3 204.3 color -1;                    terminals                     input 224 200 fixed;                   end;                   implementation eqequations    collect (output) = input;implementation_end;                  v1 160 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 160 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v12 224 120                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg right                    figures                     text '1' 224 120 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v2 296 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 296 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  X0 224 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type X0                    ports                     power in p1;                     power out p2;                     power out p12;                     signal boolean in condition;                    restrictions                     causality fixed out p1;                     causality fixed out p2;                     causality fixed in p12;                   end;                   icon bg                    figures                     text 'X0' 224 176 color 8388608 18 bold;                   end;                   implementation eqequations	p1.e = if condition then p12.e else 0 end;	p2.e = p1.e;	p12.f = if condition then p1.f-p2.f else 0 end; implementation_end;                  x1 160 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = -1.79;                   end;                   icon bg left                    figures                     rectangle 145 289 175 319 fill 15132390;                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                  x12 224 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot PlusMinus                    ports                     signal knot duplicatable in plus [1];                     signal knot duplicatable in minus [1];                     signal knot out output [1];                   end;                   icon bg ellipse bottom                    figures                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;                   end;                   implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;                  x2 296 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = -1.789;                   end;                   icon bg right                    figures                     rectangle 281 289 311 319 fill 15132390;                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                 end;                 connections                  v1\p => X0\p1;                  X0\p2 => v2\p;                  X0\p12 => v12\p;                  v2\p => p2;                  v12\p => p12;                  p1 => v1\p;                  v1\flow -> x1\input;                  x1\output -> x12\plus;                  v2\flow -> x2\input;                  x2\output -> x12\minus;                  x12\output -> Condition1\dx;                  Condition1\contact -> Splitter1\input;                  Splitter1\output -> X0\condition;                  Splitter1\output -> collision;                 end;                 parameterrelationsx1\Initial = EndstopLocation;x2\Initial = InitialPos;parameterrelations_end;                implementation_end;               plug p2 152 120;               plug collision 360 120;               OneJunction 248 160                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';                knot OneJunction                 ports                  power knot duplicatable none p [1];                  signal knot out flow [1];                 restrictions                  causality constraint one_out p;                end;                icon bg                 figures                  text '1' 248 160 18 bold;                end;                implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;               Rendstop 288 160                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type R                 ports                  power in p;                 parameters                  real Rendstop = 1000.0;                end;                icon bg bottom                 figures                  text 'R' 288 160 18 bold;                end;                implementation eqequations						p.e = Rendstop * p.f;implementation_end;               Sf2 248 64                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>  <TimeStamp>2007-9-25 12:3:35</TimeStamp></Description>';                type Sf                 ports                  power out p;                 restrictions                  causality fixed in p;                end;                icon bg bottom                 figures                  text 'Sf' 248 64 18 bold;                end;                implementation eqparameters	real flow = 0.0;variables	real effort;equations	p.f = flow;	effort = p.e;implementation_end;              end;              connections               Collision\p12 => OneJunction\p;               OneJunction\p => Rendstop\p;               OneJunction\p => Cendstop\p;               Sf2\p => Collision\p1;               Collision\p2 => p2;               Collision\collision -> collision;              end;              parameterrelationsCendstop\Cendstop = Cendstop;Rendstop\Rendstop = Rendstop;Collision\InitialPos = InitialPos;Collision\EndstopLocation = EndstopPos;parameterrelations_end;             implementation_end;            Integrate 320 336             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath> <TimeStamp>2007-9-26 12:3:23</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Integrate              ports               signal in input;               signal out output [4,4];              parameters               real init = -1.789;             end;             icon bg              figures               rectangle 304 320 336 352 fill 15132390;               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;             end;             implementation eqvariables	real R[3,3];	real p[3];	real q;equationsq = int(input,init);R = [	cos(q),	0,	sin(q);			0,				1,	0;			-sin(q),	0,	cos(q)];p = [0;0;0];output = homogeneous(R,p);	     implementation_end;            MatrixMul 320 496             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath> <TimeStamp>2007-9-26 12:15:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input1 [4,4];               signal out output [4,4];               signal in input2 [4,4];             end;             icon bg bottom              figures               rectangle 304.1 480 335.9 512 fill 15132390;               text 'X' 320 496 color 16711680 16 bold;             end;             implementation eqequations	output = input2*input1;    implementation_end;            plug p1 240 56;            plug p2 496 424;            plug Hin 112 496;            plug Hout 504 496;            plug p 112 424;            OneJunction 240 272             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               power knot duplicatable none p [1];               signal knot out flow [1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 240 272 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Or 392 216             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>  <TimeStamp>2007-12-18 23:20:57</TimeStamp></Description>';             type 'Or-Or'              ports               signal boolean in input1;               signal boolean out output;               signal boolean in input2;             end;             icon bg bottom              figures               rectangle 376.1 200 407.9 232 fill 15132390;               group                line 378.3 209.3 388.8 209.3 color 16711680 fill 16711680;                line 378.3 223.1 388.8 223.1 color 16711680 fill 16711680;               end;               spline 387.9 204.8 389.9 216.5 387.9 227.7 color 16711680 fill 16711680;               line 396.7 216 405.5 216 color 16711680 fill 16711680;               spline 387.7 204.3 393.9 206.6 396.8 216.4 393.6 225.4 387.7 227.7 color 16711680 fill 15132390;             end;             implementation eqequations	output = if input1 or input2 then 		true	else		false	end;      implementation_end;            Rjoint 192 272             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type R              ports               power in p;              parameters               real Rjoint = 0.1;             end;             icon bg bottom              figures               text 'R' 192 272 18 bold;             end;             implementation eqequations						p.e = Rjoint * p.f;implementation_end;            Splitter2 320 368             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;               ellipse 315.7 363.7 324.3 372.3 color -1;              terminals               input 320 368 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Tbai 240 384             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg left              figures               text '1' 240 384 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            uTbai 240 328             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1;               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real Rconstraint = 1000.0;               real Cconstraint = 1.0e-4;             end;             icon bg left              figures               text 'TF' 240 328 18 bold;             end;             implementation eqequations	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);	p2.e[2] = p1.e;	p2.e[3] = (Rconstraint*-p2.f[3] + int(-p2.f[3])/Cconstraint);	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);	p1.f = p2.f[2];implementation_end;            Wbai 240 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:43</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [6,1];               signal knot out effort [6,1];              restrictions               causality constraint one_in p;             end;             icon bg bottom              figures               text '0' 240 424 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;            ZeroJunction 240 104             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:43</TimeStamp></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [1];               signal knot out effort [1];              restrictions               causality constraint one_in p;             end;             icon bg              figures               text '0' 240 104 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;           end;           connections            p1 => ZeroJunction\p;            OneJunction\p <= EndstopMax\p2;            OneJunction\p => Rjoint\p;            uTbai\p2 => Tbai\p;            Tbai\p => Wbai\p;            p <= Wbai\p;            ZeroJunction\p => OneJunction\p;            OneJunction\p => uTbai\p1;            Wbai\p <= AdHji\p1;            OneJunction\p <= EndstopMin\p2;            p2 => AdHji\p2;            EndstopMin\collision -> Or\input2;            Integrate\output -> Splitter2\input;            Splitter2\output -> MatrixMul\input1;            EndstopMax\collision -> Or\input1;            OneJunction\flow -> Integrate\input 320 272;            Splitter2\output -> AdHji\H 424 368;            MatrixMul\output -> Hout;            Hin -> MatrixMul\input2;           end;           parameterrelationsEndstopMin\Rendstop = Rendstop;EndstopMin\Cendstop = Cendstop;EndstopMin\InitialPos = InitialPos;EndstopMin\EndstopPos = MinEndstopPos;EndstopMax\Rendstop = Rendstop;EndstopMax\Cendstop = Cendstop;EndstopMax\InitialPos = InitialPos;EndstopMax\EndstopPos = MaxEndstopPos;Rjoint\Rjoint= Rjoint;Integrate\init = InitialPos;uTbai\Rconstraint = Rconstraint;uTbai\Cconstraint = Cconstraint;parameterrelations_end;           figures            text 'b = next link (body)a = previous link (body)i = Frame fixed in previous body, fixed in jointj = Frame fixed in next body, fixed in joint ' 744 400;          implementation_end;         Joint45 1088.2 504          description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>Joint-rotz.emx</LibraryPath> <TimeStamp>2011-1-18 17:30:00</TimeStamp></Description>';          type 'Submodel-rotz'           ports            power out p [6,1];            power in p1;            power in p2 [6,1];            signal in Hin [4,4];            signal out Hout [4,4];           parameters            real Rendstop = 1000.0;            real Cendstop = 1.0e-4;            real InitialPos = -2.9234;            real MinEndstopPos = -2.94;            real MaxEndstopPos = 2.92;            real Rconstraint = 1000.0;            real Cconstraint = 1.0e-4;            real Rjoint = 0.1;          end;          icon bg bottom           figures            rectangle 1056.4 432 1119.9 576 fill 14745599;            text 'Joint-rotz' 1088.4 507 fill 14745599;           terminals            p 1055.9 464 fixed;            p1 1087.4 432 fixed;            p2 1119.9 464 fixed;            Hin 1055.9 544 fixed;            Hout 1119.9 544 fixed;          end;          implementation bg           submodels            AdHji 424 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg bottom              figures               text 'MTF' 424 424 18 bold;             end;             implementation eqequations						p2.e = transpose(Adjoint(H)) * p1.e;	p1.f = Adjoint(H) * p2.f;implementation_end;            EndstopMax 479 225             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>EndstopMax.emx</LibraryPath>  <TimeStamp>2011-1-18 16:54:54</TimeStamp></Description>';             type Submodel              ports               power out p2;               signal boolean out collision;              parameters               real Rendstop = 1000.0;               real Cendstop = 1.0e-4;               real InitialPos = -2.9234;               real EndstopPos = 2.92;             end;             icon bg bottom              figures               rectangle 430 202 528 248 fill 14013909;               text 'EndstopMax' 480 224 16;              terminals               p2 480 248 fixed;             end;             implementation bg              submodels               Cendstop 704 144                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\C.emx</LibraryPath> <TimeStamp>2007-10-31 10:43:59</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type C                 ports                  power in p;                  signal out state;                 restrictions                  causality preferred out p;                 parameters                  real Cendstop = 1.0e-4;                end;                icon bg right                 figures                  text 'C' 704 144 18 bold;                end;                implementation eqequations    state = int(p.f);    p.e = state / Cendstop;implementation_end;               Collision 704 216                description '<Description> <Version>No Version Info</Version> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type X0e                 ports                  power in p1;                  power out p2;                  power out p12;                  signal boolean out Collision;                 restrictions                  causality fixed out p2;                  causality fixed out p1;                  causality fixed in p12;                 parameters                  real InitialPos = -2.9234;                  real EndstopPos = 2.92;                end;                icon bg                 figures                  text 'X0e' 704 216 18 bold;                end;                implementation bg                 submodels                  Condition1 224.9 231.5                   type Condition                    ports                     signal in dx;                     signal boolean out contact;                   end;                   icon bg                    figures                     rectangle 197.2 215 252.6 248 fill 15132390;                     text 'Condition' 224 231.5;                    terminals                     dx 224 248 fixed;                     contact 224 215 fixed;                   end;                   implementation eqparameters	real global epsilon;variables	boolean bounce;equations	contact = if dx - epsilon  < 0 then true else false end;	bounce = event (dx - epsilon);implementation_end;                  plug p1 96 176;                  plug p2 352 176;                  plug p12 224 64;                  plug Collision 408 192;                  Splitter1 224 200                   description '<Description><Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>  <TimeStamp>2007-10-31 11:27:48</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot Splitter                    ports                     signal knot boolean duplicatable out output [1];                     signal knot boolean in input [1];                   end;                   icon bg ellipse                    figures                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;                     ellipse 219.7 195.7 228.3 204.3 color -1;                    terminals                     input 224 200 fixed;                   end;                   implementation eqequations    collect (output) = input;implementation_end;                  v1 160 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 160 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v12 224 120                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg right                    figures                     text '1' 224 120 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v2 296 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 296 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  X0 224 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type X0                    ports                     mechanical in p1;                     mechanical out p2;                     mechanical out p12;                     signal boolean in condition;                    restrictions                     causality fixed out p1;                     causality fixed out p2;                     causality fixed in p12;                   end;                   icon bg                    figures                     text 'X0' 224 176 color 8388608 18 bold;                   end;                   implementation eqequations	p1.e = if condition then p12.e else 0 end;	p2.e = p1.e;	p12.f = if condition then p1.f-p2.f else 0 end; implementation_end;                  x1 160 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = 2.92;                   end;                   icon bg left                    figures                     rectangle 145 289 175 319 fill 15132390;                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                  x12 224 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot PlusMinus                    ports                     signal knot duplicatable in plus [1];                     signal knot duplicatable in minus [1];                     signal knot out output [1];                   end;                   icon bg ellipse bottom                    figures                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;                   end;                   implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;                  x2 296 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = -2.9234;                   end;                   icon bg right                    figures                     rectangle 281 289 311 319 fill 15132390;                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                 end;                 connections                  v1\p => X0\p1;                  X0\p2 => v2\p;                  X0\p12 => v12\p;                  v2\p => p2;                  v12\p => p12;                  p1 => v1\p;                  v1\flow -> x1\input;                  x1\output -> x12\plus;                  v2\flow -> x2\input;                  x2\output -> x12\minus;                  x12\output -> Condition1\dx;                  Condition1\contact -> Splitter1\input;                  Splitter1\output -> X0\condition;                  Splitter1\output -> Collision;                 end;                 parameterrelationsx1\Initial = EndstopPos;x2\Initial = InitialPos;parameterrelations_end;                implementation_end;               plug p2 648 216;               plug collision 800 216;               OneJunction5 704 176                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';                knot OneJunction                 ports                  mechanical knot duplicatable none p [1];                  signal knot out flow [1];                 restrictions                  causality constraint one_out p;                end;                icon bg                 figures                  text '1' 704 176 18 bold;                end;                implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;               Rendstop 736 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type R                 ports                  power in p;                 parameters                  real Rendstop = 1000.0;                end;                icon bg bottom                 figures                  text 'R' 736 176 18 bold;                end;                implementation eqequations						p.e = Rendstop * p.f;implementation_end;               Sf1 704 264                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>  <TimeStamp>2007-9-25 12:3:35</TimeStamp></Description>';                type Sf                 ports                  power out p;                 restrictions                  causality fixed in p;                end;                icon bg bottom                 figures                  text 'Sf' 704 264 18 bold;                end;                implementation eqparameters	real flow = 0.0;variables	real effort;equations	p.f = flow;	effort = p.e;implementation_end;              end;              connections               OneJunction5\p => Cendstop\p;               Collision\p12 => OneJunction5\p;               Sf1\p => Collision\p1;               OneJunction5\p => Rendstop\p;               Collision\p2 => p2;               Collision\Collision -> collision;              end;              parameterrelationsCollision\InitialPos = InitialPos;Collision\EndstopPos = EndstopPos;Rendstop\Rendstop = Rendstop;Cendstop\Cendstop = Cendstop;parameterrelations_end;             implementation_end;            EndstopMin 320 224             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>EndstopMin.emx</LibraryPath>  <TimeStamp>2011-1-18 16:54:44</TimeStamp></Description>';             type Submodel              ports               power out p2;               signal boolean out collision;              parameters               real Cendstop = 1.0e-4;               real Rendstop = 1000.0;               real InitialPos = -2.9234;               real EndstopPos = -2.94;             end;             icon bg bottom              figures               rectangle 271 201 369 247 fill 14013909;               text 'EndstopMin' 321 223 16;             end;             implementation bg              submodels               Cendstop 248 208                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\C.emx</LibraryPath> <TimeStamp>2007-10-31 10:43:59</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type C                 ports                  power in p;                  signal out state;                 restrictions                  causality preferred out p;                 parameters                  real Cendstop = 1.0e-4;                end;                icon bg right                 figures                  text 'C' 248 208 18 bold;                end;                implementation eqequations    state = int(p.f);    p.e = state / Cendstop;implementation_end;               Collision 248 120                description '<Description> <Version>No Version Info</Version> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type X0e                 ports                  power in p1;                  power out p2;                  power out p12;                  signal boolean out collision;                 restrictions                  causality fixed out p1;                  causality fixed out p2;                  causality fixed in p12;                 parameters                  real InitialPos = -2.9234;                  real EndstopLocation = -2.94;                end;                icon bg                 figures                  text 'X0e' 248 120 18 bold;                end;                implementation bg                 submodels                  Condition1 224.9 231.5                   type Condition                    ports                     signal in dx;                     signal boolean out contact;                   end;                   icon bg                    figures                     rectangle 197.2 215 252.6 248 fill 15132390;                     text 'Condition' 224 231.5;                    terminals                     dx 224 248 fixed;                     contact 224 215 fixed;                   end;                   implementation eqparameters	real global epsilon;variables	boolean bounce;equations	contact = if dx - epsilon  > 0 then true else false end;	bounce = event (dx - epsilon);implementation_end;                  plug p1 96 176;                  plug p2 352 176;                  plug p12 224 64;                  plug collision 400 200;                  Splitter1 224 200                   description '<Description><Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>  <TimeStamp>2007-10-31 11:27:48</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot Splitter                    ports                     signal knot boolean duplicatable out output [1];                     signal knot boolean in input [1];                   end;                   icon bg ellipse                    figures                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;                     ellipse 219.7 195.7 228.3 204.3 color -1;                    terminals                     input 224 200 fixed;                   end;                   implementation eqequations    collect (output) = input;implementation_end;                  v1 160 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 160 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v12 224 120                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg right                    figures                     text '1' 224 120 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v2 296 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 296 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  X0 224 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type X0                    ports                     power in p1;                     power out p2;                     power out p12;                     signal boolean in condition;                    restrictions                     causality fixed out p1;                     causality fixed out p2;                     causality fixed in p12;                   end;                   icon bg                    figures                     text 'X0' 224 176 color 8388608 18 bold;                   end;                   implementation eqequations	p1.e = if condition then p12.e else 0 end;	p2.e = p1.e;	p12.f = if condition then p1.f-p2.f else 0 end; implementation_end;                  x1 160 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = -2.94;                   end;                   icon bg left                    figures                     rectangle 145 289 175 319 fill 15132390;                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                  x12 224 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot PlusMinus                    ports                     signal knot duplicatable in plus [1];                     signal knot duplicatable in minus [1];                     signal knot out output [1];                   end;                   icon bg ellipse bottom                    figures                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;                   end;                   implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;                  x2 296 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = -2.9234;                   end;                   icon bg right                    figures                     rectangle 281 289 311 319 fill 15132390;                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                 end;                 connections                  v1\p => X0\p1;                  X0\p2 => v2\p;                  X0\p12 => v12\p;                  v2\p => p2;                  v12\p => p12;                  p1 => v1\p;                  v1\flow -> x1\input;                  x1\output -> x12\plus;                  v2\flow -> x2\input;                  x2\output -> x12\minus;                  x12\output -> Condition1\dx;                  Condition1\contact -> Splitter1\input;                  Splitter1\output -> X0\condition;                  Splitter1\output -> collision;                 end;                 parameterrelationsx1\Initial = EndstopLocation;x2\Initial = InitialPos;parameterrelations_end;                implementation_end;               plug p2 152 120;               plug collision 360 120;               OneJunction 248 160                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';                knot OneJunction                 ports                  power knot duplicatable none p [1];                  signal knot out flow [1];                 restrictions                  causality constraint one_out p;                end;                icon bg                 figures                  text '1' 248 160 18 bold;                end;                implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;               Rendstop 288 160                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type R                 ports                  power in p;                 parameters                  real Rendstop = 1000.0;                end;                icon bg bottom                 figures                  text 'R' 288 160 18 bold;                end;                implementation eqequations						p.e = Rendstop * p.f;implementation_end;               Sf2 248 64                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>  <TimeStamp>2007-9-25 12:3:35</TimeStamp></Description>';                type Sf                 ports                  power out p;                 restrictions                  causality fixed in p;                end;                icon bg bottom                 figures                  text 'Sf' 248 64 18 bold;                end;                implementation eqparameters	real flow = 0.0;variables	real effort;equations	p.f = flow;	effort = p.e;implementation_end;              end;              connections               Collision\p12 => OneJunction\p;               OneJunction\p => Rendstop\p;               OneJunction\p => Cendstop\p;               Sf2\p => Collision\p1;               Collision\p2 => p2;               Collision\collision -> collision;              end;              parameterrelationsCendstop\Cendstop = Cendstop;Rendstop\Rendstop = Rendstop;Collision\InitialPos = InitialPos;Collision\EndstopLocation = EndstopPos;parameterrelations_end;             implementation_end;            Integrate 320 336             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath> <TimeStamp>2007-9-26 12:3:23</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Integrate              ports               signal in input;               signal out output [4,4];              parameters               real init = -2.9234;             end;             icon bg              figures               rectangle 304 320 336 352 fill 15132390;               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;             end;             implementation eqvariables	real R[3,3];	real p[3];	real q;equationsq = -int(input,init);R = [	cos(q),	-sin(q),	0;			sin(q),	cos(q),	0;			0,				0,				1];p = [0;0;0];output = homogeneous(R,p);	     implementation_end;            MatrixMul 320 576             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath> <TimeStamp>2007-9-26 12:15:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input1 [4,4];               signal out output [4,4];               signal in input2 [4,4];             end;             icon bg bottom              figures               rectangle 304.1 560 335.9 592 fill 15132390;               text 'X' 320 576 color 16711680 16 bold;             end;             implementation eqequations	output = input2*input1;    implementation_end;            plug p1 240 40;            plug p2 496 424;            plug Hin 112 576;            plug Hout 504 576;            plug p 112 424;            OneJunction 240 288             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               mechanical knot duplicatable none p [1];               signal knot out flow [1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 240 288 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Or 400 224             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>  <TimeStamp>2007-12-18 23:20:57</TimeStamp></Description>';             type 'Or-Or'              ports               signal boolean in input1;               signal boolean out output;               signal boolean in input2;             end;             icon bg bottom              figures               rectangle 384.1 208 415.9 240 fill 15132390;               group                line 386.3 217.3 396.8 217.3 color 16711680 fill 16711680;                line 386.3 231.1 396.8 231.1 color 16711680 fill 16711680;               end;               spline 395.9 212.8 397.9 224.5 395.9 235.7 color 16711680 fill 16711680;               line 404.7 224 413.5 224 color 16711680 fill 16711680;               spline 395.7 212.3 401.9 214.6 404.8 224.4 401.6 233.4 395.7 235.7 color 16711680 fill 15132390;             end;             implementation eqequations	output = if input1 or input2 then 		true	else		false	end;      implementation_end;            Rjoint 168 288             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type R              ports               power in p;              parameters               real Rjoint = 0.1;             end;             icon bg bottom              figures               text 'R' 168 288 18 bold;             end;             implementation eqequations						p.e = Rjoint * p.f;implementation_end;            Splitter2 320 368             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;               ellipse 315.7 363.7 324.3 372.3 color -1;              terminals               input 320 368 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            uTbai 240 336             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1;               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;               causality fixed in p1;               causality fixed out p2;              parameters               real Cconstraint = 1.0e-4;               real Rconstraint = 1000.0;             end;             icon bg left              figures               text 'TF' 240 336 18 bold;             end;             implementation eqequations	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);	p2.e[2] = (Rconstraint*-p2.f[2] + int(-p2.f[2])/Cconstraint);	p2.e[3] = p1.e;	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);	p1.f = p2.f[3];implementation_end;            Wbai 240 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:43</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [6,1];               signal knot out effort [6,1];              restrictions               causality constraint one_in p;             end;             icon bg bottom              figures               text '0' 240 424 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;            ZeroJunction 240 104             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:43</TimeStamp></Description>';             knot ZeroJunction              ports               mechanical knot duplicatable none p [1];               signal knot out effort [1];              restrictions               causality constraint one_in p;             end;             icon bg              figures               text '0' 240 104 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;           end;           connections            uTbai\p1 <= OneJunction\p;            p <= Wbai\p;            OneJunction\p <= EndstopMin\p2;            Wbai\p <= AdHji\p1;            p2 => AdHji\p2;            OneJunction\p <= EndstopMax\p2;            Rjoint\p <= OneJunction\p;            ZeroJunction\p => OneJunction\p;            p1 => ZeroJunction\p;            uTbai\p2 => Wbai\p;            OneJunction\flow -> Integrate\input 288 336;            Integrate\output -> Splitter2\input;            Splitter2\output -> MatrixMul\input1;            EndstopMin\collision -> Or\input2;            EndstopMax\collision -> Or\input1;            Splitter2\output -> AdHji\H 424 368;            MatrixMul\output -> Hout;            Hin -> MatrixMul\input2;           end;           parameterrelationsEndstopMin\Rendstop = Rendstop;EndstopMin\Cendstop = Cendstop;EndstopMin\InitialPos = InitialPos;EndstopMin\EndstopPos = MinEndstopPos;EndstopMax\Rendstop = Rendstop;EndstopMax\Cendstop = Cendstop;EndstopMax\InitialPos = InitialPos;EndstopMax\EndstopPos = MaxEndstopPos;Rjoint\Rjoint= Rjoint;Integrate\init = InitialPos;uTbai\Rconstraint = Rconstraint;uTbai\Cconstraint = Cconstraint;parameterrelations_end;           figures            text 'b = next link (body)a = previous link (body)i = Frame fixed in previous body, fixed in jointj = Frame fixed in next body, fixed in joint ' 680 488;          implementation_end;         JointBase1 448.2 504          description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>Joint-rotz.emx</LibraryPath>  <TimeStamp>2011-1-21 10:08:41</TimeStamp></Description>';          type 'Submodel-rotz'           ports            power out p [6,1];            power in p1;            power in p2 [6,1];            signal in Hin [4,4];            signal out Hout [4,4];           parameters            real Rendstop = 1000.0;            real Cendstop = 1.0e-4;            real InitialPos = -2.9496;            real MinEndstopPos = -2.95;            real MaxEndstopPos = 2.95;            real Rconstraint = 1000.0;            real Cconstraint = 1.0e-4;            real Rjoint = 0.1;          end;          icon bg bottom           figures            rectangle 416.4 432 479.9 576 fill 14745599;            text 'Joint-rotz' 448.4 507 fill 14745599;           terminals            p 415.9 464 fixed;            p1 447.4 432 fixed;            p2 479.9 464 fixed;            Hin 415.9 544 fixed;            Hout 479.9 544 fixed;          end;          implementation bg           submodels            AdHji 424 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg bottom              figures               text 'MTF' 424 424 18 bold;             end;             implementation eqequations						p2.e = transpose(Adjoint(H)) * p1.e;	p1.f = Adjoint(H) * p2.f;implementation_end;            EndstopMax 479 225             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>EndstopMax.emx</LibraryPath>  <TimeStamp>2011-1-18 16:54:54</TimeStamp></Description>';             type Submodel              ports               power out p2;               signal boolean out collision;              parameters               real Rendstop = 1000.0;               real Cendstop = 1.0e-4;               real InitialPos = -2.9496;               real EndstopPos = 2.95;             end;             icon bg bottom              figures               rectangle 430 202 528 248 fill 14013909;               text 'EndstopMax' 480 224 16;              terminals               p2 480 248 fixed;             end;             implementation bg              submodels               Cendstop 704 144                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\C.emx</LibraryPath> <TimeStamp>2007-10-31 10:43:59</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type C                 ports                  power in p;                  signal out state;                 restrictions                  causality preferred out p;                 parameters                  real Cendstop = 1.0e-4;                end;                icon bg right                 figures                  text 'C' 704 144 18 bold;                end;                implementation eqequations    state = int(p.f);    p.e = state / Cendstop;implementation_end;               Collision 704 216                description '<Description> <Version>No Version Info</Version> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type X0e                 ports                  power in p1;                  power out p2;                  power out p12;                  signal boolean out Collision;                 restrictions                  causality fixed out p2;                  causality fixed out p1;                  causality fixed in p12;                 parameters                  real InitialPos = -2.9496;                  real EndstopPos = 2.95;                end;                icon bg                 figures                  text 'X0e' 704 216 18 bold;                end;                implementation bg                 submodels                  Condition1 224.9 231.5                   type Condition                    ports                     signal in dx;                     signal boolean out contact;                   end;                   icon bg                    figures                     rectangle 197.2 215 252.6 248 fill 15132390;                     text 'Condition' 224 231.5;                    terminals                     dx 224 248 fixed;                     contact 224 215 fixed;                   end;                   implementation eqparameters	real global epsilon;variables	boolean bounce;equations	contact = if dx - epsilon  < 0 then true else false end;	bounce = event (dx - epsilon);implementation_end;                  plug p1 96 176;                  plug p2 352 176;                  plug p12 224 64;                  plug Collision 408 192;                  Splitter1 224 200                   description '<Description><Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>  <TimeStamp>2007-10-31 11:27:48</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot Splitter                    ports                     signal knot boolean duplicatable out output [1];                     signal knot boolean in input [1];                   end;                   icon bg ellipse                    figures                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;                     ellipse 219.7 195.7 228.3 204.3 color -1;                    terminals                     input 224 200 fixed;                   end;                   implementation eqequations    collect (output) = input;implementation_end;                  v1 160 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 160 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v12 224 120                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg right                    figures                     text '1' 224 120 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v2 296 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 296 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  X0 224 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type X0                    ports                     mechanical in p1;                     mechanical out p2;                     mechanical out p12;                     signal boolean in condition;                    restrictions                     causality fixed out p1;                     causality fixed out p2;                     causality fixed in p12;                   end;                   icon bg                    figures                     text 'X0' 224 176 color 8388608 18 bold;                   end;                   implementation eqequations	p1.e = if condition then p12.e else 0 end;	p2.e = p1.e;	p12.f = if condition then p1.f-p2.f else 0 end; implementation_end;                  x1 160 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = 2.95;                   end;                   icon bg left                    figures                     rectangle 145 289 175 319 fill 15132390;                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                  x12 224 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot PlusMinus                    ports                     signal knot duplicatable in plus [1];                     signal knot duplicatable in minus [1];                     signal knot out output [1];                   end;                   icon bg ellipse bottom                    figures                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;                   end;                   implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;                  x2 296 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = -2.9496;                   end;                   icon bg right                    figures                     rectangle 281 289 311 319 fill 15132390;                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                 end;                 connections                  v1\p => X0\p1;                  X0\p2 => v2\p;                  X0\p12 => v12\p;                  v2\p => p2;                  v12\p => p12;                  p1 => v1\p;                  v1\flow -> x1\input;                  x1\output -> x12\plus;                  v2\flow -> x2\input;                  x2\output -> x12\minus;                  x12\output -> Condition1\dx;                  Condition1\contact -> Splitter1\input;                  Splitter1\output -> X0\condition;                  Splitter1\output -> Collision;                 end;                 parameterrelationsx1\Initial = EndstopPos;x2\Initial = InitialPos;parameterrelations_end;                implementation_end;               plug p2 648 216;               plug collision 800 216;               OneJunction5 704 176                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';                knot OneJunction                 ports                  mechanical knot duplicatable none p [1];                  signal knot out flow [1];                 restrictions                  causality constraint one_out p;                end;                icon bg                 figures                  text '1' 704 176 18 bold;                end;                implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;               Rendstop 736 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type R                 ports                  power in p;                 parameters                  real Rendstop = 1000.0;                end;                icon bg bottom                 figures                  text 'R' 736 176 18 bold;                end;                implementation eqequations						p.e = Rendstop * p.f;implementation_end;               Sf1 704 264                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>  <TimeStamp>2007-9-25 12:3:35</TimeStamp></Description>';                type Sf                 ports                  power out p;                 restrictions                  causality fixed in p;                end;                icon bg bottom                 figures                  text 'Sf' 704 264 18 bold;                end;                implementation eqparameters	real flow = 0.0;variables	real effort;equations	p.f = flow;	effort = p.e;implementation_end;              end;              connections               OneJunction5\p => Cendstop\p;               Collision\p12 => OneJunction5\p;               Sf1\p => Collision\p1;               OneJunction5\p => Rendstop\p;               Collision\p2 => p2;               Collision\Collision -> collision;              end;              parameterrelationsCollision\InitialPos = InitialPos;Collision\EndstopPos = EndstopPos;Rendstop\Rendstop = Rendstop;Cendstop\Cendstop = Cendstop;parameterrelations_end;             implementation_end;            EndstopMin 320 224             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>EndstopMin.emx</LibraryPath>  <TimeStamp>2011-1-18 16:54:44</TimeStamp></Description>';             type Submodel              ports               power out p2;               signal boolean out collision;              parameters               real Cendstop = 1.0e-4;               real Rendstop = 1000.0;               real InitialPos = -2.9496;               real EndstopPos = -2.95;             end;             icon bg bottom              figures               rectangle 271 201 369 247 fill 14013909;               text 'EndstopMin' 321 223 16;             end;             implementation bg              submodels               Cendstop 248 208                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\C.emx</LibraryPath> <TimeStamp>2007-10-31 10:43:59</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type C                 ports                  power in p;                  signal out state;                 restrictions                  causality preferred out p;                 parameters                  real Cendstop = 1.0e-4;                end;                icon bg right                 figures                  text 'C' 248 208 18 bold;                end;                implementation eqequations    state = int(p.f);    p.e = state / Cendstop;implementation_end;               Collision 248 120                description '<Description> <Version>No Version Info</Version> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type X0e                 ports                  power in p1;                  power out p2;                  power out p12;                  signal boolean out collision;                 restrictions                  causality fixed out p1;                  causality fixed out p2;                  causality fixed in p12;                 parameters                  real InitialPos = -2.9496;                  real EndstopLocation = -2.95;                end;                icon bg                 figures                  text 'X0e' 248 120 18 bold;                end;                implementation bg                 submodels                  Condition1 224.9 231.5                   type Condition                    ports                     signal in dx;                     signal boolean out contact;                   end;                   icon bg                    figures                     rectangle 197.2 215 252.6 248 fill 15132390;                     text 'Condition' 224 231.5;                    terminals                     dx 224 248 fixed;                     contact 224 215 fixed;                   end;                   implementation eqparameters	real global epsilon;variables	boolean bounce;equations	contact = if dx - epsilon  > 0 then true else false end;	bounce = event (dx - epsilon);implementation_end;                  plug p1 96 176;                  plug p2 352 176;                  plug p12 224 64;                  plug collision 400 200;                  Splitter1 224 200                   description '<Description><Version>4.0</Version>   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>  <TimeStamp>2007-10-31 11:27:48</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot Splitter                    ports                     signal knot boolean duplicatable out output [1];                     signal knot boolean in input [1];                   end;                   icon bg ellipse                    figures                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;                     ellipse 219.7 195.7 228.3 204.3 color -1;                    terminals                     input 224 200 fixed;                   end;                   implementation eqequations    collect (output) = input;implementation_end;                  v1 160 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 160 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v12 224 120                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg right                    figures                     text '1' 224 120 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  v2 296 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot OneJunction                    ports                     mechanical knot duplicatable none p [1];                     signal knot out flow [1];                    restrictions                     causality constraint one_out p;                   end;                   icon bg top                    figures                     text '1' 296 176 18 bold;                   end;                   implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);  implementation_end;                  X0 224 176                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type X0                    ports                     power in p1;                     power out p2;                     power out p12;                     signal boolean in condition;                    restrictions                     causality fixed out p1;                     causality fixed out p2;                     causality fixed in p12;                   end;                   icon bg                    figures                     text 'X0' 224 176 color 8388608 18 bold;                   end;                   implementation eqequations	p1.e = if condition then p12.e else 0 end;	p2.e = p1.e;	p12.f = if condition then p1.f-p2.f else 0 end; implementation_end;                  x1 160 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = -2.95;                   end;                   icon bg left                    figures                     rectangle 145 289 175 319 fill 15132390;                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                  x12 224 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   knot PlusMinus                    ports                     signal knot duplicatable in plus [1];                     signal knot duplicatable in minus [1];                     signal knot out output [1];                   end;                   icon bg ellipse bottom                    figures                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;                   end;                   implementation eqequations    output = sum (collect (plus)) - sum (collect (minus));    implementation_end;                  x2 296 304                   description '<Description> <IsMainModel>0</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';                   type Integrate                    ports                     signal in input;                     signal out output;                    parameters                     real Initial = -2.9496;                   end;                   icon bg right                    figures                     rectangle 281 289 311 319 fill 15132390;                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;                   end;                   implementation eqequations	output = int (input, Initial);     implementation_end;                 end;                 connections                  v1\p => X0\p1;                  X0\p2 => v2\p;                  X0\p12 => v12\p;                  v2\p => p2;                  v12\p => p12;                  p1 => v1\p;                  v1\flow -> x1\input;                  x1\output -> x12\plus;                  v2\flow -> x2\input;                  x2\output -> x12\minus;                  x12\output -> Condition1\dx;                  Condition1\contact -> Splitter1\input;                  Splitter1\output -> X0\condition;                  Splitter1\output -> collision;                 end;                 parameterrelationsx1\Initial = EndstopLocation;x2\Initial = InitialPos;parameterrelations_end;                implementation_end;               plug p2 152 120;               plug collision 360 120;               OneJunction 248 160                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';                knot OneJunction                 ports                  power knot duplicatable none p [1];                  signal knot out flow [1];                 restrictions                  causality constraint one_out p;                end;                icon bg                 figures                  text '1' 248 160 18 bold;                end;                implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;               Rendstop 288 160                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type R                 ports                  power in p;                 parameters                  real Rendstop = 1000.0;                end;                icon bg bottom                 figures                  text 'R' 288 160 18 bold;                end;                implementation eqequations						p.e = Rendstop * p.f;implementation_end;               Sf2 248 64                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>  <TimeStamp>2007-9-25 12:3:35</TimeStamp></Description>';                type Sf                 ports                  power out p;                 restrictions                  causality fixed in p;                end;                icon bg bottom                 figures                  text 'Sf' 248 64 18 bold;                end;                implementation eqparameters	real flow = 0.0;variables	real effort;equations	p.f = flow;	effort = p.e;implementation_end;              end;              connections               Collision\p12 => OneJunction\p;               OneJunction\p => Rendstop\p;               OneJunction\p => Cendstop\p;               Sf2\p => Collision\p1;               Collision\p2 => p2;               Collision\collision -> collision;              end;              parameterrelationsCendstop\Cendstop = Cendstop;Rendstop\Rendstop = Rendstop;Collision\InitialPos = InitialPos;Collision\EndstopLocation = EndstopPos;parameterrelations_end;             implementation_end;            Integrate 320 336             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath> <TimeStamp>2007-9-26 12:3:23</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Integrate              ports               signal in input;               signal out output [4,4];              parameters               real init = -2.9496;             end;             icon bg              figures               rectangle 304 320 336 352 fill 15132390;               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;             end;             implementation eqvariables	real R[3,3];	real p[3];	real q;equationsq = -int(input,init);R = [	cos(q),	-sin(q),	0;			sin(q),	cos(q),	0;			0,				0,				1];p = [0;0;0];output = homogeneous(R,p);	     implementation_end;            MatrixMul 320 576             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath> <TimeStamp>2007-9-26 12:15:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input1 [4,4];               signal out output [4,4];               signal in input2 [4,4];             end;             icon bg bottom              figures               rectangle 304.1 560 335.9 592 fill 15132390;               text 'X' 320 576 color 16711680 16 bold;             end;             implementation eqequations	output = input2*input1;    implementation_end;            plug p1 240 40;            plug p2 496 424;            plug Hin 112 576;            plug Hout 504 576;            plug p 112 424;            OneJunction 240 288             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               mechanical knot duplicatable none p [1];               signal knot out flow [1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 240 288 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Or 400 224             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>  <TimeStamp>2007-12-18 23:20:57</TimeStamp></Description>';             type 'Or-Or'              ports               signal boolean in input1;               signal boolean out output;               signal boolean in input2;             end;             icon bg bottom              figures               rectangle 384.1 208 415.9 240 fill 15132390;               group                line 386.3 217.3 396.8 217.3 color 16711680 fill 16711680;                line 386.3 231.1 396.8 231.1 color 16711680 fill 16711680;               end;               spline 395.9 212.8 397.9 224.5 395.9 235.7 color 16711680 fill 16711680;               line 404.7 224 413.5 224 color 16711680 fill 16711680;               spline 395.7 212.3 401.9 214.6 404.8 224.4 401.6 233.4 395.7 235.7 color 16711680 fill 15132390;             end;             implementation eqequations	output = if input1 or input2 then 		true	else		false	end;      implementation_end;            Rjoint 168 288             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type R              ports               power in p;              parameters               real Rjoint = 0.1;             end;             icon bg bottom              figures               text 'R' 168 288 18 bold;             end;             implementation eqequations						p.e = Rjoint * p.f;implementation_end;            Splitter2 320 368             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;               ellipse 315.7 363.7 324.3 372.3 color -1;              terminals               input 320 368 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            uTbai 240 336             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1;               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;               causality fixed in p1;               causality fixed out p2;              parameters               real Cconstraint = 1.0e-4;               real Rconstraint = 1000.0;             end;             icon bg left              figures               text 'TF' 240 336 18 bold;             end;             implementation eqequations	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);	p2.e[2] = (Rconstraint*-p2.f[2] + int(-p2.f[2])/Cconstraint);	p2.e[3] = p1.e;	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);	p1.f = p2.f[3];implementation_end;            Wbai 240 424             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:43</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [6,1];               signal knot out effort [6,1];              restrictions               causality constraint one_in p;             end;             icon bg bottom              figures               text '0' 240 424 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;            ZeroJunction 240 104             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:43</TimeStamp></Description>';             knot ZeroJunction              ports               mechanical knot duplicatable none p [1];               signal knot out effort [1];              restrictions               causality constraint one_in p;             end;             icon bg              figures               text '0' 240 104 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;           end;           connections            uTbai\p1 <= OneJunction\p;            p1 => ZeroJunction\p;            uTbai\p2 => Wbai\p;            p <= Wbai\p;            OneJunction\p <= EndstopMin\p2;            Wbai\p <= AdHji\p1;            p2 => AdHji\p2;            OneJunction\p <= EndstopMax\p2;            Rjoint\p <= OneJunction\p;            ZeroJunction\p => OneJunction\p;            OneJunction\flow -> Integrate\input 288 336;            MatrixMul\output -> Hout;            Hin -> MatrixMul\input2;            Integrate\output -> Splitter2\input;            Splitter2\output -> MatrixMul\input1;            EndstopMin\collision -> Or\input2;            EndstopMax\collision -> Or\input1;            Splitter2\output -> AdHji\H 424 368;           end;           parameterrelationsEndstopMin\Rendstop = Rendstop;EndstopMin\Cendstop = Cendstop;EndstopMin\InitialPos = InitialPos;EndstopMin\EndstopPos = MinEndstopPos;EndstopMax\Rendstop = Rendstop;EndstopMax\Cendstop = Cendstop;EndstopMax\InitialPos = InitialPos;EndstopMax\EndstopPos = MaxEndstopPos;Rjoint\Rjoint= Rjoint;Integrate\init = InitialPos;uTbai\Rconstraint = Rconstraint;uTbai\Cconstraint = Cconstraint;parameterrelations_end;           figures            text 'b = next link (body)a = previous link (body)i = Frame fixed in previous body, fixed in jointj = Frame fixed in next body, fixed in joint ' 680 488;          implementation_end;         Link1 528 504          description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>Link.emx</LibraryPath>  <TimeStamp>2011-1-18 16:36:40</TimeStamp><Description>Base</Description></Description>';          type Submodel           ports            power out p [6,1];            signal in Hin [4,4];            power in p1 [6,1];            signal out Hout [4,4];           parameters            real I[3,1] = [1.0; 1.0; 1.0];            real m = 2.412;            real COMdim[3,1] = [0.10453; 0.0017; -0.00297];            real dim[3,1] = [0.033; 0.0; 0.019];          end;          icon bg bottom           figures            rectangle 496 432 560 576 fill 10025880;            text 'Link' 528 504;           terminals            p 496 464 fixed;            Hin 496 544 fixed;            p1 560 464 fixed;            Hout 560 544 fixed;          end;          implementation bg           submodels            AdHi0 664 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power in p1 [6,1];               power out p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'MTF' 664 416 18 bold;             end;             implementation eqvariables 	real onlyRotH[4,4];code	//Only rotations with respect to the inertial system matter!	onlyRotH = H;	onlyRotH[1,4] = 0;	onlyRotH[2,4] = 0;	onlyRotH[3,4] = 0;							p2.e = transpose(Adjoint(onlyRotH)) * p1.e;	p1.f = Adjoint(onlyRotH) * p2.f;implementation_end;            AdHij 816 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg top              figures               text 'MTF' 816 304 18 bold;             end;             implementation eqequations	//Only rotations with respect to the inertial system matter!							p1.e = transpose(Adjoint(H)) * p2.e;	p2.f = Adjoint(H) * p1.f;implementation_end;            AdHik 664 224             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1 [6,1];               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.10453; 0.0017; -0.00297];             end;             icon bg left              figures               text 'TF' 664 224 18 bold;             end;             implementation eq//Frame in joint connected to port 1//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            AdHik1 664 368             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power out p1 [6,1];               power in p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.10453; 0.0017; -0.00297];             end;             icon bg left              figures               text 'TF' 664 368 18 bold;             end;             implementation eq//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            EJS 728 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MGY.emx</LibraryPath> <TimeStamp>2007-10-31 11:43:6</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MGY              ports               power in p1 [6,1];              parameters               real I[3,1] = [1.0; 1.0; 1.0];               real m = 2.412;             end;             icon bg top              figures               text 'MGY' 728 184 18 bold;             end;             implementation eq//EJS / Gyroscopic effectsvariables	real II[6,6]; //Inertial tensor	real Q[6,6];	real QI[6,6];	real v[3];	real omega[3];equations	II = [	I[1],0,	0,	0,	0,	0;			0,	I[2],0,	0,	0,	0;			0,	0,	I[3],0,	0,	0;			0,	0,	0,	m,	0,	0;			0,	0,	0,	0,	m,	0;			0,	0,	0,	0,	0,	m];	v[1:3] = p1.f[4:6];	omega[1:3] = p1.f[1:3];	Q[1:3,1:3] = -skew(omega);	Q[1:3,4:6] = -skew(v);	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros	Q[4:6,4:6] = -skew(omega);	QI = Q*II;	p1.e = QI*p1.f;implementation_end;            Gravity 776 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Se.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:26</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Se              ports               power out p [6,1];              restrictions               causality fixed out p;              parameters               real m = 2.412;             end;             icon bg bottom              figures               text 'Se' 776 416 18 bold;             end;             implementation eqvariables	real effort[6];equations	effort = [0;0;0;0;0;-9.8*m];	p.e = effort;implementation_end;            Hij 816 496             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>H.emx</LibraryPath>  <TimeStamp>2010-9-21 15:03:50</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input [4,4];               signal out output [4,4];               signal out Hab [4,4];              parameters               real dim[3,1] = [0.033; 0.0; 0.019];             end;             icon bg bottom              figures               rectangle 800.1 480 831.9 512 fill 15132390;               text 'H' 816 496 color 16711680 16 bold;             end;             implementation eqequations	Hab = homogeneous(eye(3),dim);	output = input * Hab;    implementation_end;            InertialTensor 616 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\I.emx</LibraryPath> <TimeStamp>2007-9-25 12:2:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type I              ports               power in p [6,1];               signal out state [6,1];              restrictions               causality preferred in p;              parameters               real m = 1.0;               real I[3,1] = [1.0; 1.0; 1.0];             end;             icon bg top              figures               text 'I' 616 184 18 bold;             end;             implementation eqvariables	real II[6,6]; //Inertial tensorequations	II = [I[1],0,	0,	0,	0,	0;			0,	I[2],0,	0,	0,	0;			0,	0,	I[3],0,	0,	0;			0,	0,	0,	m,	0,	0;			0,	0,	0,	0,	m,	0;			0,	0,	0,	0,	0,	m];    state = int(p.e); //state = generalized momentum    p.f = inverse(II)*state;implementation_end;            plug Hout 896 496;            plug p1 904 304;            plug Hin 592 496;            plug p 592 304;            Splitter1 664 496             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;               ellipse 659.7 491.7 668.3 500.3 color -1;              terminals               input 664 496 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Ta00 720 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 720 416 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0i 664 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 664 304 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0k 664 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg top              figures               text '1' 664 184 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;           end;           connections            AdHik\p2 => Ta0k\p;            Ta00\p => AdHi0\p1;            Ta0k\p => InertialTensor\p;            Ta0i\p <= AdHik1\p1;            AdHi0\p2 => AdHik1\p2;            Gravity\p => Ta00\p;            Ta0i\p => AdHik\p1;            p <= Ta0i\p;            Ta0i\p <= AdHij\p1;            Ta0k\p => EJS\p1;            p1 => AdHij\p2;            Hin -> Splitter1\input;            Hij\output -> Hout;            Splitter1\output -> Hij\input;            Splitter1\output -> AdHi0\H;            Hij\Hab -> AdHij\H;           end;           parameterrelationsInertialTensor\I = I;InterialTensor\m = m;EJS\I = I;EJS\m = m;AdHik\COMdim = COMdim;AdHik1\COMdim = COMdim;Hij\dim = dim;Gravity\m=m;parameterrelations_end;           figures            text 'b = current link (body)a = previous link (body)i = Body fixed frame, fixed in joint with previous linkj = Body fixed frame, fixed in joint with next linkk = Body fixed frame, principal inertial frame0 = inertial system ' 352 296;          implementation_end;         Link2 688 504          description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>Link.emx</LibraryPath>  <TimeStamp>2011-1-18 16:36:40</TimeStamp><Description>Base</Description></Description>';          type Submodel           ports            power out p [6,1];            signal in Hin [4,4];            power in p1 [6,1];            signal out Hout [4,4];           parameters            real I[3,1] = [1.0; 1.0; 1.0];            real m = 1.155;            real COMdim[3,1] = [0.001; 0.0967; 0.02107];            real dim[3,1] = [0.0; 0.0; 0.155];          end;          icon bg bottom           figures            rectangle 656 432 720 576 fill 10025880;            text 'Link' 688 504;           terminals            p 656 464 fixed;            Hin 656 544 fixed;            p1 720 464 fixed;            Hout 720 544 fixed;          end;          implementation bg           submodels            AdHi0 664 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power in p1 [6,1];               power out p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'MTF' 664 416 18 bold;             end;             implementation eqvariables 	real onlyRotH[4,4];code	//Only rotations with respect to the inertial system matter!	onlyRotH = H;	onlyRotH[1,4] = 0;	onlyRotH[2,4] = 0;	onlyRotH[3,4] = 0;							p2.e = transpose(Adjoint(onlyRotH)) * p1.e;	p1.f = Adjoint(onlyRotH) * p2.f;implementation_end;            AdHij 816 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg top              figures               text 'MTF' 816 304 18 bold;             end;             implementation eqequations	//Only rotations with respect to the inertial system matter!							p1.e = transpose(Adjoint(H)) * p2.e;	p2.f = Adjoint(H) * p1.f;implementation_end;            AdHik 664 224             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1 [6,1];               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.001; 0.0967; 0.02107];             end;             icon bg left              figures               text 'TF' 664 224 18 bold;             end;             implementation eq//Frame in joint connected to port 1//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            AdHik1 664 368             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power out p1 [6,1];               power in p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.001; 0.0967; 0.02107];             end;             icon bg left              figures               text 'TF' 664 368 18 bold;             end;             implementation eq//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            EJS 728 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MGY.emx</LibraryPath> <TimeStamp>2007-10-31 11:43:6</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MGY              ports               power in p1 [6,1];              parameters               real I[3,1] = [1.0; 1.0; 1.0];               real m = 1.155;             end;             icon bg top              figures               text 'MGY' 728 184 18 bold;             end;             implementation eq//EJS / Gyroscopic effectsvariables	real II[6,6]; //Inertial tensor	real Q[6,6];	real QI[6,6];	real v[3];	real omega[3];equations	II = [	I[1],0,	0,	0,	0,	0;			0,	I[2],0,	0,	0,	0;			0,	0,	I[3],0,	0,	0;			0,	0,	0,	m,	0,	0;			0,	0,	0,	0,	m,	0;			0,	0,	0,	0,	0,	m];	v[1:3] = p1.f[4:6];	omega[1:3] = p1.f[1:3];	Q[1:3,1:3] = -skew(omega);	Q[1:3,4:6] = -skew(v);	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros	Q[4:6,4:6] = -skew(omega);	QI = Q*II;	p1.e = QI*p1.f;implementation_end;            Gravity 776 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Se.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:26</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Se              ports               power out p [6,1];              restrictions               causality fixed out p;              parameters               real m = 1.155;             end;             icon bg bottom              figures               text 'Se' 776 416 18 bold;             end;             implementation eqvariables	real effort[6];equations	effort = [0;0;0;0;0;-9.8*m];	p.e = effort;implementation_end;            Hij 816 496             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>H.emx</LibraryPath>  <TimeStamp>2010-9-21 15:03:50</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input [4,4];               signal out output [4,4];               signal out Hab [4,4];              parameters               real dim[3,1] = [0.0; 0.0; 0.155];             end;             icon bg bottom              figures               rectangle 800.1 480 831.9 512 fill 15132390;               text 'H' 816 496 color 16711680 16 bold;             end;             implementation eqequations	Hab = homogeneous(eye(3),dim);	output = input * Hab;    implementation_end;            InertialTensor 616 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\I.emx</LibraryPath> <TimeStamp>2007-9-25 12:2:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type I              ports               power in p [6,1];               signal out state [6,1];              restrictions               causality preferred in p;              parameters               real m = 1.0;               real I[3,1] = [1.0; 1.0; 1.0];             end;             icon bg top              figures               text 'I' 616 184 18 bold;             end;             implementation eqvariables	real II[6,6]; //Inertial tensorequations	II = [I[1],0,	0,	0,	0,	0;			0,	I[2],0,	0,	0,	0;			0,	0,	I[3],0,	0,	0;			0,	0,	0,	m,	0,	0;			0,	0,	0,	0,	m,	0;			0,	0,	0,	0,	0,	m];    state = int(p.e); //state = generalized momentum    p.f = inverse(II)*state;implementation_end;            plug Hout 896 496;            plug p1 904 304;            plug Hin 592 496;            plug p 592 304;            Splitter1 664 496             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;               ellipse 659.7 491.7 668.3 500.3 color -1;              terminals               input 664 496 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Ta00 720 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 720 416 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0i 664 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 664 304 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0k 664 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg top              figures               text '1' 664 184 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;           end;           connections            AdHik\p2 => Ta0k\p;            Ta00\p => AdHi0\p1;            Ta0k\p => InertialTensor\p;            Ta0i\p <= AdHik1\p1;            AdHi0\p2 => AdHik1\p2;            Gravity\p => Ta00\p;            Ta0i\p => AdHik\p1;            p <= Ta0i\p;            Ta0i\p <= AdHij\p1;            Ta0k\p => EJS\p1;            p1 => AdHij\p2;            Hin -> Splitter1\input;            Hij\output -> Hout;            Splitter1\output -> Hij\input;            Splitter1\output -> AdHi0\H;            Hij\Hab -> AdHij\H;           end;           parameterrelationsInertialTensor\I = I;InterialTensor\m = m;EJS\I = I;EJS\m = m;AdHik\COMdim = COMdim;AdHik1\COMdim = COMdim;Hij\dim = dim;Gravity\m=m;parameterrelations_end;           figures            text 'b = current link (body)a = previous link (body)i = Body fixed frame, fixed in joint with previous linkj = Body fixed frame, fixed in joint with next linkk = Body fixed frame, principal inertial frame0 = inertial system ' 352 296;          implementation_end;         Link3 848 504          description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>Link.emx</LibraryPath> <TimeStamp>2011-1-18 16:36:40</TimeStamp>   <Description>Base</Description></Description>';          type Submodel           ports            power out p [6,1];            signal in Hin [4,4];            power in p1 [6,1];            signal out Hout [4,4];           parameters            real I[3,1] = [1.0; 1.0; 1.0];            real m = 0.934;            real COMdim[3,1] = [0.011; 0.05103; -0.02319];            real dim[3,1] = [0.0; 0.0; 0.135];          end;          icon bg bottom           figures            rectangle 816 432 880 576 fill 10025880;            text 'Link' 848 504;           terminals            p 816 464 fixed;            Hin 816 544 fixed;            p1 880 464 fixed;            Hout 880 544 fixed;          end;          implementation bg           submodels            AdHi0 664 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power in p1 [6,1];               power out p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'MTF' 664 416 18 bold;             end;             implementation eqvariables 	real onlyRotH[4,4];code	//Only rotations with respect to the inertial system matter!	onlyRotH = H;	onlyRotH[1,4] = 0;	onlyRotH[2,4] = 0;	onlyRotH[3,4] = 0;							p2.e = transpose(Adjoint(onlyRotH)) * p1.e;	p1.f = Adjoint(onlyRotH) * p2.f;implementation_end;            AdHij 816 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg top              figures               text 'MTF' 816 304 18 bold;             end;             implementation eqequations	//Only rotations with respect to the inertial system matter!							p1.e = transpose(Adjoint(H)) * p2.e;	p2.f = Adjoint(H) * p1.f;implementation_end;            AdHik 664 224             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1 [6,1];               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.011; 0.05103; -0.02319];             end;             icon bg left              figures               text 'TF' 664 224 18 bold;             end;             implementation eq//Frame in joint connected to port 1//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            AdHik1 664 368             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power out p1 [6,1];               power in p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.011; 0.05103; -0.02319];             end;             icon bg left              figures               text 'TF' 664 368 18 bold;             end;             implementation eq//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            EJS 728 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MGY.emx</LibraryPath> <TimeStamp>2007-10-31 11:43:6</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MGY              ports               power in p1 [6,1];              parameters               real I[3,1] = [1.0; 1.0; 1.0];               real m = 0.934;             end;             icon bg top              figures               text 'MGY' 728 184 18 bold;             end;             implementation eq//EJS / Gyroscopic effectsvariables	real II[6,6]; //Inertial tensor	real Q[6,6];	real QI[6,6];	real v[3];	real omega[3];equations	II = [	I[1],0,	0,	0,	0,	0;			0,	I[2],0,	0,	0,	0;			0,	0,	I[3],0,	0,	0;			0,	0,	0,	m,	0,	0;			0,	0,	0,	0,	m,	0;			0,	0,	0,	0,	0,	m];	v[1:3] = p1.f[4:6];	omega[1:3] = p1.f[1:3];	Q[1:3,1:3] = -skew(omega);	Q[1:3,4:6] = -skew(v);	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros	Q[4:6,4:6] = -skew(omega);	QI = Q*II;	p1.e = QI*p1.f;implementation_end;            Gravity 776 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Se.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:26</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Se              ports               power out p [6,1];              restrictions               causality fixed out p;              parameters               real m = 0.934;             end;             icon bg bottom              figures               text 'Se' 776 416 18 bold;             end;             implementation eqvariables	real effort[6];equations	effort = [0;0;0;0;0;-9.8*m];	p.e = effort;implementation_end;            Hij 816 496             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>H.emx</LibraryPath>  <TimeStamp>2010-9-21 15:03:50</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input [4,4];               signal out output [4,4];               signal out Hab [4,4];              parameters               real dim[3,1] = [0.0; 0.0; 0.135];             end;             icon bg bottom              figures               rectangle 800.1 480 831.9 512 fill 15132390;               text 'H' 816 496 color 16711680 16 bold;             end;             implementation eqequations	Hab = homogeneous(eye(3),dim);	output = input * Hab;    implementation_end;            InertialTensor 616 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\I.emx</LibraryPath> <TimeStamp>2007-9-25 12:2:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type I              ports               power in p [6,1];               signal out state [6,1];              restrictions               causality preferred in p;              parameters               real m = 1.0;               real I[3,1] = [1.0; 1.0; 1.0];             end;             icon bg top              figures               text 'I' 616 184 18 bold;             end;             implementation eqvariables	real II[6,6]; //Inertial tensorequations	II = [I[1],0,	0,	0,	0,	0;			0,	I[2],0,	0,	0,	0;			0,	0,	I[3],0,	0,	0;			0,	0,	0,	m,	0,	0;			0,	0,	0,	0,	m,	0;			0,	0,	0,	0,	0,	m];    state = int(p.e); //state = generalized momentum    p.f = inverse(II)*state;implementation_end;            plug Hout 896 496;            plug p1 904 304;            plug Hin 592 496;            plug p 592 304;            Splitter1 664 496             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;               ellipse 659.7 491.7 668.3 500.3 color -1;              terminals               input 664 496 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Ta00 720 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 720 416 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0i 664 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 664 304 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0k 664 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg top              figures               text '1' 664 184 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;           end;           connections            AdHik\p2 => Ta0k\p;            Ta0k\p => EJS\p1;            p1 => AdHij\p2;            Ta00\p => AdHi0\p1;            Ta0k\p => InertialTensor\p;            Ta0i\p <= AdHik1\p1;            AdHi0\p2 => AdHik1\p2;            Gravity\p => Ta00\p;            Ta0i\p => AdHik\p1;            p <= Ta0i\p;            Ta0i\p <= AdHij\p1;            Hin -> Splitter1\input;            Hij\output -> Hout;            Splitter1\output -> Hij\input;            Splitter1\output -> AdHi0\H;            Hij\Hab -> AdHij\H;           end;           parameterrelationsInertialTensor\I = I;InterialTensor\m = m;EJS\I = I;EJS\m = m;AdHik\COMdim = COMdim;AdHik1\COMdim = COMdim;Hij\dim = dim;Gravity\m=m;parameterrelations_end;           figures            text 'b = current link (body)a = previous link (body)i = Body fixed frame, fixed in joint with previous linkj = Body fixed frame, fixed in joint with next linkk = Body fixed frame, principal inertial frame0 = inertial system ' 352 296;          implementation_end;         Link4 1008 504          description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>Link.emx</LibraryPath> <TimeStamp>2011-1-18 16:36:40</TimeStamp>   <Description>Base</Description></Description>';          type Submodel           ports            power out p [6,1];            signal in Hin [4,4];            power in p1 [6,1];            signal out Hout [4,4];           parameters            real I[3,1] = [1.0; 1.0; 1.0];            real m = 0.877;            real COMdim[3,1] = [0.0; 0.00115; -0.01683];            real dim[3,1] = [0.0; 0.0; 0.096];          end;          icon bg bottom           figures            rectangle 976 432 1040 576 fill 10025880;            text 'Link' 1008 504;           terminals            p 976 464 fixed;            Hin 976 544 fixed;            p1 1040 464 fixed;            Hout 1040 544 fixed;          end;          implementation bg           submodels            AdHi0 664 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power in p1 [6,1];               power out p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'MTF' 664 416 18 bold;             end;             implementation eqvariables 	real onlyRotH[4,4];code	//Only rotations with respect to the inertial system matter!	onlyRotH = H;	onlyRotH[1,4] = 0;	onlyRotH[2,4] = 0;	onlyRotH[3,4] = 0;							p2.e = transpose(Adjoint(onlyRotH)) * p1.e;	p1.f = Adjoint(onlyRotH) * p2.f;implementation_end;            AdHij 816 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg top              figures               text 'MTF' 816 304 18 bold;             end;             implementation eqequations	//Only rotations with respect to the inertial system matter!							p1.e = transpose(Adjoint(H)) * p2.e;	p2.f = Adjoint(H) * p1.f;implementation_end;            AdHik 664 224             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1 [6,1];               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.0; 0.00115; -0.01683];             end;             icon bg left              figures               text 'TF' 664 224 18 bold;             end;             implementation eq//Frame in joint connected to port 1//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            AdHik1 664 368             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power out p1 [6,1];               power in p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.0; 0.00115; -0.01683];             end;             icon bg left              figures               text 'TF' 664 368 18 bold;             end;             implementation eq//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            EJS 728 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MGY.emx</LibraryPath> <TimeStamp>2007-10-31 11:43:6</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MGY              ports               power in p1 [6,1];              parameters               real I[3,1] = [1.0; 1.0; 1.0];               real m = 0.877;             end;             icon bg top              figures               text 'MGY' 728 184 18 bold;             end;             implementation eq//EJS / Gyroscopic effectsvariables	real II[6,6]; //Inertial tensor	real Q[6,6];	real QI[6,6];	real v[3];	real omega[3];equations	II = [	I[1],0,	0,	0,	0,	0;			0,	I[2],0,	0,	0,	0;			0,	0,	I[3],0,	0,	0;			0,	0,	0,	m,	0,	0;			0,	0,	0,	0,	m,	0;			0,	0,	0,	0,	0,	m];	v[1:3] = p1.f[4:6];	omega[1:3] = p1.f[1:3];	Q[1:3,1:3] = -skew(omega);	Q[1:3,4:6] = -skew(v);	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros	Q[4:6,4:6] = -skew(omega);	QI = Q*II;	p1.e = QI*p1.f;implementation_end;            Gravity 776 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Se.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:26</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Se              ports               power out p [6,1];              restrictions               causality fixed out p;              parameters               real m = 0.877;             end;             icon bg bottom              figures               text 'Se' 776 416 18 bold;             end;             implementation eqvariables	real effort[6];equations	effort = [0;0;0;0;0;-9.8*m];	p.e = effort;implementation_end;            Hij 816 496             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>H.emx</LibraryPath>  <TimeStamp>2010-9-21 15:03:50</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input [4,4];               signal out output [4,4];               signal out Hab [4,4];              parameters               real dim[3,1] = [0.0; 0.0; 0.096];             end;             icon bg bottom              figures               rectangle 800.1 480 831.9 512 fill 15132390;               text 'H' 816 496 color 16711680 16 bold;             end;             implementation eqequations	Hab = homogeneous(eye(3),dim);	output = input * Hab;    implementation_end;            InertialTensor 616 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\I.emx</LibraryPath> <TimeStamp>2007-9-25 12:2:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type I              ports               power in p [6,1];               signal out state [6,1];              restrictions               causality preferred in p;              parameters               real m = 1.0;               real I[3,1] = [1.0; 1.0; 1.0];             end;             icon bg top              figures               text 'I' 616 184 18 bold;             end;             implementation eqvariables	real II[6,6]; //Inertial tensorequations	II = [I[1],0,	0,	0,	0,	0;			0,	I[2],0,	0,	0,	0;			0,	0,	I[3],0,	0,	0;			0,	0,	0,	m,	0,	0;			0,	0,	0,	0,	m,	0;			0,	0,	0,	0,	0,	m];    state = int(p.e); //state = generalized momentum    p.f = inverse(II)*state;implementation_end;            plug Hout 896 496;            plug p1 904 304;            plug Hin 592 496;            plug p 592 304;            Splitter1 664 496             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;               ellipse 659.7 491.7 668.3 500.3 color -1;              terminals               input 664 496 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Ta00 720 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 720 416 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0i 664 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 664 304 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0k 664 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg top              figures               text '1' 664 184 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;           end;           connections            AdHik\p2 => Ta0k\p;            Ta00\p => AdHi0\p1;            Ta0k\p => InertialTensor\p;            Ta0i\p <= AdHik1\p1;            AdHi0\p2 => AdHik1\p2;            Gravity\p => Ta00\p;            Ta0i\p => AdHik\p1;            p <= Ta0i\p;            Ta0i\p <= AdHij\p1;            Ta0k\p => EJS\p1;            p1 => AdHij\p2;            Hin -> Splitter1\input;            Hij\output -> Hout;            Splitter1\output -> Hij\input;            Splitter1\output -> AdHi0\H;            Hij\Hab -> AdHij\H;           end;           parameterrelationsInertialTensor\I = I;InterialTensor\m = m;EJS\I = I;EJS\m = m;AdHik\COMdim = COMdim;AdHik1\COMdim = COMdim;Hij\dim = dim;Gravity\m=m;parameterrelations_end;           figures            text 'b = current link (body)a = previous link (body)i = Body fixed frame, fixed in joint with previous linkj = Body fixed frame, fixed in joint with next linkk = Body fixed frame, principal inertial frame0 = inertial system ' 352 296;          implementation_end;         Link5 1168 504          description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>Link.emx</LibraryPath> <TimeStamp>2011-1-18 16:36:40</TimeStamp>   <Description>Base</Description></Description>';          type Submodel           ports            power out p [6,1];            signal in Hin [4,4];            power in p1 [6,1];            signal out Hout [4,4];           parameters            real I[3,1] = [1.0; 1.0; 1.0];            real m = 1.121;            real COMdim[3,1] = [0.0; 0.0; 0.001];            real dim[3,1] = [0.0; 0.0; 0.034];          end;          icon bg bottom           figures            rectangle 1136 432 1200 576 fill 10025880;            text 'Link' 1168 504;           terminals            p 1136 464 fixed;            Hin 1136 544 fixed;            p1 1200 464 fixed;            Hout 1200 544 fixed;          end;          implementation bg           submodels            AdHi0 664 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power in p1 [6,1];               power out p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg left              figures               text 'MTF' 664 416 18 bold;             end;             implementation eqvariables 	real onlyRotH[4,4];code	//Only rotations with respect to the inertial system matter!	onlyRotH = H;	onlyRotH[1,4] = 0;	onlyRotH[2,4] = 0;	onlyRotH[3,4] = 0;							p2.e = transpose(Adjoint(onlyRotH)) * p1.e;	p1.f = Adjoint(onlyRotH) * p2.f;implementation_end;            AdHij 816 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MTF.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:3</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MTF              ports               power out p1 [6,1];               power in p2 [6,1];               signal in H [4,4];              restrictions               causality constraint not_equal p1 p2;             end;             icon bg top              figures               text 'MTF' 816 304 18 bold;             end;             implementation eqequations	//Only rotations with respect to the inertial system matter!							p1.e = transpose(Adjoint(H)) * p2.e;	p2.f = Adjoint(H) * p1.f;implementation_end;            AdHik 664 224             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1 [6,1];               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.0; 0.0; 0.001];             end;             icon bg left              figures               text 'TF' 664 224 18 bold;             end;             implementation eq//Frame in joint connected to port 1//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            AdHik1 664 368             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power out p1 [6,1];               power in p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real COMdim[3,1] = [0.0; 0.0; 0.001];             end;             icon bg left              figures               text 'TF' 664 368 18 bold;             end;             implementation eq//Principal inertial frame connected in port 2variables	real d[3]; //distance between frames	real R[3,3]; //rotation between frames	real H[4,4]; //homogeneous matrix	real AdH[6,6]; //Adjoint of homogeneous matrixequations	d = COMdim; //distance of 1 in z direction of frames	R = eye(3); //no rotation	H = homogeneous(R,d);	AdH = Adjoint(H);	p1.f = AdH * p2.f; 	p2.e = transpose(AdH) * p1.e;implementation_end;            EJS 728 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\MGY.emx</LibraryPath> <TimeStamp>2007-10-31 11:43:6</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type MGY              ports               power in p1 [6,1];              parameters               real I[3,1] = [1.0; 1.0; 1.0];               real m = 1.121;             end;             icon bg top              figures               text 'MGY' 728 184 18 bold;             end;             implementation eq//EJS / Gyroscopic effectsvariables	real II[6,6]; //Inertial tensor	real Q[6,6];	real QI[6,6];	real v[3];	real omega[3];equations	II = [	I[1],0,	0,	0,	0,	0;			0,	I[2],0,	0,	0,	0;			0,	0,	I[3],0,	0,	0;			0,	0,	0,	m,	0,	0;			0,	0,	0,	0,	m,	0;			0,	0,	0,	0,	0,	m];	v[1:3] = p1.f[4:6];	omega[1:3] = p1.f[1:3];	Q[1:3,1:3] = -skew(omega);	Q[1:3,4:6] = -skew(v);	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros	Q[4:6,4:6] = -skew(omega);	QI = Q*II;	p1.e = QI*p1.f;implementation_end;            Gravity 776 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Se.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:26</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Se              ports               power out p [6,1];              restrictions               causality fixed out p;              parameters               real m = 1.121;             end;             icon bg bottom              figures               text 'Se' 776 416 18 bold;             end;             implementation eqvariables	real effort[6];equations	effort = [0;0;0;0;0;-9.8*m];	p.e = effort;implementation_end;            Hij 816 496             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues>   <LibraryPath>H.emx</LibraryPath>  <TimeStamp>2010-9-21 15:03:50</TimeStamp><AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input [4,4];               signal out output [4,4];               signal out Hab [4,4];              parameters               real dim[3,1] = [0.0; 0.0; 0.034];             end;             icon bg bottom              figures               rectangle 800.1 480 831.9 512 fill 15132390;               text 'H' 816 496 color 16711680 16 bold;             end;             implementation eqequations	Hab = homogeneous(eye(3),dim);	output = input * Hab;    implementation_end;            InertialTensor 616 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\I.emx</LibraryPath> <TimeStamp>2007-9-25 12:2:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type I              ports               power in p [6,1];               signal out state [6,1];              restrictions               causality preferred in p;              parameters               real m = 1.0;               real I[3,1] = [1.0; 1.0; 1.0];             end;             icon bg top              figures               text 'I' 616 184 18 bold;             end;             implementation eqvariables	real II[6,6]; //Inertial tensorequations	II = [I[1],0,	0,	0,	0,	0;			0,	I[2],0,	0,	0,	0;			0,	0,	I[3],0,	0,	0;			0,	0,	0,	m,	0,	0;			0,	0,	0,	0,	m,	0;			0,	0,	0,	0,	0,	m];    state = int(p.e); //state = generalized momentum    p.f = inverse(II)*state;implementation_end;            plug Hout 896 496;            plug p1 904 304;            plug Hin 592 496;            plug p 592 304;            Splitter1 664 496             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;               ellipse 659.7 491.7 668.3 500.3 color -1;              terminals               input 664 496 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            Ta00 720 416             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 720 416 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0i 664 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg bottom              figures               text '1' 664 304 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            Ta0k 664 184             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description></Description></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg top              figures               text '1' 664 184 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;           end;           connections            AdHik\p2 => Ta0k\p;            Ta0i\p <= AdHik1\p1;            AdHi0\p2 => AdHik1\p2;            Gravity\p => Ta00\p;            Ta0i\p => AdHik\p1;            p <= Ta0i\p;            Ta0i\p <= AdHij\p1;            Ta0k\p => EJS\p1;            p1 => AdHij\p2;            Ta00\p => AdHi0\p1;            Ta0k\p => InertialTensor\p;            Hin -> Splitter1\input;            Hij\output -> Hout;            Splitter1\output -> Hij\input;            Splitter1\output -> AdHi0\H;            Hij\Hab -> AdHij\H;           end;           parameterrelationsInertialTensor\I = I;InterialTensor\m = m;EJS\I = I;EJS\m = m;AdHik\COMdim = COMdim;AdHik1\COMdim = COMdim;Hij\dim = dim;Gravity\m=m;parameterrelations_end;           figures            text 'b = current link (body)a = previous link (body)i = Body fixed frame, fixed in joint with previous linkj = Body fixed frame, fixed in joint with next linkk = Body fixed frame, principal inertial frame0 = inertial system ' 352 296;          implementation_end;         MecanumWheels 279.9 504          description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>MechanumWheels.emx</LibraryPath>  <TimeStamp>2011-1-21 10:44:35</TimeStamp></Description>';          type Submodel           ports            power in p [6,1];            power in p1 [6,1];            power in MotorRR;            power in MotorLR;            power in MotorLF;            power in MotorRF;            signal out Hout [4,4];            signal in Hin [4,4];           restrictions            causality fixed in MotorLR;            causality fixed in MotorLF;            causality fixed in MotorRF;            causality fixed in MotorRR;           parameters            real WheelRadius = 0.0475;            real WheelLFpos[2,1] = [0.235; 0.15];            real WheelRFpos[2,1] = [0.235; -0.15];            real WheelLRpos[2,1] = [-0.235; 0.15];            real WheelRRpos[2,1] = [-0.235; -0.15];            real Cfloor = 1.0e-4;            real Rfloor = 1000.0;            real init[4,4] = [1.0, 0.0, 0.0, 0.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];            real Rwheel = 0.1;          end;          icon bg bottom           figures            rectangle 239.1 432.5 320.6 575.5 fill 16443110;            text 'Mecanum  Wheels' 279.9 504 fill 16443110 16;           terminals            p 319.9 464 fixed;            p1 240.4 463 fixed;            MotorRR 303.9 432 fixed;            MotorLR 287.9 432 fixed;            MotorLF 255.9 432 fixed;            MotorRF 271.9 432 fixed;            Hout 319.9 544 fixed;            Hin 239.9 544 fixed;          end;          implementation bg           submodels            Cfloor 816 664             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\C.emx</LibraryPath> <TimeStamp>2007-10-31 10:43:59</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type C              ports               power in p [6,1];               signal out state [6,1];              restrictions               causality preferred out p;              parameters               real Cfloor = 1.0e-4;             end;             icon bg bottom              figures               text 'C' 816 664 18 bold;             end;             implementation eqequations    state = int(p.f);    p.e = 100*[(1/Cfloor) * state[1];(1/Cfloor) * state[2];0;0;0;(1/Cfloor) * state[6]];implementation_end;            Integrate2 1032 624             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath> <TimeStamp>2007-9-26 12:3:23</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Integrate              ports               signal in input [6,1];               signal out output [4,4];              parameters               real init[4,4] = [1.0, 0.0, 0.0, 0.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];             end;             icon bg              figures               rectangle 1016 608 1048 640 fill 15132390;               text 'ò' 1032 621.3 color 16711680 'SymbolProp BT' 21 symbol;             end;             implementation eqparameters	real r = 0.047;//5; //radius of the wheels	real x = 0.235;  // lateral distance from center of mass to wheel contact point	real y = 0.15;   // longitudinal  distance from center of mass to wheel contact pointvariables	real H[4,4];	real dotH[4,4];	real tildeT[4,4];	real A[3,4];	real Base_velocities[4];	real intTest;equations	tildeT = tilde(input);	dotH = H*tildeT;	H = int(dotH,init);	output = H;	A=(1/(2*r))*	[ 	x+y 	,x+y	,x+y	,x+y;		-1		, 1	,-1	, 1;		1		, 1	,-1	,- 1];	Base_velocities=transpose(A)*input[3:5];	intTest=det(H);     	     implementation_end;            MatrixMul 1032 792             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath> <TimeStamp>2007-9-26 12:15:12</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type Gain              ports               signal in input1 [4,4];               signal out output [4,4];               signal in input2 [4,4];             end;             icon bg bottom              figures               rectangle 1016.1 776 1047.9 808 fill 15132390;               text 'X' 1032 792 color 16711680 16 bold;             end;             implementation eqequations	output = input2*input1;    implementation_end;            MecanumWheelAnimation 1103.5 312             description '<Description> <Version>4.0</Version> <LibraryPath>Template\Submodel-Equation.emx</LibraryPath> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <TimeStamp>2007-11-1 22:32:1</TimeStamp> <AllowLibraryUpdate>False</AllowLibraryUpdate></Description>';             type 'Submodel-Equation'              ports               signal in Hbase0 [4,4];               signal in vWheelLF;               signal in vWheelRF;               signal in vWheelLR;               signal in vWheelRR;              parameters               real WheelLFpos[2,1] = [0.235; 0.15];               real WheelRFpos[2,1] = [0.235; -0.15];               real WheelLRpos[2,1] = [-0.235; 0.15];               real WheelRRpos[2,1] = [-0.235; -0.15];             end;             icon bg              figures               rectangle 1055 272 1152 352 fill 14013909;               text 'Mecanum   Wheel Animation' 1104 312 16;              terminals               Hbase0 1104 352 fixed;               vWheelLF 1056 288 fixed;               vWheelRF 1056 304 fixed;               vWheelLR 1056 320 fixed;               vWheelRR 1056 336 fixed;             end;             implementation eqparameters	real rot = 1.57;	real CameraOffset[4]=[1;1;1;1];//endvariables//t.b.v. animation of mecanum wheels	real HLRrot[4,4], HLFrot[4,4], HRRrot[4,4], HRFrot[4,4];	real RLRrot[3,3], RLFrot[3,3], RRRrot[3,3], RRFrot[3,3];	real RLRbase[3,3], RLFbase[3,3], RRFbase[3,3], RRRbase[3,3];	real HLRbase[4,4], HLFbase[4,4], HRFbase[4,4], HRRbase[4,4];	real HLR0[4,4], HLF0[4,4], HRF0[4,4], HRR0[4,4];	real pLRbase[3], pLFbase[3], pRFbase[3], pRRbase[3];	real qWheelLF, qWheelRF,qWheelLR, qWheelRR;	real CameraPose[4];//endequations	qWheelLF = int(-vWheelLF);//actual direction of the roation is negative due too KUKA naming convention	qWheelRF = int(vWheelRF);	qWheelLR = int(-vWheelLR);//actual direction of the roation is negative due too KUKA naming convention	qWheelRR = int(vWheelRR);	CameraPose=Hbase0*CameraOffset;//t.b.v. animation of mecanum wheel	pLFbase = [WheelLFpos[1];WheelLFpos[2];0.05];	pRFbase = [WheelRFpos[1];WheelRFpos[2];0.05];	pLRbase = [WheelLRpos[1];WheelLRpos[2];0.05];	pRRbase = [WheelRRpos[1];WheelRRpos[2];0.05];		RLRbase = [		1,	0,				0;		0,	cos(rot),	-sin(rot);		0, sin(rot),	cos(rot)	];			RLFbase = [		1,	0,				0;		0,	cos(rot),	-sin(rot);		0, sin(rot),	cos(rot)	];	RRFbase = [		1,	0,				0;		0,	cos(rot),	-sin(rot);		0, sin(rot),	cos(rot)	];	RRRbase = [		1,	0,				0;		0,	cos(rot),	-sin(rot);		0, sin(rot),	cos(rot)	];	HLFbase = homogeneous(RLFbase, pLFbase);	HLRbase = homogeneous(RLRbase, pLRbase);	HRRbase = homogeneous(RRRbase, pRRbase);	HRFbase = homogeneous(RRFbase, pRFbase);	RLRrot = [		cos(-qWheelLR),	-sin(-qWheelLR),	0;		sin(-qWheelLR),	cos(-qWheelLR),	0;		0,				0,				1	];			RLFrot = [		cos(-qWheelLF),	-sin(-qWheelLF),	0;		sin(-qWheelLF),	cos(-qWheelLF),	0;		0,				0,				1	];	RRFrot = [		cos(-qWheelRF),	-sin(-qWheelRF),	0;		sin(-qWheelRF),	cos(-qWheelRF),	0;		0,				0,				1	];	RRRrot = [		cos(-qWheelRR),	-sin(-qWheelRR),	0;		sin(-qWheelRR),	cos(-qWheelRR),	0;		0,				0,				1	];	HLFrot = homogeneous(RLFrot,[0;0;0]);	HRFrot = homogeneous(RRFrot,[0;0;0]);	HLRrot = homogeneous(RLRrot,[0;0;0]);	HRRrot = homogeneous(RRRrot,[0;0;0]);	HLF0 = Hbase0*HLFbase*HLFrot;	HRF0 = Hbase0*HRFbase*HRFrot;	HLR0 = Hbase0*HLRbase*HLRrot;	HRR0 = Hbase0*HRRbase*HRRrot;//end implementation_end;            plug MotorLR 912 240;            plug MotorLF 720 240;            plug Hout 1184 792;            plug Hin 696 792;            plug MotorRR 1008 240;            plug p1 693 704;            plug MotorRF 816 240;            plug p 1168 704;            OneJunction 920 624             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               power knot duplicatable none p [6,1];               signal knot out flow [6,1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 920 624 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);implementation_end;            OneJunction2 1008 336             description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               power knot duplicatable none p [1];               signal knot out flow [1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 1008 336 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);    implementation_end;            OneJunction3 912 320             description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               power knot duplicatable none p [1];               signal knot out flow [1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 912 320 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);    implementation_end;            OneJunction4 720 288             description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               power knot duplicatable none p [1];               signal knot out flow [1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 720 288 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);    implementation_end;            OneJunction5 816 304             description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:18</TimeStamp></Description>';             knot OneJunction              ports               power knot duplicatable none p [1];               signal knot out flow [1];              restrictions               causality constraint one_out p;             end;             icon bg              figures               text '1' 816 304 18 bold;             end;             implementation eqequations	sum (direct (p.e)) = 0;	equal (collect (p.f));	flow = first (p.f);    implementation_end;            Rfloor 816 608             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type R              ports               power in p [6,1];              parameters               real Rfloor = 1000.0;             end;             icon bg bottom              figures               text 'R' 816 608 18 bold;             end;             implementation eqequations						p.e = [Rfloor * p.f[1];Rfloor * p.f[2];0;0;0;Rfloor * p.f[6]];	implementation_end;            RwheelLF 672 288             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type R              ports               power in p;              parameters               real Rwheel = 0.1;             end;             icon bg bottom              figures               text 'R' 672 288 18 bold;             end;             implementation eqequations						p.e = Rwheel * p.f;implementation_end;            RwheelLR 864 320             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type R              ports               power in p;              parameters               real Rwheel = 0.1;             end;             icon bg bottom              figures               text 'R' 864 320 18 bold;             end;             implementation eqequations						p.e = Rwheel * p.f;implementation_end;            RwheelRF 768 304             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type R              ports               power in p;              parameters               real Rwheel = 0.1;             end;             icon bg bottom              figures               text 'R' 768 304 18 bold;             end;             implementation eqequations						p.e = Rwheel * p.f;implementation_end;            RwheelRR 960 336             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\R.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:18</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type R              ports               power in p;              parameters               real Rwheel = 0.1;             end;             icon bg bottom              figures               text 'R' 960 336 18 bold;             end;             implementation eqequations						p.e = Rwheel * p.f;implementation_end;            Splitter1 1104 792             description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';             knot Splitter              ports               signal knot duplicatable out output [4,4];               signal knot in input [4,4];             end;             icon bg ellipse              figures               ellipse 1100.8 788.8 1107.2 795.2 color -1 fill 0;               ellipse 1099.7 787.7 1108.3 796.3 color -1;              terminals               input 1104 792 fixed;             end;             implementation eqequations    collect (output) = input;implementation_end;            TF_LF 720 504             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1 [3,1];               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real WheelLFpos[2,1] = [0.235; 0.15];             end;             icon bg bottom              figures               text 'TF' 720 504 18 bold;             end;             implementation eqvariables		real TFr[6,3];	real transTFr[3,6];equations	TFr[1:3,1:3] = skew([WheelLFpos[1];WheelLFpos[2];0]);	TFr[4:6,1:3] = eye(3); 	transTFr[1:3,1:3] = -skew([WheelLFpos[1];WheelLFpos[2];0]);	transTFr[1:3,4:6] = eye(3); 		p2.e = TFr*p1.e;	p1.f = transTFr*p2.f;implementation_end;            TF_LR 912 504             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1 [3,1];               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real WheelLRpos[2,1] = [-0.235; 0.15];             end;             icon bg bottom              figures               text 'TF' 912 504 18 bold;             end;             implementation eqvariables	real TFr[6,3];	real transTFr[3,6];equations	TFr[1:3,1:3] = skew([WheelLRpos[1];WheelLRpos[2];0]);	TFr[4:6,1:3] = eye(3); 	transTFr[1:3,1:3] = -skew([WheelLRpos[1];WheelLRpos[2];0]);	transTFr[1:3,4:6] = eye(3); 		p2.e = TFr*p1.e;	p1.f = transTFr*p2.f;implementation_end;            TF_RF 816 504             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1 [3,1];               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real WheelRFpos[2,1] = [0.235; -0.15];             end;             icon bg bottom              figures               text 'TF' 816 504 18 bold;             end;             implementation eqvariables		real TFr[6,3];	real transTFr[3,6];equations	TFr[1:3,1:3] = skew([WheelRFpos[1];WheelRFpos[2];0]);	TFr[4:6,1:3] = eye(3); 	transTFr[1:3,1:3] = -skew([WheelRFpos[1];WheelRFpos[2];0]);	transTFr[1:3,4:6] = eye(3); 		p2.e = TFr*p1.e;	p1.f = transTFr*p2.f;implementation_end;            TF_RR 1008 504             description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';             type TF              ports               power in p1 [3,1];               power out p2 [6,1];              restrictions               causality constraint not_equal p1 p2;              parameters               real WheelRRpos[2,1] = [-0.235; -0.15];             end;             icon bg bottom              figures               text 'TF' 1008 504 18 bold;             end;             implementation eqvariables		real TFr[6,3];	real transTFr[3,6];equations	TFr[1:3,1:3] = skew([WheelRRpos[1];WheelRRpos[2];0]);	TFr[4:6,1:3] = eye(3); 	transTFr[1:3,1:3] = -skew([WheelRRpos[1];WheelRRpos[2];0]);	transTFr[1:3,4:6] = eye(3); 		p2.e = TFr*p1.e;	p1.f = transTFr*p2.f;implementation_end;            WheelLF 720 408             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>MecanumWheelB.emx</LibraryPath>  <TimeStamp>2011-1-20 16:56:09</TimeStamp></Description>';             type Submodel              ports               power in p;               power out p2 [3,1];              parameters               real WheelRadius = 0.0475;             end;             icon bg bottom              figures               rectangle 690 386 750 430 fill 16777152;               text 'Mecanum wheel type B' 720 408;             end;             implementation bg              submodels               MotorTorgue 112 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:43</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                knot ZeroJunction                 ports                  power knot duplicatable none p [1];                  signal knot out effort [1];                 restrictions                  causality constraint one_in p;                end;                icon bg top                 figures                  text '0' 112 176 18 bold;                end;                implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;               plug p 71 176;               plug p2 457 176;               TF1 240 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description>Transforms from the frame in the contact point of the mechanum wheel with the floor, alligned with the principal inertial frame of the robot bodyto the the frame in the contact point of the mechanum wheel with the floor, alligned with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description></Description>';                type TF                 ports                  power in p1 [3,1];                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                end;                icon bg bottom                 figures                  text 'TF' 240 176 18 bold;                end;                implementation eq//Standard rotation arboud z-axisvariables	real R[3,3]; equations	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;			sin(-pi/4), 	cos(-pi/4),		0;			0			,	0,					1];						p1.e = transpose(R) * p2.e;	p2.f = R * p1.f;implementation_end;               TF2 304 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description>This transformer represents the interchange of energy between the wheel and the floor. In the rolling direction there is no energy exchangem, in the siding direction there is.In case of a type B mechanum wheel the rolling direction is the y direction of the frame oriented with the roller.</Description></Description>';                type TF                 ports                  power in p1 [3,1];                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                end;                icon bg bottom                 figures                  text 'TF' 304 176 18 bold;                end;                implementation eqparameters	real r[3,3] = [0.0, 0.0, 0.0;0.0, 1.0, 0.0;0.0, 0.0, 1.0];equationsp2.e = transpose(r)*p1.e;p1.f = r*p2.f;implementation_end;               TF3 368 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description>Inverse of TF1: Transforms back.</Description></Description>';                type TF                 ports                  power in p1 [3,1];                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                end;                icon bg bottom                 figures                  text 'TF' 368 176 18 bold;                end;                implementation eq//standard rotation around z-axisvariables	real R[3,3]; equations	R = [	cos(pi/4), 	-sin(pi/4), 	0;			sin(pi/4), 	cos(pi/4),	0;			0			,	0,					1];						p1.e = transpose(R) * p2.e;	p2.f = R * p1.f;implementation_end;               WheelRadius 152 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type TF                 ports                  power in p1;                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                 parameters                  real WheelRadius = 0.0475;                end;                icon bg bottom                 figures                  text 'TF' 152 176 18 bold;                end;                implementation eqequations						p2.e = [-p1.e/WheelRadius;0;0];	p1.f = -p2.f[1]/WheelRadius;implementation_end;              end;              connections               WheelRadius\p2 => TF1\p1;               MotorTorgue\p => WheelRadius\p1;               TF1\p2 => TF2\p1;               TF2\p2 => TF3\p1;               p => MotorTorgue\p;               TF3\p2 => p2;              end;              parameterrelationsWheelRadius\WheelRadius = WheelRadius;parameterrelations_end;             implementation_end;            WheelLR 912 408             description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>MecanumWheelA.emx</LibraryPath> <TimeStamp>2011-1-18 13:53:24</TimeStamp></Description>';             type Submodel              ports               power in p;               power out p2 [3,1];              parameters               real WheelRadius = 0.0475;             end;             icon bg bottom              figures               rectangle 882 386 942 430 fill 16777152;               text 'Mecanum wheel type A' 912 408;             end;             implementation bg              submodels               MotorTorgue1 96 304                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:43</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                knot ZeroJunction                 ports                  power knot duplicatable none p [1];                  signal knot out effort [1];                 restrictions                  causality constraint one_in p;                end;                icon bg top                 figures                  text '0' 96 304 18 bold;                end;                implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;               plug p 47 304;               plug p2 401 304;               TF1 200 304                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description>Transforms from the frame in the contact point of the mechanum wheel with the floor, alligned with the principal inertial frame of the robot bodyto the the frame in the contact point of the mechanum wheel with the floor, alligned with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description></Description>';                type TF                 ports                  power in p1 [3,1];                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                end;                icon bg bottom                 figures                  text 'TF' 200 304 18 bold;                end;                implementation eq//standard rotation around z-axisvariables	real R[3,3]; equations	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;			sin(-pi/4), 	cos(-pi/4),		0;			0			,	0,					1];						p1.e = transpose(R) * p2.e;	p2.f = R * p1.f;implementation_end;               TF2 256 304                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description>This transformer represents the interchange of energy between the wheel and the floor. In the rolling direction there is no energy exchangem, in the siding direction there is.In case of a type A mechanum wheel the rolling direction is the x direction of the frame oriented with the roller.</Description></Description>';                type TF                 ports                  power in p1 [3,1];                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                end;                icon bg bottom                 figures                  text 'TF' 256 304 18 bold;                end;                implementation eqparameters	real r[3,3] = [1.0, 0.0, 0.0;0.0, 0.0, 0.0;0.0, 0.0, 1.0];equationsp2.e = transpose(r)*p1.e;p1.f = r*p2.f;implementation_end;               TF3 312 304                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description>Inverse of TF1: transforms back.</Description></Description>';                type TF                 ports                  power in p1 [3,1];                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                end;                icon bg bottom                 figures                  text 'TF' 312 304 18 bold;                end;                implementation eq//standard rotation around z-axisvariables	real R[3,3]; equations	R = [	cos(pi/4), 	-sin(pi/4), 	0;			sin(pi/4), 	cos(pi/4),	0;			0			,	0,					1];						p1.e = transpose(R) * p2.e;	p2.f = R * p1.f;implementation_end;               WheelRadius 144 304                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type TF                 ports                  power in p1;                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                 parameters                  real WheelRadius = 0.0475;                end;                icon bg bottom                 figures                  text 'TF' 144 304 18 bold;                end;                implementation eqequations						p2.e = [-p1.e/WheelRadius;0;0];	p1.f = -p2.f[1]/WheelRadius;implementation_end;              end;              connections               WheelRadius\p2 => TF1\p1;               TF1\p2 => TF2\p1;               MotorTorgue1\p => WheelRadius\p1;               TF2\p2 => TF3\p1;               p => MotorTorgue1\p;               TF3\p2 => p2;              end;              parameterrelationsWheelRadius\WheelRadius = WheelRadius;parameterrelations_end;             implementation_end;            WheelRF 816 408             description '<Description>   <Version>4.1</Version><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <LibraryPath>MecanumWheelA.emx</LibraryPath>  <TimeStamp>2011-1-21 10:44:27</TimeStamp></Description>';             type Submodel              ports               power in p;               power out p2 [3,1];              parameters               real WheelRadius = 0.0475;             end;             icon bg bottom              figures               rectangle 786 386 846 430 fill 16777152;               text 'Mecanum wheel type A' 816 408;             end;             implementation bg              submodels               MotorTorgue1 96 304                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:43</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                knot ZeroJunction                 ports                  power knot duplicatable none p [1];                  signal knot out effort [1];                 restrictions                  causality constraint one_in p;                end;                icon bg top                 figures                  text '0' 96 304 18 bold;                end;                implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;               plug p 47 304;               plug p2 401 304;               TF1 200 304                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description>Transforms from the frame in the contact point of the mechanum wheel with the floor, alligned with the principal inertial frame of the robot bodyto the the frame in the contact point of the mechanum wheel with the floor, alligned with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description></Description>';                type TF                 ports                  power in p1 [3,1];                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                end;                icon bg bottom                 figures                  text 'TF' 200 304 18 bold;                end;                implementation eq//standard rotation around z-axisvariables	real R[3,3]; equations	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;			sin(-pi/4), 	cos(-pi/4),		0;			0			,	0,					1];						p1.e = transpose(R) * p2.e;	p2.f = R * p1.f;implementation_end;               TF2 256 304                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description>This transformer represents the interchange of energy between the wheel and the floor. In the rolling direction there is no energy exchangem, in the siding direction there is.In case of a type A mechanum wheel the rolling direction is the x direction of the frame oriented with the roller.</Description></Description>';                type TF                 ports                  power in p1 [3,1];                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                end;                icon bg bottom                 figures                  text 'TF' 256 304 18 bold;                end;                implementation eqparameters	real r[3,3] = [1.0, 0.0, 0.0;0.0, 0.0, 0.0;0.0, 0.0, 1.0];equationsp2.e = transpose(r)*p1.e;p1.f = r*p2.f;implementation_end;               TF3 312 304                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description>Inverse of TF1: transforms back.</Description></Description>';                type TF                 ports                  power in p1 [3,1];                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                end;                icon bg bottom                 figures                  text 'TF' 312 304 18 bold;                end;                implementation eq//standard rotation around z-axisvariables	real R[3,3]; equations	R = [	cos(pi/4), 	-sin(pi/4), 	0;			sin(pi/4), 	cos(pi/4),	0;			0			,	0,					1];						p1.e = transpose(R) * p2.e;	p2.f = R * p1.f;implementation_end;               WheelRadius 144 304                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type TF                 ports                  power in p1;                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                 parameters                  real WheelRadius = 0.0475;                end;                icon bg bottom                 figures                  text 'TF' 144 304 18 bold;                end;                implementation eqequations						p2.e = [p1.e/WheelRadius;0;0];	p1.f = p2.f[1]/WheelRadius;implementation_end;              end;              connections               WheelRadius\p2 => TF1\p1;               TF1\p2 => TF2\p1;               MotorTorgue1\p => WheelRadius\p1;               TF2\p2 => TF3\p1;               p => MotorTorgue1\p;               TF3\p2 => p2;              end;              parameterrelationsWheelRadius\WheelRadius = WheelRadius;parameterrelations_end;             implementation_end;            WheelRR 1008 408             description '<Description> <Version>4.1</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate> <LibraryPath>MecanumWheelB.emx</LibraryPath> <TimeStamp>2011-1-18 13:51:59</TimeStamp></Description>';             type Submodel              ports               power in p;               power out p2 [3,1];              parameters               real WheelRadius = 0.0475;             end;             icon bg bottom              figures               rectangle 978 386 1038 430 fill 16777152;               text 'Mecanum wheel type B' 1008 408;             end;             implementation bg              submodels               MotorTorgue 112 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath> <TimeStamp>2007-9-27 9:51:43</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                knot ZeroJunction                 ports                  power knot duplicatable none p [1];                  signal knot out effort [1];                 restrictions                  causality constraint one_in p;                end;                icon bg top                 figures                  text '0' 112 176 18 bold;                end;                implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;               plug p 71 176;               plug p2 457 176;               TF1 240 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description>Transforms from the frame in the contact point of the mechanum wheel with the floor, alligned with the principal inertial frame of the robot bodyto the the frame in the contact point of the mechanum wheel with the floor, alligned with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description></Description>';                type TF                 ports                  power in p1 [3,1];                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                end;                icon bg bottom                 figures                  text 'TF' 240 176 18 bold;                end;                implementation eq//Standard rotation arboud z-axisvariables	real R[3,3]; equations	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;			sin(-pi/4), 	cos(-pi/4),		0;			0			,	0,					1];						p1.e = transpose(R) * p2.e;	p2.f = R * p1.f;implementation_end;               TF2 304 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description>This transformer represents the interchange of energy between the wheel and the floor. In the rolling direction there is no energy exchangem, in the siding direction there is.In case of a type B mechanum wheel the rolling direction is the y direction of the frame oriented with the roller.</Description></Description>';                type TF                 ports                  power in p1 [3,1];                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                end;                icon bg bottom                 figures                  text 'TF' 304 176 18 bold;                end;                implementation eqparameters	real r[3,3] = [0.0, 0.0, 0.0;0.0, 1.0, 0.0;0.0, 0.0, 1.0];equationsp2.e = transpose(r)*p1.e;p1.f = r*p2.f;implementation_end;               TF3 368 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate>   <Description>Inverse of TF1: Transforms back.</Description></Description>';                type TF                 ports                  power in p1 [3,1];                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                end;                icon bg bottom                 figures                  text 'TF' 368 176 18 bold;                end;                implementation eq//standard rotation around z-axisvariables	real R[3,3]; equations	R = [	cos(pi/4), 	-sin(pi/4), 	0;			sin(pi/4), 	cos(pi/4),	0;			0			,	0,					1];						p1.e = transpose(R) * p2.e;	p2.f = R * p1.f;implementation_end;               WheelRadius 152 176                description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\TF.emx</LibraryPath> <TimeStamp>2007-9-25 12:4:2</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';                type TF                 ports                  power in p1;                  power out p2 [3,1];                 restrictions                  causality constraint not_equal p1 p2;                 parameters                  real WheelRadius = 0.0475;                end;                icon bg bottom                 figures                  text 'TF' 152 176 18 bold;                end;                implementation eqequations						p2.e = [p1.e/WheelRadius;0;0];	p1.f = p2.f[1]/WheelRadius;implementation_end;              end;              connections               WheelRadius\p2 => TF1\p1;               MotorTorgue\p => WheelRadius\p1;               TF1\p2 => TF2\p1;               TF2\p2 => TF3\p1;               p => MotorTorgue\p;               TF3\p2 => p2;              end;              parameterrelationsWheelRadius\WheelRadius = WheelRadius;parameterrelations_end;             implementation_end;            ZeroJunction 920 704             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>  <TimeStamp>2007-9-27 9:51:43</TimeStamp></Description>';             knot ZeroJunction              ports               power knot duplicatable none p [6,1];               signal knot out effort [6,1];              restrictions               causality constraint one_in p;             end;             icon bg              figures               text '0' 920 704 18 bold;             end;             implementation eqequations	sum (direct (p.f)) = 0;	equal (collect (p.e));	effort = first (p.e);implementation_end;           end;           connections            WheelLF\p2 => TF_LF\p1;            Cfloor\p <= OneJunction\p;            OneJunction\p => Rfloor\p;            p => ZeroJunction\p;            p1 => ZeroJunction\p;            MotorRR => OneJunction2\p;            MotorLR => OneJunction3\p;            MotorLF => OneJunction4\p;            MotorRF => OneJunction5\p;            WheelLR\p2 => TF_LR\p1;            RwheelRR\p <= OneJunction2\p;            TF_LR\p2 => OneJunction\p;            OneJunction2\p => WheelRR\p;            RwheelLR\p <= OneJunction3\p;            OneJunction4\p => WheelLF\p;            RwheelLF\p <= OneJunction4\p;            OneJunction5\p => WheelRF\p;            RwheelRF\p <= OneJunction5\p;            WheelRF\p2 => TF_RF\p1;            WheelRR\p2 => TF_RR\p1;            TF_LF\p2 => OneJunction\p;            TF_RF\p2 => OneJunction\p;            TF_RR\p2 => OneJunction\p;            OneJunction3\p => WheelLR\p;            ZeroJunction\p => OneJunction\p;            OneJunction\flow -> Integrate2\input;            MatrixMul\output -> Splitter1\input;            Splitter1\output -> Hout;            Splitter1\output -> MecanumWheelAnimation\Hbase0;            OneJunction4\flow -> MecanumWheelAnimation\vWheelLF;            OneJunction5\flow -> MecanumWheelAnimation\vWheelRF;            OneJunction3\flow -> MecanumWheelAnimation\vWheelLR;            MecanumWheelAnimation\vWheelRR <- OneJunction2\flow;            Integrate2\output -> MatrixMul\input1;            Hin -> MatrixMul\input2;           end;           parameterrelationsWheelLF\WheelRadius = WheelRadius;WheelRF\WheelRadius = WheelRadius;WheelLR\WheelRadius = WheelRadius;WheelRR\WheelRadius = WheelRadius;Integrate2\init = init;TF_LF\WheelLFpos = WheelLFpos;TF_RF\WheelRFpos = WheelRFpos;TF_LR\WheelLRpos = WheelLRpos;TF_RR\WheelRRpos = WheelRRpos;MecanumWheelAnimation\WheelLFpos = WheelLFpos;MecanumWheelAnimation\WheelLRpos = WheelLRpos;MecanumWheelAnimation\WheelRFpos = WheelRFpos;MecanumWheelAnimation\WheelRRpos = WheelRRpos;Rfloor\Rfloor = Rfloor;Cfloor\Cfloor = Cfloor;RwheelLF\Rwheel = Rwheel;RwheelRF\Rwheel = Rwheel;RwheelLR\Rwheel = Rwheel;RwheelRR\Rwheel = Rwheel;parameterrelations_end;          implementation_end;         Mux 696 193          description '<Description> <Version>4.0</Version> <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath> <TimeStamp>2007-10-31 11:32:54</TimeStamp> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Submodel           ports            power in port [9,1];            power out port1;            power out port2;            power out port3;            power out port4;            power out port5;            power out port6;            power out port7;            power out port8;            power out port9;           restrictions            causality fixed in port;            causality fixed out port1;            causality fixed out port2;            causality fixed out port3;            causality fixed out port4;            causality fixed out port5;            causality fixed out port6;            causality fixed out port7;            causality fixed out port8;            causality fixed out port9;          end;          icon bg           figures            rectangle 616 178 776 208 fill 14013909;            text 'Mux' 696 192 16;           terminals            port 696 176 fixed;            port1 632 208 fixed;            port2 648 208 fixed;            port3 664 208 fixed;            port4 680 208 fixed;            port5 696 208 fixed;            port6 712 208 fixed;            port7 728 208 fixed;            port8 744 208 fixed;            port9 760 208 fixed;          end;          implementation eqequations	port1.e = port.e[1];	port2.e = port.e[2];	port3.e = port.e[3];	port4.e = port.e[4];	port5.e = port.e[5];	port6.e = port.e[6];	port7.e = port.e[7];	port8.e = port.e[8];	port9.e = port.e[9];		port.f[1] = port1.f;	port.f[2] = port2.f;	port.f[3] = port3.f;	port.f[4] = port4.f;	port.f[5] = port5.f;	port.f[6] = port6.f;	port.f[7] = port7.f;	port.f[8] = port8.f;	port.f[9] = port9.f;implementation_end;         plug joints 696 120;         Tfloor0 192 464          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Sf.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:35</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Sf           ports            power out p [6,1];           restrictions            causality fixed in p;          end;          icon bg bottom           figures            text 'Sf' 192 464 18 bold;          end;          implementation eqparameters	real flow = 0.0;variables	real effort[6];equations	p.f = flow;	effort = p.e;implementation_end;         Wtip0 1240 464          description '<Description> <Version>4.0</Version> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <LibraryPath>Bond Graph\Se.emx</LibraryPath> <TimeStamp>2007-9-25 12:3:26</TimeStamp> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>';          type Se           ports            power out p [6,1];           restrictions            causality fixed out p;          end;          icon bg bottom           figures            text 'Se' 1240 464 18 bold;          end;          implementation eqparameters	real effort = 0.0;variables	real flow[6];equations	p.e = effort;	flow = p.f;implementation_end;        end;        connections         MecanumWheels\MotorLF <= Mux\port1 256 240 632 240;         Mux\port9 => Joint45\p1 760 224 1088 224;         Mux\port7 => Joint23\p1 728 256 768 256;         Link1\p => JointBase1\p2;         MecanumWheels\p <= Base\p;         Link3\p => Joint23\p2;         Joint12\p => Link1\p1;         Link2\p => Joint12\p2;         Joint45\p => Link4\p1;         JointBase1\p => Base\p1;         Link5\p => Joint45\p2;         Link3\p1 <= Joint34\p;         Link5\p1 <= Wtip0\p;         MecanumWheels\MotorLR <= Mux\port3 288 272 664 272;         Mux\port <= joints;         MecanumWheels\MotorRR <= Mux\port4 304 288 680 288;         JointBase1\p1 <= Mux\port5 448 304 696 304;         Tfloor0\p => MecanumWheels\p1;         MecanumWheels\MotorRF <= Mux\port2 272 256 648 256;         Joint23\p => Link2\p1;         Joint12\p1 <= Mux\port6 608 320 712 320;         Link4\p => Joint34\p2;         Mux\port8 => Joint34\p1 744 240 928 240;         MecanumWheels\Hout -> Base\Hin;         Link3\Hin <- Joint23\Hout 808 544;         Joint34\Hin <- Link3\Hout;         Link5\Hin <- Joint45\Hout;         Link5\Hout -> Htip0\input;         Link4\Hin <- Joint34\Hout;         Joint45\Hin <- Link4\Hout;         Joint12\Hout -> Link2\Hin;         Joint23\Hin <- Link2\Hout;         Hfloor0\output -> MecanumWheels\Hin;         Base\Hout -> JointBase1\Hin;         JointBase1\Hout -> Link1\Hin;         Link1\Hout -> Joint12\Hin;        end;        parameterrelationsMecanumWheels\WheelRadius = MecanumWheelRadius;MecanumWheels\WheelLFpos = Wheelpos[1:2,1];MecanumWheels\WheelRFpos = Wheelpos[1:2,2];MecanumWheels\WheelLRpos = Wheelpos[1:2,3];MecanumWheels\WheelRRpos = Wheelpos[1:2,4];MecanumWheels\Cfloor = Cconstraint;MecanumWheels\Rfloor = Rconstraint;MecanumWheels\init = InitialBasePos;MecanumWheels\Rwheel = Rwheel;Base\I = LinkI[1:3,1];Base\m = Linkm[1];Base\COMdim = LinkCOMdim[1:3,1];Base\dim = Linkdim[1:3,1];Link1\I = LinkI[1:3,2];Link1\m = Linkm[2];Link1\COMdim = LinkCOMdim[1:3,2];Link1\dim = Linkdim[1:3,2];Link2\I = LinkI[1:3,3];Link2\m = Linkm[3];Link2\COMdim = LinkCOMdim[1:3,3];Link2\dim = Linkdim[1:3,3];Link3\I =LinkI[1:3,4];Link3\m = Linkm[4];Link3\COMdim = LinkCOMdim[1:3,4];Link3\dim = Linkdim[1:3,4];Link4\I = LinkI[1:3,5];Link4\m = Linkm[5];Link4\COMdim = LinkCOMdim[1:3,5];Link4\dim = Linkdim[1:3,5];Link5\I = LinkI[1:3,6];Link5\m = Linkm[6];Link5\COMdim = LinkCOMdim[1:3,6];Link5\dim = Linkdim[1:3,6];JointBase1\Rendstop = Rconstraint;JointBase1\Cendstop = Cconstraint;JointBase1\InitialPos = InitialJointPos[1];JointBase1\MinEndstopPos = MinEndstopPos[1];JointBase1\MaxEndstopPos = MaxEndstopPos[1];JointBase1\Rconstraint = Rconstraint;JointBase1\Cconstraint = Cconstraint;JointBase1\Rjoint = Rjoint;Joint12\Rendstop = Rconstraint;Joint12\Cendstop = Cconstraint;Joint12\InitialPos = InitialJointPos[2];Joint12\MinEndstopPos = MinEndstopPos[2];Joint12\MaxEndstopPos = MaxEndstopPos[2];Joint12\Rconstraint = Rconstraint;Joint12\Cconstraint = Cconstraint;Joint12\Rjoint = Rjoint;Joint23\Rendstop = Rconstraint;Joint23\Cendstop = Cconstraint;Joint23\InitialPos = InitialJointPos[3];Joint23\MinEndstopPos = MinEndstopPos[3];Joint23\MaxEndstopPos = MaxEndstopPos[3];Joint23\Rconstraint = Rconstraint;Joint23\Cconstraint = Cconstraint;Joint23\Rjoint = Rjoint;Joint34\Rendstop = Rconstraint;Joint34\Cendstop = Cconstraint;Joint34\InitialPos = InitialJointPos[4];Joint34\MinEndstopPos = MinEndstopPos[4];Joint34\MaxEndstopPos = MaxEndstopPos[4];Joint34\Rconstraint = Rconstraint;Joint34\Cconstraint = Cconstraint;Joint34\Rjoint = Rjoint;Joint45\Rendstop = Rconstraint;Joint45\Cendstop = Cconstraint;Joint45\InitialPos = InitialJointPos[5];Joint45\MinEndstopPos = MinEndstopPos[5];Joint45\MaxEndstopPos = MaxEndstopPos[5];Joint45\Rconstraint = Rconstraint;Joint45\Cconstraint = Cconstraint;Joint45\Rjoint = Rjoint;parameterrelations_end;       implementation_end;      R 528 312       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\R.emx</LibraryPath>  <TimeStamp>2007-9-25 12:3:18</TimeStamp></Description>';       type R        ports         power in p [9,1];       end;       icon bg bottom        figures         text 'R' 528 312 18 bold;       end;       implementation eqparameters	real r = 0.0;equations						p.e = r * p.f;implementation_end;      YouBot_OODL 440 240       description '<Description> <Version>4.0</Version> <LibraryPath>Template\Submodel-Equation.emx</LibraryPath> <IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <TimeStamp>2007-11-1 22:32:1</TimeStamp> <AllowLibraryUpdate>False</AllowLibraryUpdate></Description>';       type 'Submodel-Equation'        ports         signal in Base_twist_cmd [3,1];         power out HW_bond [9,1];         signal in Arm1_joint_cmd [5,1];         signal out Arm1_joint_states [5,1];         signal out Base_odometry_state [3,1];         signal out Arm1_joint_velocities [5,1];         signal out Base_joint_velocities [4,1];         signal out Base_joint_states [4,1];         signal in Base_joint_cmd [4,1];        restrictions         causality fixed out HW_bond;       end;       icon bg        figures         rectangle 392 176 488 304 fill 14013909;         text 'name' 440 248 16;         text 'STUB' 440 200 'Bank Gothic' 20 bold;        terminals         Base_twist_cmd 392 280 fixed;         HW_bond 488 232 fixed;         Arm1_joint_cmd 392 264 fixed;         Arm1_joint_states 392 200 fixed;         Base_odometry_state 392 184 fixed;         Arm1_joint_velocities 392 232 fixed;         Base_joint_velocities 392 216 fixed;         Base_joint_states 392 248 fixed;         Base_joint_cmd 392 296 fixed;       end;       implementation eqparameters	real joint_initial_states[5]=[0;0;0;0;0];	real 	Wheelpos[2]= [0.235;0.15];	real  MecanumWheelRadius= 0.0475;	real Current_limits[5]=[2.44,2.44,2.40,0.73,0.42];   real gear_ratio[5] =  [156;  156  ;  100 ;  71 ; 71];	real torque_const[5]=[0.0335;0.0335;0.0335;0.051;0.49];	real base_gear_ratio=0.03870;	real base_torue_const=0.0335;	real base_current_limit=244;	real base_PI_P= 60.0;	real base_PI_I= 53.0;	boolean use_twist= false;variables	real A[3,4];	real PseudoInverseA[4,3];	real RotMechanumWheel; 	real virtualJoints_f[3];	real Base_Twist[6];	real Base_dotT[4,4],Base_H[4,4];	real Base_init[4,4];	real pitch,yaw;	real force_limits[5]; 	real base_force_limit;	real wheel_veloicties[4];	real Base_joint_cmd_temp[4];	real base_twist_delta[3];initialequations	Base_init=eye(4);	force_limits=diag(gear_ratio .* torque_const)*Current_limits;	base_force_limit=base_torue_const*base_current_limit/base_gear_ratio;equations	Base_joint_velocities=HW_bond.f[1:4];	Arm1_joint_velocities=HW_bond.f[5:9];	Base_joint_states=int(HW_bond.f[1:4]);	Arm1_joint_states=int(HW_bond.f[5:9],joint_initial_states);		RotMechanumWheel=Wheelpos[1]+Wheelpos[2];	/*A = (1/(2*MecanumWheelRadius))*	[ RotMechanumWheel,RotMechanumWheel,RotMechanumWheel	,RotMechanumWheel;		1		, 1		,-1		, -1;		-1		, 1		,-1		, 1];*/    A =  (1/(2*MecanumWheelRadius))*	[ RotMechanumWheel,RotMechanumWheel,RotMechanumWheel	,RotMechanumWheel;		-1		, 1	,-1	, 1;		1		, 1	,-1	,- 1]; 	PseudoInverseA = transpose(A)*inverse(A*transpose(A));	virtualJoints_f = transpose(PseudoInverseA)*HW_bond.f[1:4];	wheel_veloicties=PseudoInverseA*Base_twist_cmd;	Base_Twist=[0;0;virtualJoints_f[1];virtualJoints_f[2];virtualJoints_f[3];0];	   Base_dotT=Base_H*tilde(Base_Twist);   Base_H = int(Base_dotT,Base_init);//	H=H0*inverseH(homogeneous(eye(3),offset));	pitch =  arcsin(limit(Base_H[3,1],-1,1)); //m_el[2].x());	yaw = atan2(Base_H[2,1]/cos(pitch),Base_H[1,1]/cos(pitch));	Base_odometry_state[1]=yaw;	Base_odometry_state[2]=Base_H[1,4];	Base_odometry_state[3]=Base_H[2,4];	base_twist_delta=[Base_twist_cmd[1];Base_twist_cmd[3];Base_twist_cmd[2]]-virtualJoints_f;	if use_twist then		Base_joint_cmd_temp=PseudoInverseA*(base_PI_P*base_twist_delta);//+base_PI_I*int(base_twist_delta));	else		Base_joint_cmd_temp=Base_joint_cmd;	end;// HW_bond.e=0;   HW_bond.e[1]=limit(Base_joint_cmd_temp[1],-base_force_limit,base_force_limit);	HW_bond.e[2]=limit(Base_joint_cmd_temp[2],-base_force_limit,base_force_limit);	HW_bond.e[3]=limit(Base_joint_cmd_temp[3],-base_force_limit,base_force_limit);	HW_bond.e[4]=limit(Base_joint_cmd_temp[4],-base_force_limit,base_force_limit);	HW_bond.e[5]=limit(Arm1_joint_cmd[1],-force_limits[1],force_limits[1]);	HW_bond.e[6]=limit(Arm1_joint_cmd[2],-force_limits[2],force_limits[2]);	HW_bond.e[7]=limit(Arm1_joint_cmd[3],-force_limits[3],force_limits[3]);	HW_bond.e[8]=limit(Arm1_joint_cmd[4],-force_limits[4],force_limits[4]);	HW_bond.e[9]=limit(Arm1_joint_cmd[5],-force_limits[5],force_limits[5]);	implementation_end;     end;     connections      YouBot_OODL\HW_bond => OneJunction1\p;      OneJunction1\p => Plant\joints;      OneJunction1\p => R\p;      Base_twist_cmd -> YouBot_OODL\Base_twist_cmd;      Arm1_joint_cmd -> YouBot_OODL\Arm1_joint_cmd;      YouBot_OODL\Arm1_joint_states -> Arm1_joint_states;      YouBot_OODL\Base_odometry_state -> Base_odometry_state;      YouBot_OODL\Arm1_joint_velocities -> Arm1_joint_velocities;      YouBot_OODL\Base_joint_velocities -> Base_joint_velocities;      YouBot_OODL\Base_joint_states -> Base_joint_states;      Base_joint_cmd -> YouBot_OODL\Base_joint_cmd;     end;    implementation_end;  end;  connections   Constant\output -> YouBotModel\Base_twist_cmd;   CartesianStiffnessSetpoint\output -> CartesianController\StiffnessCC;   SampleArmJonitsAngle\output -> ArmPoseController\joints_angle;   HapticMaster\Hout0 -> Delay5\input;   CartesianSpaceStiffness2\output -> HapticMaster\CartSpaceStiffness;   ArmPoseController\input_energy <- Delay7\output 1272 392;   SampleBaseWheelsAngle\output -> BasePoseController\Base_wheels_angle;   BasePoseController\input_energy <- Delay9\output 1264 696;   YouBotModel\Base_joint_states -> SampleBaseWheelsAngle\input;   BasePoseController\output_energy -> Delay10\input 1264 680;   HoldBaseWheelsTorque\output -> YouBotModel\Base_joint_cmd;   HtipCC\output -> CartesianController\HtipCC;   Delay3\output -> YouBotKinematics\input_energy_spring;   CartesianController\W_tooltip_00 -> YouBotKinematics\W_tooltip_00;   Amcl\H_odom_map -> Odometry\H_odom_map;   Splitter1\output -> CartesianController\Htip0;   HapticMaster\H_base_0 -> BasePoseController\H_vp_0 576 824 1320 824;   YouBotKinematics\H_tooltip_0 -> Splitter1\input;   YouBotModel\Arm1_joint_states -> SampleArmJonitsAngle\input;   HapticMaster\input_energy <- Delay1\output;   BasePoseController\H_base_0_output -> YouBotKinematics\H_base_0;   HoldArmJointsTorque\output -> YouBotModel\Arm1_joint_cmd;   YouBotKinematics\T_tooltip_00 -> CartesianController\T_tooltip_00;   Odometry\H_base_odom -> Amcl\H_base_odom 1416 784;   InteractiveMarker1\HJoym -> HapticMaster\HJoym;   ArmPoseController\output_energy -> Delay8\input 1280 368;   Delay9\input <- YouBotKinematics\output_energy_base;   HapticMaster\JoyTwist <- Joystick2\port1;   HapticMaster\effort -> MockupPhantom1\W;   MockupPhantom1\Hpos0 -> HapticMaster\Htip0;   YouBotKinematics\torques_cmd -> ArmPoseController\joints_torque;   BasePoseController\T_base_00 -> Odometry\T_base_00;   ArmJointActive\output -> ArmPoseController\active_joint 1344 288;   BaseJointActive\output -> BasePoseController\active_joint 1288 760;   Splitter1\output -> Delay4\input 1000 592;   BasePoseController\Base_torque -> HoldBaseWheelsTorque\input;   HapticMaster\output_energy -> Delay1\input;   Delay6\output -> SimpleEnergySupply\input_energy;   ArmPoseController\Arm_torque -> HoldArmJointsTorque\input;   Delay8\output -> YouBotKinematics\input_energy_arm;   Odometry\H_base_map -> BasePoseController\H_base_0;   HapticMaster\Hytip0 <- Delay4\output;   SimpleEnergySupply\output_energy -> Delay3\input;   HapticMaster\JointSetpoint -> ArmPoseController\angles_setpoint 736 320 1312 320;   Delay10\output -> YouBotKinematics\input_energy_base 1144 680;   Delay5\output -> CartesianController\Hvp0;   Delay7\input <- YouBotKinematics\output_energy_arm 1120 392;   YouBotKinematics\output_energy_spring -> Delay6\input;   EnergyButtonStub\output -> HapticMaster\input_energy_button;   MockupPhantom1\joint_space -> HapticMaster\PhantomJointState 208 576;   ArmPoseController\joints_angle_output -> YouBotKinematics\angles_measured;   YouBotKinematics\W_base_00 -> BasePoseController\W_base_00;   CartesianDamping\output -> CartesianController\CartesianDamping 896 472;  end;  figures   rectangle 604 208 792 856 fill 13959039;   rectangle 808 208 1000 856 fill 13959039;   rectangle 1008 208 1232 856 fill 13959039;   rectangle 1472 208 1696 856 fill 13959039;   rectangle 1244 208 1464 856 fill 13959039;   text 'Actuator ControlHW / Frimware / Drivers' 1568 240 18 bold;   text 'Joint ControlJoint Position' 1312 240 18 bold;   text 'Joint ControlTooltip force /Kinematic TF' 1128 240 18 bold;   text 'Cartesian ControlPotential field ' 888 240 18 bold;   text 'Trajectory planner' 704 240 18 bold;   text 'To swith of energy depednacyPassivityLayer\PassiveZOH\PassivityLayerActive =false' 112 256 15; implementation_end;]]>
  </Sidops>
</Model>
 <Experiments>
  <DefaultExperiment><![CDATA[Experiment 1]]>
</DefaultExperiment>
  <Experiment>
   <Name>Experiment 1</Name>
   <CreatedBy></CreatedBy>
   <Info></Info>
   <ExpData>
    <VersionNumber>4.1</VersionNumber>
    <ModelProperties>
     <ModelProperty section="CCodeDialog" entry="SubmodelName" value="Odometry"></ModelProperty>
     <ModelProperty section="CCodeDialog" entry="TargetName" value="Orocos Component"></ModelProperty>
    </ModelProperties>
    <Variables>
     <Constants></Constants>
     <Parameters>
      <Variable>
       <Name>epsilon</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>HapticMaster\EnergyEncodingButton\counter</Name>
       <Value>134</Value>
      </Variable>
     </Parameters>
     <Initials>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\Base\InertialTensor\state_initial</Name>
       <Rows>6</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\Joint12\EndstopMax\Cendstop\state_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\Joint12\EndstopMin\Cendstop\state_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\Joint23\EndstopMax\Cendstop\state_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\Joint23\EndstopMin\Cendstop\state_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\Joint34\EndstopMax\Cendstop\state_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\Joint34\EndstopMin\Cendstop\state_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\Joint45\EndstopMax\Cendstop\state_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\Joint45\EndstopMin\Cendstop\state_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\JointBase1\EndstopMax\Cendstop\state_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\JointBase1\EndstopMin\Cendstop\state_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\Link1\InertialTensor\state_initial</Name>
       <Rows>6</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\Link2\InertialTensor\state_initial</Name>
       <Rows>6</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\Link3\InertialTensor\state_initial</Name>
       <Rows>6</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\Link4\InertialTensor\state_initial</Name>
       <Rows>6</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\Link5\InertialTensor\state_initial</Name>
       <Rows>6</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\MecanumWheels\Cfloor\state_initial</Name>
       <Rows>6</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\qWheelLF_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\qWheelLR_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\qWheelRF_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\qWheelRR_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\YouBot_OODL\Base_init</Name>
       <Rows>4</Rows>
       <Columns>4</Columns>
       <Value>1 0 0 0
0 1 0 0
0 0 1 0
0 0 0 1</Value>
      </Variable>
      <Variable>
       <Name>YouBotModel\YouBot_OODL\Base_joint_states_initial</Name>
       <Rows>4</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>ArmPoseController\EnergyEncoding\outputCount_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>ArmPoseController\JointSpaceController\PD_Joint1\error_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>ArmPoseController\JointSpaceController\PD_Joint1\uD_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>ArmPoseController\JointSpaceController\PD_Joint2\error_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>ArmPoseController\JointSpaceController\PD_Joint2\uD_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>ArmPoseController\JointSpaceController\PD_Joint3\error_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>ArmPoseController\JointSpaceController\PD_Joint3\uD_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>ArmPoseController\JointSpaceController\PD_Joint4\error_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>ArmPoseController\JointSpaceController\PD_Joint4\uD_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>ArmPoseController\JointSpaceController\PD_Joint5\error_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>ArmPoseController\JointSpaceController\PD_Joint5\uD_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>ArmPoseController\PassivityLayer\EnergyTankControl\sensorValue_previous_initial</Name>
       <Rows>5</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>ArmPoseController\PassivityLayer\PassiveSampling\sensorValue_previous_initial</Name>
       <Rows>5</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>ArmPoseController\PassivityLayer\PassiveZOH\sensorValue_previous_initial</Name>
       <Rows>5</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>BasePoseController\BasePositionController\PD_BaseAngle\error_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>BasePoseController\BasePositionController\PD_BaseAngle\uD_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>BasePoseController\BasePositionController\PD_BaseX\error_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>BasePoseController\BasePositionController\PD_BaseX\uD_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>BasePoseController\BasePositionController\PD_BaseY\error_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>BasePoseController\BasePositionController\PD_BaseY\uD_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>BasePoseController\DiscreteDifferential\input_previous_initial</Name>
       <Rows>4</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>BasePoseController\EnergyEncoding\outputCount_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>BasePoseController\PassivityLayer\EnergyTankControl\sensorValue_previous_initial</Name>
       <Rows>4</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>BasePoseController\PassivityLayer\PassiveSampling\sensorValue_previous_initial</Name>
       <Rows>4</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>BasePoseController\PassivityLayer\PassiveZOH\sensorValue_previous_initial</Name>
       <Rows>4</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>CartesianController\Delay\output_initial</Name>
       <Rows>4</Rows>
       <Columns>4</Columns>
       <Value>0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>Delay10\output_initial</Name>
       <Rows>2</Rows>
       <Columns>1</Columns>
       <Value>0 0</Value>
      </Variable>
      <Variable>
       <Name>Delay1\output_initial</Name>
       <Rows>2</Rows>
       <Columns>1</Columns>
       <Value>0 0</Value>
      </Variable>
      <Variable>
       <Name>Delay3\output_initial</Name>
       <Rows>2</Rows>
       <Columns>1</Columns>
       <Value>0 0</Value>
      </Variable>
      <Variable>
       <Name>Delay4\output_initial</Name>
       <Rows>4</Rows>
       <Columns>4</Columns>
       <Value>0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>Delay5\output_initial</Name>
       <Rows>4</Rows>
       <Columns>4</Columns>
       <Value>0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>Delay6\output_initial</Name>
       <Rows>2</Rows>
       <Columns>1</Columns>
       <Value>0 0</Value>
      </Variable>
      <Variable>
       <Name>Delay7\output_initial</Name>
       <Rows>2</Rows>
       <Columns>1</Columns>
       <Value>0 0</Value>
      </Variable>
      <Variable>
       <Name>Delay8\output_initial</Name>
       <Rows>2</Rows>
       <Columns>1</Columns>
       <Value>0 0</Value>
      </Variable>
      <Variable>
       <Name>Delay9\output_initial</Name>
       <Rows>2</Rows>
       <Columns>1</Columns>
       <Value>0 0</Value>
      </Variable>
      <Variable>
       <Name>HapticMaster\EnergyEncoding\outputCount_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>HapticMaster\PassivityLayerW\HToTwist\H_t0_0_initial</Name>
       <Rows>4</Rows>
       <Columns>4</Columns>
       <Value>0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>HapticMaster\PassivityLayerW\PassiveZOH\sensorValue_previous_initial</Name>
       <Rows>6</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>MockupPhantom1\P_previous_initial</Name>
       <Rows>6</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>new_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>SimpleEnergySupply\EnergyEncoding1\outputCount_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotKinematics\DiscreteDifferential\input_previous_initial</Name>
       <Rows>8</Rows>
       <Columns>1</Columns>
       <Value>0 0 0 0 0 0 0 0</Value>
      </Variable>
      <Variable>
       <Name>YouBotKinematics\EnergyEncodingArm\outputCount_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotKinematics\EnergyEncodingBase\outputCount_previous_initial</Name>
       <Value>0</Value>
      </Variable>
      <Variable>
       <Name>YouBotKinematics\EnergyEncodingSpring\outputCount_previous_initial</Name>
       <Value>0</Value>
      </Variable>
     </Initials>
    </Variables>
    <PlotSpecs>
     <VarNames>
      <VarName>time</VarName>
      <VarName>YouBotKinematics\CalculateJ\H20[1,4]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H20[2,4]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H20[3,4]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H20[1,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H20[2,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H20[3,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H20[1,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H20[2,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H20[3,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H30[1,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H30[2,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H30[3,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H30[1,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H30[2,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H30[3,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H10[1,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H10[2,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H10[3,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H10[1,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H10[2,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H10[3,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H40[1,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H40[2,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H40[3,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H40[1,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H40[2,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H40[3,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H50[1,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H50[2,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H50[3,3]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H50[1,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H50[2,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H50[3,2]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H30[1,4]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H30[2,4]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H30[3,4]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H10[1,4]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H10[2,4]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H10[3,4]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H40[1,4]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H40[2,4]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H40[3,4]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H50[1,4]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H50[2,4]</VarName>
      <VarName>YouBotKinematics\CalculateJ\H50[3,4]</VarName>
      <VarName>CartesianController\CartesianSpaceStiffness\Hvp0[1,4]</VarName>
      <VarName>CartesianController\CartesianSpaceStiffness\Hvp0[2,4]</VarName>
      <VarName>CartesianController\CartesianSpaceStiffness\Hvp0[3,4]</VarName>
      <VarName>CartesianController\CartesianSpaceStiffness\Hvp0[1,3]</VarName>
      <VarName>CartesianController\CartesianSpaceStiffness\Hvp0[2,3]</VarName>
      <VarName>CartesianController\CartesianSpaceStiffness\Hvp0[3,3]</VarName>
      <VarName>CartesianController\CartesianSpaceStiffness\Hvp0[1,2]</VarName>
      <VarName>CartesianController\CartesianSpaceStiffness\Hvp0[2,2]</VarName>
      <VarName>CartesianController\CartesianSpaceStiffness\Hvp0[3,2]</VarName>
      <VarName>YouBotModel\Plant\Link2\Hin[1,4]</VarName>
      <VarName>YouBotModel\Plant\Link2\Hin[2,4]</VarName>
      <VarName>YouBotModel\Plant\Link2\Hin[3,4]</VarName>
      <VarName>YouBotModel\Plant\Link2\Hin[1,3]</VarName>
      <VarName>YouBotModel\Plant\Link2\Hin[2,3]</VarName>
      <VarName>YouBotModel\Plant\Link2\Hin[3,3]</VarName>
      <VarName>YouBotModel\Plant\Link2\Hin[1,2]</VarName>
      <VarName>YouBotModel\Plant\Link2\Hin[2,2]</VarName>
      <VarName>YouBotModel\Plant\Link2\Hin[3,2]</VarName>
      <VarName>YouBotModel\Plant\Link3\Hin[1,3]</VarName>
      <VarName>YouBotModel\Plant\Link3\Hin[2,3]</VarName>
      <VarName>YouBotModel\Plant\Link3\Hin[3,3]</VarName>
      <VarName>YouBotModel\Plant\Link3\Hin[1,2]</VarName>
      <VarName>YouBotModel\Plant\Link3\Hin[2,2]</VarName>
      <VarName>YouBotModel\Plant\Link3\Hin[3,2]</VarName>
      <VarName>YouBotModel\Plant\Link1\Hin[1,3]</VarName>
      <VarName>YouBotModel\Plant\Link1\Hin[2,3]</VarName>
      <VarName>YouBotModel\Plant\Link1\Hin[3,3]</VarName>
      <VarName>YouBotModel\Plant\Link1\Hin[1,2]</VarName>
      <VarName>YouBotModel\Plant\Link1\Hin[2,2]</VarName>
      <VarName>YouBotModel\Plant\Link1\Hin[3,2]</VarName>
      <VarName>YouBotModel\Plant\Link4\Hin[1,3]</VarName>
      <VarName>YouBotModel\Plant\Link4\Hin[2,3]</VarName>
      <VarName>YouBotModel\Plant\Link4\Hin[3,3]</VarName>
      <VarName>YouBotModel\Plant\Link4\Hin[1,2]</VarName>
      <VarName>YouBotModel\Plant\Link4\Hin[2,2]</VarName>
      <VarName>YouBotModel\Plant\Link4\Hin[3,2]</VarName>
      <VarName>YouBotModel\Plant\Link5\Hin[1,3]</VarName>
      <VarName>YouBotModel\Plant\Link5\Hin[2,3]</VarName>
      <VarName>YouBotModel\Plant\Link5\Hin[3,3]</VarName>
      <VarName>YouBotModel\Plant\Link5\Hin[1,2]</VarName>
      <VarName>YouBotModel\Plant\Link5\Hin[2,2]</VarName>
      <VarName>YouBotModel\Plant\Link5\Hin[3,2]</VarName>
      <VarName>YouBotModel\Plant\Base\Hin[1,4]</VarName>
      <VarName>YouBotModel\Plant\Base\Hin[2,4]</VarName>
      <VarName>YouBotModel\Plant\Base\Hin[3,4]</VarName>
      <VarName>YouBotModel\Plant\Base\Hin[1,3]</VarName>
      <VarName>YouBotModel\Plant\Base\Hin[2,3]</VarName>
      <VarName>YouBotModel\Plant\Base\Hin[3,3]</VarName>
      <VarName>YouBotModel\Plant\Base\Hin[1,2]</VarName>
      <VarName>YouBotModel\Plant\Base\Hin[2,2]</VarName>
      <VarName>YouBotModel\Plant\Base\Hin[3,2]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,4]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,4]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,4]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,3]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,3]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,3]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,2]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,2]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,2]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,3]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,3]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,3]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,2]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,2]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,2]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,3]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,3]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,3]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,2]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,2]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,2]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,4]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,4]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,4]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,3]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,3]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,3]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,2]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,2]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,2]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,4]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,4]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,4]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,4]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,4]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,4]</VarName>
      <VarName>YouBotModel\Plant\Link5\Hin[1,4]</VarName>
      <VarName>YouBotModel\Plant\Link5\Hin[2,4]</VarName>
      <VarName>YouBotModel\Plant\Link5\Hin[3,4]</VarName>
      <VarName>YouBotModel\Plant\Link4\Hin[1,4]</VarName>
      <VarName>YouBotModel\Plant\Link4\Hin[2,4]</VarName>
      <VarName>YouBotModel\Plant\Link4\Hin[3,4]</VarName>
      <VarName>YouBotModel\Plant\Link1\Hin[1,4]</VarName>
      <VarName>YouBotModel\Plant\Link1\Hin[2,4]</VarName>
      <VarName>YouBotModel\Plant\Link1\Hin[3,4]</VarName>
      <VarName>YouBotModel\Plant\Link3\Hin[1,4]</VarName>
      <VarName>YouBotModel\Plant\Link3\Hin[2,4]</VarName>
      <VarName>YouBotModel\Plant\Link3\Hin[3,4]</VarName>
      <VarName>YouBotModel\YouBot_OODL\Base_H[1,4]</VarName>
      <VarName>YouBotModel\YouBot_OODL\Base_H[2,4]</VarName>
      <VarName>YouBotModel\YouBot_OODL\Base_H[3,4]</VarName>
      <VarName>YouBotModel\YouBot_OODL\Base_H[1,3]</VarName>
      <VarName>YouBotModel\YouBot_OODL\Base_H[2,3]</VarName>
      <VarName>YouBotModel\YouBot_OODL\Base_H[3,3]</VarName>
      <VarName>YouBotModel\YouBot_OODL\Base_H[1,2]</VarName>
      <VarName>YouBotModel\YouBot_OODL\Base_H[2,2]</VarName>
      <VarName>YouBotModel\YouBot_OODL\Base_H[3,2]</VarName>
      <VarName>YouBotKinematics\HToAngles\pose[2]</VarName>
      <VarName>YouBotKinematics\HToAngles\pose[3]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\CameraPose[1]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\CameraPose[2]</VarName>
      <VarName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\CameraPose[3]</VarName>
      <VarName>HtipCC\output[1,4]</VarName>
      <VarName>HtipCC\output[2,4]</VarName>
      <VarName>HtipCC\output[3,4]</VarName>
      <VarName>HtipCC\output[1,3]</VarName>
      <VarName>HtipCC\output[2,3]</VarName>
      <VarName>HtipCC\output[3,3]</VarName>
      <VarName>HtipCC\output[1,2]</VarName>
      <VarName>HtipCC\output[2,2]</VarName>
      <VarName>HtipCC\output[3,2]</VarName>
      <VarName>ArmPoseController\PassivityLayer\PassiveSampling\energyQuanta</VarName>
      <VarName>ArmPoseController\PassivityLayer\force[5]</VarName>
      <VarName>ArmPoseController\PassivityLayer\EnergyTankControl\adjustedForce[5]</VarName>
      <VarName>ArmPoseController\JointSpaceController\Demux\port5</VarName>
      <VarName>SimpleEnergySupply\EnergyTankBlock\EnergyState</VarName>
      <VarName>Odometry\H_base_0[1,4]</VarName>
      <VarName>Odometry\H_base_0[2,4]</VarName>
      <VarName>Odometry\H_base_0[3,4]</VarName>
      <VarName>Odometry\H_base_0[1,3]</VarName>
      <VarName>Odometry\H_base_0[2,3]</VarName>
      <VarName>Odometry\H_base_0[3,3]</VarName>
      <VarName>Odometry\H_base_0[1,2]</VarName>
      <VarName>Odometry\H_base_0[2,2]</VarName>
      <VarName>Odometry\H_base_0[3,2]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,4]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,4]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,4]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,3]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,3]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,3]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,2]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,2]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,2]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,4]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,4]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,4]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,3]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,3]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,3]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,2]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,2]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,2]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,4]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,4]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,4]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,3]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,3]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,3]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,2]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,2]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,2]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,4]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,4]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,4]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,3]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,3]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,3]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,2]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,2]</VarName>
      <VarName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,2]</VarName>
      <VarName>ArmPoseController\PassivityLayer\EnegyTank\energyState</VarName>
     </VarNames>
     <Plots>
      <Plot>
       <PlotType>GraphPlot</PlotType>
       <BasePlot>
        <UseWindowsBGColor>true</UseWindowsBGColor>
        <BGColor>13160660</BGColor>
       </BasePlot>
       <Grid>
        <DrawGrid>true</DrawGrid>
        <GridColor>15780518</GridColor>
        <XTicks>10</XTicks>
        <YTicks>10</YTicks>
        <ZTicks>10</ZTicks>
        <Use3DLook>false</Use3DLook>
       </Grid>
       <PlotBGColor>16777215</PlotBGColor>
       <ShowPlotTitle>true</ShowPlotTitle>
       <TitlePosition>1</TitlePosition>
       <PlotTitle>model</PlotTitle>
       <ShowXValues>true</ShowXValues>
       <Fonts>
        <TitleFont>
         <Name>Arial</Name>
         <Height>12</Height>
         <PitchFamily>34</PitchFamily>
         <Weight>400</Weight>
         <Italic>0</Italic>
         <UnderLine>0</UnderLine>
         <StrikeOut>0</StrikeOut>
         <Color>0</Color>
        </TitleFont>
        <LabelFont>
         <Name>Arial</Name>
         <Height>12</Height>
         <PitchFamily>34</PitchFamily>
         <Weight>400</Weight>
         <Italic>0</Italic>
         <UnderLine>0</UnderLine>
         <StrikeOut>0</StrikeOut>
         <Color>0</Color>
        </LabelFont>
        <ValuesFont>
         <Name>Arial</Name>
         <Height>10</Height>
         <PitchFamily>34</PitchFamily>
         <Weight>400</Weight>
         <Italic>0</Italic>
         <UnderLine>0</UnderLine>
         <StrikeOut>0</StrikeOut>
         <Color>0</Color>
        </ValuesFont>
       </Fonts>
       <SharedXAxis>true</SharedXAxis>
       <SharedYAxis>true</SharedYAxis>
       <SharedZAxis>false</SharedZAxis>
       <XAxes>
        <Axis>
         <Minimum>-4</Minimum>
         <Maximum>16</Maximum>
         <Linear>true</Linear>
         <Scaling>3</Scaling>
         <Label>time</Label>
        </Axis>
       </XAxes>
       <YAxes>
        <Axis>
         <Minimum>-4000</Minimum>
         <Maximum>16000</Maximum>
         <Linear>true</Linear>
         <Scaling>1</Scaling>
         <Label>controlforce[5]</Label>
        </Axis>
        <Axis>
         <Minimum>-4000</Minimum>
         <Maximum>16000</Maximum>
         <Linear>true</Linear>
         <Scaling>1</Scaling>
         <Label>adjustedForce[5]</Label>
        </Axis>
        <Axis>
         <Minimum>0</Minimum>
         <Maximum>10</Maximum>
         <Linear>true</Linear>
         <Scaling>1</Scaling>
         <Label>ArmPoseController\JointSpaceController\Demux\port5</Label>
        </Axis>
       </YAxes>
       <ZAxes></ZAxes>
       <Curves>
        <Curve>
         <LineColor>0</LineColor>
         <LineStyle>1</LineStyle>
         <TickColor>16764108</TickColor>
         <TickStyle>0</TickStyle>
         <PixelThresshold>1</PixelThresshold>
         <LineThickness>1</LineThickness>
         <LineOrder>1</LineOrder>
         <ShowYValues>true</ShowYValues>
         <XCurveData>
     <ShowUnit>true</ShowUnit>
     <VarName>time</VarName>
         </XCurveData>
         <YCurveData>
     <ShowUnit>true</ShowUnit>
     <VarName>ArmPoseController\PassivityLayer\force[5]</VarName>
         </YCurveData>
        </Curve>
        <Curve>
         <LineColor>255</LineColor>
         <LineStyle>1</LineStyle>
         <TickColor>3368601</TickColor>
         <TickStyle>0</TickStyle>
         <PixelThresshold>1</PixelThresshold>
         <LineThickness>1</LineThickness>
         <LineOrder>1</LineOrder>
         <ShowYValues>true</ShowYValues>
         <XCurveData>
     <ShowUnit>true</ShowUnit>
     <VarName>time</VarName>
         </XCurveData>
         <YCurveData>
     <ShowUnit>true</ShowUnit>
     <VarName>ArmPoseController\PassivityLayer\EnergyTankControl\adjustedForce[5]</VarName>
         </YCurveData>
        </Curve>
        <Curve>
         <LineColor>16711680</LineColor>
         <LineStyle>1</LineStyle>
         <TickColor>16711680</TickColor>
         <TickStyle>0</TickStyle>
         <PixelThresshold>1</PixelThresshold>
         <LineThickness>1</LineThickness>
         <LineOrder>1</LineOrder>
         <ShowYValues>true</ShowYValues>
         <XCurveData>
     <ShowUnit>true</ShowUnit>
     <VarName>time</VarName>
         </XCurveData>
         <YCurveData>
     <ShowUnit>true</ShowUnit>
     <VarName>ArmPoseController\JointSpaceController\Demux\port5</VarName>
         </YCurveData>
        </Curve>
       </Curves>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
       <StripChartPlots>
        <DistributState>2</DistributState>
        <StripChartPlot>
         <Legenda>
     <ShowLegenda>true</ShowLegenda>
         </Legenda>
        </StripChartPlot>
        <StripChartPlot>
         <Legenda>
     <ShowLegenda>true</ShowLegenda>
         </Legenda>
        </StripChartPlot>
        <StripChartPlot>
         <Legenda>
     <ShowLegenda>true</ShowLegenda>
         </Legenda>
        </StripChartPlot>
       </StripChartPlots>
      </Plot>
      <Plot>
       <PlotType>D3DPlot</PlotType>
       <BasePlot>
        <UseWindowsBGColor>true</UseWindowsBGColor>
        <BGColor>13160660</BGColor>
       </BasePlot>
       <RenderQuality>137</RenderQuality>
       <ShowGrid>true</ShowGrid>
       <BackgroundColor>4294967295</BackgroundColor>
       <FrameScale>1</FrameScale>
       <FrameThickness>1</FrameThickness>
       <MainFrame>
        <Frame>
         <ScaleValue>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Reference Frame</Name>
         <Position></Position>
         <Orientation>
     <Angles></Angles>
     <OrientationType>Bryant</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
     <Frame>
      <ScaleValue>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </ScaleValue>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Default Lights and Cameras</Name>
      <Position></Position>
      <Orientation>
       <Angles></Angles>
       <OrientationType>Bryant</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
       <Light>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Ambient</Name>
        <Position></Position>
        <Orientation>
         <ZAxis>
     <Z>
      <Value>1</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <Y>
      <Value>1</Value>
     </Y>
         </YAxis>
         <OrientationType>Direct3D</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs></Childs>
        <LightType>0</LightType>
        <LightColor>
         <Color>
     <X>
      <Value>0.3</Value>
     </X>
     <Y>
      <Value>0.3</Value>
     </Y>
     <Z>
      <Value>0.3</Value>
     </Z>
         </Color>
         <Offset></Offset>
         <Multipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </Multipliers>
         <Direct3DColorRange>true</Direct3DColorRange>
        </LightColor>
        <AmbientLight>
         <Color>
     <X>
      <Value>0.3</Value>
     </X>
     <Y>
      <Value>0.3</Value>
     </Y>
     <Z>
      <Value>0.3</Value>
     </Z>
         </Color>
         <Offset></Offset>
         <Multipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </Multipliers>
         <Direct3DColorRange>true</Direct3DColorRange>
        </AmbientLight>
        <AmbientOn>true</AmbientOn>
        <DiffuseOn>false</DiffuseOn>
        <SpecularOn>false</SpecularOn>
       </Light>
       <Light>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Parallel</Name>
        <Position>
         <X>
     <Value>-3</Value>
         </X>
         <Y>
     <Value>5</Value>
         </Y>
         <Z>
     <Value>3</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <Value>0.457495710997814</Value>
     </X>
     <Y>
      <Value>-0.762492851663023</Value>
     </Y>
     <Z>
      <Value>-0.457495710997814</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <Value>0.235379601434674</Value>
     </X>
     <Y>
      <Value>-0.392299335724456</Value>
     </Y>
     <Z>
      <Value>0.889211827642101</Value>
     </Z>
         </YAxis>
         <OrientationType>Direct3D</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs></Childs>
        <LightType>3</LightType>
        <LightColor>
         <Color>
     <X>
      <Value>0.5</Value>
     </X>
     <Y>
      <Value>0.5</Value>
     </Y>
     <Z>
      <Value>0.5</Value>
     </Z>
         </Color>
         <Offset></Offset>
         <Multipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </Multipliers>
         <Direct3DColorRange>true</Direct3DColorRange>
        </LightColor>
        <Attenuation>
         <Constant>
     <Value>1</Value>
         </Constant>
         <Linear>
     <Value>0</Value>
         </Linear>
         <Quadratic>
     <Value>0</Value>
         </Quadratic>
        </Attenuation>
        <DiffuseLight>
         <Color>
     <X>
      <Value>0.5</Value>
     </X>
     <Y>
      <Value>0.5</Value>
     </Y>
     <Z>
      <Value>0.5</Value>
     </Z>
         </Color>
         <Offset></Offset>
         <Multipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </Multipliers>
         <Direct3DColorRange>true</Direct3DColorRange>
        </DiffuseLight>
        <SpecularLight>
         <Color>
     <X>
      <Value>0.5</Value>
     </X>
     <Y>
      <Value>0.5</Value>
     </Y>
     <Z>
      <Value>0.5</Value>
     </Z>
         </Color>
         <Offset></Offset>
         <Multipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </Multipliers>
         <Direct3DColorRange>true</Direct3DColorRange>
        </SpecularLight>
        <AmbientOn>false</AmbientOn>
        <DiffuseOn>true</DiffuseOn>
        <SpecularOn>true</SpecularOn>
       </Light>
       <Light>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Spot Light 1</Name>
        <Position>
         <X>
     <Value>-3</Value>
         </X>
         <Y>
     <Value>-5</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <Value>0.50709255283711</Value>
     </X>
     <Y>
      <Value>0.845154254728517</Value>
     </Y>
     <Z>
      <Value>-0.169030850945703</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <Value>0.0869656553478673</Value>
     </X>
     <Y>
      <Value>0.144942758913112</Value>
     </Y>
     <Z>
      <Value>0.985610760609162</Value>
     </Z>
         </YAxis>
         <OrientationType>Direct3D</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs></Childs>
        <LightType>2</LightType>
        <LightColor>
         <Color>
     <X>
      <Value>0.5</Value>
     </X>
     <Y>
      <Value>0.5</Value>
     </Y>
     <Z>
      <Value>0.5</Value>
     </Z>
         </Color>
         <Offset></Offset>
         <Multipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </Multipliers>
         <Direct3DColorRange>true</Direct3DColorRange>
        </LightColor>
        <Attenuation>
         <Constant>
     <Value>1</Value>
         </Constant>
         <Linear>
     <Value>0.05</Value>
         </Linear>
         <Quadratic>
     <Value>0.05</Value>
         </Quadratic>
        </Attenuation>
        <Umbra>
         <Value>1.0471975511966</Value>
        </Umbra>
        <Penumbra>
         <Value>1.0471975511966</Value>
        </Penumbra>
        <DiffuseLight>
         <Color>
     <X>
      <Value>0.5</Value>
     </X>
     <Y>
      <Value>0.5</Value>
     </Y>
     <Z>
      <Value>0.5</Value>
     </Z>
         </Color>
         <Offset></Offset>
         <Multipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </Multipliers>
         <Direct3DColorRange>true</Direct3DColorRange>
        </DiffuseLight>
        <SpecularLight>
         <Color>
     <X>
      <Value>0.5</Value>
     </X>
     <Y>
      <Value>0.5</Value>
     </Y>
     <Z>
      <Value>0.5</Value>
     </Z>
         </Color>
         <Offset></Offset>
         <Multipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </Multipliers>
         <Direct3DColorRange>true</Direct3DColorRange>
        </SpecularLight>
        <AmbientOn>false</AmbientOn>
        <DiffuseOn>true</DiffuseOn>
        <SpecularOn>true</SpecularOn>
       </Light>
       <Light>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Spot Light 2</Name>
        <Position>
         <X>
     <Value>2</Value>
         </X>
         <Y>
     <Value>-3</Value>
         </Y>
         <Z>
     <Value>-1</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <Value>-0.534522483824849</Value>
     </X>
     <Y>
      <Value>0.801783725737273</Value>
     </Y>
     <Z>
      <Value>0.267261241912424</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <Value>0.14824986333222</Value>
     </X>
     <Y>
      <Value>-0.22237479499833</Value>
     </Y>
     <Z>
      <Value>0.963624111659432</Value>
     </Z>
         </YAxis>
         <OrientationType>Direct3D</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs></Childs>
        <LightType>2</LightType>
        <LightColor>
         <Color>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </Color>
         <Offset></Offset>
         <Multipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </Multipliers>
         <Direct3DColorRange>true</Direct3DColorRange>
        </LightColor>
        <Attenuation>
         <Constant>
     <Value>1</Value>
         </Constant>
         <Linear>
     <Value>0.05</Value>
         </Linear>
         <Quadratic>
     <Value>0.05</Value>
         </Quadratic>
        </Attenuation>
        <Umbra>
         <Value>1.5707963267949</Value>
        </Umbra>
        <Penumbra>
         <Value>1.5707963267949</Value>
        </Penumbra>
        <DiffuseLight>
         <Color>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </Color>
         <Offset></Offset>
         <Multipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </Multipliers>
         <Direct3DColorRange>true</Direct3DColorRange>
        </DiffuseLight>
        <SpecularLight>
         <Color>
     <X>
      <Value>0.5</Value>
     </X>
     <Y>
      <Value>0.5</Value>
     </Y>
     <Z>
      <Value>0.5</Value>
     </Z>
         </Color>
         <Offset></Offset>
         <Multipliers>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </Multipliers>
         <Direct3DColorRange>true</Direct3DColorRange>
        </SpecularLight>
        <AmbientOn>false</AmbientOn>
        <DiffuseOn>true</DiffuseOn>
        <SpecularOn>true</SpecularOn>
       </Light>
       <Camera>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Camera Looking at Origin</Name>
        <Position>
         <X>
     <Value>2</Value>
         </X>
         <Y>
     <Value>-1</Value>
         </Y>
         <Z>
     <Value>3</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <Value>-0.531442451907421</Value>
     </X>
     <Y>
      <Value>0.245382029361419</Value>
     </Y>
     <Z>
      <Value>-0.810775295613464</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <Value>-0.73609785510847</Value>
     </X>
     <Y>
      <Value>0.339877224423482</Value>
     </Y>
     <Z>
      <Value>0.585357514706098</Value>
     </Z>
         </YAxis>
         <OrientationType>Direct3D</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs></Childs>
        <FrontPlane>0.01</FrontPlane>
        <BackPlane>100</BackPlane>
        <AutoFrontBack>true</AutoFrontBack>
        <Field>0.00392699081698724</Field>
        <Fieldy>45</Fieldy>
        <PlaneLeft>-10</PlaneLeft>
        <PlaneRight>10</PlaneRight>
        <PlaneTop>10</PlaneTop>
        <PlaneBottom>-10</PlaneBottom>
        <UseLookatPosition>true</UseLookatPosition>
        <LookatPosition>
         <X>
     <Value>0.0335767945224168</Value>
         </X>
         <Y>
     <Value>-0.0920467211235639</Value>
         </Y>
         <Z>
     <Value>-1.16573417585641e-015</Value>
         </Z>
        </LookatPosition>
        <UseAlwaysLookUp>true</UseAlwaysLookUp>
        <LookUpVector>
         <Z>
     <Value>1</Value>
         </Z>
        </LookUpVector>
        <RightHand>true</RightHand>
        <Perspective>true</Perspective>
        <IsSelectedCamera>true</IsSelectedCamera>
       </Camera>
      </Childs>
     </Frame>
     <Frame>
      <ScaleValue>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </ScaleValue>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Scenery</Name>
      <Position></Position>
      <Orientation>
       <Angles></Angles>
       <OrientationType>Bryant</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Frame>
     <Frame>
      <ScaleValue>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </ScaleValue>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>motion_stack</Name>
      <SceneryFileName>C:\users\yury\Desktop\motion_stack.scn</SceneryFileName>
      <Position></Position>
      <Orientation>
       <Angles></Angles>
       <OrientationType>Bryant</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
       <Frame>
        <ScaleValue>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </ScaleValue>
        <ShowReferenceFrame>true</ShowReferenceFrame>
        <Name>Reference Frame</Name>
        <Position></Position>
        <Orientation>
         <Angles></Angles>
         <OrientationType>Bryant</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
         <Frame>
     <ScaleValue>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </ScaleValue>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>Default Lights and Cameras</Name>
     <Position></Position>
     <Orientation>
      <Angles></Angles>
      <OrientationType>Bryant</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
      <Camera>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Camera Looking at Origin</Name>
       <Position>
        <X>
         <Value>2.49504474286811</Value>
        </X>
        <Y>
         <Value>1.21672675375277</Value>
        </Y>
        <Z>
         <Value>3.63104270814814</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <Value>-0.524349966770274</Value>
         </X>
         <Y>
     <Value>-0.248138351473946</Value>
         </Y>
         <Z>
     <Value>-0.814545560957646</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <X>
     <Value>-0.736264856034671</Value>
         </X>
         <Y>
     <Value>-0.348422922099064</Value>
         </Y>
         <Z>
     <Value>0.580099585523205</Value>
         </Z>
        </YAxis>
        <OrientationType>Direct3D</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs></Childs>
       <FrontPlane>0.01</FrontPlane>
       <BackPlane>100</BackPlane>
       <AutoFrontBack>true</AutoFrontBack>
       <Field>0.00392699081698724</Field>
       <Fieldy>45</Fieldy>
       <PlaneLeft>-10</PlaneLeft>
       <PlaneRight>10</PlaneRight>
       <PlaneTop>10</PlaneTop>
       <PlaneBottom>-10</PlaneBottom>
       <UseLookatPosition>true</UseLookatPosition>
       <LookatPosition>
        <X>
         <VariableName>YouBotKinematics\HToAngles\pose[2]</VariableName>
         <Value>0.000264116800236482</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\HToAngles\pose[3]</VariableName>
         <Value>-4.99762345736344e-005</Value>
        </Y>
       </LookatPosition>
       <UseAlwaysLookUp>true</UseAlwaysLookUp>
       <LookUpVector>
        <Z>
         <Value>1</Value>
        </Z>
       </LookUpVector>
       <RightHand>true</RightHand>
       <Perspective>true</Perspective>
       <IsSelectedCamera>false</IsSelectedCamera>
      </Camera>
      <Camera>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Ground level</Name>
       <Position>
        <X>
         <Value>2.49504474286811</Value>
        </X>
        <Y>
         <Value>1.21672675375277</Value>
        </Y>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <Value>-0.903896468564703</Value>
         </X>
         <Y>
     <Value>-0.427751299374132</Value>
         </Y>
        </ZAxis>
        <YAxis>
         <Z>
     <Value>1</Value>
         </Z>
        </YAxis>
        <OrientationType>Direct3D</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs></Childs>
       <FrontPlane>0.01</FrontPlane>
       <BackPlane>100</BackPlane>
       <AutoFrontBack>true</AutoFrontBack>
       <Field>0.00392699081698724</Field>
       <Fieldy>45</Fieldy>
       <PlaneLeft>-10</PlaneLeft>
       <PlaneRight>10</PlaneRight>
       <PlaneTop>10</PlaneTop>
       <PlaneBottom>-10</PlaneBottom>
       <UseLookatPosition>true</UseLookatPosition>
       <LookatPosition>
        <X>
         <VariableName>YouBotKinematics\HToAngles\pose[2]</VariableName>
         <Value>0.000264116800236482</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\HToAngles\pose[3]</VariableName>
         <Value>-4.99762345736344e-005</Value>
        </Y>
       </LookatPosition>
       <UseAlwaysLookUp>true</UseAlwaysLookUp>
       <LookUpVector>
        <Z>
         <Value>1</Value>
        </Z>
       </LookUpVector>
       <RightHand>true</RightHand>
       <Perspective>true</Perspective>
       <IsSelectedCamera>false</IsSelectedCamera>
      </Camera>
      <Camera>
       <ShowReferenceFrame>false</ShowReferenceFrame>
       <Name>Moving</Name>
       <Position>
        <X>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\CameraPose[1]</VariableName>
         <Value>0.999298331199564</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\CameraPose[2]</VariableName>
         <Value>1.00113245210335</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\CameraPose[3]</VariableName>
         <Value>0.999748974696299</Value>
        </Z>
       </Position>
       <Orientation>
        <ZAxis>
         <X>
     <Value>-0.451000366352678</Value>
         </X>
         <Y>
     <Value>-0.680817351209232</Value>
         </Y>
         <Z>
     <Value>-0.577136382358793</Value>
         </Z>
        </ZAxis>
        <YAxis>
         <X>
     <Value>-0.318728252664147</Value>
         </X>
         <Y>
     <Value>-0.4811431229851</Value>
         </Y>
         <Z>
     <Value>0.816647779742163</Value>
         </Z>
        </YAxis>
        <OrientationType>Direct3D</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs></Childs>
       <FrontPlane>0.01</FrontPlane>
       <BackPlane>100</BackPlane>
       <AutoFrontBack>true</AutoFrontBack>
       <Field>0.00392699081698724</Field>
       <Fieldy>45</Fieldy>
       <PlaneLeft>-10</PlaneLeft>
       <PlaneRight>10</PlaneRight>
       <PlaneTop>10</PlaneTop>
       <PlaneBottom>-10</PlaneBottom>
       <UseLookatPosition>true</UseLookatPosition>
       <LookatPosition>
        <X>
         <VariableName>YouBotKinematics\HToAngles\pose[2]</VariableName>
         <Value>0.000264116800236482</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\HToAngles\pose[3]</VariableName>
         <Value>-4.99762345736344e-005</Value>
        </Y>
       </LookatPosition>
       <UseAlwaysLookUp>true</UseAlwaysLookUp>
       <LookUpVector>
        <Z>
         <Value>1</Value>
        </Z>
       </LookUpVector>
       <RightHand>true</RightHand>
       <Perspective>true</Perspective>
       <IsSelectedCamera>false</IsSelectedCamera>
      </Camera>
     </Childs>
         </Frame>
         <Frame>
     <ScaleValue>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </ScaleValue>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>Scenery</Name>
     <Position></Position>
     <Orientation>
      <Angles></Angles>
      <OrientationType>Bryant</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs>
      <Frame>
       <ScaleValue>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </ScaleValue>
       <ShowReferenceFrame>true</ShowReferenceFrame>
       <Name>Reference Frame</Name>
       <Position></Position>
       <Orientation>
        <Angles></Angles>
        <OrientationType>Bryant</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
        <Frame>
         <ScaleValue>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <ShowReferenceFrame>false</ShowReferenceFrame>
         <Name>Robot</Name>
         <Position></Position>
         <Orientation>
     <Angles></Angles>
     <OrientationType>Bryant</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
     <Cube>
      <Center>Bottom</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.055</Value>
       </X>
       <Y>
        <Value>0.09</Value>
       </Y>
       <Z>
        <Value>0.155</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>0.552941176470588</Value>
       </Y>
       <Z>
        <Value>0.109803921568627</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.498039215686275</Value>
       </X>
       <Y>
        <Value>0.498039215686275</Value>
       </Y>
       <Z>
        <Value>0.498039215686275</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>14.298713684082</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Link2</Name>
      <Position>
       <X>
        <VariableName>YouBotKinematics\CalculateJ\H20[1,4]</VariableName>
        <Value>0.134919713033878</Value>
       </X>
       <Y>
        <VariableName>YouBotKinematics\CalculateJ\H20[2,4]</VariableName>
        <Value>0.00659283458446372</Value>
       </Y>
       <Z>
        <VariableName>YouBotKinematics\CalculateJ\H20[3,4]</VariableName>
        <Value>0.161</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotKinematics\CalculateJ\H20[1,3]</VariableName>
         <Value>0.872345862386751</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\CalculateJ\H20[2,3]</VariableName>
         <Value>-0.176531288266175</Value>
        </Y>
        <Z>
         <VariableName>YouBotKinematics\CalculateJ\H20[3,3]</VariableName>
         <Value>0.455905034672573</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotKinematics\CalculateJ\H20[1,2]</VariableName>
         <Value>-0.198343427107405</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\CalculateJ\H20[2,2]</VariableName>
         <Value>-0.980132585379799</Value>
        </Y>
        <Z>
         <VariableName>YouBotKinematics\CalculateJ\H20[3,2]</VariableName>
         <Value>1.38777878078145e-017</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cube>
      <Center>Bottom</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.055</Value>
       </X>
       <Y>
        <Value>0.09</Value>
       </Y>
       <Z>
        <Value>0.135</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>0.552941176470588</Value>
       </Y>
       <Z>
        <Value>0.109803921568627</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Link3</Name>
      <Position>
       <X>
        <VariableName>YouBotKinematics\CalculateJ\H30[1,4]</VariableName>
        <Value>0.270133321703824</Value>
       </X>
       <Y>
        <VariableName>YouBotKinematics\CalculateJ\H30[2,4]</VariableName>
        <Value>-0.0207695150967935</Value>
       </Y>
       <Z>
        <VariableName>YouBotKinematics\CalculateJ\H30[3,4]</VariableName>
        <Value>0.231665280374249</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotKinematics\CalculateJ\H30[1,3]</VariableName>
         <Value>-0.962402951338296</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\CalculateJ\H30[2,3]</VariableName>
         <Value>0.194755589676422</Value>
        </Y>
        <Z>
         <VariableName>YouBotKinematics\CalculateJ\H30[3,3]</VariableName>
         <Value>0.189343126479751</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotKinematics\CalculateJ\H30[1,2]</VariableName>
         <Value>-0.198343427107405</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\CalculateJ\H30[2,2]</VariableName>
         <Value>-0.980132585379799</Value>
        </Y>
        <Z>
         <VariableName>YouBotKinematics\CalculateJ\H30[3,2]</VariableName>
         <Value>6.93889390390723e-018</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cylinder>
      <CircleElements>16</CircleElements>
      <LowerRadius>0.09</LowerRadius>
      <UpperRadius>0.09</UpperRadius>
      <Height>1</Height>
      <Closed>true</Closed>
      <LowerClosed>true</LowerClosed>
      <UpperClosed>true</UpperClosed>
      <CenterInOrigin>false</CenterInOrigin>
      <ShowInnerSide>false</ShowInnerSide>
      <ShowOuterSide>true</ShowOuterSide>
      <ScaleValue>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>0.075</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>0.552941176470588</Value>
       </Y>
       <Z>
        <Value>0.109803921568627</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Link1</Name>
      <Position>
       <X>
        <VariableName>YouBotKinematics\CalculateJ\H10[1,4]</VariableName>
        <Value>0.167264088351411</Value>
       </X>
       <Y>
        <VariableName>YouBotKinematics\CalculateJ\H10[2,4]</VariableName>
        <Value>4.75014899193511e-005</Value>
       </Y>
       <Z>
        <VariableName>YouBotKinematics\CalculateJ\H10[3,4]</VariableName>
        <Value>0.142</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotKinematics\CalculateJ\H10[1,3]</VariableName>
         <Value>0</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\CalculateJ\H10[2,3]</VariableName>
         <Value>0</Value>
        </Y>
        <Z>
         <VariableName>YouBotKinematics\CalculateJ\H10[3,3]</VariableName>
         <Value>1</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotKinematics\CalculateJ\H10[1,2]</VariableName>
         <Value>-0.198343427107405</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\CalculateJ\H10[2,2]</VariableName>
         <Value>-0.980132585379799</Value>
        </Y>
        <Z>
         <VariableName>YouBotKinematics\CalculateJ\H10[3,2]</VariableName>
         <Value>0</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cylinder>
     <Cube>
      <Center>Bottom</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.055</Value>
       </X>
       <Y>
        <Value>0.1</Value>
       </Y>
       <Z>
        <Value>0.081</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>0.552941176470588</Value>
       </Y>
       <Z>
        <Value>0.109803921568627</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Link4</Name>
      <Position>
       <X>
        <VariableName>YouBotKinematics\CalculateJ\H40[1,4]</VariableName>
        <Value>0.140208923273154</Value>
       </X>
       <Y>
        <VariableName>YouBotKinematics\CalculateJ\H40[2,4]</VariableName>
        <Value>0.00552248950952352</Value>
       </Y>
       <Z>
        <VariableName>YouBotKinematics\CalculateJ\H40[3,4]</VariableName>
        <Value>0.257226602449015</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotKinematics\CalculateJ\H40[1,3]</VariableName>
         <Value>0.347777974644327</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\CalculateJ\H40[2,3]</VariableName>
         <Value>-0.0703776982750743</Value>
        </Y>
        <Z>
         <VariableName>YouBotKinematics\CalculateJ\H40[3,3]</VariableName>
         <Value>0.934931794270466</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotKinematics\CalculateJ\H40[1,2]</VariableName>
         <Value>-0.198343427107405</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\CalculateJ\H40[2,2]</VariableName>
         <Value>-0.980132585379799</Value>
        </Y>
        <Z>
         <VariableName>YouBotKinematics\CalculateJ\H40[3,2]</VariableName>
         <Value>1.38777878078145e-017</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cube>
      <Center>Bottom</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.055</Value>
       </X>
       <Y>
        <Value>0.1</Value>
       </Y>
       <Z>
        <Value>0.137</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>0.501960784313725</Value>
       </X>
       <Y>
        <Value>0.501960784313725</Value>
       </Y>
       <Z>
        <Value>0.501960784313725</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Link5</Name>
      <Position>
       <X>
        <VariableName>YouBotKinematics\CalculateJ\H50[1,4]</VariableName>
        <Value>0.17359560883901</Value>
       </X>
       <Y>
        <VariableName>YouBotKinematics\CalculateJ\H50[2,4]</VariableName>
        <Value>-0.00123376952488362</Value>
       </Y>
       <Z>
        <VariableName>YouBotKinematics\CalculateJ\H50[3,4]</VariableName>
        <Value>0.34698005469898</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotKinematics\CalculateJ\H50[1,3]</VariableName>
         <Value>0.347777974644327</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\CalculateJ\H50[2,3]</VariableName>
         <Value>-0.0703776982750743</Value>
        </Y>
        <Z>
         <VariableName>YouBotKinematics\CalculateJ\H50[3,3]</VariableName>
         <Value>0.934931794270466</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotKinematics\CalculateJ\H50[1,2]</VariableName>
         <Value>0.386577338145505</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\CalculateJ\H50[2,2]</VariableName>
         <Value>0.919234591361983</Value>
        </Y>
        <Z>
         <VariableName>YouBotKinematics\CalculateJ\H50[3,2]</VariableName>
         <Value>-0.0746038047012617</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cube>
      <Center>Bottom</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.53</Value>
       </X>
       <Y>
        <Value>0.36</Value>
       </Y>
       <Z>
        <Value>0.11</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>0.541176470588235</Value>
       </Y>
       <Z>
        <Value>0.0980392156862745</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.498039215686275</Value>
       </X>
       <Y>
        <Value>0.498039215686275</Value>
       </Y>
       <Z>
        <Value>0.498039215686275</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>14.298713684082</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Base</Name>
      <Position>
       <X>
        <VariableName>Odometry\H_base_0[1,4]</VariableName>
        <Value>0.000141188881933179</Value>
       </X>
       <Y>
        <VariableName>Odometry\H_base_0[2,4]</VariableName>
        <Value>2.79774572630036e-005</Value>
       </Y>
       <Z>
        <VariableName>Odometry\H_base_0[3,4]</VariableName>
        <Value>0</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>Odometry\H_base_0[1,3]</VariableName>
         <Value>0</Value>
        </X>
        <Y>
         <VariableName>Odometry\H_base_0[2,3]</VariableName>
         <Value>0</Value>
        </Y>
        <Z>
         <VariableName>Odometry\H_base_0[3,3]</VariableName>
         <Value>1</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>Odometry\H_base_0[1,2]</VariableName>
         <Value>-0.0010712094003223</Value>
        </X>
        <Y>
         <VariableName>Odometry\H_base_0[2,2]</VariableName>
         <Value>0.999999426255046</Value>
        </Y>
        <Z>
         <VariableName>Odometry\H_base_0[3,2]</VariableName>
         <Value>0</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cube>
      <Center>Center</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.12</Value>
       </X>
       <Y>
        <Value>0.12</Value>
       </Y>
       <Z>
        <Value>0.07</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>0.403921568627451</Value>
       </X>
       <Y>
        <Value>0.403921568627451</Value>
       </Y>
       <Z>
        <Value>0.403921568627451</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.498039215686275</Value>
       </X>
       <Y>
        <Value>0.498039215686275</Value>
       </Y>
       <Z>
        <Value>0.498039215686275</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>14.298713684082</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>WheelLF</Name>
      <Position>
       <X>
        <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,4]</VariableName>
        <Value>0</Value>
       </X>
       <Y>
        <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,4]</VariableName>
        <Value>0</Value>
       </Y>
       <Z>
        <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,4]</VariableName>
        <Value>0</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,3]</VariableName>
         <Value>-0.0003826890736452</Value>
        </X>
        <Y>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,3]</VariableName>
         <Value>0.999999611378293</Value>
        </Y>
        <Z>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,3]</VariableName>
         <Value>0.000794224361237951</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,2]</VariableName>
         <Value>0.978204758756781</Value>
        </X>
        <Y>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,2]</VariableName>
         <Value>0.000209433625721467</Value>
        </Y>
        <Z>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,2]</VariableName>
         <Value>0.207642495850787</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cube>
      <Center>Center</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.12</Value>
       </X>
       <Y>
        <Value>0.12</Value>
       </Y>
       <Z>
        <Value>0.07</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>0.403921568627451</Value>
       </X>
       <Y>
        <Value>0.403921568627451</Value>
       </Y>
       <Z>
        <Value>0.403921568627451</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>WheelRF</Name>
      <Position>
       <X>
        <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,4]</VariableName>
        <Value>0</Value>
       </X>
       <Y>
        <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,4]</VariableName>
        <Value>0</Value>
       </Y>
       <Z>
        <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,4]</VariableName>
        <Value>0</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,3]</VariableName>
         <Value>-0.0003826890736452</Value>
        </X>
        <Y>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,3]</VariableName>
         <Value>0.999999611378293</Value>
        </Y>
        <Z>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,3]</VariableName>
         <Value>0.000794224361237951</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,2]</VariableName>
         <Value>0.640722434232433</Value>
        </X>
        <Y>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,2]</VariableName>
         <Value>-0.000364586299353574</Value>
        </Y>
        <Z>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,2]</VariableName>
         <Value>0.767772511456418</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cube>
      <Center>Center</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.12</Value>
       </X>
       <Y>
        <Value>0.12</Value>
       </Y>
       <Z>
        <Value>0.07</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>0.403921568627451</Value>
       </X>
       <Y>
        <Value>0.403921568627451</Value>
       </Y>
       <Z>
        <Value>0.403921568627451</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>WheelLR</Name>
      <Position>
       <X>
        <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,4]</VariableName>
        <Value>0</Value>
       </X>
       <Y>
        <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,4]</VariableName>
        <Value>0</Value>
       </Y>
       <Z>
        <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,4]</VariableName>
        <Value>0</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,3]</VariableName>
         <Value>-0.0003826890736452</Value>
        </X>
        <Y>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,3]</VariableName>
         <Value>0.999999611378293</Value>
        </Y>
        <Z>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,3]</VariableName>
         <Value>0.000794224361237951</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,2]</VariableName>
         <Value>-0.963194685232876</Value>
        </X>
        <Y>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,2]</VariableName>
         <Value>-0.000582095095311139</Value>
        </Y>
        <Z>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,2]</VariableName>
         <Value>0.268804128510782</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cube>
      <Center>Center</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.12</Value>
       </X>
       <Y>
        <Value>0.12</Value>
       </Y>
       <Z>
        <Value>0.07</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>0.403921568627451</Value>
       </X>
       <Y>
        <Value>0.403921568627451</Value>
       </Y>
       <Z>
        <Value>0.403921568627451</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>WheelRR</Name>
      <Position>
       <X>
        <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,4]</VariableName>
        <Value>0</Value>
       </X>
       <Y>
        <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,4]</VariableName>
        <Value>0</Value>
       </Y>
       <Z>
        <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,4]</VariableName>
        <Value>0</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,3]</VariableName>
         <Value>-0.0003826890736452</Value>
        </X>
        <Y>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,3]</VariableName>
         <Value>0.999999611378293</Value>
        </Y>
        <Z>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,3]</VariableName>
         <Value>0.000794224361237951</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,2]</VariableName>
         <Value>-0.923399306585115</Value>
        </X>
        <Y>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,2]</VariableName>
         <Value>-4.85191728357347e-005</Value>
        </Y>
        <Z>
         <VariableName>Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,2]</VariableName>
         <Value>-0.383840745940317</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Frame>
      <ScaleValue>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </ScaleValue>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Reference Frame</Name>
      <Position>
       <X>
        <VariableName>YouBotKinematics\CalculateJ\H50[1,4]</VariableName>
        <Value>0.17359560883901</Value>
       </X>
       <Y>
        <VariableName>YouBotKinematics\CalculateJ\H50[2,4]</VariableName>
        <Value>-0.00123376952488362</Value>
       </Y>
       <Z>
        <VariableName>YouBotKinematics\CalculateJ\H50[3,4]</VariableName>
        <Value>0.34698005469898</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotKinematics\CalculateJ\H50[1,3]</VariableName>
         <Value>0.347777974644327</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\CalculateJ\H50[2,3]</VariableName>
         <Value>-0.0703776982750743</Value>
        </Y>
        <Z>
         <VariableName>YouBotKinematics\CalculateJ\H50[3,3]</VariableName>
         <Value>0.934931794270466</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotKinematics\CalculateJ\H50[1,2]</VariableName>
         <Value>0.386577338145505</Value>
        </X>
        <Y>
         <VariableName>YouBotKinematics\CalculateJ\H50[2,2]</VariableName>
         <Value>0.919234591361983</Value>
        </Y>
        <Z>
         <VariableName>YouBotKinematics\CalculateJ\H50[3,2]</VariableName>
         <Value>-0.0746038047012617</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
       <Frame>
        <ScaleValue>
         <X>
     <Value>0.3</Value>
         </X>
         <Y>
     <Value>0.3</Value>
         </Y>
         <Z>
     <Value>0.3</Value>
         </Z>
        </ScaleValue>
        <ShowReferenceFrame>true</ShowReferenceFrame>
        <Name>Reference Frame</Name>
        <Position>
         <X>
     <VariableName>HtipCC\output[1,4]</VariableName>
     <Value>0</Value>
         </X>
         <Y>
     <VariableName>HtipCC\output[2,4]</VariableName>
     <Value>0</Value>
         </Y>
         <Z>
     <VariableName>HtipCC\output[3,4]</VariableName>
     <Value>0</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <VariableName>HtipCC\output[1,3]</VariableName>
      <Value>0</Value>
     </X>
     <Y>
      <VariableName>HtipCC\output[2,3]</VariableName>
      <Value>0</Value>
     </Y>
     <Z>
      <VariableName>HtipCC\output[3,3]</VariableName>
      <Value>1</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <VariableName>HtipCC\output[1,2]</VariableName>
      <Value>0</Value>
     </X>
     <Y>
      <VariableName>HtipCC\output[2,2]</VariableName>
      <Value>1</Value>
     </Y>
     <Z>
      <VariableName>HtipCC\output[3,2]</VariableName>
      <Value>0</Value>
     </Z>
         </YAxis>
         <OrientationType>Matrix</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
         <Sphere>
     <InsideOutside>0</InsideOutside>
     <Accuracy>30</Accuracy>
     <SphereAdvanced>false</SphereAdvanced>
     <ScaleValue>
      <X>
       <Value>0.3</Value>
      </X>
      <Y>
       <Value>0.3</Value>
      </Y>
      <Z>
       <Value>0.3</Value>
      </Z>
     </ScaleValue>
     <OverrideColor>true</OverrideColor>
     <MeshColor>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>0</Value>
      </Y>
      <Z>
       <Value>0</Value>
      </Z>
     </MeshColor>
     <Alpha>1</Alpha>
     <MeshColorMultipliers>
      <X>
       <Value>1</Value>
      </X>
      <Y>
       <Value>1</Value>
      </Y>
      <Z>
       <Value>1</Value>
      </Z>
     </MeshColorMultipliers>
     <MeshColorOffsets></MeshColorOffsets>
     <Direct3DColorRange>true</Direct3DColorRange>
     <SpecularColor>
      <X>
       <Value>0.498039215686275</Value>
      </X>
      <Y>
       <Value>0.498039215686275</Value>
      </Y>
      <Z>
       <Value>0.498039215686275</Value>
      </Z>
     </SpecularColor>
     <EmissiveColor></EmissiveColor>
     <ShininessPower>
      <Value>14.298713684082</Value>
     </ShininessPower>
     <OverrideQuality>false</OverrideQuality>
     <ShowReferenceFrame>false</ShowReferenceFrame>
     <Name>Sphere</Name>
     <Position></Position>
     <Orientation>
      <Angles></Angles>
      <OrientationType>Bryant</OrientationType>
     </Orientation>
     <LockX>false</LockX>
     <LockY>false</LockY>
     <LockZ>false</LockZ>
     <LockXPitch>false</LockXPitch>
     <LockYYaw>false</LockYYaw>
     <LockZRoll>false</LockZRoll>
     <Childs></Childs>
         </Sphere>
        </Childs>
       </Frame>
      </Childs>
     </Frame>
         </Childs>
        </Frame>
        <Frame>
         <ScaleValue>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Hvp0</Name>
         <Position>
     <X>
      <VariableName>CartesianController\CartesianSpaceStiffness\Hvp0[1,4]</VariableName>
      <Value>0.00248017299097319</Value>
     </X>
     <Y>
      <VariableName>CartesianController\CartesianSpaceStiffness\Hvp0[2,4]</VariableName>
      <Value>-1.31607164341573e-005</Value>
     </Y>
     <Z>
      <VariableName>CartesianController\CartesianSpaceStiffness\Hvp0[3,4]</VariableName>
      <Value>0.996975369070354</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>CartesianController\CartesianSpaceStiffness\Hvp0[1,3]</VariableName>
       <Value>4.18943545474415e-007</Value>
      </X>
      <Y>
       <VariableName>CartesianController\CartesianSpaceStiffness\Hvp0[2,3]</VariableName>
       <Value>3.86373313208224e-007</Value>
      </Y>
      <Z>
       <VariableName>CartesianController\CartesianSpaceStiffness\Hvp0[3,3]</VariableName>
       <Value>0.999999999999838</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>CartesianController\CartesianSpaceStiffness\Hvp0[1,2]</VariableName>
       <Value>0.000999435419740498</Value>
      </X>
      <Y>
       <VariableName>CartesianController\CartesianSpaceStiffness\Hvp0[2,2]</VariableName>
       <Value>0.999999500564221</Value>
      </Y>
      <Z>
       <VariableName>CartesianController\CartesianSpaceStiffness\Hvp0[3,2]</VariableName>
       <Value>-3.86791827257849e-007</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
     <Cylinder>
      <CircleElements>16</CircleElements>
      <LowerRadius>0.1</LowerRadius>
      <UpperRadius>0</UpperRadius>
      <Height>1</Height>
      <Closed>true</Closed>
      <LowerClosed>true</LowerClosed>
      <UpperClosed>true</UpperClosed>
      <CenterInOrigin>false</CenterInOrigin>
      <ShowInnerSide>false</ShowInnerSide>
      <ShowOuterSide>true</ShowOuterSide>
      <ScaleValue>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>0</Value>
       </Y>
       <Z>
        <Value>0</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Cylinder</Name>
      <Position>
       <Z>
        <Value>0.2</Value>
       </Z>
      </Position>
      <Orientation>
       <Angles>
        <Y>
         <Value>3.14</Value>
        </Y>
       </Angles>
       <OrientationType>Bryant</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cylinder>
     <Frame>
      <ScaleValue>
       <X>
        <Value>0.3</Value>
       </X>
       <Y>
        <Value>0.3</Value>
       </Y>
       <Z>
        <Value>0.3</Value>
       </Z>
      </ScaleValue>
      <ShowReferenceFrame>true</ShowReferenceFrame>
      <Name>Reference Frame</Name>
      <Position>
       <X>
        <VariableName>HtipCC\output[1,4]</VariableName>
        <Value>0</Value>
       </X>
       <Y>
        <VariableName>HtipCC\output[2,4]</VariableName>
        <Value>0</Value>
       </Y>
       <Z>
        <VariableName>HtipCC\output[3,4]</VariableName>
        <Value>0</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>HtipCC\output[1,3]</VariableName>
         <Value>0</Value>
        </X>
        <Y>
         <VariableName>HtipCC\output[2,3]</VariableName>
         <Value>0</Value>
        </Y>
        <Z>
         <VariableName>HtipCC\output[3,3]</VariableName>
         <Value>1</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>HtipCC\output[1,2]</VariableName>
         <Value>0</Value>
        </X>
        <Y>
         <VariableName>HtipCC\output[2,2]</VariableName>
         <Value>1</Value>
        </Y>
        <Z>
         <VariableName>HtipCC\output[3,2]</VariableName>
         <Value>0</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
       <Sphere>
        <InsideOutside>0</InsideOutside>
        <Accuracy>30</Accuracy>
        <SphereAdvanced>false</SphereAdvanced>
        <ScaleValue>
         <X>
     <Value>0.3</Value>
         </X>
         <Y>
     <Value>0.3</Value>
         </Y>
         <Z>
     <Value>0.3</Value>
         </Z>
        </ScaleValue>
        <OverrideColor>true</OverrideColor>
        <MeshColor>
         <X>
     <Value>0</Value>
         </X>
         <Y>
     <Value>0</Value>
         </Y>
         <Z>
     <Value>0.733333333333333</Value>
         </Z>
        </MeshColor>
        <Alpha>1</Alpha>
        <MeshColorMultipliers>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </MeshColorMultipliers>
        <MeshColorOffsets></MeshColorOffsets>
        <Direct3DColorRange>true</Direct3DColorRange>
        <SpecularColor>
         <X>
     <Value>0.5</Value>
         </X>
         <Y>
     <Value>0.5</Value>
         </Y>
         <Z>
     <Value>0.5</Value>
         </Z>
        </SpecularColor>
        <EmissiveColor></EmissiveColor>
        <ShininessPower>
         <Value>15</Value>
        </ShininessPower>
        <OverrideQuality>false</OverrideQuality>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Sphere</Name>
        <Position></Position>
        <Orientation>
         <Angles></Angles>
         <OrientationType>Bryant</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs></Childs>
       </Sphere>
      </Childs>
     </Frame>
         </Childs>
        </Frame>
        <Frame>
         <ScaleValue>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <ShowReferenceFrame>false</ShowReferenceFrame>
         <Name>Robot</Name>
         <Position>
     <Z>
      <Value>-5</Value>
     </Z>
         </Position>
         <Orientation>
     <Angles></Angles>
     <OrientationType>Bryant</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
     <Cube>
      <Center>Bottom</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.055</Value>
       </X>
       <Y>
        <Value>0.09</Value>
       </Y>
       <Z>
        <Value>0.155</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>0.552941176470588</Value>
       </Y>
       <Z>
        <Value>0.109803921568627</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.498039215686275</Value>
       </X>
       <Y>
        <Value>0.498039215686275</Value>
       </Y>
       <Z>
        <Value>0.498039215686275</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>14.298713684082</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Link2</Name>
      <Position>
       <X>
        <VariableName>YouBotModel\Plant\Link2\Hin[1,4]</VariableName>
        <Value>0.13519726880314</Value>
       </X>
       <Y>
        <VariableName>YouBotModel\Plant\Link2\Hin[2,4]</VariableName>
        <Value>0.00662966138320878</Value>
       </Y>
       <Z>
        <VariableName>YouBotModel\Plant\Link2\Hin[3,4]</VariableName>
        <Value>0.160737844557251</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotModel\Plant\Link2\Hin[1,3]</VariableName>
         <Value>0.87236986825785</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\Link2\Hin[2,3]</VariableName>
         <Value>-0.175990760620703</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\Link2\Hin[3,3]</VariableName>
         <Value>0.456068048795273</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotModel\Plant\Link2\Hin[1,2]</VariableName>
         <Value>-0.197753241219153</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\Link2\Hin[2,2]</VariableName>
         <Value>-0.980251832734444</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\Link2\Hin[3,2]</VariableName>
         <Value>-2.84311269138637e-006</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cube>
      <Center>Bottom</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.055</Value>
       </X>
       <Y>
        <Value>0.09</Value>
       </Y>
       <Z>
        <Value>0.135</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>0.552941176470588</Value>
       </Y>
       <Z>
        <Value>0.109803921568627</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Link3</Name>
      <Position>
       <X>
        <VariableName>YouBotModel\Plant\Link3\Hin[1,4]</VariableName>
        <Value>0.270414598383106</Value>
       </X>
       <Y>
        <VariableName>YouBotModel\Plant\Link3\Hin[2,4]</VariableName>
        <Value>-0.0206489065130002</Value>
       </Y>
       <Z>
        <VariableName>YouBotModel\Plant\Link3\Hin[3,4]</VariableName>
        <Value>0.231428392120518</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotModel\Plant\Link3\Hin[1,3]</VariableName>
         <Value>-0.962483322631882</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\Link3\Hin[2,3]</VariableName>
         <Value>0.194168122350198</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\Link3\Hin[3,3]</VariableName>
         <Value>0.189537842972032</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotModel\Plant\Link3\Hin[1,2]</VariableName>
         <Value>-0.197753241219153</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\Link3\Hin[2,2]</VariableName>
         <Value>-0.980251832734444</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\Link3\Hin[3,2]</VariableName>
         <Value>-2.8431126909978e-006</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cylinder>
      <CircleElements>16</CircleElements>
      <LowerRadius>0.09</LowerRadius>
      <UpperRadius>0.09</UpperRadius>
      <Height>1</Height>
      <Closed>true</Closed>
      <LowerClosed>true</LowerClosed>
      <UpperClosed>true</UpperClosed>
      <CenterInOrigin>false</CenterInOrigin>
      <ShowInnerSide>false</ShowInnerSide>
      <ShowOuterSide>true</ShowOuterSide>
      <ScaleValue>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>0.075</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>0.552941176470588</Value>
       </Y>
       <Z>
        <Value>0.109803921568627</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Link1</Name>
      <Position>
       <X>
        <VariableName>YouBotModel\Plant\Link1\Hin[1,4]</VariableName>
        <Value>0.167545815412549</Value>
       </X>
       <Y>
        <VariableName>YouBotModel\Plant\Link1\Hin[2,4]</VariableName>
        <Value>0.000103811893196126</Value>
       </Y>
       <Z>
        <VariableName>YouBotModel\Plant\Link1\Hin[3,4]</VariableName>
        <Value>0.141738244016908</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotModel\Plant\Link1\Hin[1,3]</VariableName>
         <Value>-1.24279808482114e-005</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\Link1\Hin[2,3]</VariableName>
         <Value>-3.9320425986083e-007</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\Link1\Hin[3,3]</VariableName>
         <Value>0.999999999922695</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotModel\Plant\Link1\Hin[1,2]</VariableName>
         <Value>-0.197753241219152</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\Link1\Hin[2,2]</VariableName>
         <Value>-0.980251832734444</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\Link1\Hin[3,2]</VariableName>
         <Value>-2.84311269113071e-006</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cylinder>
     <Cube>
      <Center>Bottom</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.055</Value>
       </X>
       <Y>
        <Value>0.1</Value>
       </Y>
       <Z>
        <Value>0.081</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>0.552941176470588</Value>
       </Y>
       <Z>
        <Value>0.109803921568627</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Link4</Name>
      <Position>
       <X>
        <VariableName>YouBotModel\Plant\Link4\Hin[1,4]</VariableName>
        <Value>0.140479349827803</Value>
       </X>
       <Y>
        <VariableName>YouBotModel\Plant\Link4\Hin[2,4]</VariableName>
        <Value>0.00556379000427659</Value>
       </Y>
       <Z>
        <VariableName>YouBotModel\Plant\Link4\Hin[3,4]</VariableName>
        <Value>0.257016000921743</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotModel\Plant\Link4\Hin[1,3]</VariableName>
         <Value>0.347767229771166</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\Link4\Hin[2,3]</VariableName>
         <Value>-0.0701602922378363</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\Link4\Hin[3,3]</VariableName>
         <Value>0.934952131015482</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotModel\Plant\Link4\Hin[1,2]</VariableName>
         <Value>-0.197753241219152</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\Link4\Hin[2,2]</VariableName>
         <Value>-0.980251832734444</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\Link4\Hin[3,2]</VariableName>
         <Value>-2.84311269133086e-006</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cube>
      <Center>Bottom</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.055</Value>
       </X>
       <Y>
        <Value>0.1</Value>
       </Y>
       <Z>
        <Value>0.137</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>0.501960784313725</Value>
       </X>
       <Y>
        <Value>0.501960784313725</Value>
       </Y>
       <Z>
        <Value>0.501960784313725</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Link5</Name>
      <Position>
       <X>
        <VariableName>YouBotModel\Plant\Link5\Hin[1,4]</VariableName>
        <Value>0.173865003885834</Value>
       </X>
       <Y>
        <VariableName>YouBotModel\Plant\Link5\Hin[2,4]</VariableName>
        <Value>-0.0011715980505557</Value>
       </Y>
       <Z>
        <VariableName>YouBotModel\Plant\Link5\Hin[3,4]</VariableName>
        <Value>0.346771405499229</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotModel\Plant\Link5\Hin[1,3]</VariableName>
         <Value>0.347767229771166</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\Link5\Hin[2,3]</VariableName>
         <Value>-0.0701602922378363</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\Link5\Hin[3,3]</VariableName>
         <Value>0.934952131015482</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotModel\Plant\Link5\Hin[1,2]</VariableName>
         <Value>0.385998613983232</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\Link5\Hin[2,2]</VariableName>
         <Value>0.919479863074982</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\Link5\Hin[3,2]</VariableName>
         <Value>-0.0745778211175148</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cube>
      <Center>Bottom</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.53</Value>
       </X>
       <Y>
        <Value>0.36</Value>
       </Y>
       <Z>
        <Value>0.11</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>0.541176470588235</Value>
       </Y>
       <Z>
        <Value>0.0980392156862745</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.498039215686275</Value>
       </X>
       <Y>
        <Value>0.498039215686275</Value>
       </Y>
       <Z>
        <Value>0.498039215686275</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>14.298713684082</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Base</Name>
      <Position>
       <X>
        <VariableName>YouBotModel\Plant\Base\Hin[1,4]</VariableName>
        <Value>0.00054770779946995</Value>
       </X>
       <Y>
        <VariableName>YouBotModel\Plant\Base\Hin[2,4]</VariableName>
        <Value>-0.000102575076740707</Value>
       </Y>
       <Z>
        <VariableName>YouBotModel\Plant\Base\Hin[3,4]</VariableName>
        <Value>-0.000263831524504614</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotModel\Plant\Base\Hin[1,3]</VariableName>
         <Value>-1.24279808482114e-005</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\Base\Hin[2,3]</VariableName>
         <Value>-3.9320425986083e-007</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\Base\Hin[3,3]</VariableName>
         <Value>0.999999999922695</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotModel\Plant\Base\Hin[1,2]</VariableName>
         <Value>-0.0012361844655203</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\Base\Hin[2,2]</VariableName>
         <Value>0.99999923592362</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\Base\Hin[3,2]</VariableName>
         <Value>3.77840682589609e-007</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cube>
      <Center>Center</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.12</Value>
       </X>
       <Y>
        <Value>0.12</Value>
       </Y>
       <Z>
        <Value>0.07</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>0.403921568627451</Value>
       </X>
       <Y>
        <Value>0.403921568627451</Value>
       </Y>
       <Z>
        <Value>0.403921568627451</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.498039215686275</Value>
       </X>
       <Y>
        <Value>0.498039215686275</Value>
       </Y>
       <Z>
        <Value>0.498039215686275</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>14.298713684082</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>WheelLF</Name>
      <Position>
       <X>
        <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,4]</VariableName>
        <Value>0.235361479154518</Value>
       </X>
       <Y>
        <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,4]</VariableName>
        <Value>0.150187793999861</Value>
       </Y>
       <Z>
        <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,4]</VariableName>
        <Value>0.0497391458352275</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,3]</VariableName>
         <Value>0.00123617417683245</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,3]</VariableName>
         <Value>-0.999998919168816</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,3]</VariableName>
         <Value>0.000795948870109137</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,2]</VariableName>
         <Value>0.00182431926368199</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,2]</VariableName>
         <Value>0.000798203331118863</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,2]</VariableName>
         <Value>0.999998017363368</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cube>
      <Center>Center</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.12</Value>
       </X>
       <Y>
        <Value>0.12</Value>
       </Y>
       <Z>
        <Value>0.07</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>0.403921568627451</Value>
       </X>
       <Y>
        <Value>0.403921568627451</Value>
       </Y>
       <Z>
        <Value>0.403921568627451</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>WheelRF</Name>
      <Position>
       <X>
        <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,4]</VariableName>
        <Value>0.235732334494174</Value>
       </X>
       <Y>
        <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,4]</VariableName>
        <Value>-0.149811976777225</Value>
       </Y>
       <Z>
        <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,4]</VariableName>
        <Value>0.0497390324830227</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,3]</VariableName>
         <Value>0.00123617417683245</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,3]</VariableName>
         <Value>-0.999998919168816</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,3]</VariableName>
         <Value>0.000795948870109137</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,2]</VariableName>
         <Value>0.00967841946471428</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,2]</VariableName>
         <Value>0.000807876415890026</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,2]</VariableName>
         <Value>0.99995283665399</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cube>
      <Center>Center</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.12</Value>
       </X>
       <Y>
        <Value>0.12</Value>
       </Y>
       <Z>
        <Value>0.07</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>0.403921568627451</Value>
       </X>
       <Y>
        <Value>0.403921568627451</Value>
       </Y>
       <Z>
        <Value>0.403921568627451</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>WheelLR</Name>
      <Position>
       <X>
        <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,4]</VariableName>
        <Value>-0.234638161693319</Value>
       </X>
       <Y>
        <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,4]</VariableName>
        <Value>0.149606787303318</Value>
       </Y>
       <Z>
        <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,4]</VariableName>
        <Value>0.0497333044602376</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,3]</VariableName>
         <Value>0.00123617417683245</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,3]</VariableName>
         <Value>-0.999998919168816</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,3]</VariableName>
         <Value>0.000795948870109137</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,2]</VariableName>
         <Value>-0.000341024390819134</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,2]</VariableName>
         <Value>0.000795527866247395</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,2]</VariableName>
         <Value>0.999999625418819</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
     <Cube>
      <Center>Center</Center>
      <RibLength>1</RibLength>
      <ShowInnerSide>true</ShowInnerSide>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>0.12</Value>
       </X>
       <Y>
        <Value>0.12</Value>
       </Y>
       <Z>
        <Value>0.07</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>0.403921568627451</Value>
       </X>
       <Y>
        <Value>0.403921568627451</Value>
       </Y>
       <Z>
        <Value>0.403921568627451</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets></MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor></EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>WheelRR</Name>
      <Position>
       <X>
        <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,4]</VariableName>
        <Value>-0.234267306353663</Value>
       </X>
       <Y>
        <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,4]</VariableName>
        <Value>-0.150392983473768</Value>
       </Y>
       <Z>
        <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,4]</VariableName>
        <Value>0.0497331911080328</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,3]</VariableName>
         <Value>0.00123617417683245</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,3]</VariableName>
         <Value>-0.999998919168816</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,3]</VariableName>
         <Value>0.000795948870109137</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,2]</VariableName>
         <Value>0.0118436383376089</Value>
        </X>
        <Y>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,2]</VariableName>
         <Value>0.000810534458022811</Value>
        </Y>
        <Z>
         <VariableName>YouBotModel\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,2]</VariableName>
         <Value>0.999929533149622</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
     </Cube>
         </Childs>
        </Frame>
        <Frame>
         <ScaleValue>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <ShowReferenceFrame>true</ShowReferenceFrame>
         <Name>Reference Frame</Name>
         <Position>
     <X>
      <VariableName>YouBotModel\YouBot_OODL\Base_H[1,4]</VariableName>
      <Value>0.000547707691209703</Value>
     </X>
     <Y>
      <VariableName>YouBotModel\YouBot_OODL\Base_H[2,4]</VariableName>
      <Value>-0.000102575043360676</Value>
     </Y>
     <Z>
      <VariableName>YouBotModel\YouBot_OODL\Base_H[3,4]</VariableName>
      <Value>0</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <VariableName>YouBotModel\YouBot_OODL\Base_H[1,3]</VariableName>
       <Value>0</Value>
      </X>
      <Y>
       <VariableName>YouBotModel\YouBot_OODL\Base_H[2,3]</VariableName>
       <Value>0</Value>
      </Y>
      <Z>
       <VariableName>YouBotModel\YouBot_OODL\Base_H[3,3]</VariableName>
       <Value>1</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <VariableName>YouBotModel\YouBot_OODL\Base_H[1,2]</VariableName>
       <Value>-0.00123618442441958</Value>
      </X>
      <Y>
       <VariableName>YouBotModel\YouBot_OODL\Base_H[2,2]</VariableName>
       <Value>0.999999235923743</Value>
      </Y>
      <Z>
       <VariableName>YouBotModel\YouBot_OODL\Base_H[3,2]</VariableName>
       <Value>0</Value>
      </Z>
     </YAxis>
     <OrientationType>Matrix</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
     <Camera>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Camera Looking at Origin</Name>
      <Position>
       <X>
        <Value>2.37811866848997</Value>
       </X>
       <Y>
        <Value>1.67451075895056</Value>
       </Y>
       <Z>
        <Value>1.74705146721286</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <Value>-0.687600271245606</Value>
        </X>
        <Y>
         <Value>-0.48428547581278</Value>
        </Y>
        <Z>
         <Value>-0.540993017422368</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <Value>-0.442300792496069</Value>
        </X>
        <Y>
         <Value>-0.311517983200181</Value>
        </Y>
        <Z>
         <Value>0.841027083452276</Value>
        </Z>
       </YAxis>
       <OrientationType>Direct3D</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs></Childs>
      <FrontPlane>0.01</FrontPlane>
      <BackPlane>100</BackPlane>
      <AutoFrontBack>true</AutoFrontBack>
      <Field>0.00392699081698724</Field>
      <Fieldy>45</Fieldy>
      <PlaneLeft>-10</PlaneLeft>
      <PlaneRight>10</PlaneRight>
      <PlaneTop>10</PlaneTop>
      <PlaneBottom>-10</PlaneBottom>
      <UseLookatPosition>true</UseLookatPosition>
      <LookatPosition>
       <X>
        <VariableName>YouBotKinematics\HToAngles\pose[2]</VariableName>
        <Value>0.000264116800236482</Value>
       </X>
       <Y>
        <VariableName>YouBotKinematics\HToAngles\pose[3]</VariableName>
        <Value>-4.99762345736344e-005</Value>
       </Y>
      </LookatPosition>
      <UseAlwaysLookUp>true</UseAlwaysLookUp>
      <LookUpVector>
       <Z>
        <Value>1</Value>
       </Z>
      </LookUpVector>
      <RightHand>true</RightHand>
      <Perspective>true</Perspective>
      <IsSelectedCamera>false</IsSelectedCamera>
     </Camera>
         </Childs>
        </Frame>
       </Childs>
      </Frame>
     </Childs>
         </Frame>
        </Childs>
       </Frame>
      </Childs>
     </Frame>
         </Childs>
        </Frame>
       </MainFrame>
      </Plot>
      <Plot>
       <PlotType>GraphPlot</PlotType>
       <BasePlot>
        <UseWindowsBGColor>true</UseWindowsBGColor>
        <BGColor>13160660</BGColor>
       </BasePlot>
       <Grid>
        <DrawGrid>true</DrawGrid>
        <GridColor>15780518</GridColor>
        <XTicks>10</XTicks>
        <YTicks>10</YTicks>
        <ZTicks>10</ZTicks>
        <Use3DLook>false</Use3DLook>
       </Grid>
       <PlotBGColor>16777215</PlotBGColor>
       <ShowPlotTitle>true</ShowPlotTitle>
       <TitlePosition>1</TitlePosition>
       <PlotTitle>Energy</PlotTitle>
       <ShowXValues>true</ShowXValues>
       <Fonts>
        <TitleFont>
         <Name>Arial</Name>
         <Height>12</Height>
         <PitchFamily>34</PitchFamily>
         <Weight>400</Weight>
         <Italic>0</Italic>
         <UnderLine>0</UnderLine>
         <StrikeOut>0</StrikeOut>
         <Color>0</Color>
        </TitleFont>
        <LabelFont>
         <Name>Arial</Name>
         <Height>12</Height>
         <PitchFamily>34</PitchFamily>
         <Weight>400</Weight>
         <Italic>0</Italic>
         <UnderLine>0</UnderLine>
         <StrikeOut>0</StrikeOut>
         <Color>0</Color>
        </LabelFont>
        <ValuesFont>
         <Name>Arial</Name>
         <Height>10</Height>
         <PitchFamily>34</PitchFamily>
         <Weight>400</Weight>
         <Italic>0</Italic>
         <UnderLine>0</UnderLine>
         <StrikeOut>0</StrikeOut>
         <Color>0</Color>
        </ValuesFont>
       </Fonts>
       <SharedXAxis>true</SharedXAxis>
       <SharedYAxis>true</SharedYAxis>
       <SharedZAxis>false</SharedZAxis>
       <XAxes>
        <Axis>
         <Minimum>0</Minimum>
         <Maximum>8.95100000000001</Maximum>
         <Linear>true</Linear>
         <Scaling>3</Scaling>
         <Label>time</Label>
        </Axis>
       </XAxes>
       <YAxes>
        <Axis>
         <Minimum>-100</Minimum>
         <Maximum>900</Maximum>
         <Linear>true</Linear>
         <Scaling>1</Scaling>
         <Label>ArmPoseController\PassivityLayer\EnegyTank\energyState</Label>
        </Axis>
        <Axis>
         <Minimum>0</Minimum>
         <Maximum>10</Maximum>
         <Linear>true</Linear>
         <Scaling>1</Scaling>
         <Label>ArmPoseController\PassivityLayer\PassiveSampling\energyQuanta</Label>
        </Axis>
        <Axis>
         <Minimum>0</Minimum>
         <Maximum>10</Maximum>
         <Linear>true</Linear>
         <Scaling>1</Scaling>
         <Label>SimpleEnergySupply\EnergyTankBlock\EnergyState</Label>
        </Axis>
       </YAxes>
       <ZAxes></ZAxes>
       <Curves>
        <Curve>
         <LineColor>16711680</LineColor>
         <LineStyle>1</LineStyle>
         <TickColor>16711680</TickColor>
         <TickStyle>0</TickStyle>
         <PixelThresshold>1</PixelThresshold>
         <LineThickness>1</LineThickness>
         <LineOrder>1</LineOrder>
         <ShowYValues>true</ShowYValues>
         <XCurveData>
     <ShowUnit>true</ShowUnit>
     <VarName>time</VarName>
         </XCurveData>
         <YCurveData>
     <ShowUnit>true</ShowUnit>
     <VarName>ArmPoseController\PassivityLayer\EnegyTank\energyState</VarName>
         </YCurveData>
        </Curve>
        <Curve>
         <LineColor>16711935</LineColor>
         <LineStyle>1</LineStyle>
         <TickColor>16711935</TickColor>
         <TickStyle>0</TickStyle>
         <PixelThresshold>1</PixelThresshold>
         <LineThickness>1</LineThickness>
         <LineOrder>1</LineOrder>
         <ShowYValues>true</ShowYValues>
         <XCurveData>
     <ShowUnit>true</ShowUnit>
     <VarName>time</VarName>
         </XCurveData>
         <YCurveData>
     <ShowUnit>true</ShowUnit>
     <VarName>ArmPoseController\PassivityLayer\PassiveSampling\energyQuanta</VarName>
         </YCurveData>
        </Curve>
        <Curve>
         <LineColor>255</LineColor>
         <LineStyle>1</LineStyle>
         <TickColor>255</TickColor>
         <TickStyle>0</TickStyle>
         <PixelThresshold>1</PixelThresshold>
         <LineThickness>1</LineThickness>
         <LineOrder>1</LineOrder>
         <ShowYValues>true</ShowYValues>
         <XCurveData>
     <ShowUnit>true</ShowUnit>
     <VarName>time</VarName>
         </XCurveData>
         <YCurveData>
     <ShowUnit>true</ShowUnit>
     <VarName>SimpleEnergySupply\EnergyTankBlock\EnergyState</VarName>
         </YCurveData>
        </Curve>
       </Curves>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
       <StripChartPlots>
        <DistributState>2</DistributState>
        <StripChartPlot>
         <Legenda>
     <ShowLegenda>true</ShowLegenda>
         </Legenda>
        </StripChartPlot>
        <StripChartPlot>
         <Legenda>
     <ShowLegenda>true</ShowLegenda>
         </Legenda>
        </StripChartPlot>
        <StripChartPlot>
         <Legenda>
     <ShowLegenda>true</ShowLegenda>
         </Legenda>
        </StripChartPlot>
       </StripChartPlots>
      </Plot>
     </Plots>
     <WindowRectangles virtualDesktopWidth="1680" virtualDesktopHeight="2078">
      <WindowRectangle monitor="1" left="0" top="1028" right="1680" bottom="2078">0.0125 -0.0514286 0.348214 0.580952</WindowRectangle>
      <WindowRectangle monitor="1" left="0" top="1028" right="1680" bottom="2078">0.0125 -0.0514286 0.335119 0.338095</WindowRectangle>
      <WindowRectangle monitor="0" left="0" top="0" right="1680" bottom="1028">0.333929 0.020428 0.997024 0.995136</WindowRectangle>
     </WindowRectangles>
    </PlotSpecs>
    <RunSpecs>
     <SimulatorSettings>
      <StartTime>0</StartTime>
      <FinishTime>40</FinishTime>
      <Warp>false</Warp>
      <UseOutputAfterEach>false</UseOutputAfterEach>
      <OutputAfterEach>0.1</OutputAfterEach>
      <EventEpsilon>1e-006</EventEpsilon>
      <AlgebraicTolerance>1e-007</AlgebraicTolerance>
      <SteadyStateAnalysis>false</SteadyStateAnalysis>
      <UpdateHoldInstructions>false</UpdateHoldInstructions>
      <DiscreteSystems>
       <DiscreteSystem>
        <DiscreteID>ArmPoseController\PassivityLayer\PassiveSampling\sensorValue</DiscreteID>
        <TimeInterval>0.001</TimeInterval>
        <InitialSampleTimeDelay>0</InitialSampleTimeDelay>
        <FixedSampleTimeDelay>0</FixedSampleTimeDelay>
        <VariableTimeDelayMin>0</VariableTimeDelayMin>
        <VariableTimeDelayMax>0</VariableTimeDelayMax>
        <VariableTimeDelayMean>0</VariableTimeDelayMean>
        <VariableTimeDelayDeviation>0</VariableTimeDelayDeviation>
        <UseVariableTimeDelay>false</UseVariableTimeDelay>
        <UniformVariableTimeDelay>false</UniformVariableTimeDelay>
        <UseGlobalTime>true</UseGlobalTime>
        <HoldTimeDelay>0</HoldTimeDelay>
        <ActionOnSampleMissed>0</ActionOnSampleMissed>
       </DiscreteSystem>
      </DiscreteSystems>
     </SimulatorSettings>
     <IntegrationMethods>
      <IntegrationMethod>
       <Name>Euler</Name>
       <StepSize>0.01</StepSize>
      </IntegrationMethod>
      <IntegrationMethod>
       <Name>BackwardEuler</Name>
       <AbsoluteTolerance>1e-005</AbsoluteTolerance>
       <RelativeTolerance>1e-005</RelativeTolerance>
       <AlgebraicAbsoluteTolerance>1e-005</AlgebraicAbsoluteTolerance>
       <AlgebraicRelativeTolerance>1e-005</AlgebraicRelativeTolerance>
       <StepSize>0.01</StepSize>
       <Alpha>1</Alpha>
      </IntegrationMethod>
      <IntegrationMethod>
       <Name>AdamsBashforth</Name>
       <StepSize>0.01</StepSize>
      </IntegrationMethod>
      <IntegrationMethod>
       <Name>RungeKutta2</Name>
       <StepSize>0.01</StepSize>
      </IntegrationMethod>
      <IntegrationMethod>
       <Name>RungeKutta4</Name>
       <StepSize>0.0001</StepSize>
      </IntegrationMethod>
      <IntegrationMethod>
       <Name>RungeKutta8</Name>
       <UseInitialStepSize>false</UseInitialStepSize>
       <InitialStepSize>0</InitialStepSize>
       <UseMaximumStepSize>false</UseMaximumStepSize>
       <MaximumStepSize>0</MaximumStepSize>
       <AbsoluteTolerance>1e-006</AbsoluteTolerance>
       <RelativeTolerance>1e-006</RelativeTolerance>
       <SafetyFactor>0.9</SafetyFactor>
       <Factor1>0.33</Factor1>
       <Factor2>6</Factor2>
       <Beta>0</Beta>
       <UseMaxNrSteps>false</UseMaxNrSteps>
       <MaxNrSteps>100000</MaxNrSteps>
       <UseStiffDetection>false</UseStiffDetection>
       <MaxNrStiffnessSteps>1000</MaxNrStiffnessSteps>
      </IntegrationMethod>
      <IntegrationMethod>
       <Name>RungeKuttaFehlberg</Name>
       <UseInitialStepSize>false</UseInitialStepSize>
       <InitialStepSize>0</InitialStepSize>
       <UseMaximumStepSize>false</UseMaximumStepSize>
       <MaximumStepSize>0</MaximumStepSize>
       <AbsoluteTolerance>1e-006</AbsoluteTolerance>
       <RelativeTolerance>1e-006</RelativeTolerance>
      </IntegrationMethod>
      <IntegrationMethod>
       <Name>VodeAdams</Name>
       <UseInitialStepSize>false</UseInitialStepSize>
       <InitialStepSize>0</InitialStepSize>
       <UseMaximumStepSize>false</UseMaximumStepSize>
       <MaximumStepSize>0</MaximumStepSize>
       <AbsoluteTolerance>1e-006</AbsoluteTolerance>
       <RelativeTolerance>1e-006</RelativeTolerance>
      </IntegrationMethod>
      <IntegrationMethod>
       <Name>BDFMethod</Name>
       <AbsoluteTolerance>1e-005</AbsoluteTolerance>
       <RelativeTolerance>1e-005</RelativeTolerance>
       <AlgebraicAbsoluteTolerance>1e-005</AlgebraicAbsoluteTolerance>
       <AlgebraicRelativeTolerance>1e-005</AlgebraicRelativeTolerance>
       <UseInitialStepSize>false</UseInitialStepSize>
       <InitialStepSize>0</InitialStepSize>
       <UseMaximumStepSize>false</UseMaximumStepSize>
       <MaximumStepSize>0</MaximumStepSize>
       <UseFixedStepSize>false</UseFixedStepSize>
       <FixedStepSize>0</FixedStepSize>
      </IntegrationMethod>
      <IntegrationMethod>
       <Name>MeBDFiMethod</Name>
       <AbsoluteTolerance>1e-005</AbsoluteTolerance>
       <RelativeTolerance>1e-005</RelativeTolerance>
       <AlgebraicAbsoluteTolerance>1e-005</AlgebraicAbsoluteTolerance>
       <AlgebraicRelativeTolerance>1e-005</AlgebraicRelativeTolerance>
       <UseInitialStepSize>false</UseInitialStepSize>
       <InitialStepSize>0</InitialStepSize>
       <UseMaximumStepSize>false</UseMaximumStepSize>
       <MaximumStepSize>0</MaximumStepSize>
       <UseFixedStepSize>false</UseFixedStepSize>
       <FixedStepSize>0</FixedStepSize>
      </IntegrationMethod>
      <SelectedIntegrationMethod>4</SelectedIntegrationMethod>
     </IntegrationMethods>
    </RunSpecs>
    <MultipleRun>
     <NrSteps>10</NrSteps>
     <CopyFromStates>false</CopyFromStates>
     <JoinParameterVariation>true</JoinParameterVariation>
     <ClearAfterRun>true</ClearAfterRun>
     <RedrawAfterRun>false</RedrawAfterRun>
     <DrawDuringSimulation>true</DrawDuringSimulation>
     <ActionBeforeOptimization>0</ActionBeforeOptimization>
     <CompareValue>0</CompareValue>
     <UseCompareValue>true</UseCompareValue>
     <MultipleRunType>MultipleRun</MultipleRunType>
     <Minimize>true</Minimize>
     <OptimizationVariable></OptimizationVariable>
     <ResulVarUsage>UseEndValue</ResulVarUsage>
     <Tolerance>0.001</Tolerance>
     <OptimizationMethod>BroydonFletcherGoldfarbShanno</OptimizationMethod>
     <MultipleRunVariables></MultipleRunVariables>
    </MultipleRun>
    <ExportData>
     <WriteAsText>true</WriteAsText>
     <ReadAsText>true</ReadAsText>
     <WriteHeader>true</WriteHeader>
     <ReadHeader>true</ReadHeader>
     <ReadFilename></ReadFilename>
     <WriteFilename></WriteFilename>
     <DoWrite>false</DoWrite>
     <ExportVariables></ExportVariables>
     <ImportVariables></ImportVariables>
    </ExportData>
    <BreakPoints></BreakPoints>
    <AnimationPlayback>
     <PlaybackSpeed>1</PlaybackSpeed>
    </AnimationPlayback>
   </ExpData>
  </Experiment>
 </Experiments>
</Document>
