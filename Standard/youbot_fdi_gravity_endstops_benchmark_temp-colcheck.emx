<?xml version="1.0" encoding="UTF-8"?>
<Document>
 <Model version="4.1" build="4.1.2.4">
  <Sidops><![CDATA[model 128 184
 description '<Description>
   <Version>4.1</Version>
<IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Z:\Users\yury\Dropbox\UT\BRICS\Workspace\modeling\Douwe\youbot_fdi_gravity_endstops_benchmark_temp-colcheck.emx</LibraryPath>
  <TimeStamp>2011-9-29 11:29:01</TimeStamp>
</Description>';
 type 'Mainmodel-319'
 end;
 implementation bg
  submodels
   model 416 152
    description '<Description>
   <Version>4.1</Version>
<IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>E:\My Dropbox\Studie en werk\UTwente\Master project\Fault detection and Isolation\youbot_fdi_gravity_endstops_temp.emx</LibraryPath>
  <TimeStamp>2011-1-19 10:37:33</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
    type Mainmodel
     parameters
      real InitialBasePos[4,4] = [1.0, 0.0, 0.0, 0.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];
      real InitialJointPos[5,1] = [0.0; 0.0; 0.0; 0.0; 0.0];
      real Linkdim[3,6] = [0.115, 0.0, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.08, 0.075, 0.155, 0.135, 0.081, 0.137];
      real LinkCOMdim[3,6] = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0375, 0.0775, 0.0675, 0.0405, 0.0685];
      real Linkm[6,1] = [20.0; 1.0; 1.0; 1.0; 1.0; 1.0];
      real LinkI[3,6] = [20.0, 1.0, 1.0, 1.0, 1.0, 1.0; 20.0, 1.0, 1.0, 1.0, 1.0, 1.0; 20.0, 1.0, 1.0, 1.0, 1.0, 1.0];
      real MecanumWheelRadius = 0.053;
      real Wheelpos[2,4] = [0.215, 0.215, -0.215, -0.215; -0.15, 0.15, -0.15, 0.15];
      real MaxEndstopPos[5,1] = [2.95; 1.57; 2.55; 1.79; 2.92] {rad};
      real MinEndstopPos[5,1] = [-2.95; -1.13; -2.64; -1.79; -2.92] {rad};
      real CtipControl = 0.07;
      real Rcontrol[8,1] = [100.0; 100.0; 100.0; 40.0; 40.0; 40.0; 40.0; 40.0];
      real Rjoint = 1.0;
      real CobserverControl = 1.0e-9;
      real RobserverControl = 100.0;
      real Rwheel = 0.1;
      real CendstopAvoidanceControl = 50;
      real EndstopDangerzone = 0.035;
      real Rconstraint = 1000.0;
      real Cconstraint = 1.0e-4;
      real DiagnosticsTreshold = 0.1;
      real Rbreaks = 10000.0;
      real Cbreaks = 1.0e-4;
    end;
    implementation bg
     submodels
      CalculateJ 552 224
       description '<Description>
   <Version>4.1</Version>
  <LibraryPath>CalculateYoubotJ.emx</LibraryPath>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <TimeStamp>2011-1-19 15:06:55</TimeStamp>
<AllowLibraryUpdate>False</AllowLibraryUpdate>
</Description>';
       type 'Submodel-Equation'
        ports
         signal in jointVelocities [8,1];
         signal out controllableJ [6,8];
         signal out Htip0 [4,4];
        parameters
         real InitialJointPos[5,1] = [0.0; 0.0; 0.0; 0.0; 0.0];
         real Linkdim[3,6] = [0.115, 0.0, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.08, 0.075, 0.155, 0.135, 0.081, 0.137];
         real InitialBasePos[4,4] = [1.0, 0.0, 0.0, 0.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];
       end;
       icon bg right
        figures
         rectangle 515 202 589 246 fill 11206627;
         text 'Calculate
YouBot J' 552 224 16;
       end;
       implementation eq
constants
	real hidden vx[3] = [1;0;0];
	real hidden vy[3] = [0;1;0];
	real hidden omegaz[3] = [0;0;1];
	real hidden omega1[3] = [0;0;1]; 
	real hidden omega2[3] = [0;1;0]; 
	real hidden omega3[3] = [0;1;0]; 
	real hidden omega4[3] = [0;1;0]; 
	real hidden omega5[3] = [0;0;1];

variables
	real uTrzrefref[6];
	real uTryrefref[6];
	real uTrxrefref[6];
	real uTr1refref[6];
	real uTr211[6];	
	real uTr322[6];	
	real uTr433[6];
	real uTr544[6];


	real 					R1ref[3,3], 	R21[3,3], 	R32[3,3], 	R43[3,3], 	R54[3,3], 	Rtip5[3,3];
	real 					p1ref[3], 		p21[3], 		p32[3], 		p43[3], 		p54[3], 		ptip5[3];
	real 	Href0[4,4],	H1ref[4,4], 	H21[4,4], 	H32[4,4], 	H43[4,4], 	H54[4,4], 	Htip5[4,4];
	real 					H10[4,4],		H20[4,4],	H30[4,4],	H40[4,4],	H50[4,4];

	real q[8];
	real T[6];
	real tildeT[4,4];
	real dotH[4,4];
	real initialq[8];

code

	T = [0;0;jointVelocities[1];jointVelocities[3];jointVelocities[2];0];	
	tildeT = tilde(T);
	dotH = Href0*tildeT;
	Href0 = int(dotH,InitialBasePos);

initialequations
	initialq = [0;0;0;InitialJointPos[1];InitialJointPos[2];InitialJointPos[3];InitialJointPos[4];InitialJointPos[5]];
equations

	q = int(jointVelocities,initialq);

//Calculate relative positions of the joints
R1ref = [	cos(q[4]),	-sin(q[4]),	0;
			sin(q[4]),	cos(q[4]),	0;
			0,				0,				1];
p1ref = Linkdim[1:3,1];
H1ref = homogeneous(R1ref,p1ref);

R21 = [	cos(q[5]),	0,	sin(q[5]);
			0,				1,	0;
			-sin(q[5]),	0,	cos(q[5])];
p21 = Linkdim[1:3,2];
H21 = homogeneous(R21,p21);

R32 = [	cos(q[6]),	0,	sin(q[6]);
			0,				1,	0;
			-sin(q[6]),	0,	cos(q[6])];
p32 = Linkdim[1:3,3];
H32 = homogeneous(R32,p32);

R43 = [	cos(q[7]),	0,	sin(q[7]);
			0,				1,	0;
			-sin(q[7]),	0,	cos(q[7])];
p43 = Linkdim[1:3,4];
H43 = homogeneous(R43,p43);

R54 = [	cos(q[8]),	-sin(q[8]),	0;
			sin(q[8]),	cos(q[8]),	0;
			0,				0,				1];
p54 = Linkdim[1:3,5];
H54 = homogeneous(R54,p54);

Rtip5 = eye(3);
ptip5 = Linkdim[1:3,6];
Htip5 = homogeneous(Rtip5,ptip5);

//calculate position of the joints with respect to inertial frame

H10 = Href0 * H1ref;
H20 = H10 * H21;
H30 = H20 * H32;
H40 = H30 * H43;
H50 = H40 * H54;
Htip0 = H50 * Htip5;

uTrzrefref[1:3] = omegaz; 
uTrzrefref[4:6] = 0;
uTryrefref[1:3] = 0;
uTryrefref[4:6] = vy;
uTrxrefref[1:3] = 0;
uTrxrefref[4:6] = vx;
uTr1refref[1:3] = omega1;
uTr1refref[4:6] = skew(Linkdim[1:3,1])*omega1;
uTr211[1:3] = omega2;
uTr211[4:6] = skew(Linkdim[1:3,2])*omega2;
uTr322[1:3] = omega3;
uTr322[4:6] = skew(Linkdim[1:3,3])*omega3;
uTr433[1:3] = omega4;
uTr433[4:6] = skew(Linkdim[1:3,4])*omega4;
uTr544[1:3] = omega5;
uTr544[4:6] = skew(Linkdim[1:3,5])*omega5;

//Construct Geometric Jacobian

controllableJ[1:6,1] = Adjoint(Href0)*uTrzrefref;
controllableJ[1:6,2] = Adjoint(Href0)*uTryrefref;
controllableJ[1:6,3] = Adjoint(Href0)*uTrxrefref;
controllableJ[1:6,4] = Adjoint(Href0)*uTr1refref;
controllableJ[1:6,5] = Adjoint(H10)*uTr211;
controllableJ[1:6,6] = Adjoint(H20)*uTr322;
controllableJ[1:6,7] = Adjoint(H30)*uTr433;
controllableJ[1:6,8] = Adjoint(H40)*uTr544;



implementation_end;
      CendstopAvoidanceControl 544 328
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type C
        ports
         power in p [8,1];
         signal out state [8,1];
        restrictions
         causality preferred out p;
        parameters
         real CendstopAvoidanceControl = 50.0;
         real dangerzone = 0.035 {rad};
         real InitialJointPos[5,1] = [0.0; 0.0; 0.0; 0.0; 0.0];
         real MaxEndstopPos[5,1] = [2.95; 1.57; 2.55; 1.79; 2.92];
         real MinEndstopPos[5,1] = [-2.95; -1.13; -2.64; -1.79; -2.92];
       end;
       icon bg bottom
        figures
         text 'C' 544 328 18 bold;
       end;
       implementation eq
variables
	real K[8,8];
	real ks[8];
	real posdangerzones[8];
	real negdangerzones[8];
	real tempstate[8];
	real initstate[8];
initialequations
	initstate = [0;0;0;InitialJointPos[1];InitialJointPos[2];InitialJointPos[3];InitialJointPos[4];InitialJointPos[5]];

code
   state = int(p.f,initstate);//radians
	tempstate = state;

	posdangerzones = [
		0;
		0;
		0;
		MaxEndstopPos[1]-dangerzone;
		MaxEndstopPos[2]-dangerzone;
		MaxEndstopPos[3]-dangerzone;
		MaxEndstopPos[4]-dangerzone;
		MaxEndstopPos[5]-dangerzone
	];

	negdangerzones = [
		0;
		0;
		0;
		MinEndstopPos[1]+dangerzone;
		MinEndstopPos[2]+dangerzone;
		MinEndstopPos[3]+dangerzone;
		MinEndstopPos[4]+dangerzone;
		MinEndstopPos[5]+dangerzone
	];

	ks[1] = 0;
	ks[2] = 0;
	ks[3] = 0;
	
	if (state[4] > posdangerzones[4]) then
		ks[4] = CendstopAvoidanceControl;
		tempstate[4] = (posdangerzones[4]-state[4]);
	else 
		if (state[4] < negdangerzones[4]) then
			ks[4] = CendstopAvoidanceControl;
			tempstate[4] = (negdangerzones[4]-state[4]);
		else
			ks[4] = 0;
		end;
	end;

	if (state[5] > posdangerzones[5]) then
		ks[5] = CendstopAvoidanceControl;
		tempstate[5] = (posdangerzones[5]-state[5]);
	else 
		if (state[5] < negdangerzones[5]) then
			ks[5] = CendstopAvoidanceControl;
			tempstate[5] = (negdangerzones[5]-state[5]);
		else
			ks[5] = 0;
		end;
	end;

	if (state[6] > posdangerzones[6]) then
		ks[6] = CendstopAvoidanceControl;
		tempstate[6] = (posdangerzones[6]-state[6]);
	else 
		if (state[6] < negdangerzones[6]) then
			ks[6] = CendstopAvoidanceControl;
			tempstate[6] = (negdangerzones[6]-state[6]);
		else
			ks[6] = 0;
		end;
	end;

	if (state[7] > posdangerzones[7]) then
		ks[7] = CendstopAvoidanceControl;
		tempstate[7] = (posdangerzones[7]-state[7]);
	else 
		if (state[7] < negdangerzones[7]) then
			ks[7] = CendstopAvoidanceControl;
			tempstate[7] = (negdangerzones[7]-state[7]);
		else
			ks[7] = 0;
		end;
	end;

	if (state[8] > posdangerzones[8]) then
		ks[8] = CendstopAvoidanceControl;
		tempstate[8] = (posdangerzones[8]-state[8]);
	else 
		if (state[8] < negdangerzones[8]) then
			ks[8] = CendstopAvoidanceControl;
			tempstate[8] = (negdangerzones[8]-state[8]);
		else
			ks[8] = 0;
		end;
	end;

	K = diag(ks);
   p.e = K*tempstate;
implementation_end;
      Cinterconnection 616 808
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type C
        ports
         power in p [9,1];
         signal in state [9,1];
        restrictions
         causality preferred out p;
       end;
       icon bg bottom
        figures
         text 'C' 616 808 18 bold;
       end;
       implementation eq
parameters
	real c = 1e-14;
equations
    p.e = -(state - int(p.f)) / c;
implementation_end;
      CobserverControl 712 928
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type C
        ports
         power in p [9,1];
         signal out state [8,1];
        restrictions
         causality preferred out p;
        parameters
         real CobserverControl = 1.0e-9;
         real Wheelpos[2,4] = [0.215, 0.215, -0.215, -0.215; -0.15, 0.15, -0.15, 0.15];
         real MecanumWheelRadius = 0.053;
       end;
       icon bg bottom
        figures
         text 'C' 712 928 18 bold;
       end;
       implementation eq
variables
	real Vjointv[8];
	real r,x,y;
	real A[3,4];
	real PseudoInverseA[4,3];

equations
	y = Wheelpos[2,2];
	x = Wheelpos[1,2];
	r = MecanumWheelRadius;

	A = (1/(2*r))*
	[ 	x+y 	,-(x+y)		,x+y	,-(x+y);
		1		, -1		,-1		, 1;
		1		, 1		,1		, 1];

	PseudoInverseA = transpose(A)*inverse(A*transpose(A));

	Vjointv[1:3] = transpose(PseudoInverseA)*p.f[1:4];
	Vjointv[4:8] = p.f[5:9];

   state = int(Vjointv);
	
	p.e[1:4] = PseudoInverseA*(state[1:3]/CobserverControl);
   p.e[5:9] = state[4:8] / CobserverControl;
	implementation_end;
      ControllableJ 464 224
       description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>GeometricJacobian.emx</LibraryPath>
 <TimeStamp>2010-11-23 11:48:09</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type MTF
        ports
         power out joints [8,1];
         power in tip [6,1];
         signal in controlledJ [6,8];
        restrictions
         causality fixed out joints;
         causality fixed in tip;
       end;
       icon bg left
        figures
         text 'MTF' 464 224 18 bold;
       end;
       implementation eq
equations
joints.e = transpose(controlledJ)*tip.e;
tip.f = controlledJ*joints.f;implementation_end;
      CtipControl 464 88
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type C
        ports
         power in p [6,1];
         signal out state [4,4];
         signal in Hvp0 [4,4];
         signal in Htip0 [4,4];
        restrictions
         causality preferred out p;
        parameters
         real CtipControl = 0.07;
       end;
       icon bg left
        figures
         text 'C' 464 88 18 bold;
       end;
       implementation eq
variables
	real theta;
	real omega[3];
	real Wr[6];
	real Wt[6];
	real temp;

equations
	state = inverse(Hvp0)*Htip0;

	temp = (trace(state[1:3,1:3])-1)/2;

	if (temp < -1) then temp = -1; end;
	if (temp > 1) then temp = 1; end;

	theta = arccos(temp);
	if(theta == 0) then
		omega = 0;
	else
	omega = (1/(2*sin(theta)))*[	state[3,2] - state[2,3];
											state[1,3] - state[3,1];
											state[2,1] - state[1,2]];
	end;

	Wt[1:3] = 0;
	Wt[4:6] = state[1:3,4]/CtipControl;
	//Wr[1:3] = theta*omega/(CtipControl);
	Wr[1:3]=10*(1-state[1,1])*skew([1;0;0])*state[1:3,1]+
	10000*(1-state[2,2])*skew([0;1;0])*state[1:3,2]+
	10*(1-state[3,3])*skew([0;0;1])*state[1:3,3];

	Wr[4:6] = 0;

	p.e = inverse(transpose(Adjoint(Hvp0)))*(Wt + Wr);
	

	
				


implementation_end;
      Diagnostics 1168 1000
       description '<Description>
 <Version>4.0</Version>
 <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:32:54</TimeStamp>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type Submodel
        ports
         signal in residuals [9,1];
         signal out useActuator [9,1];
        parameters
         real TorqueThreshold = 0.1;
         real VelocityThreshold = 5.0e-4;
       end;
       implementation eq
parameters
 boolean FDIworking=true;
variables
	boolean initial;
	real actuatorControllable[9];
	real actuatorControllable_hold[9];
initialequations
	initial = true;
	useActuator = 1;
code
	actuatorControllable[1] = if((abs(residuals[1]) > 4e-6)) then 0 else 1 end;
	actuatorControllable[2] = if((abs(residuals[2]) > 4e-6)) then 0 else 1 end;
	actuatorControllable[3] = if((abs(residuals[3]) > 4e-6)) then 0 else 1 end;
	actuatorControllable[4] = if((abs(residuals[4]) > 4e-6)) then 0 else 1 end;
	
	actuatorControllable[5] = if((abs(residuals[5]) > 4e-6)) then 0 else 1 end;
	actuatorControllable[6] = if((abs(residuals[6]) > 4e-6)) then 0 else 1 end;
	actuatorControllable[7] = if((abs(residuals[7]) > 4e-6)) then 0 else 1 end;
	actuatorControllable[8] = if((abs(residuals[8]) > 4e-6)) then 0 else 1 end;
	actuatorControllable[9] = if((abs(residuals[9]) > 4e-6)) then 0 else 1 end;


equations
	if initial then
		actuatorControllable_hold = actuatorControllable;
		initial = false;
	end;
	if major then
		actuatorControllable_hold[1] = min([actuatorControllable[1], actuatorControllable_hold[1]]);
		actuatorControllable_hold[2] = min([actuatorControllable[2], actuatorControllable_hold[2]]);
		actuatorControllable_hold[3] = min([actuatorControllable[3], actuatorControllable_hold[3]]);
		actuatorControllable_hold[4] = min([actuatorControllable[4], actuatorControllable_hold[4]]);
		actuatorControllable_hold[5] = min([actuatorControllable[5], actuatorControllable_hold[5]]);
		actuatorControllable_hold[6] = min([actuatorControllable[6], actuatorControllable_hold[6]]);
		actuatorControllable_hold[7] = min([actuatorControllable[7], actuatorControllable_hold[7]]);
		actuatorControllable_hold[8] = min([actuatorControllable[8], actuatorControllable_hold[8]]);
		actuatorControllable_hold[9] = min([actuatorControllable[9], actuatorControllable_hold[9]]);
	end;


	if initial then
		useActuator = actuatorControllable;
		initial = false;
	end;
if FDIworking then
	if major then
		useActuator[1] = min([actuatorControllable[1], useActuator[1]]);
		useActuator[2] = min([actuatorControllable[2], useActuator[2]]);
		useActuator[3] = min([actuatorControllable[3], useActuator[3]]);
		useActuator[4] = min([actuatorControllable[4], useActuator[4]]);
		useActuator[5] = min([actuatorControllable[5], useActuator[5]]);
		useActuator[6] = min([actuatorControllable[6], useActuator[6]]);
		useActuator[7] = min([actuatorControllable[7], useActuator[7]]);
		useActuator[8] = min([actuatorControllable[8], useActuator[8]]);
		useActuator[9] = min([actuatorControllable[9], useActuator[9]]);
	end;
else
	useActuator = 1;
end;implementation_end;
      EffortSensor1 464 704
       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\EffortSensor.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:59:27</TimeStamp>
</Description>';
       knot EffortSensor
        ports
         power knot in p1 [9,1];
         power knot out p2 [9,1];
         signal knot out effort [9,1];
        restrictions
         causality constraint not_equal p1 p2;
       end;
       icon bg ellipse
        figures
         ellipse 457.1 698.3 470.9 712.4 fill 16777215;
         text 'e' 464.5 702.6;
       end;
       implementation eq
equations
	p2.e = p1.e;
	p1.f = p2.f;
	effort = p1.e;
     implementation_end;
      EncoderIdeal 616 752
						specifications active 'Incremental'
							specification 'Ideal'
description '<Description>
   <Version>4.0</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Iconic Diagrams\Mechanical\Rotation\Sensors\Encoder.emx</LibraryPath>
  <TimeStamp>2008-8-6 11:16:21</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
 type Encoder
  ports
   rotation in p;
   signal out output;
  restrictions
   causality fixed out p;
 end;
 icon bg bottom
  figures
   group
    rectangle 230.9 324.2 247.4 348.2 fill 13421772;
    rectangle 247.4 333.3 253.8 339.7 fill 9211020;
   end;
  terminals
   p 231.9 335.9 fixed;
   output 255.4 335.9 fixed;
 end;
 implementation eq
variables
	real phi {rad};	// encoder position
equations
	p.T = 0;
	phi = int (p.omega);
	output = sample ( phi );
             implementation_end;
specification_end;
							specification 'Incremental'
 description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Iconic Diagrams\Mechanical\Rotation\Sensors\Encoder.emx</LibraryPath>
  <TimeStamp>2007-9-25 16:57:25</TimeStamp>
</Description>';
 type Encoder
  ports
   power in p [9,1];
   signal out output [9,1];
   signal in failure [9,1];
  restrictions
   causality fixed out p;
 end;
 icon bg left
  figures
   group
    rectangle 604.5 740 621 764 fill 13421772;
    rectangle 621 749.1 627.4 755.5 fill 9211020;
   end;
 end;
 implementation eq
parameters
	real bits = 12 {};			// resolution in amount of bits
	real counts = 2000 {};	// pulses per revolution
variables
	real hidden hold_signal[9], quantisized_signal[9],holdinput[9],rounded_signal[9];
	real turns[9] {rev};
	real hidden exp2bits;
equations
	p.e = 0;
	turns = int (p.f) / (2*pi);
	holdinput = turns * counts;
	hold_signal = holdinput; //edited -> removed sample to stay continuous
	if hold_signal[1] < 0.0 then
		quantisized_signal[1] = hold_signal[1] - 0.5;
	else
		 quantisized_signal[1] = hold_signal[1] + 0.5;
	end;
	if hold_signal[2] < 0.0 then
		quantisized_signal[2] = hold_signal[2] - 0.5;
	else
		 quantisized_signal[2] = hold_signal[2] + 0.5;
	end;
	if hold_signal[3] < 0.0 then
		quantisized_signal[3] = hold_signal[3] - 0.5;
	else
		 quantisized_signal[3] = hold_signal[3] + 0.5;
	end;
	if hold_signal[4] < 0.0 then
		quantisized_signal[4] = hold_signal[4] - 0.5;
	else
		 quantisized_signal[4] = hold_signal[4] + 0.5;
	end;
	if hold_signal[5] < 0.0 then
		quantisized_signal[5] = hold_signal[5] - 0.5;
	else
		 quantisized_signal[5] = hold_signal[5] + 0.5;
	end;
	if hold_signal[6] < 0.0 then
		quantisized_signal[6] = hold_signal[6] - 0.5;
	else
		 quantisized_signal[6] = hold_signal[6] + 0.5;
	end;
	if hold_signal[7] < 0.0 then
		quantisized_signal[7] = hold_signal[7] - 0.5;
	else
		 quantisized_signal[7] = hold_signal[7] + 0.5;
	end;
	if hold_signal[8] < 0.0 then
		quantisized_signal[8] = hold_signal[8] - 0.5;
	else
		 quantisized_signal[8] = hold_signal[8] + 0.5;
	end;
	if hold_signal[9] < 0.0 then
		quantisized_signal[9] = hold_signal[9] - 0.5;
	else
		 quantisized_signal[9] = hold_signal[9] + 0.5;
	end;



	rounded_signal =  quantisized_signal - (quantisized_signal mod 1); 
	exp2bits = exp2 (bits);
	output = int(diag(abs(failure-1))*p.f);//( ( rounded_signal + 2.5 * exp2bits ) mod exp2bits ) - 0.5 * exp2bits;
implementation_end;
specification_end;
							specification 'Absolute'
description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Iconic Diagrams\Mechanical\Rotation\Sensors\Encoder.emx</LibraryPath>
  <TimeStamp>2007-9-25 16:57:25</TimeStamp>
</Description>';
 type Encoder
  ports
   rotation in p;
   signal out output;
  restrictions
   causality fixed out p;
 end;
 icon bg bottom
  figures
   group
    rectangle 230.9 324.2 247.4 348.2 fill 13421772;
    rectangle 247.4 333.3 253.8 339.7 fill 9211020;
   end;
  terminals
   p 231.9 335.9 fixed;
   output 255.4 335.9 fixed;
 end;
 implementation eq
parameters
	real counts = 2000 {};	// pulses per revolution
variables
	real hidden hold_signal, quantisized_signal,holdinput;
	real turns {rev};
equations
	p.T = 0;
	turns = int (p.omega) / (2*pi);
	holdinput = turns * counts;
	hold_signal = sample ( holdinput );
	if hold_signal < 0.0 then
		quantisized_signal = hold_signal - 0.5;
	else
		 quantisized_signal = hold_signal + 0.5;
	end;
	output = quantisized_signal - (quantisized_signal mod 1); 
            implementation_end;
specification_end;
						end;
      failure 544 592
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\SignalGenerator-Step.emx</LibraryPath>
 <TimeStamp>2007-9-27 16:2:44</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type 'SignalGenerator-Step'
        ports
         signal out output [9,1];
       end;
       icon bg right
        figures
         group
          rectangle 528 576 560 608 fill 15132390;
          line 537.6 588.8 554.6 588.8 color 16711680 width 2;
          line 530.9 600 557.1 600;
          line 533.1 600.1 537.7 600.1 537.7 588.7 color 16711680 width 2;
          line 533.1 584 533.1 602.2;
         end;
       end;
       implementation eq
parameters
	real amplitude[9] = [0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0];
	real start_time = 0.1 {s};
	real end_time = 60.0 {s};
variables
	boolean hidden changestart;
	boolean hidden changeend;
equations
	"calculate at least at the start time"
	changestart = timeevent (start_time);
	
	"calculate at least at the end time"
	changeend = timeevent (end_time);

	
	"calculate the step signal"
	output = amplitude * (step (start_time) - step (end_time));   implementation_end;
      failure1 712 752
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\SignalGenerator-Step.emx</LibraryPath>
 <TimeStamp>2007-9-27 16:2:44</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type 'SignalGenerator-Step'
        ports
         signal out output [9,1];
       end;
       icon bg right
        figures
         group
          rectangle 696 736 728 768 fill 15132390;
          line 705.6 748.8 722.6 748.8 color 16711680 width 2;
          line 698.9 760 725.1 760;
          line 701.1 760.1 705.7 760.1 705.7 748.7 color 16711680 width 2;
          line 701.1 744 701.1 762.2;
         end;
       end;
       implementation eq
parameters
	real amplitude[9] = [0.0;0.0;0.0;0.0;0.0;0;0.0;0.0;0.0];
	real start_time = 0.1 {s};
	real end_time = 60.0 {s};
variables
	boolean hidden changestart;
	boolean hidden changeend;
equations
	"calculate at least at the start time"
	changestart = timeevent (start_time);
	
	"calculate at least at the end time"
	changeend = timeevent (end_time);

	
	"calculate the step signal"
	output = amplitude * (step (start_time) - step (end_time));   implementation_end;
      FlowSensor2 464 288
       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\FlowSensor.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:59:12</TimeStamp>
</Description>';
       knot FlowSensor
        ports
         power knot in p1 [8,1];
         power knot out p2 [8,1];
         signal knot out flow [8,1];
        restrictions
         causality constraint not_equal p1 p2;
       end;
       icon bg ellipse
        figures
         ellipse 457.1 281.6 470.9 295.9 fill 16777215;
         text 'f' 464.5 287.1;
       end;
       implementation eq
equations
	p2.f = p1.f;
	p1.e = p2.e;
	flow = p1.f;
      implementation_end;
      GravityCompensation 568 400
       description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>youBot_GravityCompensation.emx</LibraryPath>
  <TimeStamp>2011-1-21 10:13:56</TimeStamp>
</Description>';
       type Submodel
        ports
         power out joints [8,1];
        parameters
         real InitialJointPos[5,1] = [0.0; 0.0; 0.0; 0.0; 0.0];
         real LinkCOMdim[3,6] = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0375, 0.0775, 0.0675, 0.0405, 0.0685];
         real Linkdim[3,6] = [0.115, 0.0, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.08, 0.075, 0.155, 0.135, 0.081, 0.137];
         real Linkm[6,1] = [20.0; 1.0; 1.0; 1.0; 1.0; 1.0];
       end;
       icon bg bottom
        figures
         rectangle 513.5 361 622.5 439 fill 11206638;
         text '     youBot
     Gravity
Compensation' 566.5 401 16;
       end;
       implementation bg
        submodels
         Base 368 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Link_GravityCompensation.emx</LibraryPath>
  <TimeStamp>2011-1-19 11:37:47</TimeStamp>
<Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real m = 20.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0];
            real dim[3,1] = [0.115; 0.0; 0.08];
          end;
          icon bg bottom
           figures
            rectangle 336 432 400 576 fill 10025880;
            text 'Link
GC' 368 504;
           terminals
            p 336 464 fixed;
            Hin 336 544 fixed;
            p1 400 464 fixed;
            Hout 400 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 20.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.115; 0.0; 0.08];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            plug Hin 592 496;
            plug p1 904 304;
            plug Hout 896 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 416 376;
          implementation_end;
         Hfloor0 272 544
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\Constant.emx</LibraryPath>
 <TimeStamp>2007-10-19 14:48:44</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Constant
           ports
            signal out output [4,4];
          end;
          icon bg bottom
           figures
            rectangle 256.1 528 287.9 560 fill 15132390;
            line 260.9 539.6 282.9 539.6 color 16711680 width 2;
            line 258.2 550.7 283.9 550.7;
            line 260.5 534.7 260.5 553;
          end;
          implementation eq
equations
	output = eye(4);
     implementation_end;
         Htip0 1248 544
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\SignalMonitor.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:14:4</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type SignalMonitor
           ports
            signal in input [4,4];
          end;
          icon bg bottom
           figures
            rectangle 1232 528 1264 560 fill 15132390;
            rectangle 1237.7 533.8 1258.3 554.6 color 16711680 fill 11776947 width 2;
            rectangle 1239.8 536.4 1255.9 552 color -1 fill 16777215;
            line 1241.9 538.7 1241.9 550 fill 16777215;
            line 1240 548.4 1252.5 548.4 fill 16777215;
            line 1241.5 548.1 1254.4 541.7 color 255 fill 16777215;
          end;
          implementation eq

   implementation_end;
         Joint12 608.2 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Joint-roty_GravityCompensation.emx</LibraryPath>
  <TimeStamp>2011-1-19 11:38:03</TimeStamp>
</Description>';
          type 'Submodel-roty'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real InitialPos = 0.0;
          end;
          icon bg bottom
           figures
            rectangle 576.4 432 639.9 576 fill 14745599;
            text 'Joint-roty
   GC' 608.4 507 fill 14745599;
           terminals
            p 575.9 464 fixed;
            p1 607.4 432 fixed;
            p2 639.9 464 fixed;
            Hin 575.9 544 fixed;
            Hout 639.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 496
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 480 335.9 512 fill 15132390;
               text 'X' 320 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 56;
            plug p2 496 424;
            plug Hin 112 496;
            plug Hout 504 496;
            plug p 112 424;
            OneJunction 240 272
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 272 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Tbai 240 384
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg left
              figures
               text '1' 240 384 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            uTbai 240 328
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'TF' 240 328 18 bold;
             end;
             implementation eq
equations
	p2.f = [0;p1.f;0;0;0;0];
	p1.e = p2.e[2];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            p1 => ZeroJunction\p;
            uTbai\p2 => Tbai\p;
            Tbai\p => Wbai\p;
            p <= Wbai\p;
            ZeroJunction\p => OneJunction\p;
            OneJunction\p => uTbai\p1;
            Wbai\p <= AdHji\p1;
            p2 => AdHji\p2;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            OneJunction\flow -> Integrate\input 320 272;
            Splitter2\output -> AdHji\H 424 368;
           end;
           parameterrelations
Integrate\init = InitialPos;parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
          implementation_end;
         Joint23 768.2 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-roty_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:38:03</TimeStamp>
</Description>';
          type 'Submodel-roty'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real InitialPos = 0.0;
          end;
          icon bg bottom
           figures
            rectangle 736.4 432 799.9 576 fill 14745599;
            text 'Joint-roty
   GC' 768.4 507 fill 14745599;
           terminals
            p 735.9 464 fixed;
            p1 767.4 432 fixed;
            p2 799.9 464 fixed;
            Hin 735.9 544 fixed;
            Hout 799.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 496
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 480 335.9 512 fill 15132390;
               text 'X' 320 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 56;
            plug p2 496 424;
            plug Hin 112 496;
            plug Hout 504 496;
            plug p 112 424;
            OneJunction 240 272
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 272 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Tbai 240 384
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg left
              figures
               text '1' 240 384 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            uTbai 240 328
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'TF' 240 328 18 bold;
             end;
             implementation eq
equations
	p2.f = [0;p1.f;0;0;0;0];
	p1.e = p2.e[2];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            p1 => ZeroJunction\p;
            uTbai\p2 => Tbai\p;
            Tbai\p => Wbai\p;
            p <= Wbai\p;
            ZeroJunction\p => OneJunction\p;
            OneJunction\p => uTbai\p1;
            Wbai\p <= AdHji\p1;
            p2 => AdHji\p2;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            OneJunction\flow -> Integrate\input 320 272;
            Splitter2\output -> AdHji\H 424 368;
           end;
           parameterrelations
Integrate\init = InitialPos;parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
          implementation_end;
         Joint34 928.2 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-roty_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:38:03</TimeStamp>
</Description>';
          type 'Submodel-roty'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real InitialPos = 0.0;
          end;
          icon bg bottom
           figures
            rectangle 896.4 432 959.9 576 fill 14745599;
            text 'Joint-roty
   GC' 928.4 507 fill 14745599;
           terminals
            p 895.9 464 fixed;
            p1 927.4 432 fixed;
            p2 959.9 464 fixed;
            Hin 895.9 544 fixed;
            Hout 959.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 496
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 480 335.9 512 fill 15132390;
               text 'X' 320 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 56;
            plug p2 496 424;
            plug Hin 112 496;
            plug Hout 504 496;
            plug p 112 424;
            OneJunction 240 272
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 272 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Tbai 240 384
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg left
              figures
               text '1' 240 384 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            uTbai 240 328
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'TF' 240 328 18 bold;
             end;
             implementation eq
equations
	p2.f = [0;p1.f;0;0;0;0];
	p1.e = p2.e[2];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            p1 => ZeroJunction\p;
            uTbai\p2 => Tbai\p;
            Tbai\p => Wbai\p;
            p <= Wbai\p;
            ZeroJunction\p => OneJunction\p;
            OneJunction\p => uTbai\p1;
            Wbai\p <= AdHji\p1;
            p2 => AdHji\p2;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            OneJunction\flow -> Integrate\input 320 272;
            Splitter2\output -> AdHji\H 424 368;
           end;
           parameterrelations
Integrate\init = InitialPos;parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
          implementation_end;
         Joint45 1088.2 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-rotz_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:37:54</TimeStamp>
</Description>';
          type 'Submodel-rotz'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real InitialPos = 0.0;
          end;
          icon bg bottom
           figures
            rectangle 1056.4 432 1119.9 576 fill 14745599;
            text 'Joint-rotz
   GC' 1088.4 507 fill 14745599;
           terminals
            p 1055.9 464 fixed;
            p1 1087.4 432 fixed;
            p2 1119.9 464 fixed;
            Hin 1055.9 544 fixed;
            Hout 1119.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            Integrate 320 288
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 272 336 304 fill 15132390;
               text 'ò' 320 285.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	-sin(q),	0;
			sin(q),	cos(q),	0;
			0,				0,				1];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 576
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 560 335.9 592 fill 15132390;
               text 'X' 320 576 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 40;
            plug p2 496 424;
            plug Hin 112 576;
            plug Hout 504 576;
            plug p 112 424;
            OneJunction 240 288
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 288 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            uTbai 240 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
               causality fixed out p1;
               causality fixed in p2;
             end;
             icon bg left
              figures
               text 'TF' 240 336 18 bold;
             end;
             implementation eq
equations
	p1.e = p2.e[3];
	p2.f = [0;0;p1.f;0;0;0];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            uTbai\p1 <= OneJunction\p;
            Wbai\p <= AdHji\p1;
            p2 => AdHji\p2;
            ZeroJunction\p => OneJunction\p;
            p1 => ZeroJunction\p;
            uTbai\p2 => Wbai\p;
            p <= Wbai\p;
            OneJunction\flow -> Integrate\input 288 288;
            Splitter2\output -> AdHji\H 424 368;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
           end;
           parameterrelations
Integrate\init = InitialPos;

parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 680 488;
          implementation_end;
         JointBase1 448.2 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Joint-rotz_GravityCompensation.emx</LibraryPath>
  <TimeStamp>2011-1-21 10:09:48</TimeStamp>
</Description>';
          type 'Submodel-rotz'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real InitialPos = 0.0;
          end;
          icon bg bottom
           figures
            rectangle 416.4 432 479.9 576 fill 14745599;
            text 'Joint-rotz
   GC' 448.4 507 fill 14745599;
           terminals
            p 415.9 464 fixed;
            p1 447.4 432 fixed;
            p2 479.9 464 fixed;
            Hin 415.9 544 fixed;
            Hout 479.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            Integrate 320 288
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 272 336 304 fill 15132390;
               text 'ò' 320 285.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	-sin(q),	0;
			sin(q),	cos(q),	0;
			0,				0,				1];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 576
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 560 335.9 592 fill 15132390;
               text 'X' 320 576 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 40;
            plug p2 496 424;
            plug Hin 112 576;
            plug Hout 504 576;
            plug p 112 424;
            OneJunction 240 288
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 288 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            uTbai 240 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
               causality fixed out p1;
               causality fixed in p2;
             end;
             icon bg left
              figures
               text 'TF' 240 336 18 bold;
             end;
             implementation eq
equations
	p1.e = p2.e[3];
	p2.f = [0;0;p1.f;0;0;0];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            uTbai\p1 <= OneJunction\p;
            Wbai\p <= AdHji\p1;
            p2 => AdHji\p2;
            ZeroJunction\p => OneJunction\p;
            p1 => ZeroJunction\p;
            uTbai\p2 => Wbai\p;
            p <= Wbai\p;
            OneJunction\flow -> Integrate\input 288 288;
            Splitter2\output -> AdHji\H 424 368;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
           end;
           parameterrelations
Integrate\init = InitialPos;

parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 680 488;
          implementation_end;
         Link1 528 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:37:47</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0375];
            real dim[3,1] = [0.0; 0.0; 0.075];
          end;
          icon bg bottom
           figures
            rectangle 496 432 560 576 fill 10025880;
            text 'Link
GC' 528 504;
           terminals
            p 496 464 fixed;
            Hin 496 544 fixed;
            p1 560 464 fixed;
            Hout 560 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0375];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.075];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            plug Hin 592 496;
            plug p1 904 304;
            plug Hout 896 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 416 376;
          implementation_end;
         Link2 688 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:37:47</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0775];
            real dim[3,1] = [0.0; 0.0; 0.155];
          end;
          icon bg bottom
           figures
            rectangle 656 432 720 576 fill 10025880;
            text 'Link
GC' 688 504;
           terminals
            p 656 464 fixed;
            Hin 656 544 fixed;
            p1 720 464 fixed;
            Hout 720 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0775];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.155];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            plug Hin 592 496;
            plug p1 904 304;
            plug Hout 896 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 416 376;
          implementation_end;
         Link3 848 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:37:47</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0675];
            real dim[3,1] = [0.0; 0.0; 0.135];
          end;
          icon bg bottom
           figures
            rectangle 816 432 880 576 fill 10025880;
            text 'Link
GC' 848 504;
           terminals
            p 816 464 fixed;
            Hin 816 544 fixed;
            p1 880 464 fixed;
            Hout 880 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0675];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.135];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            plug Hin 592 496;
            plug p1 904 304;
            plug Hout 896 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 416 376;
          implementation_end;
         Link4 1008 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:37:47</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0405];
            real dim[3,1] = [0.0; 0.0; 0.081];
          end;
          icon bg bottom
           figures
            rectangle 976 432 1040 576 fill 10025880;
            text 'Link
GC' 1008 504;
           terminals
            p 976 464 fixed;
            Hin 976 544 fixed;
            p1 1040 464 fixed;
            Hout 1040 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0405];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.081];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            plug Hin 592 496;
            plug p1 904 304;
            plug Hout 896 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 416 376;
          implementation_end;
         Link5 1168 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link_GravityCompensation.emx</LibraryPath>
 <TimeStamp>2011-1-19 11:37:47</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0685];
            real dim[3,1] = [0.0; 0.0; 0.137];
          end;
          icon bg bottom
           figures
            rectangle 1136 432 1200 576 fill 10025880;
            text 'Link
GC' 1168 504;
           terminals
            p 1136 464 fixed;
            Hin 1136 544 fixed;
            p1 1200 464 fixed;
            Hout 1200 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0685];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.137];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            plug Hin 592 496;
            plug p1 904 304;
            plug Hout 896 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 416 376;
          implementation_end;
         Mux 696 193
          description '<Description>
 <Version>4.0</Version>
 <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:32:54</TimeStamp>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Submodel
           ports
            power out port [8,1];
            power out port5;
            power out port6;
            power out port7;
            power out port8;
            power out port9;
           restrictions
            causality fixed in port8;
            causality fixed in port9;
            causality fixed in port5;
            causality fixed in port6;
            causality fixed in port7;
            causality fixed out port;
          end;
          icon bg
           figures
            rectangle 616 178 776 208 fill 14013909;
            text 'Mux' 696 192 16;
           terminals
            port 696 176 fixed;
            port5 696 208 fixed;
            port6 712 208 fixed;
            port7 728 208 fixed;
            port8 744 208 fixed;
            port9 760 208 fixed;
          end;
          implementation eq
equations
	port.e[1] = 0;
	port.e[2] = 0;
	port.e[3] = 0;
	port.e[4] = port5.e;
	port.e[5] = port6.e;
	port.e[6] = port7.e;
	port.e[7] = port8.e;
	port.e[8] = port9.e;
	
	port5.f = port.f[4];
	port6.f = port.f[5];
	port7.f = port.f[6];
	port8.f = port.f[7];
	port9.f = port.f[8];implementation_end;
         plug joints 696 120;
         Wtip0 1240 464
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Se
           ports
            power out p [6,1];
           restrictions
            causality fixed out p;
          end;
          icon bg bottom
           figures
            text 'Se' 1240 464 18 bold;
          end;
          implementation eq
parameters
	real effort = 0;
variables
	real flow[6];
equations
	p.e = effort;
	flow = p.f;
implementation_end;
         ZeroJunction 272 464
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
          knot ZeroJunction
           ports
            power knot duplicatable none p [6,1];
            signal knot out effort [6,1];
           restrictions
            causality constraint one_in p;
          end;
          icon bg
           figures
            text '0' 272 464 18 bold;
          end;
          implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
        end;
        connections
         Base\p => ZeroJunction\p;
         Mux\port7 => Joint23\p1 728 256 768 256;
         Mux\port8 => Joint34\p1 744 240 928 240;
         Mux\port9 => Joint45\p1 760 224 1088 224;
         JointBase1\p2 <= Link1\p;
         Joint12\p => Link1\p1;
         Joint12\p2 <= Link2\p;
         Joint23\p => Link2\p1;
         Joint23\p2 <= Link3\p;
         Joint34\p => Link3\p1;
         Link4\p => Joint34\p2;
         Joint45\p => Link4\p1;
         joints <= Mux\port;
         Link5\p => Joint45\p2;
         JointBase1\p1 <= Mux\port5 448 304 696 304;
         Joint12\p1 <= Mux\port6 608 320 712 320;
         JointBase1\p => Base\p1;
         Wtip0\p => Link5\p1;
         Hfloor0\output -> Base\Hin;
         Link3\Hin <- Joint23\Hout;
         Link2\Hout -> Joint23\Hin;
         Link2\Hin <- Joint12\Hout;
         Joint12\Hin <- Link1\Hout;
         Base\Hout -> JointBase1\Hin;
         Htip0\input <- Link5\Hout;
         Link1\Hin <- JointBase1\Hout;
         Joint45\Hout -> Link5\Hin;
         Joint45\Hin <- Link4\Hout;
         Joint34\Hout -> Link4\Hin;
         Joint34\Hin <- Link3\Hout;
        end;
        parameterrelations
Base\m = Linkm[1];
Base\COMdim = LinkCOMdim[1:3,1];
Base\dim = Linkdim[1:3,1];

Link1\m = Linkm[2];
Link1\COMdim = LinkCOMdim[1:3,2];
Link1\dim = Linkdim[1:3,2];

Link2\m = Linkm[3];
Link2\COMdim = LinkCOMdim[1:3,3];
Link2\dim = Linkdim[1:3,3];

Link3\m = Linkm[4];
Link3\COMdim = LinkCOMdim[1:3,4];
Link3\dim = Linkdim[1:3,4];

Link4\m = Linkm[5];
Link4\COMdim = LinkCOMdim[1:3,5];
Link4\dim = Linkdim[1:3,5];

Link5\m = Linkm[6];
Link5\COMdim = LinkCOMdim[1:3,6];
Link5\dim = Linkdim[1:3,6];

JointBase1\InitialPos = InitialJointPos[1];

Joint12\InitialPos = InitialJointPos[2];

Joint23\InitialPos = InitialJointPos[3];

Joint34\InitialPos = InitialJointPos[4];

Joint45\InitialPos = InitialJointPos[5];

parameterrelations_end;
       implementation_end;
      Iinterconnection 544 920
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type I
        ports
         power in p [9,1];
         signal out state [9,1];
        restrictions
         causality preferred in p;
       end;
       icon bg bottom
        figures
         text 'I' 544 920 18 bold;
       end;
       implementation eq
parameters
	real i = 1e-0010;
equations
    state = int(p.e);
    p.f = state / i;
implementation_end;
      MSe 544 704
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\MSe.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:2:44</TimeStamp>
</Description>';
       type MSe
        ports
         power out p [9,1];
         signal in effort [9,1];
         signal in working [9,1];
        restrictions
         causality fixed out p;
       end;
       icon bg bottom
        figures
         text 'MSe' 544 704 18 bold;
       end;
       implementation eq
variables
	real flow[9];
	real actuatorOK[9];
equations
	actuatorOK = abs(working-1);

	p.e = diag(actuatorOK)*effort;
	flow = diag(actuatorOK)*p.f;
implementation_end;
      Observer 904 1096
       description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>youBot.emx</LibraryPath>
 <TimeStamp>2011-1-21 10:28:22</TimeStamp>
</Description>';
       type Submodel
        ports
         power in joints [9,1];
        parameters
         real Rconstraint = 1000.0;
         real Cconstraint = 1.0e-4;
         real Rjoint = 1.0;
         real InitialJointPos[5,1] = [0.0; 0.0; 0.0; 0.0; 0.0];
         real InitialBasePos[4,4] = [1.0, 0.0, 0.0, 0.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];
         real LinkI[3,6] = [20.0, 1.0, 1.0, 1.0, 1.0, 1.0; 20.0, 1.0, 1.0, 1.0, 1.0, 1.0; 20.0, 1.0, 1.0, 1.0, 1.0, 1.0];
         real LinkCOMdim[3,6] = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0375, 0.0775, 0.0675, 0.0405, 0.0685];
         real Linkdim[3,6] = [0.115, 0.0, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.08, 0.075, 0.155, 0.135, 0.081, 0.137];
         real Linkm[6,1] = [20.0; 1.0; 1.0; 1.0; 1.0; 1.0];
         real MinEndstopPos[5,1] = [-2.95; -1.13; -2.64; -1.79; -2.92];
         real MaxEndstopPos[5,1] = [2.95; 1.57; 2.55; 1.79; 2.92];
         real Wheelpos[2,4] = [0.215, 0.215, -0.215, -0.215; -0.15, 0.15, -0.15, 0.15]; "[1:2,1] = LF, [1:2,2] = RF, [1:2,3] = LR, [1:2,4] = RR "
         real MecanumWheelRadius = 0.053;
         real Rwheel = 0.1;
       end;
       icon bg bottom
        figures
         rectangle 867 1074 941 1118 fill 11206638;
         text 'youBot' 904 1096 16;
       end;
       implementation bg
        submodels
         Base 368 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Link.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:36:40</TimeStamp>
<Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real I[3,1] = [20.0; 20.0; 20.0];
            real m = 20.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0];
            real dim[3,1] = [0.115; 0.0; 0.08];
          end;
          icon bg bottom
           figures
            rectangle 336 432 400 576 fill 10025880;
            text 'Link' 368 504;
           terminals
            p 336 464 fixed;
            Hin 336 544 fixed;
            p1 400 464 fixed;
            Hout 400 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik 664 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0];
             end;
             icon bg left
              figures
               text 'TF' 664 224 18 bold;
             end;
             implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            EJS 728 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MGY
              ports
               power in p1 [6,1];
              parameters
               real I[3,1] = [20.0; 20.0; 20.0];
               real m = 20.0;
             end;
             icon bg top
              figures
               text 'MGY' 728 184 18 bold;
             end;
             implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 20.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.115; 0.0; 0.08];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            InertialTensor 616 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type I
              ports
               power in p [6,1];
               signal out state [6,1];
              restrictions
               causality preferred in p;
              parameters
               real m = 1.0;
               real I[3,1] = [20.0; 20.0; 20.0];
             end;
             icon bg top
              figures
               text 'I' 616 184 18 bold;
             end;
             implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
            plug Hout 896 496;
            plug p1 904 304;
            plug Hin 592 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0k 664 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg top
              figures
               text '1' 664 184 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            AdHik\p2 => Ta0k\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            Ta0k\p => EJS\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Ta0k\p => InertialTensor\p;
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            Ta0i\p => AdHik\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
          implementation_end;
         Hfloor0 208 544
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\Constant.emx</LibraryPath>
 <TimeStamp>2007-10-19 14:48:44</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Constant
           ports
            signal out output [4,4];
          end;
          icon bg bottom
           figures
            rectangle 192.1 528 223.9 560 fill 15132390;
            line 196.9 539.6 218.9 539.6 color 16711680 width 2;
            line 194.2 550.7 219.9 550.7;
            line 196.5 534.7 196.5 553;
          end;
          implementation eq
equations
	output = eye(4);
     implementation_end;
         Htip0 1248 544
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\SignalMonitor.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:14:4</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type SignalMonitor
           ports
            signal in input [4,4];
          end;
          icon bg bottom
           figures
            rectangle 1232 528 1264 560 fill 15132390;
            rectangle 1237.7 533.8 1258.3 554.6 color 16711680 fill 11776947 width 2;
            rectangle 1239.8 536.4 1255.9 552 color -1 fill 16777215;
            line 1241.9 538.7 1241.9 550 fill 16777215;
            line 1240 548.4 1252.5 548.4 fill 16777215;
            line 1241.5 548.1 1254.4 541.7 color 255 fill 16777215;
          end;
          implementation eq

   implementation_end;
         Joint12 608.2 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Joint-roty.emx</LibraryPath>
  <TimeStamp>2011-1-18 17:30:05</TimeStamp>
</Description>';
          type 'Submodel-roty'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real Rconstraint = 1000.0;
            real Cconstraint = 1.0e-4;
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = 0.0;
            real MaxEndstopPos = 1.57;
            real MinEndstopPos = -1.13;
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            rectangle 576.4 432 639.9 576 fill 14745599;
            text 'Joint-roty' 608.4 507 fill 14745599;
           terminals
            p 575.9 464 fixed;
            p1 607.4 432 fixed;
            p2 639.9 464 fixed;
            Hin 575.9 544 fixed;
            Hout 639.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            EndstopMax 471 217
             description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Rendstop = 1000.0;
               real Cendstop = 1.0e-4;
               real InitialPos = 0.0;
               real EndstopPos = 1.57;
             end;
             icon bg bottom
              figures
               rectangle 422 194 520 240 fill 14013909;
               text 'EndstopMax' 472 216 16;
              terminals
               p2 472 240 fixed;
             end;
             implementation bg
              submodels
               Cendstop 704 144
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 704 144 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 704 216
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out Collision;
                 restrictions
                  causality fixed in p12;
                  causality fixed out p2;
                  causality fixed out p1;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopPos = 1.57;
                end;
                icon bg
                 figures
                  text 'X0e' 704 216 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug Collision 408 192;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     mechanical in p1;
                     mechanical out p2;
                     mechanical out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 1.57;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> Collision;
                 end;
                 parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 648 216;
               plug collision 800 216;
               OneJunction5 704 176
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 704 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 736 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 736 176 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf1 704 264
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 704 264 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               OneJunction5\p => Cendstop\p;
               Collision\p12 => OneJunction5\p;
               Sf1\p => Collision\p1;
               OneJunction5\p => Rendstop\p;
               Collision\p2 => p2;
               Collision\Collision -> collision;
              end;
              parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
             implementation_end;
            EndstopMin 312 216
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 14:37:57</TimeStamp>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Cendstop = 1.0e-4;
               real Rendstop = 1000.0;
               real InitialPos = 0.0;
               real EndstopPos = -1.13;
             end;
             icon bg bottom
              figures
               rectangle 263 193 361 239 fill 14013909;
               text 'EndstopMin' 313 215 16;
             end;
             implementation bg
              submodels
               Cendstop 248 208
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 248 208 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 248 120
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out collision;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopLocation = -1.13;
                end;
                icon bg
                 figures
                  text 'X0e' 248 120 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug collision 400 200;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     power in p1;
                     power out p2;
                     power out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = -1.13;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> collision;
                 end;
                 parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 152 120;
               plug collision 360 120;
               OneJunction 248 160
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 248 160 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 288 160
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 288 160 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf2 248 64
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 248 64 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               Collision\p12 => OneJunction\p;
               OneJunction\p => Rendstop\p;
               OneJunction\p => Cendstop\p;
               Sf2\p => Collision\p1;
               Collision\p2 => p2;
               Collision\collision -> collision;
              end;
              parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
             implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 496
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 480 335.9 512 fill 15132390;
               text 'X' 320 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 56;
            plug p2 496 424;
            plug Hin 112 496;
            plug Hout 504 496;
            plug p 112 424;
            OneJunction 240 272
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 272 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Or 392 216
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
             type 'Or-Or'
              ports
               signal boolean in input1;
               signal boolean out output;
               signal boolean in input2;
             end;
             icon bg bottom
              figures
               rectangle 376.1 200 407.9 232 fill 15132390;
               group
                line 378.3 209.3 388.8 209.3 color 16711680 fill 16711680;
                line 378.3 223.1 388.8 223.1 color 16711680 fill 16711680;
               end;
               spline 387.9 204.8 389.9 216.5 387.9 227.7 color 16711680 fill 16711680;
               line 396.7 216 405.5 216 color 16711680 fill 16711680;
               spline 387.7 204.3 393.9 206.6 396.8 216.4 393.6 225.4 387.7 227.7 color 16711680 fill 15132390;
             end;
             implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
            Rjoint 192 272
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rjoint = 1.0;
             end;
             icon bg bottom
              figures
               text 'R' 192 272 18 bold;
             end;
             implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Tbai 240 384
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg left
              figures
               text '1' 240 384 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            uTbai 240 328
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real Rconstraint = 1000.0;
               real Cconstraint = 1.0e-4;
             end;
             icon bg left
              figures
               text 'TF' 240 328 18 bold;
             end;
             implementation eq
equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = p1.e;
	p2.e[3] = (Rconstraint*-p2.f[3] + int(-p2.f[3])/Cconstraint);
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[2];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            p1 => ZeroJunction\p;
            p <= Wbai\p;
            ZeroJunction\p => OneJunction\p;
            OneJunction\p => uTbai\p1;
            Wbai\p <= AdHji\p1;
            OneJunction\p <= EndstopMin\p2;
            p2 => AdHji\p2;
            OneJunction\p <= EndstopMax\p2;
            OneJunction\p => Rjoint\p;
            uTbai\p2 => Tbai\p;
            Tbai\p => Wbai\p;
            EndstopMin\collision -> Or\input2;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            EndstopMax\collision -> Or\input1;
            OneJunction\flow -> Integrate\input 320 272;
            Splitter2\output -> AdHji\H 424 368;
           end;
           parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
          implementation_end;
         Joint23 768.2 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-roty.emx</LibraryPath>
 <TimeStamp>2011-1-18 17:30:05</TimeStamp>
</Description>';
          type 'Submodel-roty'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real Rconstraint = 1000.0;
            real Cconstraint = 1.0e-4;
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = 0.0;
            real MaxEndstopPos = 2.55;
            real MinEndstopPos = -2.64;
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            rectangle 736.4 432 799.9 576 fill 14745599;
            text 'Joint-roty' 768.4 507 fill 14745599;
           terminals
            p 735.9 464 fixed;
            p1 767.4 432 fixed;
            p2 799.9 464 fixed;
            Hin 735.9 544 fixed;
            Hout 799.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            EndstopMax 471 217
             description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Rendstop = 1000.0;
               real Cendstop = 1.0e-4;
               real InitialPos = 0.0;
               real EndstopPos = 2.55;
             end;
             icon bg bottom
              figures
               rectangle 422 194 520 240 fill 14013909;
               text 'EndstopMax' 472 216 16;
              terminals
               p2 472 240 fixed;
             end;
             implementation bg
              submodels
               Cendstop 704 144
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 704 144 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 704 216
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out Collision;
                 restrictions
                  causality fixed in p12;
                  causality fixed out p2;
                  causality fixed out p1;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopPos = 2.55;
                end;
                icon bg
                 figures
                  text 'X0e' 704 216 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug Collision 408 192;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     mechanical in p1;
                     mechanical out p2;
                     mechanical out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 2.55;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> Collision;
                 end;
                 parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 648 216;
               plug collision 800 216;
               OneJunction5 704 176
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 704 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 736 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 736 176 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf1 704 264
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 704 264 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               OneJunction5\p => Cendstop\p;
               Collision\p12 => OneJunction5\p;
               Sf1\p => Collision\p1;
               OneJunction5\p => Rendstop\p;
               Collision\p2 => p2;
               Collision\Collision -> collision;
              end;
              parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
             implementation_end;
            EndstopMin 312 216
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 14:37:57</TimeStamp>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Cendstop = 1.0e-4;
               real Rendstop = 1000.0;
               real InitialPos = 0.0;
               real EndstopPos = -2.64;
             end;
             icon bg bottom
              figures
               rectangle 263 193 361 239 fill 14013909;
               text 'EndstopMin' 313 215 16;
             end;
             implementation bg
              submodels
               Cendstop 248 208
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 248 208 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 248 120
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out collision;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopLocation = -2.64;
                end;
                icon bg
                 figures
                  text 'X0e' 248 120 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug collision 400 200;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     power in p1;
                     power out p2;
                     power out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = -2.64;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> collision;
                 end;
                 parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 152 120;
               plug collision 360 120;
               OneJunction 248 160
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 248 160 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 288 160
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 288 160 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf2 248 64
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 248 64 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               Collision\p12 => OneJunction\p;
               OneJunction\p => Rendstop\p;
               OneJunction\p => Cendstop\p;
               Sf2\p => Collision\p1;
               Collision\p2 => p2;
               Collision\collision -> collision;
              end;
              parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
             implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 496
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 480 335.9 512 fill 15132390;
               text 'X' 320 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 56;
            plug p2 496 424;
            plug Hin 112 496;
            plug Hout 504 496;
            plug p 112 424;
            OneJunction 240 272
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 272 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Or 392 216
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
             type 'Or-Or'
              ports
               signal boolean in input1;
               signal boolean out output;
               signal boolean in input2;
             end;
             icon bg bottom
              figures
               rectangle 376.1 200 407.9 232 fill 15132390;
               group
                line 378.3 209.3 388.8 209.3 color 16711680 fill 16711680;
                line 378.3 223.1 388.8 223.1 color 16711680 fill 16711680;
               end;
               spline 387.9 204.8 389.9 216.5 387.9 227.7 color 16711680 fill 16711680;
               line 396.7 216 405.5 216 color 16711680 fill 16711680;
               spline 387.7 204.3 393.9 206.6 396.8 216.4 393.6 225.4 387.7 227.7 color 16711680 fill 15132390;
             end;
             implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
            Rjoint 192 272
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rjoint = 1.0;
             end;
             icon bg bottom
              figures
               text 'R' 192 272 18 bold;
             end;
             implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Tbai 240 384
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg left
              figures
               text '1' 240 384 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            uTbai 240 328
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real Rconstraint = 1000.0;
               real Cconstraint = 1.0e-4;
             end;
             icon bg left
              figures
               text 'TF' 240 328 18 bold;
             end;
             implementation eq
equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = p1.e;
	p2.e[3] = (Rconstraint*-p2.f[3] + int(-p2.f[3])/Cconstraint);
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[2];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            p1 => ZeroJunction\p;
            uTbai\p2 => Tbai\p;
            Tbai\p => Wbai\p;
            p <= Wbai\p;
            ZeroJunction\p => OneJunction\p;
            OneJunction\p => uTbai\p1;
            Wbai\p <= AdHji\p1;
            OneJunction\p <= EndstopMin\p2;
            p2 => AdHji\p2;
            OneJunction\p <= EndstopMax\p2;
            OneJunction\p => Rjoint\p;
            EndstopMin\collision -> Or\input2;
            Splitter2\output -> AdHji\H 424 368;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            EndstopMax\collision -> Or\input1;
            OneJunction\flow -> Integrate\input 320 272;
           end;
           parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
          implementation_end;
         Joint34 928.2 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-roty.emx</LibraryPath>
 <TimeStamp>2011-1-18 17:30:05</TimeStamp>
</Description>';
          type 'Submodel-roty'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real Rconstraint = 1000.0;
            real Cconstraint = 1.0e-4;
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = 0.0;
            real MaxEndstopPos = 1.79;
            real MinEndstopPos = -1.79;
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            rectangle 896.4 432 959.9 576 fill 14745599;
            text 'Joint-roty' 928.4 507 fill 14745599;
           terminals
            p 895.9 464 fixed;
            p1 927.4 432 fixed;
            p2 959.9 464 fixed;
            Hin 895.9 544 fixed;
            Hout 959.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            EndstopMax 471 217
             description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Rendstop = 1000.0;
               real Cendstop = 1.0e-4;
               real InitialPos = 0.0;
               real EndstopPos = 1.79;
             end;
             icon bg bottom
              figures
               rectangle 422 194 520 240 fill 14013909;
               text 'EndstopMax' 472 216 16;
              terminals
               p2 472 240 fixed;
             end;
             implementation bg
              submodels
               Cendstop 704 144
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 704 144 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 704 216
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out Collision;
                 restrictions
                  causality fixed in p12;
                  causality fixed out p2;
                  causality fixed out p1;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopPos = 1.79;
                end;
                icon bg
                 figures
                  text 'X0e' 704 216 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug Collision 408 192;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     mechanical in p1;
                     mechanical out p2;
                     mechanical out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 1.79;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> Collision;
                 end;
                 parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 648 216;
               plug collision 800 216;
               OneJunction5 704 176
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 704 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 736 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 736 176 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf1 704 264
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 704 264 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               OneJunction5\p => Cendstop\p;
               Collision\p12 => OneJunction5\p;
               Sf1\p => Collision\p1;
               OneJunction5\p => Rendstop\p;
               Collision\p2 => p2;
               Collision\Collision -> collision;
              end;
              parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
             implementation_end;
            EndstopMin 312 216
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 14:37:57</TimeStamp>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Cendstop = 1.0e-4;
               real Rendstop = 1000.0;
               real InitialPos = 0.0;
               real EndstopPos = -1.79;
             end;
             icon bg bottom
              figures
               rectangle 263 193 361 239 fill 14013909;
               text 'EndstopMin' 313 215 16;
             end;
             implementation bg
              submodels
               Cendstop 248 208
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 248 208 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 248 120
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out collision;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopLocation = -1.79;
                end;
                icon bg
                 figures
                  text 'X0e' 248 120 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug collision 400 200;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     power in p1;
                     power out p2;
                     power out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = -1.79;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> collision;
                 end;
                 parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 152 120;
               plug collision 360 120;
               OneJunction 248 160
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 248 160 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 288 160
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 288 160 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf2 248 64
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 248 64 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               Collision\p12 => OneJunction\p;
               OneJunction\p => Rendstop\p;
               OneJunction\p => Cendstop\p;
               Sf2\p => Collision\p1;
               Collision\p2 => p2;
               Collision\collision -> collision;
              end;
              parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
             implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 496
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 480 335.9 512 fill 15132390;
               text 'X' 320 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 56;
            plug p2 496 424;
            plug Hin 112 496;
            plug Hout 504 496;
            plug p 112 424;
            OneJunction 240 272
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 272 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Or 392 216
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
             type 'Or-Or'
              ports
               signal boolean in input1;
               signal boolean out output;
               signal boolean in input2;
             end;
             icon bg bottom
              figures
               rectangle 376.1 200 407.9 232 fill 15132390;
               group
                line 378.3 209.3 388.8 209.3 color 16711680 fill 16711680;
                line 378.3 223.1 388.8 223.1 color 16711680 fill 16711680;
               end;
               spline 387.9 204.8 389.9 216.5 387.9 227.7 color 16711680 fill 16711680;
               line 396.7 216 405.5 216 color 16711680 fill 16711680;
               spline 387.7 204.3 393.9 206.6 396.8 216.4 393.6 225.4 387.7 227.7 color 16711680 fill 15132390;
             end;
             implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
            Rjoint 192 272
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rjoint = 1.0;
             end;
             icon bg bottom
              figures
               text 'R' 192 272 18 bold;
             end;
             implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Tbai 240 384
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg left
              figures
               text '1' 240 384 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            uTbai 240 328
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real Rconstraint = 1000.0;
               real Cconstraint = 1.0e-4;
             end;
             icon bg left
              figures
               text 'TF' 240 328 18 bold;
             end;
             implementation eq
equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = p1.e;
	p2.e[3] = (Rconstraint*-p2.f[3] + int(-p2.f[3])/Cconstraint);
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[2];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            p1 => ZeroJunction\p;
            OneJunction\p => uTbai\p1;
            Wbai\p <= AdHji\p1;
            OneJunction\p <= EndstopMin\p2;
            p2 => AdHji\p2;
            OneJunction\p <= EndstopMax\p2;
            OneJunction\p => Rjoint\p;
            uTbai\p2 => Tbai\p;
            Tbai\p => Wbai\p;
            p <= Wbai\p;
            ZeroJunction\p => OneJunction\p;
            EndstopMin\collision -> Or\input2;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            EndstopMax\collision -> Or\input1;
            OneJunction\flow -> Integrate\input 320 272;
            Splitter2\output -> AdHji\H 424 368;
            MatrixMul\output -> Hout;
           end;
           parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
          implementation_end;
         Joint45 1088.2 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-rotz.emx</LibraryPath>
 <TimeStamp>2011-1-18 17:30:00</TimeStamp>
</Description>';
          type 'Submodel-rotz'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = 0.0;
            real MinEndstopPos = -2.92;
            real MaxEndstopPos = 2.92;
            real Rconstraint = 1000.0;
            real Cconstraint = 1.0e-4;
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            rectangle 1056.4 432 1119.9 576 fill 14745599;
            text 'Joint-rotz' 1088.4 507 fill 14745599;
           terminals
            p 1055.9 464 fixed;
            p1 1087.4 432 fixed;
            p2 1119.9 464 fixed;
            Hin 1055.9 544 fixed;
            Hout 1119.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            EndstopMax 479 225
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMax.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:54:54</TimeStamp>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Rendstop = 1000.0;
               real Cendstop = 1.0e-4;
               real InitialPos = 0.0;
               real EndstopPos = 2.92;
             end;
             icon bg bottom
              figures
               rectangle 430 202 528 248 fill 14013909;
               text 'EndstopMax' 480 224 16;
              terminals
               p2 480 248 fixed;
             end;
             implementation bg
              submodels
               Cendstop 704 144
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 704 144 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 704 216
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out Collision;
                 restrictions
                  causality fixed out p2;
                  causality fixed out p1;
                  causality fixed in p12;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopPos = 2.92;
                end;
                icon bg
                 figures
                  text 'X0e' 704 216 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug Collision 408 192;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     mechanical in p1;
                     mechanical out p2;
                     mechanical out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 2.92;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> Collision;
                 end;
                 parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 648 216;
               plug collision 800 216;
               OneJunction5 704 176
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 704 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 736 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 736 176 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf1 704 264
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 704 264 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               OneJunction5\p => Cendstop\p;
               Collision\p12 => OneJunction5\p;
               Sf1\p => Collision\p1;
               OneJunction5\p => Rendstop\p;
               Collision\p2 => p2;
               Collision\Collision -> collision;
              end;
              parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
             implementation_end;
            EndstopMin 320 224
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:54:44</TimeStamp>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Cendstop = 1.0e-4;
               real Rendstop = 1000.0;
               real InitialPos = 0.0;
               real EndstopPos = -2.92;
             end;
             icon bg bottom
              figures
               rectangle 271 201 369 247 fill 14013909;
               text 'EndstopMin' 321 223 16;
             end;
             implementation bg
              submodels
               Cendstop 248 208
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 248 208 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 248 120
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out collision;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopLocation = -2.92;
                end;
                icon bg
                 figures
                  text 'X0e' 248 120 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug collision 400 200;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     power in p1;
                     power out p2;
                     power out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = -2.92;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> collision;
                 end;
                 parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 152 120;
               plug collision 360 120;
               OneJunction 248 160
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 248 160 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 288 160
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 288 160 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf2 248 64
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 248 64 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               Collision\p12 => OneJunction\p;
               OneJunction\p => Rendstop\p;
               OneJunction\p => Cendstop\p;
               Sf2\p => Collision\p1;
               Collision\p2 => p2;
               Collision\collision -> collision;
              end;
              parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
             implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	-sin(q),	0;
			sin(q),	cos(q),	0;
			0,				0,				1];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 576
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 560 335.9 592 fill 15132390;
               text 'X' 320 576 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 40;
            plug p2 496 424;
            plug Hin 112 576;
            plug Hout 504 576;
            plug p 112 424;
            OneJunction 240 288
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 288 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Or 400 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
             type 'Or-Or'
              ports
               signal boolean in input1;
               signal boolean out output;
               signal boolean in input2;
             end;
             icon bg bottom
              figures
               rectangle 384.1 208 415.9 240 fill 15132390;
               group
                line 386.3 217.3 396.8 217.3 color 16711680 fill 16711680;
                line 386.3 231.1 396.8 231.1 color 16711680 fill 16711680;
               end;
               spline 395.9 212.8 397.9 224.5 395.9 235.7 color 16711680 fill 16711680;
               line 404.7 224 413.5 224 color 16711680 fill 16711680;
               spline 395.7 212.3 401.9 214.6 404.8 224.4 401.6 233.4 395.7 235.7 color 16711680 fill 15132390;
             end;
             implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
            Rjoint 168 288
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rjoint = 1.0;
             end;
             icon bg bottom
              figures
               text 'R' 168 288 18 bold;
             end;
             implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            uTbai 240 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
               causality fixed in p1;
               causality fixed out p2;
              parameters
               real Cconstraint = 1.0e-4;
               real Rconstraint = 1000.0;
             end;
             icon bg left
              figures
               text 'TF' 240 336 18 bold;
             end;
             implementation eq

equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = (Rconstraint*-p2.f[2] + int(-p2.f[2])/Cconstraint);
	p2.e[3] = p1.e;
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[3];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            uTbai\p1 <= OneJunction\p;
            OneJunction\p <= EndstopMax\p2;
            Rjoint\p <= OneJunction\p;
            ZeroJunction\p => OneJunction\p;
            p1 => ZeroJunction\p;
            uTbai\p2 => Wbai\p;
            p <= Wbai\p;
            OneJunction\p <= EndstopMin\p2;
            Wbai\p <= AdHji\p1;
            p2 => AdHji\p2;
            OneJunction\flow -> Integrate\input 288 336;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            EndstopMin\collision -> Or\input2;
            EndstopMax\collision -> Or\input1;
            Splitter2\output -> AdHji\H 424 368;
            MatrixMul\output -> Hout;
           end;
           parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;

parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 680 488;
          implementation_end;
         JointBase1 448.2 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Joint-rotz.emx</LibraryPath>
  <TimeStamp>2011-1-21 10:08:41</TimeStamp>
</Description>';
          type 'Submodel-rotz'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = 0.0;
            real MinEndstopPos = -2.95;
            real MaxEndstopPos = 2.95;
            real Rconstraint = 1000.0;
            real Cconstraint = 1.0e-4;
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            rectangle 416.4 432 479.9 576 fill 14745599;
            text 'Joint-rotz' 448.4 507 fill 14745599;
           terminals
            p 415.9 464 fixed;
            p1 447.4 432 fixed;
            p2 479.9 464 fixed;
            Hin 415.9 544 fixed;
            Hout 479.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            EndstopMax 479 225
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMax.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:54:54</TimeStamp>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Rendstop = 1000.0;
               real Cendstop = 1.0e-4;
               real InitialPos = 0.0;
               real EndstopPos = 2.95;
             end;
             icon bg bottom
              figures
               rectangle 430 202 528 248 fill 14013909;
               text 'EndstopMax' 480 224 16;
              terminals
               p2 480 248 fixed;
             end;
             implementation bg
              submodels
               Cendstop 704 144
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 704 144 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 704 216
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out Collision;
                 restrictions
                  causality fixed out p2;
                  causality fixed out p1;
                  causality fixed in p12;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopPos = 2.95;
                end;
                icon bg
                 figures
                  text 'X0e' 704 216 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug Collision 408 192;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     mechanical in p1;
                     mechanical out p2;
                     mechanical out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 2.95;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> Collision;
                 end;
                 parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 648 216;
               plug collision 800 216;
               OneJunction5 704 176
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 704 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 736 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 736 176 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf1 704 264
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 704 264 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               OneJunction5\p => Cendstop\p;
               Collision\p12 => OneJunction5\p;
               Sf1\p => Collision\p1;
               OneJunction5\p => Rendstop\p;
               Collision\p2 => p2;
               Collision\Collision -> collision;
              end;
              parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
             implementation_end;
            EndstopMin 320 224
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:54:44</TimeStamp>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Cendstop = 1.0e-4;
               real Rendstop = 1000.0;
               real InitialPos = 0.0;
               real EndstopPos = -2.95;
             end;
             icon bg bottom
              figures
               rectangle 271 201 369 247 fill 14013909;
               text 'EndstopMin' 321 223 16;
             end;
             implementation bg
              submodels
               Cendstop 248 208
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 248 208 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 248 120
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out collision;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopLocation = -2.95;
                end;
                icon bg
                 figures
                  text 'X0e' 248 120 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug collision 400 200;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     power in p1;
                     power out p2;
                     power out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = -2.95;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> collision;
                 end;
                 parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 152 120;
               plug collision 360 120;
               OneJunction 248 160
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 248 160 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 288 160
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 288 160 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf2 248 64
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 248 64 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               Collision\p12 => OneJunction\p;
               OneJunction\p => Rendstop\p;
               OneJunction\p => Cendstop\p;
               Sf2\p => Collision\p1;
               Collision\p2 => p2;
               Collision\collision -> collision;
              end;
              parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
             implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	-sin(q),	0;
			sin(q),	cos(q),	0;
			0,				0,				1];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 576
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 560 335.9 592 fill 15132390;
               text 'X' 320 576 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 40;
            plug p2 496 424;
            plug Hin 112 576;
            plug Hout 504 576;
            plug p 112 424;
            OneJunction 240 288
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 288 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Or 400 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
             type 'Or-Or'
              ports
               signal boolean in input1;
               signal boolean out output;
               signal boolean in input2;
             end;
             icon bg bottom
              figures
               rectangle 384.1 208 415.9 240 fill 15132390;
               group
                line 386.3 217.3 396.8 217.3 color 16711680 fill 16711680;
                line 386.3 231.1 396.8 231.1 color 16711680 fill 16711680;
               end;
               spline 395.9 212.8 397.9 224.5 395.9 235.7 color 16711680 fill 16711680;
               line 404.7 224 413.5 224 color 16711680 fill 16711680;
               spline 395.7 212.3 401.9 214.6 404.8 224.4 401.6 233.4 395.7 235.7 color 16711680 fill 15132390;
             end;
             implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
            Rjoint 168 288
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rjoint = 1.0;
             end;
             icon bg bottom
              figures
               text 'R' 168 288 18 bold;
             end;
             implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            uTbai 240 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
               causality fixed in p1;
               causality fixed out p2;
              parameters
               real Cconstraint = 1.0e-4;
               real Rconstraint = 1000.0;
             end;
             icon bg left
              figures
               text 'TF' 240 336 18 bold;
             end;
             implementation eq

equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = (Rconstraint*-p2.f[2] + int(-p2.f[2])/Cconstraint);
	p2.e[3] = p1.e;
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[3];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            uTbai\p1 <= OneJunction\p;
            Wbai\p <= AdHji\p1;
            p2 => AdHji\p2;
            OneJunction\p <= EndstopMax\p2;
            Rjoint\p <= OneJunction\p;
            ZeroJunction\p => OneJunction\p;
            p1 => ZeroJunction\p;
            uTbai\p2 => Wbai\p;
            p <= Wbai\p;
            OneJunction\p <= EndstopMin\p2;
            OneJunction\flow -> Integrate\input 288 336;
            Splitter2\output -> AdHji\H 424 368;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            EndstopMin\collision -> Or\input2;
            EndstopMax\collision -> Or\input1;
           end;
           parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;

parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 680 488;
          implementation_end;
         Link1 528 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Link.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:36:40</TimeStamp>
<Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0375];
            real dim[3,1] = [0.0; 0.0; 0.075];
          end;
          icon bg bottom
           figures
            rectangle 496 432 560 576 fill 10025880;
            text 'Link' 528 504;
           terminals
            p 496 464 fixed;
            Hin 496 544 fixed;
            p1 560 464 fixed;
            Hout 560 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik 664 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0375];
             end;
             icon bg left
              figures
               text 'TF' 664 224 18 bold;
             end;
             implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0375];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            EJS 728 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MGY
              ports
               power in p1 [6,1];
              parameters
               real I[3,1] = [1.0; 1.0; 1.0];
               real m = 1.0;
             end;
             icon bg top
              figures
               text 'MGY' 728 184 18 bold;
             end;
             implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.075];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            InertialTensor 616 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type I
              ports
               power in p [6,1];
               signal out state [6,1];
              restrictions
               causality preferred in p;
              parameters
               real m = 1.0;
               real I[3,1] = [1.0; 1.0; 1.0];
             end;
             icon bg top
              figures
               text 'I' 616 184 18 bold;
             end;
             implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
            plug Hout 896 496;
            plug p1 904 304;
            plug Hin 592 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0k 664 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg top
              figures
               text '1' 664 184 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            AdHik\p2 => Ta0k\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            Ta0k\p => EJS\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Ta0k\p => InertialTensor\p;
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            Ta0i\p => AdHik\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
          implementation_end;
         Link2 688 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Link.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:36:40</TimeStamp>
<Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0775];
            real dim[3,1] = [0.0; 0.0; 0.155];
          end;
          icon bg bottom
           figures
            rectangle 656 432 720 576 fill 10025880;
            text 'Link' 688 504;
           terminals
            p 656 464 fixed;
            Hin 656 544 fixed;
            p1 720 464 fixed;
            Hout 720 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik 664 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0775];
             end;
             icon bg left
              figures
               text 'TF' 664 224 18 bold;
             end;
             implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0775];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            EJS 728 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MGY
              ports
               power in p1 [6,1];
              parameters
               real I[3,1] = [1.0; 1.0; 1.0];
               real m = 1.0;
             end;
             icon bg top
              figures
               text 'MGY' 728 184 18 bold;
             end;
             implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.155];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            InertialTensor 616 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type I
              ports
               power in p [6,1];
               signal out state [6,1];
              restrictions
               causality preferred in p;
              parameters
               real m = 1.0;
               real I[3,1] = [1.0; 1.0; 1.0];
             end;
             icon bg top
              figures
               text 'I' 616 184 18 bold;
             end;
             implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
            plug Hout 896 496;
            plug p1 904 304;
            plug Hin 592 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0k 664 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg top
              figures
               text '1' 664 184 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            AdHik\p2 => Ta0k\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            Ta0k\p => EJS\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Ta0k\p => InertialTensor\p;
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            Ta0i\p => AdHik\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
          implementation_end;
         Link3 848 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link.emx</LibraryPath>
 <TimeStamp>2011-1-18 16:36:40</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0675];
            real dim[3,1] = [0.0; 0.0; 0.135];
          end;
          icon bg bottom
           figures
            rectangle 816 432 880 576 fill 10025880;
            text 'Link' 848 504;
           terminals
            p 816 464 fixed;
            Hin 816 544 fixed;
            p1 880 464 fixed;
            Hout 880 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik 664 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0675];
             end;
             icon bg left
              figures
               text 'TF' 664 224 18 bold;
             end;
             implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0675];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            EJS 728 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MGY
              ports
               power in p1 [6,1];
              parameters
               real I[3,1] = [1.0; 1.0; 1.0];
               real m = 1.0;
             end;
             icon bg top
              figures
               text 'MGY' 728 184 18 bold;
             end;
             implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.135];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            InertialTensor 616 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type I
              ports
               power in p [6,1];
               signal out state [6,1];
              restrictions
               causality preferred in p;
              parameters
               real m = 1.0;
               real I[3,1] = [1.0; 1.0; 1.0];
             end;
             icon bg top
              figures
               text 'I' 616 184 18 bold;
             end;
             implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
            plug Hout 896 496;
            plug p1 904 304;
            plug Hin 592 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0k 664 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg top
              figures
               text '1' 664 184 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            AdHik\p2 => Ta0k\p;
            Gravity\p => Ta00\p;
            Ta0i\p => AdHik\p1;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            Ta0k\p => EJS\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Ta0k\p => InertialTensor\p;
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
          implementation_end;
         Link4 1008 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link.emx</LibraryPath>
 <TimeStamp>2011-1-18 16:36:40</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0405];
            real dim[3,1] = [0.0; 0.0; 0.081];
          end;
          icon bg bottom
           figures
            rectangle 976 432 1040 576 fill 10025880;
            text 'Link' 1008 504;
           terminals
            p 976 464 fixed;
            Hin 976 544 fixed;
            p1 1040 464 fixed;
            Hout 1040 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik 664 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0405];
             end;
             icon bg left
              figures
               text 'TF' 664 224 18 bold;
             end;
             implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0405];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            EJS 728 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MGY
              ports
               power in p1 [6,1];
              parameters
               real I[3,1] = [1.0; 1.0; 1.0];
               real m = 1.0;
             end;
             icon bg top
              figures
               text 'MGY' 728 184 18 bold;
             end;
             implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.081];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            InertialTensor 616 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type I
              ports
               power in p [6,1];
               signal out state [6,1];
              restrictions
               causality preferred in p;
              parameters
               real m = 1.0;
               real I[3,1] = [1.0; 1.0; 1.0];
             end;
             icon bg top
              figures
               text 'I' 616 184 18 bold;
             end;
             implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
            plug Hout 896 496;
            plug p1 904 304;
            plug Hin 592 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0k 664 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg top
              figures
               text '1' 664 184 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            AdHik\p2 => Ta0k\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            Ta0k\p => EJS\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Ta0k\p => InertialTensor\p;
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            Ta0i\p => AdHik\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
          implementation_end;
         Link5 1168 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link.emx</LibraryPath>
 <TimeStamp>2011-1-18 16:36:40</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0685];
            real dim[3,1] = [0.0; 0.0; 0.137];
          end;
          icon bg bottom
           figures
            rectangle 1136 432 1200 576 fill 10025880;
            text 'Link' 1168 504;
           terminals
            p 1136 464 fixed;
            Hin 1136 544 fixed;
            p1 1200 464 fixed;
            Hout 1200 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik 664 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0685];
             end;
             icon bg left
              figures
               text 'TF' 664 224 18 bold;
             end;
             implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0685];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            EJS 728 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MGY
              ports
               power in p1 [6,1];
              parameters
               real I[3,1] = [1.0; 1.0; 1.0];
               real m = 1.0;
             end;
             icon bg top
              figures
               text 'MGY' 728 184 18 bold;
             end;
             implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.137];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            InertialTensor 616 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type I
              ports
               power in p [6,1];
               signal out state [6,1];
              restrictions
               causality preferred in p;
              parameters
               real m = 1.0;
               real I[3,1] = [1.0; 1.0; 1.0];
             end;
             icon bg top
              figures
               text 'I' 616 184 18 bold;
             end;
             implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
            plug Hout 896 496;
            plug p1 904 304;
            plug Hin 592 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0k 664 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg top
              figures
               text '1' 664 184 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            AdHik\p2 => Ta0k\p;
            Ta0k\p => EJS\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Ta0k\p => InertialTensor\p;
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            Ta0i\p => AdHik\p1;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
          implementation_end;
         MecanumWheels 279.9 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>MechanumWheels.emx</LibraryPath>
  <TimeStamp>2011-1-21 10:44:35</TimeStamp>
</Description>';
          type Submodel
           ports
            power in p [6,1];
            power in p1 [6,1];
            power in MotorRR;
            power in MotorLR;
            power in MotorLF;
            power in MotorRF;
            signal out Hout [4,4];
            signal in Hin [4,4];
           restrictions
            causality fixed in MotorLR;
            causality fixed in MotorLF;
            causality fixed in MotorRF;
            causality fixed in MotorRR;
           parameters
            real WheelRadius = 0.053;
            real WheelLFpos[2,1] = [0.215; -0.15];
            real WheelRFpos[2,1] = [0.215; 0.15];
            real WheelLRpos[2,1] = [-0.215; -0.15];
            real WheelRRpos[2,1] = [-0.215; 0.15];
            real Cfloor = 1.0e-4;
            real Rfloor = 1000.0;
            real init[4,4] = [1.0, 0.0, 0.0, 0.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];
            real Rwheel = 0.1;
          end;
          icon bg bottom
           figures
            rectangle 239.1 432.5 320.6 575.5 fill 16443110;
            text 'Mecanum 
 Wheels' 279.9 504 fill 16443110 16;
           terminals
            p 319.9 464 fixed;
            p1 240.4 463 fixed;
            MotorRR 303.9 432 fixed;
            MotorLR 287.9 432 fixed;
            MotorLF 255.9 432 fixed;
            MotorRF 271.9 432 fixed;
            Hout 319.9 544 fixed;
            Hin 239.9 544 fixed;
          end;
          implementation bg
           submodels
            Cfloor 864 656
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type C
              ports
               power in p [6,1];
               signal out state [6,1];
              restrictions
               causality preferred out p;
              parameters
               real Cfloor = 1.0e-4;
             end;
             icon bg bottom
              figures
               text 'C' 864 656 18 bold;
             end;
             implementation eq
equations
    state = int(p.f);
    p.e = [(1/Cfloor) * state[1];(1/Cfloor) * state[2];0;0;0;(1/Cfloor) * state[6]];
implementation_end;
            Integrate2 1032 624
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:3:23</TimeStamp>
</Description>';
             type Integrate
              ports
               signal in input [6,1];
               signal out output [4,4];
              parameters
               real init[4,4] = [1.0, 0.0, 0.0, 0.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];
             end;
             icon bg
              figures
               rectangle 1016 608 1048 640 fill 15132390;
               text 'ò' 1032 621.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real H[4,4];
	real dotH[4,4];
	real tildeT[4,4];


equations
	tildeT = tilde(input);
	dotH = H*tildeT;
	H = int(dotH,init);
	output = H;





     


	
     implementation_end;
            MatrixMul 1032 792
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 1016.1 776 1047.9 808 fill 15132390;
               text 'X' 1032 792 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            MecanumWheelAnimation 1103.5 312
             description '<Description>
 <Version>4.0</Version>
 <LibraryPath>Template\Submodel-Equation.emx</LibraryPath>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <TimeStamp>2007-11-1 22:32:1</TimeStamp>
 <AllowLibraryUpdate>False</AllowLibraryUpdate>
</Description>';
             type 'Submodel-Equation'
              ports
               signal in Hbase0 [4,4];
               signal in vWheelLF;
               signal in vWheelRF;
               signal in vWheelLR;
               signal in vWheelRR;
              parameters
               real WheelLFpos[2,1] = [0.215; -0.15];
               real WheelRFpos[2,1] = [0.215; 0.15];
               real WheelLRpos[2,1] = [-0.215; -0.15];
               real WheelRRpos[2,1] = [-0.215; 0.15];
             end;
             icon bg
              figures
               rectangle 1055 272 1152 352 fill 14013909;
               text 'Mecanum
   Wheel
 Animation' 1104 312 16;
              terminals
               Hbase0 1104 352 fixed;
               vWheelLF 1056 288 fixed;
               vWheelRF 1056 304 fixed;
               vWheelLR 1056 320 fixed;
               vWheelRR 1056 336 fixed;
             end;
             implementation eq
parameters
	real rot = 1.57;
//end
variables
//t.b.v. animation of mecanum wheels
	real HLRrot[4,4], HLFrot[4,4], HRRrot[4,4], HRFrot[4,4];
	real RLRrot[3,3], RLFrot[3,3], RRRrot[3,3], RRFrot[3,3];
	real RLRbase[3,3], RLFbase[3,3], RRFbase[3,3], RRRbase[3,3];
	real HLRbase[4,4], HLFbase[4,4], HRFbase[4,4], HRRbase[4,4];
	real HLR0[4,4], HLF0[4,4], HRF0[4,4], HRR0[4,4];
	real pLRbase[3], pLFbase[3], pRFbase[3], pRRbase[3];

	real qWheelLF, qWheelRF,qWheelLR, qWheelRR;
//end
equations
	qWheelLF = int(vWheelLF);
	qWheelRF = int(vWheelRF);
	qWheelLR = int(vWheelLR);
	qWheelRR = int(vWheelRR);


//t.b.v. animation of mecanum wheel
	pLFbase = [WheelLFpos[1];WheelLFpos[2];0.05];
	pRFbase = [WheelRFpos[1];WheelRFpos[2];0.05];
	pLRbase = [WheelLRpos[1];WheelLRpos[2];0.05];
	pRRbase = [WheelRRpos[1];WheelRRpos[2];0.05];
	
	RLRbase = [
		1,	0,				0;
		0,	cos(rot),	-sin(rot);
		0, sin(rot),	cos(rot)
	];
		
	RLFbase = [
		1,	0,				0;
		0,	cos(rot),	-sin(rot);
		0, sin(rot),	cos(rot)
	];

	RRFbase = [
		1,	0,				0;
		0,	cos(rot),	-sin(rot);
		0, sin(rot),	cos(rot)
	];

	RRRbase = [
		1,	0,				0;
		0,	cos(rot),	-sin(rot);
		0, sin(rot),	cos(rot)
	];

	HLFbase = homogeneous(RLFbase, pLFbase);
	HLRbase = homogeneous(RLRbase, pLRbase);
	HRRbase = homogeneous(RRRbase, pRRbase);
	HRFbase = homogeneous(RRFbase, pRFbase);

	RLRrot = [
		cos(-qWheelLR),	-sin(-qWheelLR),	0;
		sin(-qWheelLR),	cos(-qWheelLR),	0;
		0,				0,				1
	];
		
	RLFrot = [
		cos(-qWheelLF),	-sin(-qWheelLF),	0;
		sin(-qWheelLF),	cos(-qWheelLF),	0;
		0,				0,				1
	];

	RRFrot = [
		cos(-qWheelRF),	-sin(-qWheelRF),	0;
		sin(-qWheelRF),	cos(-qWheelRF),	0;
		0,				0,				1
	];

	RRRrot = [
		cos(-qWheelRR),	-sin(-qWheelRR),	0;
		sin(-qWheelRR),	cos(-qWheelRR),	0;
		0,				0,				1
	];

	HLFrot = homogeneous(RLFrot,[0;0;0]);
	HRFrot = homogeneous(RRFrot,[0;0;0]);
	HLRrot = homogeneous(RLRrot,[0;0;0]);
	HRRrot = homogeneous(RRRrot,[0;0;0]);

	HLF0 = Hbase0*HLFbase*HLFrot;
	HRF0 = Hbase0*HRFbase*HRFrot;
	HLR0 = Hbase0*HLRbase*HLRrot;
	HRR0 = Hbase0*HRRbase*HRRrot;
//end
 implementation_end;
            plug MotorLR 912 240;
            plug MotorLF 720 240;
            plug Hout 1184 792;
            plug Hin 696 792;
            plug MotorRR 1008 240;
            plug p1 693 704;
            plug MotorRF 816 240;
            plug p 1168 704;
            OneJunction 920 624
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 920 624 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            OneJunction2 1008 336
             description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 1008 336 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction3 912 320
             description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 912 320 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction4 720 288
             description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 720 288 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction5 816 304
             description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 816 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Rfloor 840 624
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p [6,1];
              parameters
               real Rfloor = 1000.0;
             end;
             icon bg bottom
              figures
               text 'R' 840 624 18 bold;
             end;
             implementation eq
equations					
	p.e = [Rfloor * p.f[1];Rfloor * p.f[2];0;0;0;Rfloor * p.f[6]];
implementation_end;
            RwheelLF 672 288
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rwheel = 0.1;
             end;
             icon bg bottom
              figures
               text 'R' 672 288 18 bold;
             end;
             implementation eq
equations					
	p.e = Rwheel * p.f;
implementation_end;
            RwheelLR 864 320
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rwheel = 0.1;
             end;
             icon bg bottom
              figures
               text 'R' 864 320 18 bold;
             end;
             implementation eq
equations					
	p.e = Rwheel * p.f;
implementation_end;
            RwheelRF 768 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rwheel = 0.1;
             end;
             icon bg bottom
              figures
               text 'R' 768 304 18 bold;
             end;
             implementation eq
equations					
	p.e = Rwheel * p.f;
implementation_end;
            RwheelRR 960 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rwheel = 0.1;
             end;
             icon bg bottom
              figures
               text 'R' 960 336 18 bold;
             end;
             implementation eq
equations					
	p.e = Rwheel * p.f;
implementation_end;
            Splitter1 1104 792
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 1100.8 788.8 1107.2 795.2 color -1 fill 0;
               ellipse 1099.7 787.7 1108.3 796.3 color -1;
              terminals
               input 1104 792 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            TF_LF 720 504
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real WheelLFpos[2,1] = [0.215; -0.15];
             end;
             icon bg bottom
              figures
               text 'TF' 720 504 18 bold;
             end;
             implementation eq
variables	
	real TFr[6,3];
	real transTFr[3,6];
equations
	TFr[1:3,1:3] = skew([WheelLFpos[1];WheelLFpos[2];0]);
	TFr[4:6,1:3] = eye(3); 

	transTFr[1:3,1:3] = -skew([WheelLFpos[1];WheelLFpos[2];0]);
	transTFr[1:3,4:6] = eye(3); 
	
	p2.e = TFr*p1.e;
	p1.f = transTFr*p2.f;
implementation_end;
            TF_LR 912 504
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real WheelLRpos[2,1] = [-0.215; -0.15];
             end;
             icon bg bottom
              figures
               text 'TF' 912 504 18 bold;
             end;
             implementation eq
variables
	real TFr[6,3];
	real transTFr[3,6];
equations
	TFr[1:3,1:3] = skew([WheelLRpos[1];WheelLRpos[2];0]);
	TFr[4:6,1:3] = eye(3); 

	transTFr[1:3,1:3] = -skew([WheelLRpos[1];WheelLRpos[2];0]);
	transTFr[1:3,4:6] = eye(3); 
	
	p2.e = TFr*p1.e;
	p1.f = transTFr*p2.f;
implementation_end;
            TF_RF 816 504
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real WheelRFpos[2,1] = [0.215; 0.15];
             end;
             icon bg bottom
              figures
               text 'TF' 816 504 18 bold;
             end;
             implementation eq
variables	
	real TFr[6,3];
	real transTFr[3,6];
equations
	TFr[1:3,1:3] = skew([WheelRFpos[1];WheelRFpos[2];0]);
	TFr[4:6,1:3] = eye(3); 

	transTFr[1:3,1:3] = -skew([WheelRFpos[1];WheelRFpos[2];0]);
	transTFr[1:3,4:6] = eye(3); 
	
	p2.e = TFr*p1.e;
	p1.f = transTFr*p2.f;
implementation_end;
            TF_RR 1008 504
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real WheelRRpos[2,1] = [-0.215; 0.15];
             end;
             icon bg bottom
              figures
               text 'TF' 1008 504 18 bold;
             end;
             implementation eq
variables	
	real TFr[6,3];
	real transTFr[3,6];
equations
	TFr[1:3,1:3] = skew([WheelRRpos[1];WheelRRpos[2];0]);
	TFr[4:6,1:3] = eye(3); 

	transTFr[1:3,1:3] = -skew([WheelRRpos[1];WheelRRpos[2];0]);
	transTFr[1:3,4:6] = eye(3); 
	
	p2.e = TFr*p1.e;
	p1.f = transTFr*p2.f;
implementation_end;
            WheelLF 720 408
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>MecanumWheelB.emx</LibraryPath>
  <TimeStamp>2011-1-20 16:56:09</TimeStamp>
</Description>';
             type Submodel
              ports
               power in p;
               power out p2 [3,1];
              parameters
               real WheelRadius = 0.053;
             end;
             icon bg bottom
              figures
               rectangle 690 386 750 430 fill 16777152;
               text 'Mecanum 
wheel type B' 720 408;
             end;
             implementation bg
              submodels
               MotorTorgue 112 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                knot ZeroJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out effort [1];
                 restrictions
                  causality constraint one_in p;
                end;
                icon bg top
                 figures
                  text '0' 112 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
               plug p 71 176;
               plug p2 457 176;
               TF1 240 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Transforms from the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the principal inertial frame of the robot body
to the the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 240 176 18 bold;
                end;
                implementation eq
//Standard rotation arboud z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(pi/4), 	-sin(pi/4), 	0;
			sin(pi/4), 	cos(pi/4),		0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               TF2 304 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>This transformer represents the interchange of energy 
between the wheel and the floor. In the rolling direction 
there is no energy exchangem, in the siding direction there is.
In case of a type B mechanum wheel the rolling direction is 
the y direction of the frame oriented with the roller.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 304 176 18 bold;
                end;
                implementation eq
parameters
	real r[3,3] = [0, 0, 0;0, 1, 0;0, 0, 1];
equations
p2.e = transpose(r)*p1.e;
p1.f = r*p2.f;implementation_end;
               TF3 368 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Inverse of TF1: Transforms back.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 368 176 18 bold;
                end;
                implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;
			sin(-pi/4), 	cos(-pi/4),	0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               WheelRadius 152 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type TF
                 ports
                  power in p1;
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                 parameters
                  real WheelRadius = 0.053;
                end;
                icon bg bottom
                 figures
                  text 'TF' 152 176 18 bold;
                end;
                implementation eq
equations					
	p2.e = [p1.e/WheelRadius;0;0];
	p1.f = p2.f[1]/WheelRadius;
implementation_end;
              end;
              connections
               WheelRadius\p2 => TF1\p1;
               MotorTorgue\p => WheelRadius\p1;
               TF1\p2 => TF2\p1;
               TF2\p2 => TF3\p1;
               p => MotorTorgue\p;
               TF3\p2 => p2;
              end;
              parameterrelations
WheelRadius\WheelRadius = WheelRadius;parameterrelations_end;
             implementation_end;
            WheelLR 912 408
             description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>MecanumWheelA.emx</LibraryPath>
 <TimeStamp>2011-1-18 13:53:24</TimeStamp>
</Description>';
             type Submodel
              ports
               power in p;
               power out p2 [3,1];
              parameters
               real WheelRadius = 0.053;
             end;
             icon bg bottom
              figures
               rectangle 882 386 942 430 fill 16777152;
               text 'Mecanum 
wheel type A' 912 408;
             end;
             implementation bg
              submodels
               MotorTorgue1 96 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                knot ZeroJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out effort [1];
                 restrictions
                  causality constraint one_in p;
                end;
                icon bg top
                 figures
                  text '0' 96 304 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
               plug p 47 304;
               plug p2 401 304;
               TF1 200 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Transforms from the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the principal inertial frame of the robot body
to the the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 200 304 18 bold;
                end;
                implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(pi/4), 	-sin(pi/4), 	0;
			sin(pi/4), 	cos(pi/4),		0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               TF2 256 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>This transformer represents the interchange of energy 
between the wheel and the floor. In the rolling direction 
there is no energy exchangem, in the siding direction there is.
In case of a type A mechanum wheel the rolling direction is 
the x direction of the frame oriented with the roller.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 256 304 18 bold;
                end;
                implementation eq
parameters
	real r[3,3] = [1, 0, 0;0, 0, 0;0, 0, 1];
equations
p2.e = transpose(r)*p1.e;
p1.f = r*p2.f;implementation_end;
               TF3 312 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Inverse of TF1: transforms back.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 312 304 18 bold;
                end;
                implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;
			sin(-pi/4), 	cos(-pi/4),	0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               WheelRadius 144 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type TF
                 ports
                  power in p1;
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                 parameters
                  real WheelRadius = 0.053;
                end;
                icon bg bottom
                 figures
                  text 'TF' 144 304 18 bold;
                end;
                implementation eq
equations					
	p2.e = [p1.e/WheelRadius;0;0];
	p1.f = p2.f[1]/WheelRadius;
implementation_end;
              end;
              connections
               WheelRadius\p2 => TF1\p1;
               TF1\p2 => TF2\p1;
               MotorTorgue1\p => WheelRadius\p1;
               TF2\p2 => TF3\p1;
               p => MotorTorgue1\p;
               TF3\p2 => p2;
              end;
              parameterrelations
WheelRadius\WheelRadius = WheelRadius;parameterrelations_end;
             implementation_end;
            WheelRF 816 408
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>MecanumWheelA.emx</LibraryPath>
  <TimeStamp>2011-1-21 10:44:27</TimeStamp>
</Description>';
             type Submodel
              ports
               power in p;
               power out p2 [3,1];
              parameters
               real WheelRadius = 0.053;
             end;
             icon bg bottom
              figures
               rectangle 786 386 846 430 fill 16777152;
               text 'Mecanum 
wheel type A' 816 408;
             end;
             implementation bg
              submodels
               MotorTorgue1 96 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                knot ZeroJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out effort [1];
                 restrictions
                  causality constraint one_in p;
                end;
                icon bg top
                 figures
                  text '0' 96 304 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
               plug p 47 304;
               plug p2 401 304;
               TF1 200 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Transforms from the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the principal inertial frame of the robot body
to the the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 200 304 18 bold;
                end;
                implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(pi/4), 	-sin(pi/4), 	0;
			sin(pi/4), 	cos(pi/4),		0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               TF2 256 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>This transformer represents the interchange of energy 
between the wheel and the floor. In the rolling direction 
there is no energy exchangem, in the siding direction there is.
In case of a type A mechanum wheel the rolling direction is 
the x direction of the frame oriented with the roller.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 256 304 18 bold;
                end;
                implementation eq
parameters
	real r[3,3] = [1, 0, 0;0, 0, 0;0, 0, 1];
equations
p2.e = transpose(r)*p1.e;
p1.f = r*p2.f;implementation_end;
               TF3 312 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Inverse of TF1: transforms back.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 312 304 18 bold;
                end;
                implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;
			sin(-pi/4), 	cos(-pi/4),	0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               WheelRadius 144 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type TF
                 ports
                  power in p1;
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                 parameters
                  real WheelRadius = 0.053;
                end;
                icon bg bottom
                 figures
                  text 'TF' 144 304 18 bold;
                end;
                implementation eq
equations					
	p2.e = [p1.e/WheelRadius;0;0];
	p1.f = p2.f[1]/WheelRadius;
implementation_end;
              end;
              connections
               WheelRadius\p2 => TF1\p1;
               TF1\p2 => TF2\p1;
               MotorTorgue1\p => WheelRadius\p1;
               TF2\p2 => TF3\p1;
               p => MotorTorgue1\p;
               TF3\p2 => p2;
              end;
              parameterrelations
WheelRadius\WheelRadius = WheelRadius;parameterrelations_end;
             implementation_end;
            WheelRR 1008 408
             description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>MecanumWheelB.emx</LibraryPath>
 <TimeStamp>2011-1-18 13:51:59</TimeStamp>
</Description>';
             type Submodel
              ports
               power in p;
               power out p2 [3,1];
              parameters
               real WheelRadius = 0.053;
             end;
             icon bg bottom
              figures
               rectangle 978 386 1038 430 fill 16777152;
               text 'Mecanum 
wheel type B' 1008 408;
             end;
             implementation bg
              submodels
               MotorTorgue 112 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                knot ZeroJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out effort [1];
                 restrictions
                  causality constraint one_in p;
                end;
                icon bg top
                 figures
                  text '0' 112 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
               plug p 71 176;
               plug p2 457 176;
               TF1 240 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Transforms from the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the principal inertial frame of the robot body
to the the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 240 176 18 bold;
                end;
                implementation eq
//Standard rotation arboud z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(pi/4), 	-sin(pi/4), 	0;
			sin(pi/4), 	cos(pi/4),		0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               TF2 304 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>This transformer represents the interchange of energy 
between the wheel and the floor. In the rolling direction 
there is no energy exchangem, in the siding direction there is.
In case of a type B mechanum wheel the rolling direction is 
the y direction of the frame oriented with the roller.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 304 176 18 bold;
                end;
                implementation eq
parameters
	real r[3,3] = [0, 0, 0;0, 1, 0;0, 0, 1];
equations
p2.e = transpose(r)*p1.e;
p1.f = r*p2.f;implementation_end;
               TF3 368 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Inverse of TF1: Transforms back.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 368 176 18 bold;
                end;
                implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;
			sin(-pi/4), 	cos(-pi/4),	0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               WheelRadius 152 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type TF
                 ports
                  power in p1;
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                 parameters
                  real WheelRadius = 0.053;
                end;
                icon bg bottom
                 figures
                  text 'TF' 152 176 18 bold;
                end;
                implementation eq
equations					
	p2.e = [p1.e/WheelRadius;0;0];
	p1.f = p2.f[1]/WheelRadius;
implementation_end;
              end;
              connections
               WheelRadius\p2 => TF1\p1;
               MotorTorgue\p => WheelRadius\p1;
               TF1\p2 => TF2\p1;
               TF2\p2 => TF3\p1;
               p => MotorTorgue\p;
               TF3\p2 => p2;
              end;
              parameterrelations
WheelRadius\WheelRadius = WheelRadius;parameterrelations_end;
             implementation_end;
            ZeroJunction 920 704
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 920 704 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            WheelLF\p2 => TF_LF\p1;
            TF_LR\p2 => OneJunction\p;
            WheelRF\p2 => TF_RF\p1;
            WheelRR\p2 => TF_RR\p1;
            TF_LF\p2 => OneJunction\p;
            TF_RF\p2 => OneJunction\p;
            TF_RR\p2 => OneJunction\p;
            OneJunction3\p => WheelLR\p;
            ZeroJunction\p => OneJunction\p;
            Rfloor\p <= OneJunction\p;
            Cfloor\p <= OneJunction\p;
            p => ZeroJunction\p;
            p1 => ZeroJunction\p;
            MotorRR => OneJunction2\p;
            MotorLR => OneJunction3\p;
            MotorLF => OneJunction4\p;
            MotorRF => OneJunction5\p;
            WheelLR\p2 => TF_LR\p1;
            RwheelRR\p <= OneJunction2\p;
            OneJunction2\p => WheelRR\p;
            RwheelLR\p <= OneJunction3\p;
            OneJunction4\p => WheelLF\p;
            RwheelLF\p <= OneJunction4\p;
            OneJunction5\p => WheelRF\p;
            RwheelRF\p <= OneJunction5\p;
            OneJunction\flow -> Integrate2\input;
            OneJunction5\flow -> MecanumWheelAnimation\vWheelRF;
            OneJunction3\flow -> MecanumWheelAnimation\vWheelLR;
            MecanumWheelAnimation\vWheelRR <- OneJunction2\flow;
            Integrate2\output -> MatrixMul\input1;
            Hin -> MatrixMul\input2;
            MatrixMul\output -> Splitter1\input;
            Splitter1\output -> Hout;
            Splitter1\output -> MecanumWheelAnimation\Hbase0;
            OneJunction4\flow -> MecanumWheelAnimation\vWheelLF;
           end;
           parameterrelations
WheelLF\WheelRadius = WheelRadius;
WheelRF\WheelRadius = WheelRadius;
WheelLR\WheelRadius = WheelRadius;
WheelRR\WheelRadius = WheelRadius;
Integrate2\init = init;
TF_LF\WheelLFpos = WheelLFpos;
TF_RF\WheelRFpos = WheelRFpos;
TF_LR\WheelLRpos = WheelLRpos;
TF_RR\WheelRRpos = WheelRRpos;
MecanumWheelAnimation\WheelLFpos = WheelLFpos;
MecanumWheelAnimation\WheelLRpos = WheelLRpos;
MecanumWheelAnimation\WheelRFpos = WheelRFpos;
MecanumWheelAnimation\WheelRRpos = WheelRRpos;
Rfloor\Rfloor = Rfloor;
Cfloor\Cfloor = Cfloor;
RwheelLF\Rwheel = Rwheel;
RwheelRF\Rwheel = Rwheel;
RwheelLR\Rwheel = Rwheel;
RwheelRR\Rwheel = Rwheel;parameterrelations_end;
          implementation_end;
         Mux 696 193
          description '<Description>
 <Version>4.0</Version>
 <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:32:54</TimeStamp>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Submodel
           ports
            power in port [9,1];
            power out port1;
            power out port2;
            power out port3;
            power out port4;
            power out port5;
            power out port6;
            power out port7;
            power out port8;
            power out port9;
           restrictions
            causality fixed in port;
            causality fixed out port1;
            causality fixed out port2;
            causality fixed out port3;
            causality fixed out port4;
            causality fixed out port5;
            causality fixed out port6;
            causality fixed out port7;
            causality fixed out port8;
            causality fixed out port9;
          end;
          icon bg
           figures
            rectangle 616 178 776 208 fill 14013909;
            text 'Mux' 696 192 16;
           terminals
            port 696 176 fixed;
            port1 632 208 fixed;
            port2 648 208 fixed;
            port3 664 208 fixed;
            port4 680 208 fixed;
            port5 696 208 fixed;
            port6 712 208 fixed;
            port7 728 208 fixed;
            port8 744 208 fixed;
            port9 760 208 fixed;
          end;
          implementation eq
equations
	port1.e = port.e[1];
	port2.e = port.e[2];
	port3.e = port.e[3];
	port4.e = port.e[4];
	port5.e = port.e[5];
	port6.e = port.e[6];
	port7.e = port.e[7];
	port8.e = port.e[8];
	port9.e = port.e[9];
	
	port.f[1] = port1.f;
	port.f[2] = port2.f;
	port.f[3] = port3.f;
	port.f[4] = port4.f;
	port.f[5] = port5.f;
	port.f[6] = port6.f;
	port.f[7] = port7.f;
	port.f[8] = port8.f;
	port.f[9] = port9.f;implementation_end;
         plug joints 696 120;
         Tfloor0 200 464
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:35</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Sf
           ports
            power out p [6,1];
           restrictions
            causality fixed in p;
          end;
          icon bg bottom
           figures
            text 'Sf' 200 464 18 bold;
          end;
          implementation eq
parameters
	real flow = 0;
variables
	real effort[6];
equations
	p.f = flow;
	effort = p.e;
implementation_end;
         Wtip0 1240 464
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Se
           ports
            power out p [6,1];
           restrictions
            causality fixed out p;
          end;
          icon bg bottom
           figures
            text 'Se' 1240 464 18 bold;
          end;
          implementation eq
parameters
	real effort = 0;
variables
	real flow[6];
equations
	p.e = effort;
	flow = p.f;
implementation_end;
        end;
        connections
         MecanumWheels\MotorLF <= Mux\port1 256 240 632 240;
         Tfloor0\p => MecanumWheels\p1;
         Joint23\p => Link2\p1;
         Mux\port9 => Joint45\p1 760 224 1088 224;
         Joint12\p1 <= Mux\port6 608 320 712 320;
         Link4\p => Joint34\p2;
         Mux\port8 => Joint34\p1 744 240 928 240;
         Mux\port7 => Joint23\p1 728 256 768 256;
         MecanumWheels\p <= Base\p;
         Link1\p => JointBase1\p2;
         Link3\p => Joint23\p2;
         JointBase1\p => Base\p1;
         Joint12\p => Link1\p1;
         Link2\p => Joint12\p2;
         Joint45\p => Link4\p1;
         Link5\p => Joint45\p2;
         Link5\p1 <= Wtip0\p;
         Link3\p1 <= Joint34\p;
         MecanumWheels\MotorLR <= Mux\port3 288 272 664 272;
         Mux\port <= joints;
         MecanumWheels\MotorRR <= Mux\port4 304 288 680 288;
         JointBase1\p1 <= Mux\port5 448 304 696 304;
         MecanumWheels\MotorRF <= Mux\port2 272 256 648 256;
         MecanumWheels\Hout -> Base\Hin;
         Link4\Hin <- Joint34\Hout;
         Joint45\Hin <- Link4\Hout;
         Joint12\Hout -> Link2\Hin;
         Joint23\Hin <- Link2\Hout;
         Hfloor0\output -> MecanumWheels\Hin;
         Base\Hout -> JointBase1\Hin;
         JointBase1\Hout -> Link1\Hin;
         Link1\Hout -> Joint12\Hin;
         Link3\Hin <- Joint23\Hout 808 544;
         Joint34\Hin <- Link3\Hout;
         Link5\Hin <- Joint45\Hout;
         Link5\Hout -> Htip0\input;
        end;
        parameterrelations
MecanumWheels\WheelRadius = MecanumWheelRadius;
MecanumWheels\WheelLFpos = Wheelpos[1:2,1];
MecanumWheels\WheelRFpos = Wheelpos[1:2,2];
MecanumWheels\WheelLRpos = Wheelpos[1:2,3];
MecanumWheels\WheelRRpos = Wheelpos[1:2,4];
MecanumWheels\Cfloor = Cconstraint;
MecanumWheels\Rfloor = Rconstraint;
MecanumWheels\init = InitialBasePos;
MecanumWheels\Rwheel = Rwheel;

Base\I = LinkI[1:3,1];
Base\m = Linkm[1];
Base\COMdim = LinkCOMdim[1:3,1];
Base\dim = Linkdim[1:3,1];

Link1\I = LinkI[1:3,2];
Link1\m = Linkm[2];
Link1\COMdim = LinkCOMdim[1:3,2];
Link1\dim = Linkdim[1:3,2];

Link2\I = LinkI[1:3,3];
Link2\m = Linkm[3];
Link2\COMdim = LinkCOMdim[1:3,3];
Link2\dim = Linkdim[1:3,3];

Link3\I =LinkI[1:3,4];
Link3\m = Linkm[4];
Link3\COMdim = LinkCOMdim[1:3,4];
Link3\dim = Linkdim[1:3,4];

Link4\I = LinkI[1:3,5];
Link4\m = Linkm[5];
Link4\COMdim = LinkCOMdim[1:3,5];
Link4\dim = Linkdim[1:3,5];

Link5\I = LinkI[1:3,6];
Link5\m = Linkm[6];
Link5\COMdim = LinkCOMdim[1:3,6];
Link5\dim = Linkdim[1:3,6];

JointBase1\Rendstop = Rconstraint;
JointBase1\Cendstop = Cconstraint;
JointBase1\InitialPos = InitialJointPos[1];
JointBase1\MinEndstopPos = MinEndstopPos[1];
JointBase1\MaxEndstopPos = MaxEndstopPos[1];
JointBase1\Rconstraint = Rconstraint;
JointBase1\Cconstraint = Cconstraint;
JointBase1\Rjoint = Rjoint;

Joint12\Rendstop = Rconstraint;
Joint12\Cendstop = Cconstraint;
Joint12\InitialPos = InitialJointPos[2];
Joint12\MinEndstopPos = MinEndstopPos[2];
Joint12\MaxEndstopPos = MaxEndstopPos[2];
Joint12\Rconstraint = Rconstraint;
Joint12\Cconstraint = Cconstraint;
Joint12\Rjoint = Rjoint;

Joint23\Rendstop = Rconstraint;
Joint23\Cendstop = Cconstraint;
Joint23\InitialPos = InitialJointPos[3];
Joint23\MinEndstopPos = MinEndstopPos[3];
Joint23\MaxEndstopPos = MaxEndstopPos[3];
Joint23\Rconstraint = Rconstraint;
Joint23\Cconstraint = Cconstraint;
Joint23\Rjoint = Rjoint;

Joint34\Rendstop = Rconstraint;
Joint34\Cendstop = Cconstraint;
Joint34\InitialPos = InitialJointPos[4];
Joint34\MinEndstopPos = MinEndstopPos[4];
Joint34\MaxEndstopPos = MaxEndstopPos[4];
Joint34\Rconstraint = Rconstraint;
Joint34\Cconstraint = Cconstraint;
Joint34\Rjoint = Rjoint;

Joint45\Rendstop = Rconstraint;
Joint45\Cendstop = Cconstraint;
Joint45\InitialPos = InitialJointPos[5];
Joint45\MinEndstopPos = MinEndstopPos[5];
Joint45\MaxEndstopPos = MaxEndstopPos[5];
Joint45\Rconstraint = Rconstraint;
Joint45\Cconstraint = Cconstraint;
Joint45\Rjoint = Rjoint;

parameterrelations_end;
       implementation_end;
      ObserverBreakC 744 1224
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type C
        ports
         power in p [9,1];
         signal out state [9,1];
        restrictions
         causality preferred out p;
        parameters
         real Cbreaks = 1.0e-4;
       end;
       icon bg bottom
        figures
         text 'C' 744 1224 18 bold;
       end;
       implementation eq
equations
    state = int(p.f);
    p.e = state / Cbreaks;
implementation_end;
      ObserverBreakR 696 1184
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type R
        ports
         power in p [9,1];
        parameters
         real Rbreaks = 10000.0;
       end;
       icon bg bottom
        figures
         text 'R' 696 1184 18 bold;
       end;
       implementation eq
equations					
	p.e = Rbreaks * p.f;
implementation_end;
      OneJunction 616 1096
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none p [9,1];
         signal knot out flow [9,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 616 1096 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
      OneJunction1 712 1000
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none p [9,1];
         signal knot out flow [9,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 712 1000 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
      OneJunction10 616 920
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none p [9,1];
         signal knot out flow [9,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 616 920 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
      OneJunction11 616 864
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none p [9,1];
         signal knot out flow [9,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 616 864 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
      OneJunction12 464 400
       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none p [8,1];
         signal knot out flow [8,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 464 400 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
      OneJunction2 464 152
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none p [6,1];
         signal knot out flow [6,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 464 152 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
      OneJunction3 464 328
       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none p [8,1];
         signal knot out flow [8,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 464 328 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
      OneJunction4 744 1184
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none p [9,1];
         signal knot out flow [9,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 744 1184 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
      OneJunction5 744 584
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none p [9,1];
         signal knot out flow [9,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 744 584 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
      OneJunction6 792 704
       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         rotation knot duplicatable none p [9,1];
         signal knot out flow [9,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 792 704 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
      OneJunction8 616 704
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         rotation knot duplicatable none p [9,1];
         signal knot out flow [9,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 616 704 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
      OneJunction9 792 1096
       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
       knot OneJunction
        ports
         power knot duplicatable none p [9,1];
         signal knot out flow [9,1];
        restrictions
         causality constraint one_out p;
       end;
       icon bg
        figures
         text '1' 792 1096 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
      Plant 912 704
       description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>youBot.emx</LibraryPath>
  <TimeStamp>2011-1-21 10:28:22</TimeStamp>
</Description>';
       type Submodel
        ports
         power in joints [9,1];
        parameters
         real Rconstraint = 1000.0;
         real Cconstraint = 1.0e-4;
         real Rjoint = 1.0;
         real InitialJointPos[5,1] = [0.0; 0.0; 0.0; 0.0; 0.0];
         real InitialBasePos[4,4] = [1.0, 0.0, 0.0, 0.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];
         real LinkI[3,6] = [20.0, 1.0, 1.0, 1.0, 1.0, 1.0; 20.0, 1.0, 1.0, 1.0, 1.0, 1.0; 20.0, 1.0, 1.0, 1.0, 1.0, 1.0];
         real LinkCOMdim[3,6] = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0375, 0.0775, 0.0675, 0.0405, 0.0685];
         real Linkdim[3,6] = [0.115, 0.0, 0.0, 0.0, 0.0, 0.0; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0; 0.08, 0.075, 0.155, 0.135, 0.081, 0.137];
         real Linkm[6,1] = [20.0; 1.0; 1.0; 1.0; 1.0; 1.0];
         real MinEndstopPos[5,1] = [-2.95; -1.13; -2.64; -1.79; -2.92];
         real MaxEndstopPos[5,1] = [2.95; 1.57; 2.55; 1.79; 2.92];
         real Wheelpos[2,4] = [0.215, 0.215, -0.215, -0.215; -0.15, 0.15, -0.15, 0.15]; "[1:2,1] = LF, [1:2,2] = RF, [1:2,3] = LR, [1:2,4] = RR "
         real MecanumWheelRadius = 0.053;
         real Rwheel = 0.1;
       end;
       icon bg bottom
        figures
         rectangle 875 682 949 726 fill 11206638;
         text 'youBot' 912 704 16;
       end;
       implementation bg
        submodels
         Base 368 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Link.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:36:40</TimeStamp>
<Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real I[3,1] = [20.0; 20.0; 20.0];
            real m = 20.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0];
            real dim[3,1] = [0.115; 0.0; 0.08];
          end;
          icon bg bottom
           figures
            rectangle 336 432 400 576 fill 10025880;
            text 'Link' 368 504;
           terminals
            p 336 464 fixed;
            Hin 336 544 fixed;
            p1 400 464 fixed;
            Hout 400 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik 664 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0];
             end;
             icon bg left
              figures
               text 'TF' 664 224 18 bold;
             end;
             implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            EJS 728 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MGY
              ports
               power in p1 [6,1];
              parameters
               real I[3,1] = [20.0; 20.0; 20.0];
               real m = 20.0;
             end;
             icon bg top
              figures
               text 'MGY' 728 184 18 bold;
             end;
             implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 20.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.115; 0.0; 0.08];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            InertialTensor 616 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type I
              ports
               power in p [6,1];
               signal out state [6,1];
              restrictions
               causality preferred in p;
              parameters
               real m = 1.0;
               real I[3,1] = [20.0; 20.0; 20.0];
             end;
             icon bg top
              figures
               text 'I' 616 184 18 bold;
             end;
             implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
            plug Hout 896 496;
            plug p1 904 304;
            plug Hin 592 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0k 664 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg top
              figures
               text '1' 664 184 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            AdHik\p2 => Ta0k\p;
            Ta0k\p => EJS\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Ta0k\p => InertialTensor\p;
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            Ta0i\p => AdHik\p1;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
          implementation_end;
         Hfloor0 208 544
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\Constant.emx</LibraryPath>
 <TimeStamp>2007-10-19 14:48:44</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Constant
           ports
            signal out output [4,4];
          end;
          icon bg bottom
           figures
            rectangle 192.1 528 223.9 560 fill 15132390;
            line 196.9 539.6 218.9 539.6 color 16711680 width 2;
            line 194.2 550.7 219.9 550.7;
            line 196.5 534.7 196.5 553;
          end;
          implementation eq
equations
	output = eye(4);
     implementation_end;
         Htip0 1248 544
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\SignalMonitor.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:14:4</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type SignalMonitor
           ports
            signal in input [4,4];
          end;
          icon bg bottom
           figures
            rectangle 1232 528 1264 560 fill 15132390;
            rectangle 1237.7 533.8 1258.3 554.6 color 16711680 fill 11776947 width 2;
            rectangle 1239.8 536.4 1255.9 552 color -1 fill 16777215;
            line 1241.9 538.7 1241.9 550 fill 16777215;
            line 1240 548.4 1252.5 548.4 fill 16777215;
            line 1241.5 548.1 1254.4 541.7 color 255 fill 16777215;
          end;
          implementation eq

   implementation_end;
         Joint12 608.2 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Joint-roty.emx</LibraryPath>
  <TimeStamp>2011-1-18 17:30:05</TimeStamp>
</Description>';
          type 'Submodel-roty'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real Rconstraint = 1000.0;
            real Cconstraint = 1.0e-4;
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = 0.0;
            real MaxEndstopPos = 1.57;
            real MinEndstopPos = -1.13;
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            rectangle 576.4 432 639.9 576 fill 14745599;
            text 'Joint-roty' 608.4 507 fill 14745599;
           terminals
            p 575.9 464 fixed;
            p1 607.4 432 fixed;
            p2 639.9 464 fixed;
            Hin 575.9 544 fixed;
            Hout 639.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            EndstopMax 471 217
             description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Rendstop = 1000.0;
               real Cendstop = 1.0e-4;
               real InitialPos = 0.0;
               real EndstopPos = 1.57;
             end;
             icon bg bottom
              figures
               rectangle 422 194 520 240 fill 14013909;
               text 'EndstopMax' 472 216 16;
              terminals
               p2 472 240 fixed;
             end;
             implementation bg
              submodels
               Cendstop 704 144
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 704 144 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 704 216
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out Collision;
                 restrictions
                  causality fixed in p12;
                  causality fixed out p2;
                  causality fixed out p1;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopPos = 1.57;
                end;
                icon bg
                 figures
                  text 'X0e' 704 216 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug Collision 408 192;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     mechanical in p1;
                     mechanical out p2;
                     mechanical out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 1.57;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> Collision;
                 end;
                 parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 648 216;
               plug collision 800 216;
               OneJunction5 704 176
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 704 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 736 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 736 176 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf1 704 264
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 704 264 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               OneJunction5\p => Cendstop\p;
               Collision\p12 => OneJunction5\p;
               Sf1\p => Collision\p1;
               OneJunction5\p => Rendstop\p;
               Collision\p2 => p2;
               Collision\Collision -> collision;
              end;
              parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
             implementation_end;
            EndstopMin 312 216
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 14:37:57</TimeStamp>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Cendstop = 1.0e-4;
               real Rendstop = 1000.0;
               real InitialPos = 0.0;
               real EndstopPos = -1.13;
             end;
             icon bg bottom
              figures
               rectangle 263 193 361 239 fill 14013909;
               text 'EndstopMin' 313 215 16;
             end;
             implementation bg
              submodels
               Cendstop 248 208
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 248 208 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 248 120
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out collision;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopLocation = -1.13;
                end;
                icon bg
                 figures
                  text 'X0e' 248 120 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug collision 400 200;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     power in p1;
                     power out p2;
                     power out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = -1.13;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> collision;
                 end;
                 parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 152 120;
               plug collision 360 120;
               OneJunction 248 160
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 248 160 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 288 160
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 288 160 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf2 248 64
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 248 64 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               Collision\p12 => OneJunction\p;
               OneJunction\p => Rendstop\p;
               OneJunction\p => Cendstop\p;
               Sf2\p => Collision\p1;
               Collision\p2 => p2;
               Collision\collision -> collision;
              end;
              parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
             implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 496
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 480 335.9 512 fill 15132390;
               text 'X' 320 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 56;
            plug p2 496 424;
            plug Hin 112 496;
            plug Hout 504 496;
            plug p 112 424;
            OneJunction 240 272
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 272 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Or 392 216
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
             type 'Or-Or'
              ports
               signal boolean in input1;
               signal boolean out output;
               signal boolean in input2;
             end;
             icon bg bottom
              figures
               rectangle 376.1 200 407.9 232 fill 15132390;
               group
                line 378.3 209.3 388.8 209.3 color 16711680 fill 16711680;
                line 378.3 223.1 388.8 223.1 color 16711680 fill 16711680;
               end;
               spline 387.9 204.8 389.9 216.5 387.9 227.7 color 16711680 fill 16711680;
               line 396.7 216 405.5 216 color 16711680 fill 16711680;
               spline 387.7 204.3 393.9 206.6 396.8 216.4 393.6 225.4 387.7 227.7 color 16711680 fill 15132390;
             end;
             implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
            Rjoint 192 272
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rjoint = 1.0;
             end;
             icon bg bottom
              figures
               text 'R' 192 272 18 bold;
             end;
             implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Tbai 240 384
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg left
              figures
               text '1' 240 384 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            uTbai 240 328
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real Rconstraint = 1000.0;
               real Cconstraint = 1.0e-4;
             end;
             icon bg left
              figures
               text 'TF' 240 328 18 bold;
             end;
             implementation eq
equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = p1.e;
	p2.e[3] = (Rconstraint*-p2.f[3] + int(-p2.f[3])/Cconstraint);
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[2];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            p1 => ZeroJunction\p;
            OneJunction\p => uTbai\p1;
            Wbai\p <= AdHji\p1;
            OneJunction\p <= EndstopMin\p2;
            p2 => AdHji\p2;
            OneJunction\p <= EndstopMax\p2;
            OneJunction\p => Rjoint\p;
            uTbai\p2 => Tbai\p;
            Tbai\p => Wbai\p;
            p <= Wbai\p;
            ZeroJunction\p => OneJunction\p;
            EndstopMin\collision -> Or\input2;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            EndstopMax\collision -> Or\input1;
            OneJunction\flow -> Integrate\input 320 272;
            Splitter2\output -> AdHji\H 424 368;
           end;
           parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
          implementation_end;
         Joint23 768.2 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-roty.emx</LibraryPath>
 <TimeStamp>2011-1-18 17:30:05</TimeStamp>
</Description>';
          type 'Submodel-roty'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real Rconstraint = 1000.0;
            real Cconstraint = 1.0e-4;
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = 0.0;
            real MaxEndstopPos = 2.55;
            real MinEndstopPos = -2.64;
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            rectangle 736.4 432 799.9 576 fill 14745599;
            text 'Joint-roty' 768.4 507 fill 14745599;
           terminals
            p 735.9 464 fixed;
            p1 767.4 432 fixed;
            p2 799.9 464 fixed;
            Hin 735.9 544 fixed;
            Hout 799.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            EndstopMax 471 217
             description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Rendstop = 1000.0;
               real Cendstop = 1.0e-4;
               real InitialPos = 0.0;
               real EndstopPos = 2.55;
             end;
             icon bg bottom
              figures
               rectangle 422 194 520 240 fill 14013909;
               text 'EndstopMax' 472 216 16;
              terminals
               p2 472 240 fixed;
             end;
             implementation bg
              submodels
               Cendstop 704 144
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 704 144 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 704 216
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out Collision;
                 restrictions
                  causality fixed in p12;
                  causality fixed out p2;
                  causality fixed out p1;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopPos = 2.55;
                end;
                icon bg
                 figures
                  text 'X0e' 704 216 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug Collision 408 192;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     mechanical in p1;
                     mechanical out p2;
                     mechanical out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 2.55;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> Collision;
                 end;
                 parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 648 216;
               plug collision 800 216;
               OneJunction5 704 176
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 704 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 736 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 736 176 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf1 704 264
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 704 264 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               OneJunction5\p => Cendstop\p;
               Collision\p12 => OneJunction5\p;
               Sf1\p => Collision\p1;
               OneJunction5\p => Rendstop\p;
               Collision\p2 => p2;
               Collision\Collision -> collision;
              end;
              parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
             implementation_end;
            EndstopMin 312 216
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 14:37:57</TimeStamp>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Cendstop = 1.0e-4;
               real Rendstop = 1000.0;
               real InitialPos = 0.0;
               real EndstopPos = -2.64;
             end;
             icon bg bottom
              figures
               rectangle 263 193 361 239 fill 14013909;
               text 'EndstopMin' 313 215 16;
             end;
             implementation bg
              submodels
               Cendstop 248 208
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 248 208 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 248 120
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out collision;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopLocation = -2.64;
                end;
                icon bg
                 figures
                  text 'X0e' 248 120 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug collision 400 200;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     power in p1;
                     power out p2;
                     power out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = -2.64;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> collision;
                 end;
                 parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 152 120;
               plug collision 360 120;
               OneJunction 248 160
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 248 160 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 288 160
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 288 160 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf2 248 64
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 248 64 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               Collision\p12 => OneJunction\p;
               OneJunction\p => Rendstop\p;
               OneJunction\p => Cendstop\p;
               Sf2\p => Collision\p1;
               Collision\p2 => p2;
               Collision\collision -> collision;
              end;
              parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
             implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 496
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 480 335.9 512 fill 15132390;
               text 'X' 320 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 56;
            plug p2 496 424;
            plug Hin 112 496;
            plug Hout 504 496;
            plug p 112 424;
            OneJunction 240 272
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 272 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Or 392 216
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
             type 'Or-Or'
              ports
               signal boolean in input1;
               signal boolean out output;
               signal boolean in input2;
             end;
             icon bg bottom
              figures
               rectangle 376.1 200 407.9 232 fill 15132390;
               group
                line 378.3 209.3 388.8 209.3 color 16711680 fill 16711680;
                line 378.3 223.1 388.8 223.1 color 16711680 fill 16711680;
               end;
               spline 387.9 204.8 389.9 216.5 387.9 227.7 color 16711680 fill 16711680;
               line 396.7 216 405.5 216 color 16711680 fill 16711680;
               spline 387.7 204.3 393.9 206.6 396.8 216.4 393.6 225.4 387.7 227.7 color 16711680 fill 15132390;
             end;
             implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
            Rjoint 192 272
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rjoint = 1.0;
             end;
             icon bg bottom
              figures
               text 'R' 192 272 18 bold;
             end;
             implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Tbai 240 384
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg left
              figures
               text '1' 240 384 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            uTbai 240 328
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real Rconstraint = 1000.0;
               real Cconstraint = 1.0e-4;
             end;
             icon bg left
              figures
               text 'TF' 240 328 18 bold;
             end;
             implementation eq
equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = p1.e;
	p2.e[3] = (Rconstraint*-p2.f[3] + int(-p2.f[3])/Cconstraint);
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[2];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            p1 => ZeroJunction\p;
            p <= Wbai\p;
            ZeroJunction\p => OneJunction\p;
            OneJunction\p => uTbai\p1;
            Wbai\p <= AdHji\p1;
            OneJunction\p <= EndstopMin\p2;
            p2 => AdHji\p2;
            OneJunction\p <= EndstopMax\p2;
            OneJunction\p => Rjoint\p;
            uTbai\p2 => Tbai\p;
            Tbai\p => Wbai\p;
            EndstopMin\collision -> Or\input2;
            Splitter2\output -> AdHji\H 424 368;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            EndstopMax\collision -> Or\input1;
            OneJunction\flow -> Integrate\input 320 272;
           end;
           parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
          implementation_end;
         Joint34 928.2 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-roty.emx</LibraryPath>
 <TimeStamp>2011-1-18 17:30:05</TimeStamp>
</Description>';
          type 'Submodel-roty'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real Rconstraint = 1000.0;
            real Cconstraint = 1.0e-4;
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = 0.0;
            real MaxEndstopPos = 1.79;
            real MinEndstopPos = -1.79;
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            rectangle 896.4 432 959.9 576 fill 14745599;
            text 'Joint-roty' 928.4 507 fill 14745599;
           terminals
            p 895.9 464 fixed;
            p1 927.4 432 fixed;
            p2 959.9 464 fixed;
            Hin 895.9 544 fixed;
            Hout 959.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            EndstopMax 471 217
             description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Rendstop = 1000.0;
               real Cendstop = 1.0e-4;
               real InitialPos = 0.0;
               real EndstopPos = 1.79;
             end;
             icon bg bottom
              figures
               rectangle 422 194 520 240 fill 14013909;
               text 'EndstopMax' 472 216 16;
              terminals
               p2 472 240 fixed;
             end;
             implementation bg
              submodels
               Cendstop 704 144
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 704 144 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 704 216
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out Collision;
                 restrictions
                  causality fixed in p12;
                  causality fixed out p2;
                  causality fixed out p1;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopPos = 1.79;
                end;
                icon bg
                 figures
                  text 'X0e' 704 216 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug Collision 408 192;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     mechanical in p1;
                     mechanical out p2;
                     mechanical out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 1.79;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> Collision;
                 end;
                 parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 648 216;
               plug collision 800 216;
               OneJunction5 704 176
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 704 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 736 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 736 176 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf1 704 264
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 704 264 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               OneJunction5\p => Cendstop\p;
               Collision\p12 => OneJunction5\p;
               Sf1\p => Collision\p1;
               OneJunction5\p => Rendstop\p;
               Collision\p2 => p2;
               Collision\Collision -> collision;
              end;
              parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
             implementation_end;
            EndstopMin 312 216
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 14:37:57</TimeStamp>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Cendstop = 1.0e-4;
               real Rendstop = 1000.0;
               real InitialPos = 0.0;
               real EndstopPos = -1.79;
             end;
             icon bg bottom
              figures
               rectangle 263 193 361 239 fill 14013909;
               text 'EndstopMin' 313 215 16;
             end;
             implementation bg
              submodels
               Cendstop 248 208
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 248 208 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 248 120
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out collision;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopLocation = -1.79;
                end;
                icon bg
                 figures
                  text 'X0e' 248 120 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug collision 400 200;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     power in p1;
                     power out p2;
                     power out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = -1.79;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> collision;
                 end;
                 parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 152 120;
               plug collision 360 120;
               OneJunction 248 160
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 248 160 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 288 160
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 288 160 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf2 248 64
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 248 64 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               Collision\p12 => OneJunction\p;
               OneJunction\p => Rendstop\p;
               OneJunction\p => Cendstop\p;
               Sf2\p => Collision\p1;
               Collision\p2 => p2;
               Collision\collision -> collision;
              end;
              parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
             implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	0,	sin(q);
			0,				1,	0;
			-sin(q),	0,	cos(q)];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 496
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 480 335.9 512 fill 15132390;
               text 'X' 320 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 56;
            plug p2 496 424;
            plug Hin 112 496;
            plug Hout 504 496;
            plug p 112 424;
            OneJunction 240 272
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 272 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Or 392 216
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
             type 'Or-Or'
              ports
               signal boolean in input1;
               signal boolean out output;
               signal boolean in input2;
             end;
             icon bg bottom
              figures
               rectangle 376.1 200 407.9 232 fill 15132390;
               group
                line 378.3 209.3 388.8 209.3 color 16711680 fill 16711680;
                line 378.3 223.1 388.8 223.1 color 16711680 fill 16711680;
               end;
               spline 387.9 204.8 389.9 216.5 387.9 227.7 color 16711680 fill 16711680;
               line 396.7 216 405.5 216 color 16711680 fill 16711680;
               spline 387.7 204.3 393.9 206.6 396.8 216.4 393.6 225.4 387.7 227.7 color 16711680 fill 15132390;
             end;
             implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
            Rjoint 192 272
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rjoint = 1.0;
             end;
             icon bg bottom
              figures
               text 'R' 192 272 18 bold;
             end;
             implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Tbai 240 384
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg left
              figures
               text '1' 240 384 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            uTbai 240 328
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real Rconstraint = 1000.0;
               real Cconstraint = 1.0e-4;
             end;
             icon bg left
              figures
               text 'TF' 240 328 18 bold;
             end;
             implementation eq
equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = p1.e;
	p2.e[3] = (Rconstraint*-p2.f[3] + int(-p2.f[3])/Cconstraint);
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[2];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            p1 => ZeroJunction\p;
            OneJunction\p <= EndstopMin\p2;
            p2 => AdHji\p2;
            OneJunction\p <= EndstopMax\p2;
            OneJunction\p => Rjoint\p;
            uTbai\p2 => Tbai\p;
            Tbai\p => Wbai\p;
            p <= Wbai\p;
            ZeroJunction\p => OneJunction\p;
            OneJunction\p => uTbai\p1;
            Wbai\p <= AdHji\p1;
            EndstopMin\collision -> Or\input2;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            EndstopMax\collision -> Or\input1;
            OneJunction\flow -> Integrate\input 320 272;
            Splitter2\output -> AdHji\H 424 368;
            MatrixMul\output -> Hout;
           end;
           parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 744 400;
          implementation_end;
         Joint45 1088.2 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Joint-rotz.emx</LibraryPath>
 <TimeStamp>2011-1-18 17:30:00</TimeStamp>
</Description>';
          type 'Submodel-rotz'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = 0.0;
            real MinEndstopPos = -2.92;
            real MaxEndstopPos = 2.92;
            real Rconstraint = 1000.0;
            real Cconstraint = 1.0e-4;
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            rectangle 1056.4 432 1119.9 576 fill 14745599;
            text 'Joint-rotz' 1088.4 507 fill 14745599;
           terminals
            p 1055.9 464 fixed;
            p1 1087.4 432 fixed;
            p2 1119.9 464 fixed;
            Hin 1055.9 544 fixed;
            Hout 1119.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            EndstopMax 479 225
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMax.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:54:54</TimeStamp>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Rendstop = 1000.0;
               real Cendstop = 1.0e-4;
               real InitialPos = 0.0;
               real EndstopPos = 2.92;
             end;
             icon bg bottom
              figures
               rectangle 430 202 528 248 fill 14013909;
               text 'EndstopMax' 480 224 16;
              terminals
               p2 480 248 fixed;
             end;
             implementation bg
              submodels
               Cendstop 704 144
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 704 144 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 704 216
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out Collision;
                 restrictions
                  causality fixed out p2;
                  causality fixed out p1;
                  causality fixed in p12;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopPos = 2.92;
                end;
                icon bg
                 figures
                  text 'X0e' 704 216 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug Collision 408 192;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     mechanical in p1;
                     mechanical out p2;
                     mechanical out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 2.92;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> Collision;
                 end;
                 parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 648 216;
               plug collision 800 216;
               OneJunction5 704 176
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 704 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 736 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 736 176 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf1 704 264
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 704 264 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               OneJunction5\p => Cendstop\p;
               Collision\p12 => OneJunction5\p;
               Sf1\p => Collision\p1;
               OneJunction5\p => Rendstop\p;
               Collision\p2 => p2;
               Collision\Collision -> collision;
              end;
              parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
             implementation_end;
            EndstopMin 320 224
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:54:44</TimeStamp>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Cendstop = 1.0e-4;
               real Rendstop = 1000.0;
               real InitialPos = 0.0;
               real EndstopPos = -2.92;
             end;
             icon bg bottom
              figures
               rectangle 271 201 369 247 fill 14013909;
               text 'EndstopMin' 321 223 16;
             end;
             implementation bg
              submodels
               Cendstop 248 208
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 248 208 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 248 120
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out collision;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopLocation = -2.92;
                end;
                icon bg
                 figures
                  text 'X0e' 248 120 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug collision 400 200;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     power in p1;
                     power out p2;
                     power out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = -2.92;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> collision;
                 end;
                 parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 152 120;
               plug collision 360 120;
               OneJunction 248 160
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 248 160 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 288 160
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 288 160 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf2 248 64
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 248 64 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               Collision\p12 => OneJunction\p;
               OneJunction\p => Rendstop\p;
               OneJunction\p => Cendstop\p;
               Sf2\p => Collision\p1;
               Collision\p2 => p2;
               Collision\collision -> collision;
              end;
              parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
             implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	-sin(q),	0;
			sin(q),	cos(q),	0;
			0,				0,				1];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 576
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 560 335.9 592 fill 15132390;
               text 'X' 320 576 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 40;
            plug p2 496 424;
            plug Hin 112 576;
            plug Hout 504 576;
            plug p 112 424;
            OneJunction 240 288
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 288 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Or 400 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
             type 'Or-Or'
              ports
               signal boolean in input1;
               signal boolean out output;
               signal boolean in input2;
             end;
             icon bg bottom
              figures
               rectangle 384.1 208 415.9 240 fill 15132390;
               group
                line 386.3 217.3 396.8 217.3 color 16711680 fill 16711680;
                line 386.3 231.1 396.8 231.1 color 16711680 fill 16711680;
               end;
               spline 395.9 212.8 397.9 224.5 395.9 235.7 color 16711680 fill 16711680;
               line 404.7 224 413.5 224 color 16711680 fill 16711680;
               spline 395.7 212.3 401.9 214.6 404.8 224.4 401.6 233.4 395.7 235.7 color 16711680 fill 15132390;
             end;
             implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
            Rjoint 168 288
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rjoint = 1.0;
             end;
             icon bg bottom
              figures
               text 'R' 168 288 18 bold;
             end;
             implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            uTbai 240 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
               causality fixed in p1;
               causality fixed out p2;
              parameters
               real Cconstraint = 1.0e-4;
               real Rconstraint = 1000.0;
             end;
             icon bg left
              figures
               text 'TF' 240 336 18 bold;
             end;
             implementation eq

equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = (Rconstraint*-p2.f[2] + int(-p2.f[2])/Cconstraint);
	p2.e[3] = p1.e;
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[3];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            uTbai\p1 <= OneJunction\p;
            Rjoint\p <= OneJunction\p;
            ZeroJunction\p => OneJunction\p;
            p1 => ZeroJunction\p;
            uTbai\p2 => Wbai\p;
            p <= Wbai\p;
            OneJunction\p <= EndstopMin\p2;
            Wbai\p <= AdHji\p1;
            p2 => AdHji\p2;
            OneJunction\p <= EndstopMax\p2;
            OneJunction\flow -> Integrate\input 288 336;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            EndstopMin\collision -> Or\input2;
            EndstopMax\collision -> Or\input1;
            Splitter2\output -> AdHji\H 424 368;
            MatrixMul\output -> Hout;
           end;
           parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;

parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 680 488;
          implementation_end;
         JointBase1 448.2 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Joint-rotz.emx</LibraryPath>
  <TimeStamp>2011-1-21 10:08:41</TimeStamp>
</Description>';
          type 'Submodel-rotz'
           ports
            power out p [6,1];
            power in p1;
            power in p2 [6,1];
            signal in Hin [4,4];
            signal out Hout [4,4];
           parameters
            real Rendstop = 1000.0;
            real Cendstop = 1.0e-4;
            real InitialPos = 0.0;
            real MinEndstopPos = -2.95;
            real MaxEndstopPos = 2.95;
            real Rconstraint = 1000.0;
            real Cconstraint = 1.0e-4;
            real Rjoint = 1.0;
          end;
          icon bg bottom
           figures
            rectangle 416.4 432 479.9 576 fill 14745599;
            text 'Joint-rotz' 448.4 507 fill 14745599;
           terminals
            p 415.9 464 fixed;
            p1 447.4 432 fixed;
            p2 479.9 464 fixed;
            Hin 415.9 544 fixed;
            Hout 479.9 544 fixed;
          end;
          implementation bg
           submodels
            AdHji 424 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg bottom
              figures
               text 'MTF' 424 424 18 bold;
             end;
             implementation eq
equations					
	p2.e = transpose(Adjoint(H)) * p1.e;
	p1.f = Adjoint(H) * p2.f;implementation_end;
            EndstopMax 479 225
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMax.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:54:54</TimeStamp>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Rendstop = 1000.0;
               real Cendstop = 1.0e-4;
               real InitialPos = 0.0;
               real EndstopPos = 2.95;
             end;
             icon bg bottom
              figures
               rectangle 430 202 528 248 fill 14013909;
               text 'EndstopMax' 480 224 16;
              terminals
               p2 480 248 fixed;
             end;
             implementation bg
              submodels
               Cendstop 704 144
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 704 144 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 704 216
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out Collision;
                 restrictions
                  causality fixed out p2;
                  causality fixed out p1;
                  causality fixed in p12;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopPos = 2.95;
                end;
                icon bg
                 figures
                  text 'X0e' 704 216 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  < 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug Collision 408 192;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     mechanical in p1;
                     mechanical out p2;
                     mechanical out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 2.95;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> Collision;
                 end;
                 parameterrelations
x1\Initial = EndstopPos;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 648 216;
               plug collision 800 216;
               OneJunction5 704 176
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  mechanical knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 704 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 736 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 736 176 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf1 704 264
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 704 264 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               OneJunction5\p => Cendstop\p;
               Collision\p12 => OneJunction5\p;
               Sf1\p => Collision\p1;
               OneJunction5\p => Rendstop\p;
               Collision\p2 => p2;
               Collision\Collision -> collision;
              end;
              parameterrelations
Collision\InitialPos = InitialPos;
Collision\EndstopPos = EndstopPos;
Rendstop\Rendstop = Rendstop;
Cendstop\Cendstop = Cendstop;parameterrelations_end;
             implementation_end;
            EndstopMin 320 224
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>EndstopMin.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:54:44</TimeStamp>
</Description>';
             type Submodel
              ports
               power out p2;
               signal boolean out collision;
              parameters
               real Cendstop = 1.0e-4;
               real Rendstop = 1000.0;
               real InitialPos = 0.0;
               real EndstopPos = -2.95;
             end;
             icon bg bottom
              figures
               rectangle 271 201 369 247 fill 14013909;
               text 'EndstopMin' 321 223 16;
             end;
             implementation bg
              submodels
               Cendstop 248 208
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type C
                 ports
                  power in p;
                  signal out state;
                 restrictions
                  causality preferred out p;
                 parameters
                  real Cendstop = 1.0e-4;
                end;
                icon bg right
                 figures
                  text 'C' 248 208 18 bold;
                end;
                implementation eq
equations
    state = int(p.f);
    p.e = state / Cendstop;
implementation_end;
               Collision 248 120
                description '<Description>
 <Version>No Version Info</Version>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type X0e
                 ports
                  power in p1;
                  power out p2;
                  power out p12;
                  signal boolean out collision;
                 restrictions
                  causality fixed out p1;
                  causality fixed out p2;
                  causality fixed in p12;
                 parameters
                  real InitialPos = 0.0;
                  real EndstopLocation = -2.95;
                end;
                icon bg
                 figures
                  text 'X0e' 248 120 18 bold;
                end;
                implementation bg
                 submodels
                  Condition1 224.9 231.5
                   type Condition
                    ports
                     signal in dx;
                     signal boolean out contact;
                   end;
                   icon bg
                    figures
                     rectangle 197.2 215 252.6 248 fill 15132390;
                     text 'Condition' 224 231.5;
                    terminals
                     dx 224 248 fixed;
                     contact 224 215 fixed;
                   end;
                   implementation eq
parameters
	real global epsilon;
variables
	boolean bounce;
equations
	contact = if dx - epsilon  > 0 then true else false end;
	bounce = event (dx - epsilon);implementation_end;
                  plug p1 96 176;
                  plug p2 352 176;
                  plug p12 224 64;
                  plug collision 400 200;
                  Splitter1 224 200
                   description '<Description><Version>4.0</Version>
   <LibraryPath>C:\Program Files\20-sim 4.0\System\SplitterBoolean.emx</LibraryPath>
  <TimeStamp>2007-10-31 11:27:48</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot Splitter
                    ports
                     signal knot boolean duplicatable out output [1];
                     signal knot boolean in input [1];
                   end;
                   icon bg ellipse
                    figures
                     ellipse 220.8 196.8 227.2 203.2 color -1 fill 0;
                     ellipse 219.7 195.7 228.3 204.3 color -1;
                    terminals
                     input 224 200 fixed;
                   end;
                   implementation eq
equations
    collect (output) = input;
implementation_end;
                  v1 160 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 160 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v12 224 120
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg right
                    figures
                     text '1' 224 120 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  v2 296 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot OneJunction
                    ports
                     mechanical knot duplicatable none p [1];
                     signal knot out flow [1];
                    restrictions
                     causality constraint one_out p;
                   end;
                   icon bg top
                    figures
                     text '1' 296 176 18 bold;
                   end;
                   implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
  implementation_end;
                  X0 224 176
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type X0
                    ports
                     power in p1;
                     power out p2;
                     power out p12;
                     signal boolean in condition;
                    restrictions
                     causality fixed out p1;
                     causality fixed out p2;
                     causality fixed in p12;
                   end;
                   icon bg
                    figures
                     text 'X0' 224 176 color 8388608 18 bold;
                   end;
                   implementation eq
equations
	p1.e = if condition then p12.e else 0 end;
	p2.e = p1.e;
	p12.f = if condition then p1.f-p2.f else 0 end;
 implementation_end;
                  x1 160 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = -2.95;
                   end;
                   icon bg left
                    figures
                     rectangle 145 289 175 319 fill 15132390;
                     text 'ò' 157.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                  x12 224 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   knot PlusMinus
                    ports
                     signal knot duplicatable in plus [1];
                     signal knot duplicatable in minus [1];
                     signal knot out output [1];
                   end;
                   icon bg ellipse bottom
                    figures
                     ellipse 216.5 296.5 231.5 311.5 fill 16777215;
                   end;
                   implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
                  x2 296 304
                   description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
                   type Integrate
                    ports
                     signal in input;
                     signal out output;
                    parameters
                     real Initial = 0.0;
                   end;
                   icon bg right
                    figures
                     rectangle 281 289 311 319 fill 15132390;
                     text 'ò' 293.5 304 color 16711680 'SymbolProp BT' 21 symbol;
                   end;
                   implementation eq
equations
	output = int (input, Initial);
     implementation_end;
                 end;
                 connections
                  v1\p => X0\p1;
                  X0\p2 => v2\p;
                  X0\p12 => v12\p;
                  v2\p => p2;
                  v12\p => p12;
                  p1 => v1\p;
                  v1\flow -> x1\input;
                  x1\output -> x12\plus;
                  v2\flow -> x2\input;
                  x2\output -> x12\minus;
                  x12\output -> Condition1\dx;
                  Condition1\contact -> Splitter1\input;
                  Splitter1\output -> X0\condition;
                  Splitter1\output -> collision;
                 end;
                 parameterrelations
x1\Initial = EndstopLocation;
x2\Initial = InitialPos;parameterrelations_end;
                implementation_end;
               plug p2 152 120;
               plug collision 360 120;
               OneJunction 248 160
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
                knot OneJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out flow [1];
                 restrictions
                  causality constraint one_out p;
                end;
                icon bg
                 figures
                  text '1' 248 160 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
               Rendstop 288 160
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type R
                 ports
                  power in p;
                 parameters
                  real Rendstop = 1000.0;
                end;
                icon bg bottom
                 figures
                  text 'R' 288 160 18 bold;
                end;
                implementation eq
equations					
	p.e = Rendstop * p.f;
implementation_end;
               Sf2 248 64
                description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:35</TimeStamp>
</Description>';
                type Sf
                 ports
                  power out p;
                 restrictions
                  causality fixed in p;
                end;
                icon bg bottom
                 figures
                  text 'Sf' 248 64 18 bold;
                end;
                implementation eq
parameters
	real flow = 0;
variables
	real effort;
equations
	p.f = flow;
	effort = p.e;
implementation_end;
              end;
              connections
               Collision\p12 => OneJunction\p;
               OneJunction\p => Rendstop\p;
               OneJunction\p => Cendstop\p;
               Sf2\p => Collision\p1;
               Collision\p2 => p2;
               Collision\collision -> collision;
              end;
              parameterrelations
Cendstop\Cendstop = Cendstop;
Rendstop\Rendstop = Rendstop;
Collision\InitialPos = InitialPos;
Collision\EndstopLocation = EndstopPos;parameterrelations_end;
             implementation_end;
            Integrate 320 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:3:23</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Integrate
              ports
               signal in input;
               signal out output [4,4];
              parameters
               real init = 0.0;
             end;
             icon bg
              figures
               rectangle 304 320 336 352 fill 15132390;
               text 'ò' 320 333.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real R[3,3];
	real p[3];
	real q;
equations
q = int(input,init);
R = [	cos(q),	-sin(q),	0;
			sin(q),	cos(q),	0;
			0,				0,				1];
p = [0;0;0];
output = homogeneous(R,p);
	
     implementation_end;
            MatrixMul 320 576
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 304.1 560 335.9 592 fill 15132390;
               text 'X' 320 576 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            plug p1 240 40;
            plug p2 496 424;
            plug Hin 112 576;
            plug Hout 504 576;
            plug p 112 424;
            OneJunction 240 288
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 240 288 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Or 400 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Logical\Discrete\Or.emx</LibraryPath>
  <TimeStamp>2007-12-18 23:20:57</TimeStamp>
</Description>';
             type 'Or-Or'
              ports
               signal boolean in input1;
               signal boolean out output;
               signal boolean in input2;
             end;
             icon bg bottom
              figures
               rectangle 384.1 208 415.9 240 fill 15132390;
               group
                line 386.3 217.3 396.8 217.3 color 16711680 fill 16711680;
                line 386.3 231.1 396.8 231.1 color 16711680 fill 16711680;
               end;
               spline 395.9 212.8 397.9 224.5 395.9 235.7 color 16711680 fill 16711680;
               line 404.7 224 413.5 224 color 16711680 fill 16711680;
               spline 395.7 212.3 401.9 214.6 404.8 224.4 401.6 233.4 395.7 235.7 color 16711680 fill 15132390;
             end;
             implementation eq
equations
	output = if input1 or input2 then 
		true
	else
		false
	end;

      implementation_end;
            Rjoint 168 288
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rjoint = 1.0;
             end;
             icon bg bottom
              figures
               text 'R' 168 288 18 bold;
             end;
             implementation eq
equations					
	p.e = Rjoint * p.f;
implementation_end;
            Splitter2 320 368
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 316.8 364.8 323.2 371.2 color -1 fill 0;
               ellipse 315.7 363.7 324.3 372.3 color -1;
              terminals
               input 320 368 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            uTbai 240 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1;
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
               causality fixed in p1;
               causality fixed out p2;
              parameters
               real Cconstraint = 1.0e-4;
               real Rconstraint = 1000.0;
             end;
             icon bg left
              figures
               text 'TF' 240 336 18 bold;
             end;
             implementation eq

equations
	p2.e[1] = (Rconstraint*-p2.f[1] + int(-p2.f[1])/Cconstraint);
	p2.e[2] = (Rconstraint*-p2.f[2] + int(-p2.f[2])/Cconstraint);
	p2.e[3] = p1.e;
	p2.e[4] = (Rconstraint*-p2.f[4] + int(-p2.f[4])/Cconstraint);
	p2.e[5] = (Rconstraint*-p2.f[5] + int(-p2.f[5])/Cconstraint);
	p2.e[6] = (Rconstraint*-p2.f[6] + int(-p2.f[6])/Cconstraint);

	p1.f = p2.f[3];
implementation_end;
            Wbai 240 424
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg bottom
              figures
               text '0' 240 424 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
            ZeroJunction 240 104
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               mechanical knot duplicatable none p [1];
               signal knot out effort [1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 240 104 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            uTbai\p1 <= OneJunction\p;
            p2 => AdHji\p2;
            OneJunction\p <= EndstopMax\p2;
            Rjoint\p <= OneJunction\p;
            ZeroJunction\p => OneJunction\p;
            p1 => ZeroJunction\p;
            uTbai\p2 => Wbai\p;
            p <= Wbai\p;
            OneJunction\p <= EndstopMin\p2;
            Wbai\p <= AdHji\p1;
            OneJunction\flow -> Integrate\input 288 336;
            Splitter2\output -> AdHji\H 424 368;
            MatrixMul\output -> Hout;
            Hin -> MatrixMul\input2;
            Integrate\output -> Splitter2\input;
            Splitter2\output -> MatrixMul\input1;
            EndstopMin\collision -> Or\input2;
            EndstopMax\collision -> Or\input1;
           end;
           parameterrelations
EndstopMin\Rendstop = Rendstop;
EndstopMin\Cendstop = Cendstop;
EndstopMin\InitialPos = InitialPos;
EndstopMin\EndstopPos = MinEndstopPos;
EndstopMax\Rendstop = Rendstop;
EndstopMax\Cendstop = Cendstop;
EndstopMax\InitialPos = InitialPos;
EndstopMax\EndstopPos = MaxEndstopPos;
Rjoint\Rjoint= Rjoint;
Integrate\init = InitialPos;
uTbai\Rconstraint = Rconstraint;
uTbai\Cconstraint = Cconstraint;

parameterrelations_end;
           figures
            text 'b = next link (body)
a = previous link (body)
i = Frame fixed in previous body, fixed in joint
j = Frame fixed in next body, fixed in joint
 ' 680 488;
          implementation_end;
         Link1 528 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Link.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:36:40</TimeStamp>
<Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0375];
            real dim[3,1] = [0.0; 0.0; 0.075];
          end;
          icon bg bottom
           figures
            rectangle 496 432 560 576 fill 10025880;
            text 'Link' 528 504;
           terminals
            p 496 464 fixed;
            Hin 496 544 fixed;
            p1 560 464 fixed;
            Hout 560 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik 664 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0375];
             end;
             icon bg left
              figures
               text 'TF' 664 224 18 bold;
             end;
             implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0375];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            EJS 728 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MGY
              ports
               power in p1 [6,1];
              parameters
               real I[3,1] = [1.0; 1.0; 1.0];
               real m = 1.0;
             end;
             icon bg top
              figures
               text 'MGY' 728 184 18 bold;
             end;
             implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.075];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            InertialTensor 616 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type I
              ports
               power in p [6,1];
               signal out state [6,1];
              restrictions
               causality preferred in p;
              parameters
               real m = 1.0;
               real I[3,1] = [1.0; 1.0; 1.0];
             end;
             icon bg top
              figures
               text 'I' 616 184 18 bold;
             end;
             implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
            plug Hout 896 496;
            plug p1 904 304;
            plug Hin 592 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0k 664 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg top
              figures
               text '1' 664 184 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            AdHik\p2 => Ta0k\p;
            Ta0k\p => EJS\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Ta0k\p => InertialTensor\p;
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            Ta0i\p => AdHik\p1;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
          implementation_end;
         Link2 688 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>Link.emx</LibraryPath>
  <TimeStamp>2011-1-18 16:36:40</TimeStamp>
<Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0775];
            real dim[3,1] = [0.0; 0.0; 0.155];
          end;
          icon bg bottom
           figures
            rectangle 656 432 720 576 fill 10025880;
            text 'Link' 688 504;
           terminals
            p 656 464 fixed;
            Hin 656 544 fixed;
            p1 720 464 fixed;
            Hout 720 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik 664 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0775];
             end;
             icon bg left
              figures
               text 'TF' 664 224 18 bold;
             end;
             implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0775];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            EJS 728 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MGY
              ports
               power in p1 [6,1];
              parameters
               real I[3,1] = [1.0; 1.0; 1.0];
               real m = 1.0;
             end;
             icon bg top
              figures
               text 'MGY' 728 184 18 bold;
             end;
             implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.155];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            InertialTensor 616 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type I
              ports
               power in p [6,1];
               signal out state [6,1];
              restrictions
               causality preferred in p;
              parameters
               real m = 1.0;
               real I[3,1] = [1.0; 1.0; 1.0];
             end;
             icon bg top
              figures
               text 'I' 616 184 18 bold;
             end;
             implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
            plug Hout 896 496;
            plug p1 904 304;
            plug Hin 592 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0k 664 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg top
              figures
               text '1' 664 184 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            AdHik\p2 => Ta0k\p;
            Ta0k\p => EJS\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Ta0k\p => InertialTensor\p;
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            Ta0i\p => AdHik\p1;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
          implementation_end;
         Link3 848 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link.emx</LibraryPath>
 <TimeStamp>2011-1-18 16:36:40</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0675];
            real dim[3,1] = [0.0; 0.0; 0.135];
          end;
          icon bg bottom
           figures
            rectangle 816 432 880 576 fill 10025880;
            text 'Link' 848 504;
           terminals
            p 816 464 fixed;
            Hin 816 544 fixed;
            p1 880 464 fixed;
            Hout 880 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik 664 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0675];
             end;
             icon bg left
              figures
               text 'TF' 664 224 18 bold;
             end;
             implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0675];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            EJS 728 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MGY
              ports
               power in p1 [6,1];
              parameters
               real I[3,1] = [1.0; 1.0; 1.0];
               real m = 1.0;
             end;
             icon bg top
              figures
               text 'MGY' 728 184 18 bold;
             end;
             implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.135];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            InertialTensor 616 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type I
              ports
               power in p [6,1];
               signal out state [6,1];
              restrictions
               causality preferred in p;
              parameters
               real m = 1.0;
               real I[3,1] = [1.0; 1.0; 1.0];
             end;
             icon bg top
              figures
               text 'I' 616 184 18 bold;
             end;
             implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
            plug Hout 896 496;
            plug p1 904 304;
            plug Hin 592 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0k 664 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg top
              figures
               text '1' 664 184 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            AdHik\p2 => Ta0k\p;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            Ta0k\p => EJS\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Ta0k\p => InertialTensor\p;
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            Ta0i\p => AdHik\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
          implementation_end;
         Link4 1008 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link.emx</LibraryPath>
 <TimeStamp>2011-1-18 16:36:40</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0405];
            real dim[3,1] = [0.0; 0.0; 0.081];
          end;
          icon bg bottom
           figures
            rectangle 976 432 1040 576 fill 10025880;
            text 'Link' 1008 504;
           terminals
            p 976 464 fixed;
            Hin 976 544 fixed;
            p1 1040 464 fixed;
            Hout 1040 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik 664 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0405];
             end;
             icon bg left
              figures
               text 'TF' 664 224 18 bold;
             end;
             implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0405];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            EJS 728 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MGY
              ports
               power in p1 [6,1];
              parameters
               real I[3,1] = [1.0; 1.0; 1.0];
               real m = 1.0;
             end;
             icon bg top
              figures
               text 'MGY' 728 184 18 bold;
             end;
             implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.081];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            InertialTensor 616 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type I
              ports
               power in p [6,1];
               signal out state [6,1];
              restrictions
               causality preferred in p;
              parameters
               real m = 1.0;
               real I[3,1] = [1.0; 1.0; 1.0];
             end;
             icon bg top
              figures
               text 'I' 616 184 18 bold;
             end;
             implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
            plug Hout 896 496;
            plug p1 904 304;
            plug Hin 592 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0k 664 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg top
              figures
               text '1' 664 184 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            AdHik\p2 => Ta0k\p;
            Ta0k\p => EJS\p1;
            p1 => AdHij\p2;
            Ta00\p => AdHi0\p1;
            Ta0k\p => InertialTensor\p;
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            Ta0i\p => AdHik\p1;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
          implementation_end;
         Link5 1168 504
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>Link.emx</LibraryPath>
 <TimeStamp>2011-1-18 16:36:40</TimeStamp>
   <Description>Base</Description>
</Description>';
          type Submodel
           ports
            power out p [6,1];
            signal in Hin [4,4];
            power in p1 [6,1];
            signal out Hout [4,4];
           parameters
            real I[3,1] = [1.0; 1.0; 1.0];
            real m = 1.0;
            real COMdim[3,1] = [0.0; 0.0; 0.0685];
            real dim[3,1] = [0.0; 0.0; 0.137];
          end;
          icon bg bottom
           figures
            rectangle 1136 432 1200 576 fill 10025880;
            text 'Link' 1168 504;
           terminals
            p 1136 464 fixed;
            Hin 1136 544 fixed;
            p1 1200 464 fixed;
            Hout 1200 544 fixed;
          end;
          implementation bg
           submodels
            AdHi0 664 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg left
              figures
               text 'MTF' 664 416 18 bold;
             end;
             implementation eq
variables
 	real onlyRotH[4,4];
code
	//Only rotations with respect to the inertial system matter!
	onlyRotH = H;
	onlyRotH[1,4] = 0;
	onlyRotH[2,4] = 0;
	onlyRotH[3,4] = 0;
						
	p2.e = transpose(Adjoint(onlyRotH)) * p1.e;
	p1.f = Adjoint(onlyRotH) * p2.f;
implementation_end;
            AdHij 816 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:3</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MTF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
               signal in H [4,4];
              restrictions
               causality constraint not_equal p1 p2;
             end;
             icon bg top
              figures
               text 'MTF' 816 304 18 bold;
             end;
             implementation eq
equations
	//Only rotations with respect to the inertial system matter!
						
	p1.e = transpose(Adjoint(H)) * p2.e;
	p2.f = Adjoint(H) * p1.f;
implementation_end;
            AdHik 664 224
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [6,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0685];
             end;
             icon bg left
              figures
               text 'TF' 664 224 18 bold;
             end;
             implementation eq
//Frame in joint connected to port 1
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            AdHik1 664 368
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power out p1 [6,1];
               power in p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real COMdim[3,1] = [0.0; 0.0; 0.0685];
             end;
             icon bg left
              figures
               text 'TF' 664 368 18 bold;
             end;
             implementation eq
//Principal inertial frame connected in port 2
variables
	real d[3]; //distance between frames
	real R[3,3]; //rotation between frames

	real H[4,4]; //homogeneous matrix
	real AdH[6,6]; //Adjoint of homogeneous matrix
equations
	d = COMdim; //distance of 1 in z direction of frames
	R = eye(3); //no rotation

	H = homogeneous(R,d);
	AdH = Adjoint(H);

	p1.f = AdH * p2.f; 
	p2.e = transpose(AdH) * p1.e;
implementation_end;
            EJS 728 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\MGY.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:43:6</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type MGY
              ports
               power in p1 [6,1];
              parameters
               real I[3,1] = [1.0; 1.0; 1.0];
               real m = 1.0;
             end;
             icon bg top
              figures
               text 'MGY' 728 184 18 bold;
             end;
             implementation eq
//EJS / Gyroscopic effects
variables
	real II[6,6]; //Inertial tensor
	real Q[6,6];
	real QI[6,6];
	real v[3];
	real omega[3];
equations
	II = [	I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];
	v[1:3] = p1.f[4:6];
	omega[1:3] = p1.f[1:3];

	Q[1:3,1:3] = -skew(omega);
	Q[1:3,4:6] = -skew(v);
	Q[4:6,1:3] = [0,0,0;0,0,0;0,0,0];//matrix filled with zeros
	Q[4:6,4:6] = -skew(omega);
	QI = Q*II;

	p1.e = QI*p1.f;implementation_end;
            Gravity 776 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Se
              ports
               power out p [6,1];
              restrictions
               causality fixed out p;
              parameters
               real m = 1.0;
             end;
             icon bg bottom
              figures
               text 'Se' 776 416 18 bold;
             end;
             implementation eq
variables
	real effort[6];
equations
	effort = [0;0;0;0;0;-9.8*m];
	p.e = effort;
implementation_end;
            Hij 816 496
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>H.emx</LibraryPath>
  <TimeStamp>2010-9-21 15:03:50</TimeStamp>
<AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input [4,4];
               signal out output [4,4];
               signal out Hab [4,4];
              parameters
               real dim[3,1] = [0.0; 0.0; 0.137];
             end;
             icon bg bottom
              figures
               rectangle 800.1 480 831.9 512 fill 15132390;
               text 'H' 816 496 color 16711680 16 bold;
             end;
             implementation eq
equations
	Hab = homogeneous(eye(3),dim);
	output = input * Hab;
    implementation_end;
            InertialTensor 616 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\I.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:2:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type I
              ports
               power in p [6,1];
               signal out state [6,1];
              restrictions
               causality preferred in p;
              parameters
               real m = 1.0;
               real I[3,1] = [1.0; 1.0; 1.0];
             end;
             icon bg top
              figures
               text 'I' 616 184 18 bold;
             end;
             implementation eq
variables
	real II[6,6]; //Inertial tensor
equations
	II = [I[1],0,	0,	0,	0,	0;
			0,	I[2],0,	0,	0,	0;
			0,	0,	I[3],0,	0,	0;
			0,	0,	0,	m,	0,	0;
			0,	0,	0,	0,	m,	0;
			0,	0,	0,	0,	0,	m];

    state = int(p.e); //state = generalized momentum
    p.f = inverse(II)*state;
implementation_end;
            plug Hout 896 496;
            plug p1 904 304;
            plug Hin 592 496;
            plug p 592 304;
            Splitter1 664 496
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 660.8 492.8 667.2 499.2 color -1 fill 0;
               ellipse 659.7 491.7 668.3 500.3 color -1;
              terminals
               input 664 496 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            Ta00 720 416
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 720 416 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0i 664 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg bottom
              figures
               text '1' 664 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            Ta0k 664 184
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description></Description>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg top
              figures
               text '1' 664 184 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
           end;
           connections
            AdHik\p2 => Ta0k\p;
            Ta00\p => AdHi0\p1;
            Ta0k\p => InertialTensor\p;
            Ta0i\p <= AdHik1\p1;
            AdHi0\p2 => AdHik1\p2;
            Gravity\p => Ta00\p;
            Ta0i\p => AdHik\p1;
            p <= Ta0i\p;
            Ta0i\p <= AdHij\p1;
            Ta0k\p => EJS\p1;
            p1 => AdHij\p2;
            Hin -> Splitter1\input;
            Hij\output -> Hout;
            Splitter1\output -> Hij\input;
            Splitter1\output -> AdHi0\H;
            Hij\Hab -> AdHij\H;
           end;
           parameterrelations
InertialTensor\I = I;
InterialTensor\m = m;
EJS\I = I;
EJS\m = m;
AdHik\COMdim = COMdim;
AdHik1\COMdim = COMdim;
Hij\dim = dim;
Gravity\m=m;parameterrelations_end;
           figures
            text 'b = current link (body)
a = previous link (body)
i = Body fixed frame, fixed in joint with previous link
j = Body fixed frame, fixed in joint with next link
k = Body fixed frame, principal inertial frame
0 = inertial system
 ' 352 296;
          implementation_end;
         MecanumWheels 279.9 504
          description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>MechanumWheels.emx</LibraryPath>
  <TimeStamp>2011-1-21 10:44:35</TimeStamp>
</Description>';
          type Submodel
           ports
            power in p [6,1];
            power in p1 [6,1];
            power in MotorRR;
            power in MotorLR;
            power in MotorLF;
            power in MotorRF;
            signal out Hout [4,4];
            signal in Hin [4,4];
           restrictions
            causality fixed in MotorLR;
            causality fixed in MotorLF;
            causality fixed in MotorRF;
            causality fixed in MotorRR;
           parameters
            real WheelRadius = 0.053;
            real WheelLFpos[2,1] = [0.215; -0.15];
            real WheelRFpos[2,1] = [0.215; 0.15];
            real WheelLRpos[2,1] = [-0.215; -0.15];
            real WheelRRpos[2,1] = [-0.215; 0.15];
            real Cfloor = 1.0e-4;
            real Rfloor = 1000.0;
            real init[4,4] = [1.0, 0.0, 0.0, 0.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];
            real Rwheel = 0.1;
          end;
          icon bg bottom
           figures
            rectangle 239.1 432.5 320.6 575.5 fill 16443110;
            text 'Mecanum 
 Wheels' 279.9 504 fill 16443110 16;
           terminals
            p 319.9 464 fixed;
            p1 240.4 463 fixed;
            MotorRR 303.9 432 fixed;
            MotorLR 287.9 432 fixed;
            MotorLF 255.9 432 fixed;
            MotorRF 271.9 432 fixed;
            Hout 319.9 544 fixed;
            Hin 239.9 544 fixed;
          end;
          implementation bg
           submodels
            Cfloor 864 656
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type C
              ports
               power in p [6,1];
               signal out state [6,1];
              restrictions
               causality preferred out p;
              parameters
               real Cfloor = 1.0e-4;
             end;
             icon bg bottom
              figures
               text 'C' 864 656 18 bold;
             end;
             implementation eq
equations
    state = int(p.f);
    p.e = [(1/Cfloor) * state[1];(1/Cfloor) * state[2];0;0;0;(1/Cfloor) * state[6]];
implementation_end;
            Integrate2 1032 624
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\Integrate.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:3:23</TimeStamp>
</Description>';
             type Integrate
              ports
               signal in input [6,1];
               signal out output [4,4];
              parameters
               real init[4,4] = [1.0, 0.0, 0.0, 0.0; 0.0, 1.0, 0.0, 0.0; 0.0, 0.0, 1.0, 0.0; 0.0, 0.0, 0.0, 1.0];
             end;
             icon bg
              figures
               rectangle 1016 608 1048 640 fill 15132390;
               text 'ò' 1032 621.3 color 16711680 'SymbolProp BT' 21 symbol;
             end;
             implementation eq
variables
	real H[4,4];
	real dotH[4,4];
	real tildeT[4,4];


equations
	tildeT = tilde(input);
	dotH = H*tildeT;
	H = int(dotH,init);
	output = H;





     


	
     implementation_end;
            MatrixMul 1032 792
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Block Diagram\Gain.emx</LibraryPath>
 <TimeStamp>2007-9-26 12:15:12</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type Gain
              ports
               signal in input1 [4,4];
               signal out output [4,4];
               signal in input2 [4,4];
             end;
             icon bg bottom
              figures
               rectangle 1016.1 776 1047.9 808 fill 15132390;
               text 'X' 1032 792 color 16711680 16 bold;
             end;
             implementation eq
equations
	output = input2*input1;    implementation_end;
            MecanumWheelAnimation 1103.5 312
             description '<Description>
 <Version>4.0</Version>
 <LibraryPath>Template\Submodel-Equation.emx</LibraryPath>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <TimeStamp>2007-11-1 22:32:1</TimeStamp>
 <AllowLibraryUpdate>False</AllowLibraryUpdate>
</Description>';
             type 'Submodel-Equation'
              ports
               signal in Hbase0 [4,4];
               signal in vWheelLF;
               signal in vWheelRF;
               signal in vWheelLR;
               signal in vWheelRR;
              parameters
               real WheelLFpos[2,1] = [0.215; -0.15];
               real WheelRFpos[2,1] = [0.215; 0.15];
               real WheelLRpos[2,1] = [-0.215; -0.15];
               real WheelRRpos[2,1] = [-0.215; 0.15];
             end;
             icon bg
              figures
               rectangle 1055 272 1152 352 fill 14013909;
               text 'Mecanum
   Wheel
 Animation' 1104 312 16;
              terminals
               Hbase0 1104 352 fixed;
               vWheelLF 1056 288 fixed;
               vWheelRF 1056 304 fixed;
               vWheelLR 1056 320 fixed;
               vWheelRR 1056 336 fixed;
             end;
             implementation eq
parameters
	real rot = 1.57;
//end
variables
//t.b.v. animation of mecanum wheels
	real HLRrot[4,4], HLFrot[4,4], HRRrot[4,4], HRFrot[4,4];
	real RLRrot[3,3], RLFrot[3,3], RRRrot[3,3], RRFrot[3,3];
	real RLRbase[3,3], RLFbase[3,3], RRFbase[3,3], RRRbase[3,3];
	real HLRbase[4,4], HLFbase[4,4], HRFbase[4,4], HRRbase[4,4];
	real HLR0[4,4], HLF0[4,4], HRF0[4,4], HRR0[4,4];
	real pLRbase[3], pLFbase[3], pRFbase[3], pRRbase[3];

	real qWheelLF, qWheelRF,qWheelLR, qWheelRR;
//end
equations
	qWheelLF = int(vWheelLF);
	qWheelRF = int(vWheelRF);
	qWheelLR = int(vWheelLR);
	qWheelRR = int(vWheelRR);


//t.b.v. animation of mecanum wheel
	pLFbase = [WheelLFpos[1];WheelLFpos[2];0.05];
	pRFbase = [WheelRFpos[1];WheelRFpos[2];0.05];
	pLRbase = [WheelLRpos[1];WheelLRpos[2];0.05];
	pRRbase = [WheelRRpos[1];WheelRRpos[2];0.05];
	
	RLRbase = [
		1,	0,				0;
		0,	cos(rot),	-sin(rot);
		0, sin(rot),	cos(rot)
	];
		
	RLFbase = [
		1,	0,				0;
		0,	cos(rot),	-sin(rot);
		0, sin(rot),	cos(rot)
	];

	RRFbase = [
		1,	0,				0;
		0,	cos(rot),	-sin(rot);
		0, sin(rot),	cos(rot)
	];

	RRRbase = [
		1,	0,				0;
		0,	cos(rot),	-sin(rot);
		0, sin(rot),	cos(rot)
	];

	HLFbase = homogeneous(RLFbase, pLFbase);
	HLRbase = homogeneous(RLRbase, pLRbase);
	HRRbase = homogeneous(RRRbase, pRRbase);
	HRFbase = homogeneous(RRFbase, pRFbase);

	RLRrot = [
		cos(-qWheelLR),	-sin(-qWheelLR),	0;
		sin(-qWheelLR),	cos(-qWheelLR),	0;
		0,				0,				1
	];
		
	RLFrot = [
		cos(-qWheelLF),	-sin(-qWheelLF),	0;
		sin(-qWheelLF),	cos(-qWheelLF),	0;
		0,				0,				1
	];

	RRFrot = [
		cos(-qWheelRF),	-sin(-qWheelRF),	0;
		sin(-qWheelRF),	cos(-qWheelRF),	0;
		0,				0,				1
	];

	RRRrot = [
		cos(-qWheelRR),	-sin(-qWheelRR),	0;
		sin(-qWheelRR),	cos(-qWheelRR),	0;
		0,				0,				1
	];

	HLFrot = homogeneous(RLFrot,[0;0;0]);
	HRFrot = homogeneous(RRFrot,[0;0;0]);
	HLRrot = homogeneous(RLRrot,[0;0;0]);
	HRRrot = homogeneous(RRRrot,[0;0;0]);

	HLF0 = Hbase0*HLFbase*HLFrot;
	HRF0 = Hbase0*HRFbase*HRFrot;
	HLR0 = Hbase0*HLRbase*HLRrot;
	HRR0 = Hbase0*HRRbase*HRRrot;
//end
 implementation_end;
            plug MotorLR 912 240;
            plug MotorLF 720 240;
            plug Hout 1184 792;
            plug Hin 696 792;
            plug MotorRR 1008 240;
            plug p1 693 704;
            plug MotorRF 816 240;
            plug p 1168 704;
            OneJunction 920 624
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out flow [6,1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 920 624 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
implementation_end;
            OneJunction2 1008 336
             description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 1008 336 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction3 912 320
             description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 912 320 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction4 720 288
             description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 720 288 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            OneJunction5 816 304
             description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\OneJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:18</TimeStamp>
</Description>';
             knot OneJunction
              ports
               power knot duplicatable none p [1];
               signal knot out flow [1];
              restrictions
               causality constraint one_out p;
             end;
             icon bg
              figures
               text '1' 816 304 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.e)) = 0;
	equal (collect (p.f));
	flow = first (p.f);
    implementation_end;
            Rfloor 840 624
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p [6,1];
              parameters
               real Rfloor = 1000.0;
             end;
             icon bg bottom
              figures
               text 'R' 840 624 18 bold;
             end;
             implementation eq
equations					
	p.e = [Rfloor * p.f[1];Rfloor * p.f[2];0;0;0;Rfloor * p.f[6]];
implementation_end;
            RwheelLF 672 288
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rwheel = 0.1;
             end;
             icon bg bottom
              figures
               text 'R' 672 288 18 bold;
             end;
             implementation eq
equations					
	p.e = Rwheel * p.f;
implementation_end;
            RwheelLR 864 320
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rwheel = 0.1;
             end;
             icon bg bottom
              figures
               text 'R' 864 320 18 bold;
             end;
             implementation eq
equations					
	p.e = Rwheel * p.f;
implementation_end;
            RwheelRF 768 304
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rwheel = 0.1;
             end;
             icon bg bottom
              figures
               text 'R' 768 304 18 bold;
             end;
             implementation eq
equations					
	p.e = Rwheel * p.f;
implementation_end;
            RwheelRR 960 336
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type R
              ports
               power in p;
              parameters
               real Rwheel = 0.1;
             end;
             icon bg bottom
              figures
               text 'R' 960 336 18 bold;
             end;
             implementation eq
equations					
	p.e = Rwheel * p.f;
implementation_end;
            Splitter1 1104 792
             description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
             knot Splitter
              ports
               signal knot duplicatable out output [4,4];
               signal knot in input [4,4];
             end;
             icon bg ellipse
              figures
               ellipse 1100.8 788.8 1107.2 795.2 color -1 fill 0;
               ellipse 1099.7 787.7 1108.3 796.3 color -1;
              terminals
               input 1104 792 fixed;
             end;
             implementation eq
equations
    collect (output) = input;
implementation_end;
            TF_LF 720 504
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real WheelLFpos[2,1] = [0.215; -0.15];
             end;
             icon bg bottom
              figures
               text 'TF' 720 504 18 bold;
             end;
             implementation eq
variables	
	real TFr[6,3];
	real transTFr[3,6];
equations
	TFr[1:3,1:3] = skew([WheelLFpos[1];WheelLFpos[2];0]);
	TFr[4:6,1:3] = eye(3); 

	transTFr[1:3,1:3] = -skew([WheelLFpos[1];WheelLFpos[2];0]);
	transTFr[1:3,4:6] = eye(3); 
	
	p2.e = TFr*p1.e;
	p1.f = transTFr*p2.f;
implementation_end;
            TF_LR 912 504
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real WheelLRpos[2,1] = [-0.215; -0.15];
             end;
             icon bg bottom
              figures
               text 'TF' 912 504 18 bold;
             end;
             implementation eq
variables
	real TFr[6,3];
	real transTFr[3,6];
equations
	TFr[1:3,1:3] = skew([WheelLRpos[1];WheelLRpos[2];0]);
	TFr[4:6,1:3] = eye(3); 

	transTFr[1:3,1:3] = -skew([WheelLRpos[1];WheelLRpos[2];0]);
	transTFr[1:3,4:6] = eye(3); 
	
	p2.e = TFr*p1.e;
	p1.f = transTFr*p2.f;
implementation_end;
            TF_RF 816 504
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real WheelRFpos[2,1] = [0.215; 0.15];
             end;
             icon bg bottom
              figures
               text 'TF' 816 504 18 bold;
             end;
             implementation eq
variables	
	real TFr[6,3];
	real transTFr[3,6];
equations
	TFr[1:3,1:3] = skew([WheelRFpos[1];WheelRFpos[2];0]);
	TFr[4:6,1:3] = eye(3); 

	transTFr[1:3,1:3] = -skew([WheelRFpos[1];WheelRFpos[2];0]);
	transTFr[1:3,4:6] = eye(3); 
	
	p2.e = TFr*p1.e;
	p1.f = transTFr*p2.f;
implementation_end;
            TF_RR 1008 504
             description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
             type TF
              ports
               power in p1 [3,1];
               power out p2 [6,1];
              restrictions
               causality constraint not_equal p1 p2;
              parameters
               real WheelRRpos[2,1] = [-0.215; 0.15];
             end;
             icon bg bottom
              figures
               text 'TF' 1008 504 18 bold;
             end;
             implementation eq
variables	
	real TFr[6,3];
	real transTFr[3,6];
equations
	TFr[1:3,1:3] = skew([WheelRRpos[1];WheelRRpos[2];0]);
	TFr[4:6,1:3] = eye(3); 

	transTFr[1:3,1:3] = -skew([WheelRRpos[1];WheelRRpos[2];0]);
	transTFr[1:3,4:6] = eye(3); 
	
	p2.e = TFr*p1.e;
	p1.f = transTFr*p2.f;
implementation_end;
            WheelLF 720 408
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>MecanumWheelB.emx</LibraryPath>
  <TimeStamp>2011-1-20 16:56:09</TimeStamp>
</Description>';
             type Submodel
              ports
               power in p;
               power out p2 [3,1];
              parameters
               real WheelRadius = 0.053;
             end;
             icon bg bottom
              figures
               rectangle 690 386 750 430 fill 16777152;
               text 'Mecanum 
wheel type B' 720 408;
             end;
             implementation bg
              submodels
               MotorTorgue 112 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                knot ZeroJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out effort [1];
                 restrictions
                  causality constraint one_in p;
                end;
                icon bg top
                 figures
                  text '0' 112 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
               plug p 71 176;
               plug p2 457 176;
               TF1 240 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Transforms from the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the principal inertial frame of the robot body
to the the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 240 176 18 bold;
                end;
                implementation eq
//Standard rotation arboud z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(pi/4), 	-sin(pi/4), 	0;
			sin(pi/4), 	cos(pi/4),		0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               TF2 304 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>This transformer represents the interchange of energy 
between the wheel and the floor. In the rolling direction 
there is no energy exchangem, in the siding direction there is.
In case of a type B mechanum wheel the rolling direction is 
the y direction of the frame oriented with the roller.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 304 176 18 bold;
                end;
                implementation eq
parameters
	real r[3,3] = [0, 0, 0;0, 1, 0;0, 0, 1];
equations
p2.e = transpose(r)*p1.e;
p1.f = r*p2.f;implementation_end;
               TF3 368 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Inverse of TF1: Transforms back.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 368 176 18 bold;
                end;
                implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;
			sin(-pi/4), 	cos(-pi/4),	0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               WheelRadius 152 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type TF
                 ports
                  power in p1;
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                 parameters
                  real WheelRadius = 0.053;
                end;
                icon bg bottom
                 figures
                  text 'TF' 152 176 18 bold;
                end;
                implementation eq
equations					
	p2.e = [p1.e/WheelRadius;0;0];
	p1.f = p2.f[1]/WheelRadius;
implementation_end;
              end;
              connections
               WheelRadius\p2 => TF1\p1;
               MotorTorgue\p => WheelRadius\p1;
               TF1\p2 => TF2\p1;
               TF2\p2 => TF3\p1;
               p => MotorTorgue\p;
               TF3\p2 => p2;
              end;
              parameterrelations
WheelRadius\WheelRadius = WheelRadius;parameterrelations_end;
             implementation_end;
            WheelLR 912 408
             description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>MecanumWheelA.emx</LibraryPath>
 <TimeStamp>2011-1-18 13:53:24</TimeStamp>
</Description>';
             type Submodel
              ports
               power in p;
               power out p2 [3,1];
              parameters
               real WheelRadius = 0.053;
             end;
             icon bg bottom
              figures
               rectangle 882 386 942 430 fill 16777152;
               text 'Mecanum 
wheel type A' 912 408;
             end;
             implementation bg
              submodels
               MotorTorgue1 96 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                knot ZeroJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out effort [1];
                 restrictions
                  causality constraint one_in p;
                end;
                icon bg top
                 figures
                  text '0' 96 304 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
               plug p 47 304;
               plug p2 401 304;
               TF1 200 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Transforms from the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the principal inertial frame of the robot body
to the the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 200 304 18 bold;
                end;
                implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(pi/4), 	-sin(pi/4), 	0;
			sin(pi/4), 	cos(pi/4),		0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               TF2 256 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>This transformer represents the interchange of energy 
between the wheel and the floor. In the rolling direction 
there is no energy exchangem, in the siding direction there is.
In case of a type A mechanum wheel the rolling direction is 
the x direction of the frame oriented with the roller.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 256 304 18 bold;
                end;
                implementation eq
parameters
	real r[3,3] = [1, 0, 0;0, 0, 0;0, 0, 1];
equations
p2.e = transpose(r)*p1.e;
p1.f = r*p2.f;implementation_end;
               TF3 312 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Inverse of TF1: transforms back.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 312 304 18 bold;
                end;
                implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;
			sin(-pi/4), 	cos(-pi/4),	0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               WheelRadius 144 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type TF
                 ports
                  power in p1;
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                 parameters
                  real WheelRadius = 0.053;
                end;
                icon bg bottom
                 figures
                  text 'TF' 144 304 18 bold;
                end;
                implementation eq
equations					
	p2.e = [p1.e/WheelRadius;0;0];
	p1.f = p2.f[1]/WheelRadius;
implementation_end;
              end;
              connections
               WheelRadius\p2 => TF1\p1;
               TF1\p2 => TF2\p1;
               MotorTorgue1\p => WheelRadius\p1;
               TF2\p2 => TF3\p1;
               p => MotorTorgue1\p;
               TF3\p2 => p2;
              end;
              parameterrelations
WheelRadius\WheelRadius = WheelRadius;parameterrelations_end;
             implementation_end;
            WheelRF 816 408
             description '<Description>
   <Version>4.1</Version>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <LibraryPath>MecanumWheelA.emx</LibraryPath>
  <TimeStamp>2011-1-21 10:44:27</TimeStamp>
</Description>';
             type Submodel
              ports
               power in p;
               power out p2 [3,1];
              parameters
               real WheelRadius = 0.053;
             end;
             icon bg bottom
              figures
               rectangle 786 386 846 430 fill 16777152;
               text 'Mecanum 
wheel type A' 816 408;
             end;
             implementation bg
              submodels
               MotorTorgue1 96 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                knot ZeroJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out effort [1];
                 restrictions
                  causality constraint one_in p;
                end;
                icon bg top
                 figures
                  text '0' 96 304 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
               plug p 47 304;
               plug p2 401 304;
               TF1 200 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Transforms from the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the principal inertial frame of the robot body
to the the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 200 304 18 bold;
                end;
                implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(pi/4), 	-sin(pi/4), 	0;
			sin(pi/4), 	cos(pi/4),		0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               TF2 256 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>This transformer represents the interchange of energy 
between the wheel and the floor. In the rolling direction 
there is no energy exchangem, in the siding direction there is.
In case of a type A mechanum wheel the rolling direction is 
the x direction of the frame oriented with the roller.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 256 304 18 bold;
                end;
                implementation eq
parameters
	real r[3,3] = [1, 0, 0;0, 0, 0;0, 0, 1];
equations
p2.e = transpose(r)*p1.e;
p1.f = r*p2.f;implementation_end;
               TF3 312 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Inverse of TF1: transforms back.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 312 304 18 bold;
                end;
                implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;
			sin(-pi/4), 	cos(-pi/4),	0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               WheelRadius 144 304
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type TF
                 ports
                  power in p1;
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                 parameters
                  real WheelRadius = 0.053;
                end;
                icon bg bottom
                 figures
                  text 'TF' 144 304 18 bold;
                end;
                implementation eq
equations					
	p2.e = [p1.e/WheelRadius;0;0];
	p1.f = p2.f[1]/WheelRadius;
implementation_end;
              end;
              connections
               WheelRadius\p2 => TF1\p1;
               TF1\p2 => TF2\p1;
               MotorTorgue1\p => WheelRadius\p1;
               TF2\p2 => TF3\p1;
               p => MotorTorgue1\p;
               TF3\p2 => p2;
              end;
              parameterrelations
WheelRadius\WheelRadius = WheelRadius;parameterrelations_end;
             implementation_end;
            WheelRR 1008 408
             description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
 <LibraryPath>MecanumWheelB.emx</LibraryPath>
 <TimeStamp>2011-1-18 13:51:59</TimeStamp>
</Description>';
             type Submodel
              ports
               power in p;
               power out p2 [3,1];
              parameters
               real WheelRadius = 0.053;
             end;
             icon bg bottom
              figures
               rectangle 978 386 1038 430 fill 16777152;
               text 'Mecanum 
wheel type B' 1008 408;
             end;
             implementation bg
              submodels
               MotorTorgue 112 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
 <TimeStamp>2007-9-27 9:51:43</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                knot ZeroJunction
                 ports
                  power knot duplicatable none p [1];
                  signal knot out effort [1];
                 restrictions
                  causality constraint one_in p;
                end;
                icon bg top
                 figures
                  text '0' 112 176 18 bold;
                end;
                implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
               plug p 71 176;
               plug p2 457 176;
               TF1 240 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Transforms from the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the principal inertial frame of the robot body
to the the frame in the contact point 
of the mechanum wheel with the floor, alligned 
with the rollers on the mechanum wheel. (Rotation of 45 degrees)</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 240 176 18 bold;
                end;
                implementation eq
//Standard rotation arboud z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(pi/4), 	-sin(pi/4), 	0;
			sin(pi/4), 	cos(pi/4),		0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               TF2 304 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>This transformer represents the interchange of energy 
between the wheel and the floor. In the rolling direction 
there is no energy exchangem, in the siding direction there is.
In case of a type B mechanum wheel the rolling direction is 
the y direction of the frame oriented with the roller.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 304 176 18 bold;
                end;
                implementation eq
parameters
	real r[3,3] = [0, 0, 0;0, 1, 0;0, 0, 1];
equations
p2.e = transpose(r)*p1.e;
p1.f = r*p2.f;implementation_end;
               TF3 368 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
   <Description>Inverse of TF1: Transforms back.</Description>
</Description>';
                type TF
                 ports
                  power in p1 [3,1];
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                end;
                icon bg bottom
                 figures
                  text 'TF' 368 176 18 bold;
                end;
                implementation eq
//standard rotation around z-axis
variables
	real R[3,3]; 
equations
	R = [	cos(-pi/4), 	-sin(-pi/4), 	0;
			sin(-pi/4), 	cos(-pi/4),	0;
			0			,	0,					1];	
				
	p1.e = transpose(R) * p2.e;
	p2.f = R * p1.f;
implementation_end;
               WheelRadius 152 176
                description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\TF.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:4:2</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
                type TF
                 ports
                  power in p1;
                  power out p2 [3,1];
                 restrictions
                  causality constraint not_equal p1 p2;
                 parameters
                  real WheelRadius = 0.053;
                end;
                icon bg bottom
                 figures
                  text 'TF' 152 176 18 bold;
                end;
                implementation eq
equations					
	p2.e = [p1.e/WheelRadius;0;0];
	p1.f = p2.f[1]/WheelRadius;
implementation_end;
              end;
              connections
               WheelRadius\p2 => TF1\p1;
               MotorTorgue\p => WheelRadius\p1;
               TF1\p2 => TF2\p1;
               TF2\p2 => TF3\p1;
               p => MotorTorgue\p;
               TF3\p2 => p2;
              end;
              parameterrelations
WheelRadius\WheelRadius = WheelRadius;parameterrelations_end;
             implementation_end;
            ZeroJunction 920 704
             description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
             knot ZeroJunction
              ports
               power knot duplicatable none p [6,1];
               signal knot out effort [6,1];
              restrictions
               causality constraint one_in p;
             end;
             icon bg
              figures
               text '0' 920 704 18 bold;
             end;
             implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
           end;
           connections
            WheelLF\p2 => TF_LF\p1;
            p => ZeroJunction\p;
            RwheelRR\p <= OneJunction2\p;
            OneJunction2\p => WheelRR\p;
            RwheelLR\p <= OneJunction3\p;
            OneJunction4\p => WheelLF\p;
            RwheelLF\p <= OneJunction4\p;
            OneJunction5\p => WheelRF\p;
            RwheelRF\p <= OneJunction5\p;
            TF_LR\p2 => OneJunction\p;
            WheelRF\p2 => TF_RF\p1;
            WheelRR\p2 => TF_RR\p1;
            TF_LF\p2 => OneJunction\p;
            TF_RF\p2 => OneJunction\p;
            TF_RR\p2 => OneJunction\p;
            OneJunction3\p => WheelLR\p;
            ZeroJunction\p => OneJunction\p;
            Rfloor\p <= OneJunction\p;
            Cfloor\p <= OneJunction\p;
            p1 => ZeroJunction\p;
            MotorRR => OneJunction2\p;
            MotorLR => OneJunction3\p;
            MotorLF => OneJunction4\p;
            MotorRF => OneJunction5\p;
            WheelLR\p2 => TF_LR\p1;
            OneJunction\flow -> Integrate2\input;
            OneJunction3\flow -> MecanumWheelAnimation\vWheelLR;
            MecanumWheelAnimation\vWheelRR <- OneJunction2\flow;
            Integrate2\output -> MatrixMul\input1;
            Hin -> MatrixMul\input2;
            MatrixMul\output -> Splitter1\input;
            Splitter1\output -> Hout;
            Splitter1\output -> MecanumWheelAnimation\Hbase0;
            OneJunction4\flow -> MecanumWheelAnimation\vWheelLF;
            OneJunction5\flow -> MecanumWheelAnimation\vWheelRF;
           end;
           parameterrelations
WheelLF\WheelRadius = WheelRadius;
WheelRF\WheelRadius = WheelRadius;
WheelLR\WheelRadius = WheelRadius;
WheelRR\WheelRadius = WheelRadius;
Integrate2\init = init;
TF_LF\WheelLFpos = WheelLFpos;
TF_RF\WheelRFpos = WheelRFpos;
TF_LR\WheelLRpos = WheelLRpos;
TF_RR\WheelRRpos = WheelRRpos;
MecanumWheelAnimation\WheelLFpos = WheelLFpos;
MecanumWheelAnimation\WheelLRpos = WheelLRpos;
MecanumWheelAnimation\WheelRFpos = WheelRFpos;
MecanumWheelAnimation\WheelRRpos = WheelRRpos;
Rfloor\Rfloor = Rfloor;
Cfloor\Cfloor = Cfloor;
RwheelLF\Rwheel = Rwheel;
RwheelRF\Rwheel = Rwheel;
RwheelLR\Rwheel = Rwheel;
RwheelRR\Rwheel = Rwheel;parameterrelations_end;
          implementation_end;
         Mux 696 193
          description '<Description>
 <Version>4.0</Version>
 <LibraryPath>C:\Program Files\20-sim 4.0\System\Submodel.emx</LibraryPath>
 <TimeStamp>2007-10-31 11:32:54</TimeStamp>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Submodel
           ports
            power in port [9,1];
            power out port1;
            power out port2;
            power out port3;
            power out port4;
            power out port5;
            power out port6;
            power out port7;
            power out port8;
            power out port9;
           restrictions
            causality fixed in port;
            causality fixed out port1;
            causality fixed out port2;
            causality fixed out port3;
            causality fixed out port4;
            causality fixed out port5;
            causality fixed out port6;
            causality fixed out port7;
            causality fixed out port8;
            causality fixed out port9;
          end;
          icon bg
           figures
            rectangle 616 178 776 208 fill 14013909;
            text 'Mux' 696 192 16;
           terminals
            port 696 176 fixed;
            port1 632 208 fixed;
            port2 648 208 fixed;
            port3 664 208 fixed;
            port4 680 208 fixed;
            port5 696 208 fixed;
            port6 712 208 fixed;
            port7 728 208 fixed;
            port8 744 208 fixed;
            port9 760 208 fixed;
          end;
          implementation eq
equations
	port1.e = port.e[1];
	port2.e = port.e[2];
	port3.e = port.e[3];
	port4.e = port.e[4];
	port5.e = port.e[5];
	port6.e = port.e[6];
	port7.e = port.e[7];
	port8.e = port.e[8];
	port9.e = port.e[9];
	
	port.f[1] = port1.f;
	port.f[2] = port2.f;
	port.f[3] = port3.f;
	port.f[4] = port4.f;
	port.f[5] = port5.f;
	port.f[6] = port6.f;
	port.f[7] = port7.f;
	port.f[8] = port8.f;
	port.f[9] = port9.f;implementation_end;
         plug joints 696 120;
         Tfloor0 200 464
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Sf.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:35</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Sf
           ports
            power out p [6,1];
           restrictions
            causality fixed in p;
          end;
          icon bg bottom
           figures
            text 'Sf' 200 464 18 bold;
          end;
          implementation eq
parameters
	real flow = 0;
variables
	real effort[6];
equations
	p.f = flow;
	effort = p.e;
implementation_end;
         Wtip0 1240 464
          description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\Se.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:26</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type Se
           ports
            power out p [6,1];
           restrictions
            causality fixed out p;
          end;
          icon bg bottom
           figures
            text 'Se' 1240 464 18 bold;
          end;
          implementation eq
parameters
	real effort = 0;
variables
	real flow[6];
equations
	p.e = effort;
	flow = p.f;
implementation_end;
        end;
        connections
         MecanumWheels\MotorLF <= Mux\port1 256 240 632 240;
         JointBase1\p => Base\p1;
         Link5\p1 <= Wtip0\p;
         Link3\p1 <= Joint34\p;
         MecanumWheels\MotorLR <= Mux\port3 288 272 664 272;
         Mux\port <= joints;
         MecanumWheels\MotorRR <= Mux\port4 304 288 680 288;
         JointBase1\p1 <= Mux\port5 448 304 696 304;
         MecanumWheels\MotorRF <= Mux\port2 272 256 648 256;
         Tfloor0\p => MecanumWheels\p1;
         Joint23\p => Link2\p1;
         Mux\port9 => Joint45\p1 760 224 1088 224;
         Joint12\p1 <= Mux\port6 608 320 712 320;
         Link4\p => Joint34\p2;
         Mux\port8 => Joint34\p1 744 240 928 240;
         Mux\port7 => Joint23\p1 728 256 768 256;
         MecanumWheels\p <= Base\p;
         Link1\p => JointBase1\p2;
         Link3\p => Joint23\p2;
         Joint12\p => Link1\p1;
         Link2\p => Joint12\p2;
         Joint45\p => Link4\p1;
         Link5\p => Joint45\p2;
         MecanumWheels\Hout -> Base\Hin;
         Hfloor0\output -> MecanumWheels\Hin;
         Base\Hout -> JointBase1\Hin;
         JointBase1\Hout -> Link1\Hin;
         Link1\Hout -> Joint12\Hin;
         Link3\Hin <- Joint23\Hout 808 544;
         Joint34\Hin <- Link3\Hout;
         Link5\Hin <- Joint45\Hout;
         Link5\Hout -> Htip0\input;
         Link4\Hin <- Joint34\Hout;
         Joint45\Hin <- Link4\Hout;
         Joint12\Hout -> Link2\Hin;
         Joint23\Hin <- Link2\Hout;
        end;
        parameterrelations
MecanumWheels\WheelRadius = MecanumWheelRadius;
MecanumWheels\WheelLFpos = Wheelpos[1:2,1];
MecanumWheels\WheelRFpos = Wheelpos[1:2,2];
MecanumWheels\WheelLRpos = Wheelpos[1:2,3];
MecanumWheels\WheelRRpos = Wheelpos[1:2,4];
MecanumWheels\Cfloor = Cconstraint;
MecanumWheels\Rfloor = Rconstraint;
MecanumWheels\init = InitialBasePos;
MecanumWheels\Rwheel = Rwheel;

Base\I = LinkI[1:3,1];
Base\m = Linkm[1];
Base\COMdim = LinkCOMdim[1:3,1];
Base\dim = Linkdim[1:3,1];

Link1\I = LinkI[1:3,2];
Link1\m = Linkm[2];
Link1\COMdim = LinkCOMdim[1:3,2];
Link1\dim = Linkdim[1:3,2];

Link2\I = LinkI[1:3,3];
Link2\m = Linkm[3];
Link2\COMdim = LinkCOMdim[1:3,3];
Link2\dim = Linkdim[1:3,3];

Link3\I =LinkI[1:3,4];
Link3\m = Linkm[4];
Link3\COMdim = LinkCOMdim[1:3,4];
Link3\dim = Linkdim[1:3,4];

Link4\I = LinkI[1:3,5];
Link4\m = Linkm[5];
Link4\COMdim = LinkCOMdim[1:3,5];
Link4\dim = Linkdim[1:3,5];

Link5\I = LinkI[1:3,6];
Link5\m = Linkm[6];
Link5\COMdim = LinkCOMdim[1:3,6];
Link5\dim = Linkdim[1:3,6];

JointBase1\Rendstop = Rconstraint;
JointBase1\Cendstop = Cconstraint;
JointBase1\InitialPos = InitialJointPos[1];
JointBase1\MinEndstopPos = MinEndstopPos[1];
JointBase1\MaxEndstopPos = MaxEndstopPos[1];
JointBase1\Rconstraint = Rconstraint;
JointBase1\Cconstraint = Cconstraint;
JointBase1\Rjoint = Rjoint;

Joint12\Rendstop = Rconstraint;
Joint12\Cendstop = Cconstraint;
Joint12\InitialPos = InitialJointPos[2];
Joint12\MinEndstopPos = MinEndstopPos[2];
Joint12\MaxEndstopPos = MaxEndstopPos[2];
Joint12\Rconstraint = Rconstraint;
Joint12\Cconstraint = Cconstraint;
Joint12\Rjoint = Rjoint;

Joint23\Rendstop = Rconstraint;
Joint23\Cendstop = Cconstraint;
Joint23\InitialPos = InitialJointPos[3];
Joint23\MinEndstopPos = MinEndstopPos[3];
Joint23\MaxEndstopPos = MaxEndstopPos[3];
Joint23\Rconstraint = Rconstraint;
Joint23\Cconstraint = Cconstraint;
Joint23\Rjoint = Rjoint;

Joint34\Rendstop = Rconstraint;
Joint34\Cendstop = Cconstraint;
Joint34\InitialPos = InitialJointPos[4];
Joint34\MinEndstopPos = MinEndstopPos[4];
Joint34\MaxEndstopPos = MaxEndstopPos[4];
Joint34\Rconstraint = Rconstraint;
Joint34\Cconstraint = Cconstraint;
Joint34\Rjoint = Rjoint;

Joint45\Rendstop = Rconstraint;
Joint45\Cendstop = Cconstraint;
Joint45\InitialPos = InitialJointPos[5];
Joint45\MinEndstopPos = MinEndstopPos[5];
Joint45\MaxEndstopPos = MaxEndstopPos[5];
Joint45\Rconstraint = Rconstraint;
Joint45\Cconstraint = Cconstraint;
Joint45\Rjoint = Rjoint;

parameterrelations_end;
       implementation_end;
      PlantBreakC 744 624
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\C.emx</LibraryPath>
 <TimeStamp>2007-10-31 10:43:59</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type C
        ports
         power in p [9,1];
         signal out state [9,1];
        restrictions
         causality preferred out p;
        parameters
         real Cbreaks = 1.0e-4;
       end;
       icon bg bottom
        figures
         text 'C' 744 624 18 bold;
       end;
       implementation eq
equations
    state = int(p.f);
    p.e = state / Cbreaks;
implementation_end;
      PlantBreakR 696 584
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type R
        ports
         power in p [9,1];
        parameters
         real Rbreaks = 10000.0;
       end;
       icon bg bottom
        figures
         text 'R' 696 584 18 bold;
       end;
       implementation eq
equations					
	p.e = Rbreaks * p.f;
implementation_end;
      PlusMinus 936 824
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Signal\Block Diagram\PlusMinus.emx</LibraryPath>
  <TimeStamp>2007-9-27 10:15:13</TimeStamp>
</Description>';
       knot PlusMinus
        ports
         signal knot duplicatable in plus [9,1];
         signal knot duplicatable in minus [9,1];
         signal knot out output [9,1];
       end;
       icon bg ellipse
        figures
         ellipse 928 816 944 832 fill 16777215;
       end;
       implementation eq
equations
    output = sum (collect (plus)) - sum (collect (minus));
    implementation_end;
      QSensor1 616 1040
       description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\QSensor.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:59:34</TimeStamp>
</Description>';
       knot QSensor
        ports
         power knot in p1 [9,1];
         power knot out p2 [9,1];
         signal knot out q [9,1];
        restrictions
         causality constraint not_equal p1 p2;
       end;
       icon bg ellipse
        figures
         ellipse 609.1 1034.3 622.9 1048.4 fill 16777215;
         text 'q' 615.5 1038.6;
       end;
       implementation eq
equations
	p2.f = p1.f;
	p1.e = p2.e;
	q = int (p1.f);
     implementation_end;
      Rcontrol 392 328
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type R
        ports
         power in p [8,1];
        parameters
         real Rcontrol[8,1] = [100.0; 100.0; 100.0; 40.0; 40.0; 40.0; 40.0; 40.0];
       end;
       icon bg bottom
        figures
         text 'R' 392 328 18 bold;
       end;
       implementation eq
variables
	real r[8,8];
	real rdiag[8];
equations
	rdiag = Rcontrol;
	r = diag(rdiag);
	p.e = r * p.f;
implementation_end;
      RobserverControl 784 1000
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Bond Graph\R.emx</LibraryPath>
 <TimeStamp>2007-9-25 12:3:18</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type R
        ports
         power in p [9,1];
        parameters
         real RobserverControl = 100.0;
         real Wheelpos[2,4] = [0.215, 0.215, -0.215, -0.215; -0.15, 0.15, -0.15, 0.15];
         real MecanumWheelRadius = 0.053;
       end;
       icon bg bottom
        figures
         text 'R' 784 1000 18 bold;
       end;
       implementation eq
variables
	real r,x,y;
	real A[3,4];
	real PseudoInverseA[4,3];
equations
	y = Wheelpos[2,2];
	x = Wheelpos[1,2];
	r = MecanumWheelRadius;

	A = (1/(2*r))*
	[ 	x+y 	,-(x+y)		,x+y	,-(x+y);
		1		, -1		,-1		, 1;
		1		, 1		,1		, 1];

	PseudoInverseA = transpose(A)*inverse(A*transpose(A));

	p.e[5:9] = RobserverControl * p.f[5:9];
	p.e[1:4] = PseudoInverseA * RobserverControl * transpose(PseudoInverseA) * p.f[1:4];
implementation_end;
      SerialLinkToRobot 464 464
       description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type Submodel
        ports
         power in output1 [8,1];
         power out output2 [9,1];
         signal in actuatorControllable [9,1];
        parameters
         real Wheelpos[2,4] = [0.215, 0.215, -0.215, -0.215; -0.15, 0.15, -0.15, 0.15];
         real MecanumWheelRadius = 0.053;
       end;
       icon bg left
        figures
         text 'TF' 464 464 18 bold;
       end;
       implementation bg
        submodels
         Demux 176 488
          description '<Description>
 <Version>4.0</Version>
 <LibraryPath>Template\Submodel-Equation.emx</LibraryPath>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <TimeStamp>2007-11-1 22:32:1</TimeStamp>
 <AllowLibraryUpdate>False</AllowLibraryUpdate>
</Description>';
          type 'Submodel-Equation'
           ports
            power in input1 [4,1];
            power out output [9,1];
            power in input2 [5,1];
           restrictions
            causality fixed in input1;
            causality fixed in input2;
            causality fixed out output;
          end;
          implementation eq
/* Equation Submodel
Enter you equations here. You can use the Toolbar buttons at the left ( Add , f(x) etc. ).
*/
equations
  // start typing here
  	output.e[1:4] = input1.e;
	output.e[5:9] = input2.e;

	input1.f = output.f[1:4];
	input2.f = output.f[5:9];	
 implementation_end;
         MTF 128 376
          description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\MTF.emx</LibraryPath>
  <TimeStamp>2007-9-25 12:3:3</TimeStamp>
</Description>';
          type MTF
           ports
            power in p1 [5,1];
            power out p2 [5,1];
            signal in actuatorControllable [5,1];
           restrictions
            causality constraint not_equal p1 p2;
          end;
          icon bg bottom
           figures
            text 'MTF' 128 376 18 bold;
          end;
          implementation eq
equations					
	p2.e = diag(actuatorControllable) * p1.e;
	p1.f = diag(actuatorControllable) * p2.f;
implementation_end;
         Mux 176 232
          description '<Description>
 <Version>4.0</Version>
 <LibraryPath>Template\Submodel-Equation.emx</LibraryPath>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <TimeStamp>2007-11-1 22:32:1</TimeStamp>
 <AllowLibraryUpdate>False</AllowLibraryUpdate>
</Description>';
          type 'Submodel-Equation'
           ports
            power out input1 [3,1];
            power in output [8,1];
            power out input2 [5,1];
           restrictions
            causality fixed in output;
            causality fixed out input2;
            causality fixed out input1;
          end;
          implementation eq
/* Equation Submodel
Enter you equations here. You can use the Toolbar buttons at the left ( Add , f(x) etc. ).
*/
equations
  // start typing here
  	output.f[1:3] = input1.f;
	output.f[4:8] = input2.f;

	input1.e = output.e[1:3];
	input2.e = output.e[4:8];	
 implementation_end;
         plug output1 176 136;
         plug output2 176 584;
         plug actuatorControllable 672 272;
         Splitter 288 264
          description '<Description>
 <Version>4.0</Version>
 <LibraryPath>Template\Submodel-Equation.emx</LibraryPath>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <TimeStamp>2007-11-1 22:32:1</TimeStamp>
 <AllowLibraryUpdate>False</AllowLibraryUpdate>
</Description>';
          type 'Submodel-Equation'
           ports
            signal out output1 [4,1];
            signal in input [9,1];
            signal out output2 [5,1];
          end;
          implementation eq
/* Equation Submodel
Enter you equations here. You can use the Toolbar buttons at the left ( Add , f(x) etc. ).
*/
equations
  // start typing here
  	output1 = input[1:4];
	output2 = input[5:9];	
 implementation_end;
         VirtualLinkMap 232 376
          description '<Description>
 <Version>4.1</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>VirtualLinkMap.emx</LibraryPath>
 <TimeStamp>2010-11-23 11:48:20</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
          type MTF
           ports
            power in virtualJoints [3,1];
            power out motor [4,1];
            signal in actuatorsControllable [4,1];
           restrictions
            causality fixed in virtualJoints;
            causality fixed out motor;
           parameters
            real Wheelpos[2,4] = [0.215, 0.215, -0.215, -0.215; -0.15, 0.15, -0.15, 0.15];
            real MecanumWheelRadius = 0.053;
          end;
          icon bg bottom
           figures
            text 'TF' 232 376 18 bold;
          end;
          implementation eq
variables
	real r,x,y;
	real A[3,4];
	real actuatedA[3,4];
	real PseudoInverseA[4,3];
	real countOperationalWheels;
equations
	y = Wheelpos[2,2];
	x = Wheelpos[1,2];
	r = MecanumWheelRadius;
	
	countOperationalWheels = actuatorsControllable[1] + actuatorsControllable[2] + actuatorsControllable[3] + actuatorsControllable[4];

	/*
		A is a Jacobian matrix
	*/	
	A = (1/(2*r))*
	[ 	x+y 	,-(x+y)		,x+y	,-(x+y);
		1		, -1		,-1		, 1;
		1		, 1		,1		, 1];

	actuatedA = A * diag(actuatorsControllable);


	if (countOperationalWheels > 2) then
	/*
		Overdefined
	*/
		PseudoInverseA = transpose(actuatedA)*inverse(actuatedA*transpose(actuatedA));
	else
	/*
		Underdefined
	*/
		PseudoInverseA = 
		(
			inverse(
				(transpose(actuatedA)*actuatedA)+
					diag(abs(actuatorsControllable-1))
			)-
			diag(
				abs(actuatorsControllable-1)
			)
		)*
		transpose(actuatedA);
	end;

/*	PseudoInverseA2 = 0.5*[	r/(x+y), 	r,		r;
									-r/(x+y),	-r, 	r;
									r/(x+y),		-r, 	r;
									-r/(x+y),	r, 	r ];
*/
	
	motor.e = PseudoInverseA * virtualJoints.e;
	virtualJoints.f = transpose(PseudoInverseA)*motor.f;





implementation_end;
        end;
        connections
         Mux\input1 => VirtualLinkMap\virtualJoints;
         VirtualLinkMap\motor => Demux\input1;
         Mux\input2 => MTF\p1;
         output1 => Mux\output;
         Demux\output => output2;
         MTF\p2 => Demux\input2;
         Splitter\input <- actuatorControllable;
         Splitter\output2 -> MTF\actuatorControllable;
         Splitter\output1 -> VirtualLinkMap\actuatorsControllable;
        end;
        parameterrelations
VirtualLinkMap\MecanumWheelRadius = MecanumWheelRadius;
VirtualLinkMap\Wheelpos = Wheelpos;parameterrelations_end;
       implementation_end;
      SignalMonitor 1032 752
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
  <LibraryPath>Signal\Block Diagram\SignalMonitor.emx</LibraryPath>
  <TimeStamp>2007-9-26 12:14:4</TimeStamp>
</Description>
';
       type SignalMonitor
        ports
         signal in input [9,1];
       end;
       icon bg bottom
        figures
         rectangle 1016 736 1048 768 fill 15132390;
         rectangle 1021.7 741.8 1042.3 762.6 color 16711680 fill 11776947 width 2;
         rectangle 1023.8 744.4 1039.9 760 color -1 fill 16777215;
         line 1025.9 746.7 1025.9 758 fill 16777215;
         line 1024 756.4 1036.5 756.4 fill 16777215;
         line 1025.5 756.1 1038.4 749.7 color 255 fill 16777215;
       end;
       implementation eq

   implementation_end;
      Splitter1 792 464
       description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       knot Splitter
        ports
         signal knot duplicatable out output [9,1];
         signal knot in input [9,1];
       end;
       icon bg ellipse
        figures
         ellipse 788.8 460.8 795.2 467.2 color -1 fill 0;
         ellipse 787.7 459.7 796.3 468.3 color -1;
        terminals
         input 792 464 fixed;
       end;
       implementation eq
equations
    collect (output) = input;
implementation_end;
      Splitter2 1168 464
       description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       knot Splitter
        ports
         signal knot duplicatable out output [9,1];
         signal knot in input [9,1];
       end;
       icon bg ellipse
        figures
         ellipse 1164.8 460.8 1171.2 467.2 color -1 fill 0;
         ellipse 1163.7 459.7 1172.3 468.3 color -1;
        terminals
         input 1168 464 fixed;
       end;
       implementation eq
equations
    collect (output) = input;
implementation_end;
      Splitter3 616 776
       description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       knot Splitter
        ports
         signal knot duplicatable out output [9,1];
         signal knot in input [9,1];
       end;
       icon bg ellipse
        figures
         ellipse 612.8 772.8 619.2 779.2 color -1 fill 0;
         ellipse 611.7 771.7 620.3 780.3 color -1;
        terminals
         input 616 776 fixed;
       end;
       implementation eq
equations
    collect (output) = input;
implementation_end;
      Splitter4 968 824
       description '<Description><Version>4.0</Version>
   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>
  <TimeStamp>2008-01-17 11:28:29</TimeStamp>
<IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       knot Splitter
        ports
         signal knot duplicatable out output [9,1];
         signal knot in input [9,1];
       end;
       icon bg ellipse
        figures
         ellipse 964.8 820.8 971.2 827.2 color -1 fill 0;
         ellipse 963.7 819.7 972.3 828.3 color -1;
        terminals
         input 968 824 fixed;
       end;
       implementation eq
equations
    collect (output) = input;
implementation_end;
      VirtualPosition 464 32
       description '<Description>
 <Version>4.0</Version>
 <IsMainModel>1</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
 <LibraryPath>Signal\Sources\Constant.emx</LibraryPath>
 <TimeStamp>2007-10-19 14:48:44</TimeStamp>
 <AllowLibraryUpdate>True</AllowLibraryUpdate>
</Description>';
       type Constant
        ports
         signal out output [4,4];
       end;
       icon bg right
        figures
         rectangle 448.1 16 479.9 48 fill 15132390;
         line 452.9 27.6 474.9 27.6 color 16711680 width 2;
         line 450.2 38.7 475.9 38.7;
         line 452.5 22.7 452.5 41;
       end;
       implementation eq
variables
	real R[3,3];
	real p[3];
	real omega[3];
	real theta;
equations
	omega = [0;1;0];
	theta = pi/2;
	p = [3;3;0.25];	

//Rodrigues formula
	R = eye(3) + skew(omega)*sin(theta) + skew(omega)*skew(omega)*(1-cos(theta));
		

	output = homogeneous(R,p);
     implementation_end;
      X0 792 584
       description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       type X0
        ports
         power in p2 [9,1];
         power out p12 [9,1];
         signal in condition [9,1];
        restrictions
         causality fixed in p12;
         causality fixed out p2;
       end;
       icon bg
        figures
         text 'X0' 792 584 color 8388608 18 bold;
       end;
       implementation eq
equations
	p2.e = diag(abs(condition-1))*p12.e;
 	p12.f = diag(abs(condition-1))*p2.f;implementation_end;
      X1 792 1184
       description '<Description>
 <IsMainModel>0</IsMainModel>
 <KeepParameterValues>False</KeepParameterValues>
</Description>';
       type X0
        ports
         power in p2 [9,1];
         power out p12 [9,1];
         signal in condition [9,1];
        restrictions
         causality fixed in p12;
         causality fixed out p2;
       end;
       icon bg
        figures
         text 'X0' 792 1184 color 8388608 18 bold;
       end;
       implementation eq
equations
	p2.e = diag(abs(condition-1))*p12.e;
 	p12.f = diag(abs(condition-1))*p2.f;implementation_end;
      ZeroJunction 616 1000
       description '<Description><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>
   <LibraryPath>Bond Graph\ZeroJunction.emx</LibraryPath>
  <TimeStamp>2007-9-27 9:51:43</TimeStamp>
</Description>';
       knot ZeroJunction
        ports
         power knot duplicatable none p [9,1];
         signal knot out effort [9,1];
        restrictions
         causality constraint one_in p;
       end;
       icon bg
        figures
         text '0' 616 1000 18 bold;
       end;
       implementation eq
equations
	sum (direct (p.f)) = 0;
	equal (collect (p.e));
	effort = first (p.e);
implementation_end;
     end;
     connections
      OneJunction3\p => OneJunction12\p;
      OneJunction\p => OneJunction9\p;
      OneJunction5\p <= X0\p12;
      X1\p12 => OneJunction4\p;
      GravityCompensation\joints => OneJunction12\p;
      OneJunction3\p <= FlowSensor2\p2;
      Rcontrol\p <= OneJunction3\p;
      EffortSensor1\p2 => OneJunction\p 464 1096;
      ControllableJ\tip <= OneJunction2\p;
      ZeroJunction\p => QSensor1\p1;
      SerialLinkToRobot\output2 => EffortSensor1\p1;
      OneJunction11\p => OneJunction10\p;
      Cinterconnection\p <= OneJunction11\p;
      OneJunction8\p => OneJunction6\p;
      OneJunction3\p => CendstopAvoidanceControl\p;
      OneJunction1\p => ZeroJunction\p;
      ObserverBreakR\p <= OneJunction4\p;
      OneJunction9\p => X1\p2;
      OneJunction12\p => SerialLinkToRobot\output1;
      FlowSensor2\p1 <= ControllableJ\joints;
      OneJunction8\p => EncoderIdeal\p;
      QSensor1\p2 => OneJunction\p;
      PlantBreakR\p <= OneJunction5\p;
      OneJunction6\p => Plant\joints;
      Iinterconnection\p <= OneJunction10\p;
      PlantBreakC\p <= OneJunction5\p;
      ObserverBreakC\p <= OneJunction4\p;
      MSe\p => OneJunction8\p;
      OneJunction2\p => CtipControl\p;
      CobserverControl\p <= OneJunction1\p;
      OneJunction6\p => X0\p2;
      OneJunction10\p => ZeroJunction\p;
      RobserverControl\p <= OneJunction1\p;
      OneJunction9\p => Observer\joints;
      FlowSensor2\flow -> CalculateJ\jointVelocities 552 288;
      EncoderIdeal\output -> Splitter3\input;
      Splitter3\output -> PlusMinus\minus;
      Splitter3\output -> Cinterconnection\state;
      QSensor1\q -> PlusMinus\plus 936 1040;
      Diagnostics\useActuator -> Splitter2\input;
      PlusMinus\output -> Splitter4\input;
      X1\condition <- Splitter2\output 1240 1184 1240 464;
      Splitter1\output -> SerialLinkToRobot\actuatorControllable;
      Splitter4\output -> SignalMonitor\input;
      Splitter1\output -> X0\condition;
      failure\output -> MSe\working;
      VirtualPosition\output -> CtipControl\Hvp0;
      CalculateJ\controllableJ -> ControllableJ\controlledJ;
      Splitter4\output -> Diagnostics\residuals;
      Splitter1\input <- Splitter2\output;
      EffortSensor1\effort -> MSe\effort;
      failure1\output -> EncoderIdeal\failure;
      CalculateJ\Htip0 -> CtipControl\Htip0 552 88;
     end;
     parameterrelations
CalculateJ\InitialBasePos = InitialBasePos;
CalculateJ\InitialJointPos = InitialJointPos;
CalculateJ\Linkdim = Linkdim;

CendstopAvoidanceControl\CendstopAvoidanceControl = CendstopAvoidanceControl;
CendstopAvoidanceControl\dangerzone = EndstopDangerzone;
CendstopAvoidanceControl\MaxEndstopPos = MaxEndstopPos;
CendstopAvoidanceControl\MinEndstopPos = MinEndstopPos;
CendstopAvoidanceControl\InitialJointPos = InitialJointPos;

CobserverControl\CobserverControl = CobserverControl;
CobserverControl\Wheelpos = Wheelpos;
CobserverControl\MecanumWheelRadius = MecanumWheelRadius;


CtipControl\CtipControl = CtipControl;

GravityCompensation\InitialJointPos = InitialJointPos;
GravityCompensation\LinkCOMdim = LinkCOMdim;
GravityCompensation\Linkdim = Linkdim;
GravityCompensation\Linkm = Linkm;

Observer\Cconstraint = Cconstraint;
Observer\InitialBasePos = InitialBasePos;
Observer\InitialJointPos = InitialJointPos;
Observer\LinkCOMdim = LinkCOMdim;
Observer\Linkdim = Linkdim;
Observer\LinkI = LinkI;
Observer\Linkm = Linkm;
Observer\MaxEndstopPos = MaxEndstopPos;
Observer\MecanumWheelRadius = MecanumWheelRadius;
Observer\MinEndstopPos = MinEndstopPos;
Observer\Rconstraint = Rconstraint;
Observer\Rjoint = Rjoint;
Observer\Wheelpos = Wheelpos;
Observer\Rwheel = Rwheel;

Plant\Cconstraint = Cconstraint;
Plant\InitialBasePos = InitialBasePos;
Plant\InitialJointPos = InitialJointPos;
Plant\LinkCOMdim = LinkCOMdim;
Plant\Linkdim = Linkdim;
Plant\LinkI = LinkI;
Plant\Linkm = Linkm;
Plant\MaxEndstopPos = MaxEndstopPos;
Plant\MecanumWheelRadius = MecanumWheelRadius;
Plant\MinEndstopPos = MinEndstopPos;
Plant\Rconstraint = Rconstraint;
Plant\Rjoint = Rjoint;
Plant\Wheelpos = Wheelpos;
Plant\Rwheel = Rwheel;

ObserverBreakC\Cbreaks = Cbreaks;
ObserverBreakR\Rbreaks = Rbreaks;

PlantBreakC\Cbreaks = Cbreaks;
PlantBreakR\Rbreaks = Rbreaks;

Rcontrol\Rcontrol = Rcontrol;


RobserverControl\RobserverControl = RobserverControl;
RobserverControl\Wheelpos = Wheelpos;
RobserverControl\MecanumWheelRadius = MecanumWheelRadius;

SerialLinkToRobot\Wheelpos = Wheelpos;
SerialLinkToRobot\MecanumWheelRadius = MecanumWheelRadius;

parameterrelations_end;
     figures
      rectangle 337 431 1087 1057 fill 16777152;
      rectangle 640 1144 840 1256 fill 14745599;
      rectangle 640 544 840 664 fill 14745599;
      rectangle 336 256 896 432 fill 14745599;
      rectangle 336 8 896 192 fill 16443110;
      text '(Virtual) joint space' 832 408 16;
      text 'Work space' 848 168 16;
      text 'motor vectors:
[1] = LF
[2] = RF
[3] = LR
[4] = RR
[5] = Joint1
[6] = Joint2
[7] = Joint3
[8] = Joint4
[9] = Joint5' 1024 568 16;
      text 'actuator space' 1024 1256 16;
      text 'Mechanical breaks' 712 560 color 8388608 18 bold;
      text 'Mechanical breaks' 712 1160 color 8388608 18 bold;
    implementation_end;
  end;
  connections
  end;
 implementation_end;
]]>
</Sidops>
 </Model>
 <Experiments>
     <DefaultExperiment><![CDATA[Experiment 1]]>
</DefaultExperiment>
  <Experiment>
    <Name>Experiment 1</Name>
    <CreatedBy></CreatedBy>
    <Info></Info>
<ExpData>
  <VersionNumber>4.1</VersionNumber>
  <ModelProperties>
    <ModelProperty section="CCodeDialog" entry="SubmodelName" value="model\GravityCompensation"/>
    <ModelProperty section="CCodeDialog" entry="TargetName" value="C++ class for 20-sim submodel"/>
    <ModelProperty section="processing" entry="optimizationsDependent" value="0"/>
    <ModelProperty section="processing" entry="debug_optimizationsDependent" value="0"/>
    <ModelProperty section="processing" entry="optimizationsAlgebraic" value="0"/>
    <ModelProperty section="processing" entry="debug_optimizationsAlgebraic" value="0"/>
    <ModelProperty section="processing" entry="optimizationsMoves" value="0"/>
    <ModelProperty section="processing" entry="debug_optimizationsMoves" value="0"/>
    <ModelProperty section="processing" entry="optimizationsCategories" value="0"/>
    <ModelProperty section="processing" entry="debug_optimizationsCategories" value="0"/>
    <ModelProperty section="processing" entry="showresult" value="1"/>
    <ModelProperty section="processing" entry="debug_showresult" value="1"/>
  </ModelProperties>
  <Variables>
   <Constants>
   </Constants>
   <Parameters>
    <Variable>
     <Name>epsilon</Name>
     <Value>0</Value>
    </Variable>
   </Parameters>
   <Initials>
    <Variable>
     <Name>model\CalculateJ\initialq</Name>
     <Rows>8</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\CendstopAvoidanceControl\initstate</Name>
     <Rows>8</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Cinterconnection\p.f_int_initial</Name>
     <Rows>9</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\CobserverControl\state_initial</Name>
     <Rows>8</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\EncoderIdeal\output_initial</Name>
     <Rows>9</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\EncoderIdeal\p.f_int_initial</Name>
     <Rows>9</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Iinterconnection\state_initial</Name>
     <Rows>9</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\ObserverBreakC\state_initial</Name>
     <Rows>9</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\Base\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\Joint12\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\Joint12\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\Joint23\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\Joint23\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\Joint34\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\Joint34\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\Joint45\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\Joint45\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\JointBase1\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\JointBase1\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\Link1\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\Link2\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\Link3\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\Link4\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\Link5\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\MecanumWheels\Cfloor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\MecanumWheels\MecanumWheelAnimation\qWheelLF_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\MecanumWheels\MecanumWheelAnimation\qWheelLR_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\MecanumWheels\MecanumWheelAnimation\qWheelRF_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Observer\MecanumWheels\MecanumWheelAnimation\qWheelRR_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\PlantBreakC\state_initial</Name>
     <Rows>9</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\Base\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\Joint12\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\Joint12\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\Joint23\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\Joint23\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\Joint34\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\Joint34\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\Joint45\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\Joint45\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\JointBase1\EndstopMax\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\JointBase1\EndstopMin\Cendstop\state_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\Link1\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\Link2\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\Link3\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\Link4\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\Link5\InertialTensor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\MecanumWheels\Cfloor\state_initial</Name>
     <Rows>6</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\MecanumWheels\MecanumWheelAnimation\qWheelLF_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\MecanumWheels\MecanumWheelAnimation\qWheelLR_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\MecanumWheels\MecanumWheelAnimation\qWheelRF_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\Plant\MecanumWheels\MecanumWheelAnimation\qWheelRR_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>model\QSensor1\q_initial</Name>
     <Rows>9</Rows>
     <Columns>1</Columns>
     <Value>0 0 0 0 0 0 0 0 0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
    <Variable>
     <Name>new_initial</Name>
     <Value>0</Value>
    </Variable>
   </Initials>
  </Variables>
  <PlotSpecs>
   <VarNames>
    <VarName>time</VarName>
    <VarName>model\Plant\Link2\Hin[1,4]</VarName>
    <VarName>model\Plant\Link2\Hin[2,4]</VarName>
    <VarName>model\Plant\Link2\Hin[3,4]</VarName>
    <VarName>model\Plant\Link2\Hin[1,3]</VarName>
    <VarName>model\Plant\Link2\Hin[2,3]</VarName>
    <VarName>model\Plant\Link2\Hin[3,3]</VarName>
    <VarName>model\Plant\Link2\Hin[1,2]</VarName>
    <VarName>model\Plant\Link2\Hin[2,2]</VarName>
    <VarName>model\Plant\Link2\Hin[3,2]</VarName>
    <VarName>model\Plant\Link3\Hin[1,3]</VarName>
    <VarName>model\Plant\Link3\Hin[2,3]</VarName>
    <VarName>model\Plant\Link3\Hin[3,3]</VarName>
    <VarName>model\Plant\Link3\Hin[1,2]</VarName>
    <VarName>model\Plant\Link3\Hin[2,2]</VarName>
    <VarName>model\Plant\Link3\Hin[3,2]</VarName>
    <VarName>model\Plant\Link3\Hin[1,4]</VarName>
    <VarName>model\Plant\Link3\Hin[2,4]</VarName>
    <VarName>model\Plant\Link3\Hin[3,4]</VarName>
    <VarName>model\Plant\Link1\Hin[1,4]</VarName>
    <VarName>model\Plant\Link1\Hin[2,4]</VarName>
    <VarName>model\Plant\Link1\Hin[3,4]</VarName>
    <VarName>model\Plant\Link1\Hin[1,3]</VarName>
    <VarName>model\Plant\Link1\Hin[2,3]</VarName>
    <VarName>model\Plant\Link1\Hin[3,3]</VarName>
    <VarName>model\Plant\Link1\Hin[1,2]</VarName>
    <VarName>model\Plant\Link1\Hin[2,2]</VarName>
    <VarName>model\Plant\Link1\Hin[3,2]</VarName>
    <VarName>model\Plant\Link4\Hin[1,3]</VarName>
    <VarName>model\Plant\Link4\Hin[2,3]</VarName>
    <VarName>model\Plant\Link4\Hin[3,3]</VarName>
    <VarName>model\Plant\Link4\Hin[1,2]</VarName>
    <VarName>model\Plant\Link4\Hin[2,2]</VarName>
    <VarName>model\Plant\Link4\Hin[3,2]</VarName>
    <VarName>model\Plant\Link4\Hin[1,4]</VarName>
    <VarName>model\Plant\Link4\Hin[2,4]</VarName>
    <VarName>model\Plant\Link4\Hin[3,4]</VarName>
    <VarName>model\Plant\Link5\Hin[1,4]</VarName>
    <VarName>model\Plant\Link5\Hin[2,4]</VarName>
    <VarName>model\Plant\Link5\Hin[3,4]</VarName>
    <VarName>model\Plant\Link5\Hin[1,3]</VarName>
    <VarName>model\Plant\Link5\Hin[2,3]</VarName>
    <VarName>model\Plant\Link5\Hin[3,3]</VarName>
    <VarName>model\Plant\Link5\Hin[1,2]</VarName>
    <VarName>model\Plant\Link5\Hin[2,2]</VarName>
    <VarName>model\Plant\Link5\Hin[3,2]</VarName>
    <VarName>model\Plant\Base\Hin[1,3]</VarName>
    <VarName>model\Plant\Base\Hin[2,3]</VarName>
    <VarName>model\Plant\Base\Hin[3,3]</VarName>
    <VarName>model\Plant\Base\Hin[1,2]</VarName>
    <VarName>model\Plant\Base\Hin[2,2]</VarName>
    <VarName>model\Plant\Base\Hin[3,2]</VarName>
    <VarName>model\Plant\Base\Hin[1,4]</VarName>
    <VarName>model\Plant\Base\Hin[2,4]</VarName>
    <VarName>model\Plant\Base\Hin[3,4]</VarName>
    <VarName>model\CalculateJ\Htip0[1,4]</VarName>
    <VarName>model\CalculateJ\Htip0[2,4]</VarName>
    <VarName>model\CalculateJ\Htip0[3,4]</VarName>
    <VarName>model\CalculateJ\Htip0[1,3]</VarName>
    <VarName>model\CalculateJ\Htip0[2,3]</VarName>
    <VarName>model\CalculateJ\Htip0[3,3]</VarName>
    <VarName>model\CalculateJ\Htip0[1,2]</VarName>
    <VarName>model\CalculateJ\Htip0[2,2]</VarName>
    <VarName>model\CalculateJ\Htip0[3,2]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,4]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,4]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,4]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,3]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,3]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,3]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,2]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,2]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,2]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,4]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,4]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,4]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,3]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,3]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,3]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,2]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,2]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,2]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,4]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,4]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,4]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,3]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,3]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,3]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,2]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,2]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,2]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,4]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,4]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,4]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,3]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,3]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,3]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,2]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,2]</VarName>
    <VarName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,2]</VarName>
    <VarName>model\VirtualPosition\output[1,4]</VarName>
    <VarName>model\VirtualPosition\output[2,4]</VarName>
    <VarName>model\VirtualPosition\output[3,4]</VarName>
    <VarName>model\VirtualPosition\output[1,3]</VarName>
    <VarName>model\VirtualPosition\output[2,3]</VarName>
    <VarName>model\VirtualPosition\output[3,3]</VarName>
    <VarName>model\VirtualPosition\output[1,2]</VarName>
    <VarName>model\VirtualPosition\output[2,2]</VarName>
    <VarName>model\VirtualPosition\output[3,2]</VarName>
    <VarName>model\SignalMonitor\input[2]</VarName>
    <VarName>model\Diagnostics\actuatorControllable_hold[2]</VarName>
    <VarName>model\failure\output[2]</VarName>
    <VarName>model\X0\condition[1]</VarName>
    <VarName>model\X0\condition[2]</VarName>
    <VarName>model\X0\condition[3]</VarName>
    <VarName>model\X0\condition[4]</VarName>
    <VarName>model\X0\condition[5]</VarName>
    <VarName>model\X0\condition[6]</VarName>
    <VarName>model\X0\condition[7]</VarName>
    <VarName>model\X0\condition[8]</VarName>
    <VarName>model\X0\condition[9]</VarName>
    <VarName>model\SignalMonitor\input[1]</VarName>
    <VarName>model\SignalMonitor\input[3]</VarName>
    <VarName>model\SignalMonitor\input[4]</VarName>
    <VarName>model\SignalMonitor\input[5]</VarName>
    <VarName>model\SignalMonitor\input[6]</VarName>
    <VarName>model\SignalMonitor\input[7]</VarName>
    <VarName>model\SignalMonitor\input[8]</VarName>
    <VarName>model\SignalMonitor\input[9]</VarName>
    <VarName>model\CtipControl\state[1,1]</VarName>
    <VarName>model\CtipControl\state[2,2]</VarName>
    <VarName>model\CtipControl\state[3,3]</VarName>
    <VarName>model\CtipControl\Wr[1]</VarName>
    <VarName>model\CtipControl\Wr[2]</VarName>
    <VarName>model\CtipControl\Wr[3]</VarName>
    <VarName>model\CtipControl\Wr[4]</VarName>
    <VarName>model\CtipControl\Wr[5]</VarName>
    <VarName>model\CtipControl\Wr[6]</VarName>
   </VarNames>
   <Plots>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <UseWindowsBGColor>true</UseWindowsBGColor>
       <BGColor>14215660</BGColor>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>true</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>ObserverCorrectionTorques</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>false</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>30</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-2.5e-012</Minimum>
       <Maximum>2.5e-012</Maximum>
       <Linear>true</Linear>
       <Scaling>2</Scaling>
       <Label>residual</Label>
      </Axis>
      <Axis>
       <Minimum>-0.5</Minimum>
       <Maximum>0.5</Maximum>
       <Linear>true</Linear>
       <Scaling>2</Scaling>
       <Label>failure</Label>
      </Axis>
      <Axis>
       <Minimum>0.5</Minimum>
       <Maximum>1.5</Maximum>
       <Linear>true</Linear>
       <Scaling>2</Scaling>
       <Label>Effector operational</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>0</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>255</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>3</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\SignalMonitor\input[2]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>8355711</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16711935</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>3</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\failure\output[2]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>12632256</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>65280</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>3</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\Diagnostics\actuatorControllable_hold[2]</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
     </Legenda>
     <StripChartPlots>
      <DistributState>0</DistributState>
     </StripChartPlots>
    </Plot>
    <Plot>
     <PlotType>D3DPlot</PlotType>
     <BasePlot>
       <UseWindowsBGColor>true</UseWindowsBGColor>
       <BGColor>14215660</BGColor>
     </BasePlot>
     <RenderQuality>137</RenderQuality>
     <ShowGrid>true</ShowGrid>
     <BackgroundColor>4294967295</BackgroundColor>
     <FrameScale>1</FrameScale>
     <FrameThickness>1</FrameThickness>
     <MainFrame>
      <Frame>
       <ScaleValue>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </ScaleValue>
       <ShowReferenceFrame>true</ShowReferenceFrame>
       <Name>Reference Frame</Name>
       <Position>
       </Position>
       <Orientation>
        <Angles>
        </Angles>
        <OrientationType>Bryant</OrientationType>
       </Orientation>
       <LockX>false</LockX>
       <LockY>false</LockY>
       <LockZ>false</LockZ>
       <LockXPitch>false</LockXPitch>
       <LockYYaw>false</LockYYaw>
       <LockZRoll>false</LockZRoll>
       <Childs>
        <Frame>
         <ScaleValue>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <ShowReferenceFrame>false</ShowReferenceFrame>
         <Name>youbot as serial link_with base_withwheels</Name>
         <SceneryFileName>E:\My Dropbox\Studie en werk\UTwente\Master project\Interactive control\Models\youbot as serial link_with base_withwheels.scn</SceneryFileName>
         <Position>
         </Position>
         <Orientation>
     <Angles>
     </Angles>
     <OrientationType>Bryant</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
     <Frame>
      <ScaleValue>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </ScaleValue>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Robot</Name>
      <Position>
      </Position>
      <Orientation>
       <Angles>
       </Angles>
       <OrientationType>Bryant</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
       <Cube>
        <Center>Bottom</Center>
        <RibLength>1</RibLength>
        <ShowInnerSide>true</ShowInnerSide>
        <Accuracy>4</Accuracy>
        <ScaleValue>
         <X>
     <Value>0.055</Value>
         </X>
         <Y>
     <Value>0.09</Value>
         </Y>
         <Z>
     <Value>0.155</Value>
         </Z>
        </ScaleValue>
        <OverrideColor>true</OverrideColor>
        <MeshColor>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>0.552941176470588</Value>
         </Y>
         <Z>
     <Value>0.109803921568627</Value>
         </Z>
        </MeshColor>
        <Alpha>1</Alpha>
        <MeshColorMultipliers>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </MeshColorMultipliers>
        <MeshColorOffsets>
        </MeshColorOffsets>
        <Direct3DColorRange>true</Direct3DColorRange>
        <SpecularColor>
         <X>
     <Value>0.498039215686275</Value>
         </X>
         <Y>
     <Value>0.498039215686275</Value>
         </Y>
         <Z>
     <Value>0.498039215686275</Value>
         </Z>
        </SpecularColor>
        <EmissiveColor>
        </EmissiveColor>
        <ShininessPower>
         <Value>14.298713684082</Value>
        </ShininessPower>
        <OverrideQuality>false</OverrideQuality>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Link2</Name>
        <Position>
         <X>
     <VariableName>model\Plant\Link2\Hin[1,4]</VariableName>
     <Value>2.39265045581434</Value>
         </X>
         <Y>
     <VariableName>model\Plant\Link2\Hin[2,4]</VariableName>
     <Value>2.84268065304676</Value>
         </Y>
         <Z>
     <VariableName>model\Plant\Link2\Hin[3,4]</VariableName>
     <Value>0.132893672036233</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <VariableName>model\Plant\Link2\Hin[1,3]</VariableName>
      <Value>0.900211686098363</Value>
     </X>
     <Y>
      <VariableName>model\Plant\Link2\Hin[2,3]</VariableName>
      <Value>0.0519944843295319</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\Link2\Hin[3,3]</VariableName>
      <Value>0.432337245459201</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <VariableName>model\Plant\Link2\Hin[1,2]</VariableName>
      <Value>-0.0575963031305513</Value>
     </X>
     <Y>
      <VariableName>model\Plant\Link2\Hin[2,2]</VariableName>
      <Value>0.998339945634221</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\Link2\Hin[3,2]</VariableName>
      <Value>-0.000137174174238044</Value>
     </Z>
         </YAxis>
         <OrientationType>Matrix</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
       </Cube>
       <Cube>
        <Center>Bottom</Center>
        <RibLength>1</RibLength>
        <ShowInnerSide>true</ShowInnerSide>
        <Accuracy>4</Accuracy>
        <ScaleValue>
         <X>
     <Value>0.055</Value>
         </X>
         <Y>
     <Value>0.09</Value>
         </Y>
         <Z>
     <Value>0.135</Value>
         </Z>
        </ScaleValue>
        <OverrideColor>true</OverrideColor>
        <MeshColor>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>0.552941176470588</Value>
         </Y>
         <Z>
     <Value>0.109803921568627</Value>
         </Z>
        </MeshColor>
        <Alpha>1</Alpha>
        <MeshColorMultipliers>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </MeshColorMultipliers>
        <MeshColorOffsets>
        </MeshColorOffsets>
        <Direct3DColorRange>true</Direct3DColorRange>
        <SpecularColor>
         <X>
     <Value>0.5</Value>
         </X>
         <Y>
     <Value>0.5</Value>
         </Y>
         <Z>
     <Value>0.5</Value>
         </Z>
        </SpecularColor>
        <EmissiveColor>
        </EmissiveColor>
        <ShininessPower>
         <Value>15</Value>
        </ShininessPower>
        <OverrideQuality>false</OverrideQuality>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Link3</Name>
        <Position>
         <X>
     <VariableName>model\Plant\Link3\Hin[1,4]</VariableName>
     <Value>2.53218333050325</Value>
         </X>
         <Y>
     <VariableName>model\Plant\Link3\Hin[2,4]</VariableName>
     <Value>2.85073980177645</Value>
         </Y>
         <Z>
     <VariableName>model\Plant\Link3\Hin[3,4]</VariableName>
     <Value>0.19990597550395</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <VariableName>model\Plant\Link3\Hin[1,3]</VariableName>
      <Value>0.993105807259123</Value>
     </X>
     <Y>
      <VariableName>model\Plant\Link3\Hin[2,3]</VariableName>
      <Value>0.05730838834884</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\Link3\Hin[3,3]</VariableName>
      <Value>0.102257538661287</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <VariableName>model\Plant\Link3\Hin[1,2]</VariableName>
      <Value>-0.0575963062697558</Value>
     </X>
     <Y>
      <VariableName>model\Plant\Link3\Hin[2,2]</VariableName>
      <Value>0.998339945453152</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\Link3\Hin[3,2]</VariableName>
      <Value>-0.000137173896449655</Value>
     </Z>
         </YAxis>
         <OrientationType>Matrix</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
       </Cube>
       <Cylinder>
        <CircleElements>16</CircleElements>
        <LowerRadius>0.09</LowerRadius>
        <UpperRadius>0.09</UpperRadius>
        <Height>1</Height>
        <Closed>true</Closed>
        <LowerClosed>true</LowerClosed>
        <UpperClosed>true</UpperClosed>
        <CenterInOrigin>false</CenterInOrigin>
        <ShowInnerSide>false</ShowInnerSide>
        <ShowOuterSide>true</ShowOuterSide>
        <ScaleValue>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>0.075</Value>
         </Z>
        </ScaleValue>
        <OverrideColor>true</OverrideColor>
        <MeshColor>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>0.552941176470588</Value>
         </Y>
         <Z>
     <Value>0.109803921568627</Value>
         </Z>
        </MeshColor>
        <Alpha>1</Alpha>
        <MeshColorMultipliers>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </MeshColorMultipliers>
        <MeshColorOffsets>
        </MeshColorOffsets>
        <Direct3DColorRange>true</Direct3DColorRange>
        <SpecularColor>
         <X>
     <Value>0.5</Value>
         </X>
         <Y>
     <Value>0.5</Value>
         </Y>
         <Z>
     <Value>0.5</Value>
         </Z>
        </SpecularColor>
        <EmissiveColor>
        </EmissiveColor>
        <ShininessPower>
         <Value>15</Value>
        </ShininessPower>
        <OverrideQuality>false</OverrideQuality>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Link1</Name>
        <Position>
         <X>
     <VariableName>model\Plant\Link1\Hin[1,4]</VariableName>
     <Value>2.39273207924819</Value>
         </X>
         <Y>
     <VariableName>model\Plant\Link1\Hin[2,4]</VariableName>
     <Value>2.84267505670871</Value>
         </Y>
         <Z>
     <VariableName>model\Plant\Link1\Hin[3,4]</VariableName>
     <Value>0.0578937164786033</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <VariableName>model\Plant\Link1\Hin[1,3]</VariableName>
      <Value>-0.00108831244864916</Value>
     </X>
     <Y>
      <VariableName>model\Plant\Link1\Hin[2,3]</VariableName>
      <Value>7.46178405559837e-005</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\Link1\Hin[3,3]</VariableName>
      <Value>0.999999405003919</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <VariableName>model\Plant\Link1\Hin[1,2]</VariableName>
      <Value>-0.0575963015338496</Value>
     </X>
     <Y>
      <VariableName>model\Plant\Link1\Hin[2,2]</VariableName>
      <Value>0.998339945725974</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\Link1\Hin[3,2]</VariableName>
      <Value>-0.000137176824465962</Value>
     </Z>
         </YAxis>
         <OrientationType>Matrix</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
       </Cylinder>
       <Cube>
        <Center>Bottom</Center>
        <RibLength>1</RibLength>
        <ShowInnerSide>true</ShowInnerSide>
        <Accuracy>4</Accuracy>
        <ScaleValue>
         <X>
     <Value>0.055</Value>
         </X>
         <Y>
     <Value>0.1</Value>
         </Y>
         <Z>
     <Value>0.081</Value>
         </Z>
        </ScaleValue>
        <OverrideColor>true</OverrideColor>
        <MeshColor>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>0.552941176470588</Value>
         </Y>
         <Z>
     <Value>0.109803921568627</Value>
         </Z>
        </MeshColor>
        <Alpha>1</Alpha>
        <MeshColorMultipliers>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </MeshColorMultipliers>
        <MeshColorOffsets>
        </MeshColorOffsets>
        <Direct3DColorRange>true</Direct3DColorRange>
        <SpecularColor>
         <X>
     <Value>0.5</Value>
         </X>
         <Y>
     <Value>0.5</Value>
         </Y>
         <Z>
     <Value>0.5</Value>
         </Z>
        </SpecularColor>
        <EmissiveColor>
        </EmissiveColor>
        <ShininessPower>
         <Value>15</Value>
        </ShininessPower>
        <OverrideQuality>false</OverrideQuality>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Link4</Name>
        <Position>
         <X>
     <VariableName>model\Plant\Link4\Hin[1,4]</VariableName>
     <Value>2.66625268502629</Value>
         </X>
         <Y>
     <VariableName>model\Plant\Link4\Hin[2,4]</VariableName>
     <Value>2.85847643827432</Value>
         </Y>
         <Z>
     <VariableName>model\Plant\Link4\Hin[3,4]</VariableName>
     <Value>0.21371075048686</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <VariableName>model\Plant\Link4\Hin[1,3]</VariableName>
      <Value>0.998120556453235</Value>
     </X>
     <Y>
      <VariableName>model\Plant\Link4\Hin[2,3]</VariableName>
      <Value>0.0575807611691326</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\Link4\Hin[3,3]</VariableName>
      <Value>-0.0209716648997757</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <VariableName>model\Plant\Link4\Hin[1,2]</VariableName>
      <Value>-0.0575962997358723</Value>
     </X>
     <Y>
      <VariableName>model\Plant\Link4\Hin[2,2]</VariableName>
      <Value>0.998339945830167</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\Link4\Hin[3,2]</VariableName>
      <Value>-0.000137173447044026</Value>
     </Z>
         </YAxis>
         <OrientationType>Matrix</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
       </Cube>
       <Cube>
        <Center>Bottom</Center>
        <RibLength>1</RibLength>
        <ShowInnerSide>true</ShowInnerSide>
        <Accuracy>4</Accuracy>
        <ScaleValue>
         <X>
     <Value>0.055</Value>
         </X>
         <Y>
     <Value>0.1</Value>
         </Y>
         <Z>
     <Value>0.137</Value>
         </Z>
        </ScaleValue>
        <OverrideColor>true</OverrideColor>
        <MeshColor>
         <X>
     <Value>0.501960784313725</Value>
         </X>
         <Y>
     <Value>0.501960784313725</Value>
         </Y>
         <Z>
     <Value>0.501960784313725</Value>
         </Z>
        </MeshColor>
        <Alpha>1</Alpha>
        <MeshColorMultipliers>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </MeshColorMultipliers>
        <MeshColorOffsets>
        </MeshColorOffsets>
        <Direct3DColorRange>true</Direct3DColorRange>
        <SpecularColor>
         <X>
     <Value>0.5</Value>
         </X>
         <Y>
     <Value>0.5</Value>
         </Y>
         <Z>
     <Value>0.5</Value>
         </Z>
        </SpecularColor>
        <EmissiveColor>
        </EmissiveColor>
        <ShininessPower>
         <Value>15</Value>
        </ShininessPower>
        <OverrideQuality>false</OverrideQuality>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Link5</Name>
        <Position>
         <X>
     <VariableName>model\Plant\Link5\Hin[1,4]</VariableName>
     <Value>2.74710048854582</Value>
         </X>
         <Y>
     <VariableName>model\Plant\Link5\Hin[2,4]</VariableName>
     <Value>2.86314048214698</Value>
         </Y>
         <Z>
     <VariableName>model\Plant\Link5\Hin[3,4]</VariableName>
     <Value>0.212012044822166</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <VariableName>model\Plant\Link5\Hin[1,3]</VariableName>
      <Value>0.998120556453235</Value>
     </X>
     <Y>
      <VariableName>model\Plant\Link5\Hin[2,3]</VariableName>
      <Value>0.0575807611691326</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\Link5\Hin[3,3]</VariableName>
      <Value>-0.0209716648997757</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <VariableName>model\Plant\Link5\Hin[1,2]</VariableName>
      <Value>-0.057555307691738</Value>
     </X>
     <Y>
      <VariableName>model\Plant\Link5\Hin[2,2]</VariableName>
      <Value>0.998340668066866</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\Link5\Hin[3,2]</VariableName>
      <Value>0.00181577540256647</Value>
     </Z>
         </YAxis>
         <OrientationType>Matrix</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
       </Cube>
       <Cube>
        <Center>Bottom</Center>
        <RibLength>1</RibLength>
        <ShowInnerSide>true</ShowInnerSide>
        <Accuracy>4</Accuracy>
        <ScaleValue>
         <X>
     <Value>0.53</Value>
         </X>
         <Y>
     <Value>0.36</Value>
         </Y>
         <Z>
     <Value>0.11</Value>
         </Z>
        </ScaleValue>
        <OverrideColor>true</OverrideColor>
        <MeshColor>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>0.541176470588235</Value>
         </Y>
         <Z>
     <Value>0.0980392156862745</Value>
         </Z>
        </MeshColor>
        <Alpha>1</Alpha>
        <MeshColorMultipliers>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </MeshColorMultipliers>
        <MeshColorOffsets>
        </MeshColorOffsets>
        <Direct3DColorRange>true</Direct3DColorRange>
        <SpecularColor>
         <X>
     <Value>0.498039215686275</Value>
         </X>
         <Y>
     <Value>0.498039215686275</Value>
         </Y>
         <Z>
     <Value>0.498039215686275</Value>
         </Z>
        </SpecularColor>
        <EmissiveColor>
        </EmissiveColor>
        <ShininessPower>
         <Value>14.298713684082</Value>
        </ShininessPower>
        <OverrideQuality>false</OverrideQuality>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Base</Name>
        <Position>
         <X>
     <VariableName>model\Plant\Base\Hin[1,4]</VariableName>
     <Value>2.28193228606267</Value>
         </X>
         <Y>
     <VariableName>model\Plant\Base\Hin[2,4]</VariableName>
     <Value>2.81218785058314</Value>
         </Y>
         <Z>
     <VariableName>model\Plant\Base\Hin[3,4]</VariableName>
     <Value>-0.022224641954093</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <VariableName>model\Plant\Base\Hin[1,3]</VariableName>
      <Value>-0.00108831244864916</Value>
     </X>
     <Y>
      <VariableName>model\Plant\Base\Hin[2,3]</VariableName>
      <Value>7.46178405559837e-005</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\Base\Hin[3,3]</VariableName>
      <Value>0.999999405003919</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <VariableName>model\Plant\Base\Hin[1,2]</VariableName>
      <Value>-0.26505384684815</Value>
     </X>
     <Y>
      <VariableName>model\Plant\Base\Hin[2,2]</VariableName>
      <Value>0.964233544518737</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\Base\Hin[3,2]</VariableName>
      <Value>-0.000360410640413738</Value>
     </Z>
         </YAxis>
         <OrientationType>Matrix</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
       </Cube>
       <Cylinder>
        <CircleElements>16</CircleElements>
        <LowerRadius>0.05</LowerRadius>
        <UpperRadius>0</UpperRadius>
        <Height>1</Height>
        <Closed>true</Closed>
        <LowerClosed>true</LowerClosed>
        <UpperClosed>true</UpperClosed>
        <CenterInOrigin>true</CenterInOrigin>
        <ShowInnerSide>false</ShowInnerSide>
        <ShowOuterSide>true</ShowOuterSide>
        <ScaleValue>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </ScaleValue>
        <OverrideColor>true</OverrideColor>
        <MeshColor>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>0</Value>
         </Y>
         <Z>
     <Value>0</Value>
         </Z>
        </MeshColor>
        <Alpha>0.21</Alpha>
        <MeshColorMultipliers>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </MeshColorMultipliers>
        <MeshColorOffsets>
        </MeshColorOffsets>
        <Direct3DColorRange>true</Direct3DColorRange>
        <SpecularColor>
         <X>
     <Value>0.498039215686275</Value>
         </X>
         <Y>
     <Value>0.498039215686275</Value>
         </Y>
         <Z>
     <Value>0.498039215686275</Value>
         </Z>
        </SpecularColor>
        <EmissiveColor>
        </EmissiveColor>
        <ShininessPower>
         <Value>13.5413365364075</Value>
        </ShininessPower>
        <OverrideQuality>false</OverrideQuality>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Cylinder</Name>
        <Position>
         <X>
     <VariableName>model\CalculateJ\Htip0[1,4]</VariableName>
     <Value>2.88412239432826</Value>
         </X>
         <Y>
     <VariableName>model\CalculateJ\Htip0[2,4]</VariableName>
     <Value>2.87101522558378</Value>
         </Y>
         <Z>
     <VariableName>model\CalculateJ\Htip0[3,4]</VariableName>
     <Value>0.230712749478029</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <VariableName>model\CalculateJ\Htip0[1,3]</VariableName>
      <Value>0.998097135497379</Value>
     </X>
     <Y>
      <VariableName>model\CalculateJ\Htip0[2,3]</VariableName>
      <Value>0.0575825112316527</Value>
     </Y>
     <Z>
      <VariableName>model\CalculateJ\Htip0[3,3]</VariableName>
      <Value>-0.0220536280956857</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <VariableName>model\CalculateJ\Htip0[1,2]</VariableName>
      <Value>-0.0575534018819817</Value>
     </X>
     <Y>
      <VariableName>model\CalculateJ\Htip0[2,2]</VariableName>
      <Value>0.998340519112275</Value>
     </Y>
     <Z>
      <VariableName>model\CalculateJ\Htip0[3,2]</VariableName>
      <Value>0.00195290308126502</Value>
     </Z>
         </YAxis>
         <OrientationType>Matrix</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
       </Cylinder>
       <Cube>
        <Center>Center</Center>
        <RibLength>1</RibLength>
        <ShowInnerSide>true</ShowInnerSide>
        <Accuracy>4</Accuracy>
        <ScaleValue>
         <X>
     <Value>0.12</Value>
         </X>
         <Y>
     <Value>0.12</Value>
         </Y>
         <Z>
     <Value>0.07</Value>
         </Z>
        </ScaleValue>
        <OverrideColor>true</OverrideColor>
        <MeshColor>
         <X>
     <Value>0.403921568627451</Value>
         </X>
         <Y>
     <Value>0.403921568627451</Value>
         </Y>
         <Z>
     <Value>0.403921568627451</Value>
         </Z>
        </MeshColor>
        <Alpha>1</Alpha>
        <MeshColorMultipliers>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </MeshColorMultipliers>
        <MeshColorOffsets>
        </MeshColorOffsets>
        <Direct3DColorRange>true</Direct3DColorRange>
        <SpecularColor>
         <X>
     <Value>0.498039215686275</Value>
         </X>
         <Y>
     <Value>0.498039215686275</Value>
         </Y>
         <Z>
     <Value>0.498039215686275</Value>
         </Z>
        </SpecularColor>
        <EmissiveColor>
        </EmissiveColor>
        <ShininessPower>
         <Value>14.298713684082</Value>
        </ShininessPower>
        <OverrideQuality>false</OverrideQuality>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>WheelLF</Name>
        <Position>
         <X>
     <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,4]</VariableName>
     <Value>2.52894618323819</Value>
         </X>
         <Y>
     <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,4]</VariableName>
     <Value>2.72454312731967</Value>
         </Y>
         <Z>
     <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,4]</VariableName>
     <Value>0.0280507571414602</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,3]</VariableName>
      <Value>0.265052896159265</Value>
     </X>
     <Y>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,3]</VariableName>
      <Value>-0.964233179373082</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,3]</VariableName>
      <Value>0.00115673405059593</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[1,2]</VariableName>
      <Value>-0.894044935728003</Value>
     </X>
     <Y>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[2,2]</VariableName>
      <Value>-0.245309549102301</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLF0[3,2]</VariableName>
      <Value>0.37484247093724</Value>
     </Z>
         </YAxis>
         <OrientationType>Matrix</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
       </Cube>
       <Cube>
        <Center>Center</Center>
        <RibLength>1</RibLength>
        <ShowInnerSide>true</ShowInnerSide>
        <Accuracy>4</Accuracy>
        <ScaleValue>
         <X>
     <Value>0.12</Value>
         </X>
         <Y>
     <Value>0.12</Value>
         </Y>
         <Z>
     <Value>0.07</Value>
         </Z>
        </ScaleValue>
        <OverrideColor>true</OverrideColor>
        <MeshColor>
         <X>
     <Value>0.403921568627451</Value>
         </X>
         <Y>
     <Value>0.403921568627451</Value>
         </Y>
         <Z>
     <Value>0.403921568627451</Value>
         </Z>
        </MeshColor>
        <Alpha>1</Alpha>
        <MeshColorMultipliers>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </MeshColorMultipliers>
        <MeshColorOffsets>
        </MeshColorOffsets>
        <Direct3DColorRange>true</Direct3DColorRange>
        <SpecularColor>
         <X>
     <Value>0.5</Value>
         </X>
         <Y>
     <Value>0.5</Value>
         </Y>
         <Z>
     <Value>0.5</Value>
         </Z>
        </SpecularColor>
        <EmissiveColor>
        </EmissiveColor>
        <ShininessPower>
         <Value>15</Value>
        </ShininessPower>
        <OverrideQuality>false</OverrideQuality>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>WheelRF</Name>
        <Position>
         <X>
     <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,4]</VariableName>
     <Value>2.44942998388633</Value>
         </X>
         <Y>
     <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,4]</VariableName>
     <Value>3.01381335545914</Value>
         </Y>
         <Z>
     <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,4]</VariableName>
     <Value>0.027942634565976</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,3]</VariableName>
      <Value>0.265052896159265</Value>
     </X>
     <Y>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,3]</VariableName>
      <Value>-0.964233179373082</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,3]</VariableName>
      <Value>0.00115673405059593</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[1,2]</VariableName>
      <Value>0.936684963713932</Value>
     </X>
     <Y>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[2,2]</VariableName>
      <Value>0.257195234085054</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRF0[3,2]</VariableName>
      <Value>-0.23763814995948</Value>
     </Z>
         </YAxis>
         <OrientationType>Matrix</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
       </Cube>
       <Cube>
        <Center>Center</Center>
        <RibLength>1</RibLength>
        <ShowInnerSide>true</ShowInnerSide>
        <Accuracy>4</Accuracy>
        <ScaleValue>
         <X>
     <Value>0.12</Value>
         </X>
         <Y>
     <Value>0.12</Value>
         </Y>
         <Z>
     <Value>0.07</Value>
         </Z>
        </ScaleValue>
        <OverrideColor>true</OverrideColor>
        <MeshColor>
         <X>
     <Value>0.403921568627451</Value>
         </X>
         <Y>
     <Value>0.403921568627451</Value>
         </Y>
         <Z>
     <Value>0.403921568627451</Value>
         </Z>
        </MeshColor>
        <Alpha>1</Alpha>
        <MeshColorMultipliers>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </MeshColorMultipliers>
        <MeshColorOffsets>
        </MeshColorOffsets>
        <Direct3DColorRange>true</Direct3DColorRange>
        <SpecularColor>
         <X>
     <Value>0.5</Value>
         </X>
         <Y>
     <Value>0.5</Value>
         </Y>
         <Z>
     <Value>0.5</Value>
         </Z>
        </SpecularColor>
        <EmissiveColor>
        </EmissiveColor>
        <ShininessPower>
         <Value>15</Value>
        </ShininessPower>
        <OverrideQuality>false</OverrideQuality>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>WheelLR</Name>
        <Position>
         <X>
     <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,4]</VariableName>
     <Value>2.11432575699389</Value>
         </X>
         <Y>
     <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,4]</VariableName>
     <Value>2.61056980749122</Value>
         </Y>
         <Z>
     <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,4]</VariableName>
     <Value>0.027608022269344</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,3]</VariableName>
      <Value>0.265052896159265</Value>
     </X>
     <Y>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,3]</VariableName>
      <Value>-0.964233179373082</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,3]</VariableName>
      <Value>0.00115673405059593</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[1,2]</VariableName>
      <Value>-0.475985807029189</Value>
     </X>
     <Y>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[2,2]</VariableName>
      <Value>-0.131884287782164</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HLR0[3,2]</VariableName>
      <Value>-0.869507933341015</Value>
     </Z>
         </YAxis>
         <OrientationType>Matrix</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
       </Cube>
       <Cube>
        <Center>Center</Center>
        <RibLength>1</RibLength>
        <ShowInnerSide>true</ShowInnerSide>
        <Accuracy>4</Accuracy>
        <ScaleValue>
         <X>
     <Value>0.12</Value>
         </X>
         <Y>
     <Value>0.12</Value>
         </Y>
         <Z>
     <Value>0.07</Value>
         </Z>
        </ScaleValue>
        <OverrideColor>true</OverrideColor>
        <MeshColor>
         <X>
     <Value>0.403921568627451</Value>
         </X>
         <Y>
     <Value>0.403921568627451</Value>
         </Y>
         <Z>
     <Value>0.403921568627451</Value>
         </Z>
        </MeshColor>
        <Alpha>1</Alpha>
        <MeshColorMultipliers>
         <X>
     <Value>1</Value>
         </X>
         <Y>
     <Value>1</Value>
         </Y>
         <Z>
     <Value>1</Value>
         </Z>
        </MeshColorMultipliers>
        <MeshColorOffsets>
        </MeshColorOffsets>
        <Direct3DColorRange>true</Direct3DColorRange>
        <SpecularColor>
         <X>
     <Value>0.5</Value>
         </X>
         <Y>
     <Value>0.5</Value>
         </Y>
         <Z>
     <Value>0.5</Value>
         </Z>
        </SpecularColor>
        <EmissiveColor>
        </EmissiveColor>
        <ShininessPower>
         <Value>15</Value>
        </ShininessPower>
        <OverrideQuality>false</OverrideQuality>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>WheelRR</Name>
        <Position>
         <X>
     <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,4]</VariableName>
     <Value>2.03480955764203</Value>
         </X>
         <Y>
     <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,4]</VariableName>
     <Value>2.89984003563069</Value>
         </Y>
         <Z>
     <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,4]</VariableName>
     <Value>0.0274998996938598</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,3]</VariableName>
      <Value>0.265052896159265</Value>
     </X>
     <Y>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,3]</VariableName>
      <Value>-0.964233179373082</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,3]</VariableName>
      <Value>0.00115673405059593</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[1,2]</VariableName>
      <Value>-0.103217521808507</Value>
     </X>
     <Y>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[2,2]</VariableName>
      <Value>-0.029565618584971</Value>
     </Y>
     <Z>
      <VariableName>model\Plant\MecanumWheels\MecanumWheelAnimation\HRR0[3,2]</VariableName>
      <Value>-0.994219300451062</Value>
     </Z>
         </YAxis>
         <OrientationType>Matrix</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
       </Cube>
      </Childs>
     </Frame>
     <Camera>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Camera</Name>
      <Position>
       <X>
        <Value>4.98425715163803</Value>
       </X>
       <Y>
        <Value>-2.1632203316694</Value>
       </Y>
       <Z>
        <Value>2.54512444548332</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <Value>-0.830709525273011</Value>
        </X>
        <Y>
         <Value>0.360536721944903</Value>
        </Y>
        <Z>
         <Value>-0.424187407580556</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <Value>-0.389119336172629</Value>
        </X>
        <Y>
         <Value>0.1688819083457</Value>
        </Y>
        <Z>
         <Value>0.905574427228423</Value>
        </Z>
       </YAxis>
       <OrientationType>Direct3D</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
      </Childs>
      <FrontPlane>0.01</FrontPlane>
      <BackPlane>100</BackPlane>
      <Field>0.00392699081698724</Field>
      <Fieldy>45</Fieldy>
      <PlaneLeft>-10</PlaneLeft>
      <PlaneRight>10</PlaneRight>
      <PlaneTop>10</PlaneTop>
      <PlaneBottom>-10</PlaneBottom>
      <UseLookatPosition>true</UseLookatPosition>
      <LookatPosition>
      </LookatPosition>
      <UseAlwaysLookUp>true</UseAlwaysLookUp>
      <LookUpVector>
       <Z>
        <Value>1</Value>
       </Z>
      </LookUpVector>
      <RightHand>true</RightHand>
      <Perspective>true</Perspective>
      <IsSelectedCamera>false</IsSelectedCamera>
     </Camera>
     <Light>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Ambient</Name>
      <Position>
      </Position>
      <Orientation>
       <ZAxis>
        <Z>
         <Value>1</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <Y>
         <Value>1</Value>
        </Y>
       </YAxis>
       <OrientationType>Direct3D</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
      </Childs>
      <LightType>0</LightType>
      <LightColor>
       <Color>
        <X>
         <Value>0.3</Value>
        </X>
        <Y>
         <Value>0.3</Value>
        </Y>
        <Z>
         <Value>0.3</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </LightColor>
      <AmbientLight>
       <Color>
        <X>
         <Value>0.3</Value>
        </X>
        <Y>
         <Value>0.3</Value>
        </Y>
        <Z>
         <Value>0.3</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </AmbientLight>
      <AmbientOn>true</AmbientOn>
      <DiffuseOn>false</DiffuseOn>
      <SpecularOn>false</SpecularOn>
     </Light>
     <Light>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Parallel</Name>
      <Position>
       <X>
        <Value>-3</Value>
       </X>
       <Y>
        <Value>5</Value>
       </Y>
       <Z>
        <Value>3</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <Value>0.457495710997814</Value>
        </X>
        <Y>
         <Value>-0.762492851663023</Value>
        </Y>
        <Z>
         <Value>-0.457495710997814</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <Value>0.235379601434674</Value>
        </X>
        <Y>
         <Value>-0.392299335724456</Value>
        </Y>
        <Z>
         <Value>0.889211827642101</Value>
        </Z>
       </YAxis>
       <OrientationType>Direct3D</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
      </Childs>
      <LightType>3</LightType>
      <LightColor>
       <Color>
        <X>
         <Value>0.5</Value>
        </X>
        <Y>
         <Value>0.5</Value>
        </Y>
        <Z>
         <Value>0.5</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </LightColor>
      <Attenuation>
       <Constant>
        <Value>1</Value>
       </Constant>
       <Linear>
        <Value>0</Value>
       </Linear>
       <Quadratic>
        <Value>0</Value>
       </Quadratic>
      </Attenuation>
      <DiffuseLight>
       <Color>
        <X>
         <Value>0.5</Value>
        </X>
        <Y>
         <Value>0.5</Value>
        </Y>
        <Z>
         <Value>0.5</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </DiffuseLight>
      <SpecularLight>
       <Color>
        <X>
         <Value>0.5</Value>
        </X>
        <Y>
         <Value>0.5</Value>
        </Y>
        <Z>
         <Value>0.5</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </SpecularLight>
      <AmbientOn>false</AmbientOn>
      <DiffuseOn>true</DiffuseOn>
      <SpecularOn>true</SpecularOn>
     </Light>
     <Light>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Spot Light 1</Name>
      <Position>
       <X>
        <Value>-3</Value>
       </X>
       <Y>
        <Value>-5</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <Value>0.50709255283711</Value>
        </X>
        <Y>
         <Value>0.845154254728517</Value>
        </Y>
        <Z>
         <Value>-0.169030850945703</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <Value>0.0869656553478671</Value>
        </X>
        <Y>
         <Value>0.144942758913112</Value>
        </Y>
        <Z>
         <Value>0.985610760609162</Value>
        </Z>
       </YAxis>
       <OrientationType>Direct3D</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
      </Childs>
      <LightType>2</LightType>
      <LightColor>
       <Color>
        <X>
         <Value>0.5</Value>
        </X>
        <Y>
         <Value>0.5</Value>
        </Y>
        <Z>
         <Value>0.5</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </LightColor>
      <Attenuation>
       <Constant>
        <Value>1</Value>
       </Constant>
       <Linear>
        <Value>0.05</Value>
       </Linear>
       <Quadratic>
        <Value>0.05</Value>
       </Quadratic>
      </Attenuation>
      <Umbra>
       <Value>1.0471975511966</Value>
      </Umbra>
      <Penumbra>
       <Value>1.0471975511966</Value>
      </Penumbra>
      <DiffuseLight>
       <Color>
        <X>
         <Value>0.5</Value>
        </X>
        <Y>
         <Value>0.5</Value>
        </Y>
        <Z>
         <Value>0.5</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </DiffuseLight>
      <SpecularLight>
       <Color>
        <X>
         <Value>0.5</Value>
        </X>
        <Y>
         <Value>0.5</Value>
        </Y>
        <Z>
         <Value>0.5</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </SpecularLight>
      <AmbientOn>false</AmbientOn>
      <DiffuseOn>true</DiffuseOn>
      <SpecularOn>true</SpecularOn>
     </Light>
     <Light>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Spot Light 2</Name>
      <Position>
       <X>
        <Value>2</Value>
       </X>
       <Y>
        <Value>-3</Value>
       </Y>
       <Z>
        <Value>-1</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <Value>-0.534522483824849</Value>
        </X>
        <Y>
         <Value>0.801783725737273</Value>
        </Y>
        <Z>
         <Value>0.267261241912424</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <Value>0.14824986333222</Value>
        </X>
        <Y>
         <Value>-0.22237479499833</Value>
        </Y>
        <Z>
         <Value>0.963624111659432</Value>
        </Z>
       </YAxis>
       <OrientationType>Direct3D</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
      </Childs>
      <LightType>2</LightType>
      <LightColor>
       <Color>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </LightColor>
      <Attenuation>
       <Constant>
        <Value>1</Value>
       </Constant>
       <Linear>
        <Value>0.05</Value>
       </Linear>
       <Quadratic>
        <Value>0.05</Value>
       </Quadratic>
      </Attenuation>
      <Umbra>
       <Value>1.5707963267949</Value>
      </Umbra>
      <Penumbra>
       <Value>1.5707963267949</Value>
      </Penumbra>
      <DiffuseLight>
       <Color>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </DiffuseLight>
      <SpecularLight>
       <Color>
        <X>
         <Value>0.5</Value>
        </X>
        <Y>
         <Value>0.5</Value>
        </Y>
        <Z>
         <Value>0.5</Value>
        </Z>
       </Color>
       <Offset>
       </Offset>
       <Multipliers>
        <X>
         <Value>1</Value>
        </X>
        <Y>
         <Value>1</Value>
        </Y>
        <Z>
         <Value>1</Value>
        </Z>
       </Multipliers>
       <Direct3DColorRange>true</Direct3DColorRange>
      </SpecularLight>
      <AmbientOn>false</AmbientOn>
      <DiffuseOn>true</DiffuseOn>
      <SpecularOn>true</SpecularOn>
     </Light>
     <Square>
      <CornerInOrigin>false</CornerInOrigin>
      <XLength>1</XLength>
      <YLength>1</YLength>
      <BothSides>true</BothSides>
      <Accuracy>4</Accuracy>
      <ScaleValue>
       <X>
        <Value>100</Value>
       </X>
       <Y>
        <Value>100</Value>
       </Y>
       <Z>
        <Value>10</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets>
      </MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.83921568627451</Value>
       </X>
       <Y>
        <Value>0.83921568627451</Value>
       </Y>
       <Z>
        <Value>0.83921568627451</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor>
      </EmissiveColor>
      <ShininessPower>
       <Value>0</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>z</Name>
      <Position>
       <X>
        <Value>3.4</Value>
       </X>
       <Y>
        <Value>2.7</Value>
       </Y>
      </Position>
      <Orientation>
       <Angles>
       </Angles>
       <OrientationType>Bryant</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
      </Childs>
     </Square>
     <Cylinder>
      <CircleElements>16</CircleElements>
      <LowerRadius>0.01</LowerRadius>
      <UpperRadius>0</UpperRadius>
      <Height>1</Height>
      <Closed>true</Closed>
      <LowerClosed>true</LowerClosed>
      <UpperClosed>true</UpperClosed>
      <CenterInOrigin>false</CenterInOrigin>
      <ShowInnerSide>false</ShowInnerSide>
      <ShowOuterSide>true</ShowOuterSide>
      <ScaleValue>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </ScaleValue>
      <OverrideColor>true</OverrideColor>
      <MeshColor>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>0</Value>
       </Y>
       <Z>
        <Value>0</Value>
       </Z>
      </MeshColor>
      <Alpha>1</Alpha>
      <MeshColorMultipliers>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </MeshColorMultipliers>
      <MeshColorOffsets>
      </MeshColorOffsets>
      <Direct3DColorRange>true</Direct3DColorRange>
      <SpecularColor>
       <X>
        <Value>0.5</Value>
       </X>
       <Y>
        <Value>0.5</Value>
       </Y>
       <Z>
        <Value>0.5</Value>
       </Z>
      </SpecularColor>
      <EmissiveColor>
      </EmissiveColor>
      <ShininessPower>
       <Value>15</Value>
      </ShininessPower>
      <OverrideQuality>false</OverrideQuality>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Cylinder</Name>
      <Position>
       <X>
        <VariableName>model\VirtualPosition\output[1,4]</VariableName>
        <Value>3</Value>
       </X>
       <Y>
        <VariableName>model\VirtualPosition\output[2,4]</VariableName>
        <Value>3</Value>
       </Y>
       <Z>
        <VariableName>model\VirtualPosition\output[3,4]</VariableName>
        <Value>0.25</Value>
       </Z>
      </Position>
      <Orientation>
       <ZAxis>
        <X>
         <VariableName>model\VirtualPosition\output[1,3]</VariableName>
         <Value>1</Value>
        </X>
        <Y>
         <VariableName>model\VirtualPosition\output[2,3]</VariableName>
         <Value>0</Value>
        </Y>
        <Z>
         <VariableName>model\VirtualPosition\output[3,3]</VariableName>
         <Value>1.11022302462516e-016</Value>
        </Z>
       </ZAxis>
       <YAxis>
        <X>
         <VariableName>model\VirtualPosition\output[1,2]</VariableName>
         <Value>-0</Value>
        </X>
        <Y>
         <VariableName>model\VirtualPosition\output[2,2]</VariableName>
         <Value>1</Value>
        </Y>
        <Z>
         <VariableName>model\VirtualPosition\output[3,2]</VariableName>
         <Value>0</Value>
        </Z>
       </YAxis>
       <OrientationType>Matrix</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
      </Childs>
     </Cylinder>
         </Childs>
        </Frame>
        <Camera>
         <ShowReferenceFrame>false</ShowReferenceFrame>
         <Name>Camera</Name>
         <Position>
     <X>
      <Value>0.439151249912682</Value>
     </X>
     <Y>
      <Value>-6.37483845743166</Value>
     </Y>
     <Z>
      <Value>0.438110508543546</Value>
     </Z>
         </Position>
         <Orientation>
     <ZAxis>
      <X>
       <Value>0.885311347919952</Value>
      </X>
      <Y>
       <Value>0.341668817110584</Value>
      </Y>
      <Z>
       <Value>-0.315414388794189</Value>
      </Z>
     </ZAxis>
     <YAxis>
      <X>
       <Value>0.294260761811072</Value>
      </X>
      <Y>
       <Value>0.113564258095491</Value>
      </Y>
      <Z>
       <Value>0.94895403647468</Value>
      </Z>
     </YAxis>
     <OrientationType>Direct3D</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
         </Childs>
         <FrontPlane>0.01</FrontPlane>
         <BackPlane>100</BackPlane>
         <Field>0.00392699081698724</Field>
         <Fieldy>45</Fieldy>
         <PlaneLeft>-10</PlaneLeft>
         <PlaneRight>10</PlaneRight>
         <PlaneTop>10</PlaneTop>
         <PlaneBottom>-10</PlaneBottom>
         <UseLookatPosition>true</UseLookatPosition>
         <LookatPosition>
     <X>
      <Value>4.95337108856183</Value>
     </X>
     <Y>
      <Value>-4.63266249179855</Value>
     </Y>
     <Z>
      <Value>-1.17019361478603</Value>
     </Z>
         </LookatPosition>
         <UseAlwaysLookUp>true</UseAlwaysLookUp>
         <LookUpVector>
     <Z>
      <Value>1</Value>
     </Z>
         </LookUpVector>
         <RightHand>true</RightHand>
         <Perspective>true</Perspective>
         <IsSelectedCamera>false</IsSelectedCamera>
        </Camera>
        <Frame>
         <ScaleValue>
     <X>
      <Value>1</Value>
     </X>
     <Y>
      <Value>1</Value>
     </Y>
     <Z>
      <Value>1</Value>
     </Z>
         </ScaleValue>
         <ShowReferenceFrame>false</ShowReferenceFrame>
         <Name>default lights and camera</Name>
         <SceneryFileName>E:\My Dropbox\Studie en werk\UTwente\Master project\Modelling\Models\default lights and camera.scn</SceneryFileName>
         <Position>
         </Position>
         <Orientation>
     <Angles>
     </Angles>
     <OrientationType>Bryant</OrientationType>
         </Orientation>
         <LockX>false</LockX>
         <LockY>false</LockY>
         <LockZ>false</LockZ>
         <LockXPitch>false</LockXPitch>
         <LockYYaw>false</LockYYaw>
         <LockZRoll>false</LockZRoll>
         <Childs>
     <Frame>
      <ScaleValue>
       <X>
        <Value>1</Value>
       </X>
       <Y>
        <Value>1</Value>
       </Y>
       <Z>
        <Value>1</Value>
       </Z>
      </ScaleValue>
      <ShowReferenceFrame>false</ShowReferenceFrame>
      <Name>Default Lights and Cameras</Name>
      <Position>
      </Position>
      <Orientation>
       <Angles>
       </Angles>
       <OrientationType>Bryant</OrientationType>
      </Orientation>
      <LockX>false</LockX>
      <LockY>false</LockY>
      <LockZ>false</LockZ>
      <LockXPitch>false</LockXPitch>
      <LockYYaw>false</LockYYaw>
      <LockZRoll>false</LockZRoll>
      <Childs>
       <Camera>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Camera Looking at Origin</Name>
        <Position>
         <X>
     <Value>7.08215008404679</Value>
         </X>
         <Y>
     <Value>6.6370422185346</Value>
         </Y>
         <Z>
     <Value>1.3389625746917</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <Value>-0.722818916155153</Value>
     </X>
     <Y>
      <Value>-0.67739028486331</Value>
     </Y>
     <Z>
      <Value>-0.136657295528245</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <X>
      <Value>-0.099713956242438</Value>
     </X>
     <Y>
      <Value>-0.0934470082537438</Value>
     </Y>
     <Z>
      <Value>0.99061838443414</Value>
     </Z>
         </YAxis>
         <OrientationType>Direct3D</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
        <FrontPlane>0.01</FrontPlane>
        <BackPlane>100</BackPlane>
        <Field>0.00392699081698724</Field>
        <Fieldy>45</Fieldy>
        <PlaneLeft>-10</PlaneLeft>
        <PlaneRight>10</PlaneRight>
        <PlaneTop>10</PlaneTop>
        <PlaneBottom>-10</PlaneBottom>
        <UseLookatPosition>true</UseLookatPosition>
        <LookatPosition>
        </LookatPosition>
        <UseAlwaysLookUp>true</UseAlwaysLookUp>
        <LookUpVector>
         <Z>
     <Value>1</Value>
         </Z>
        </LookUpVector>
        <RightHand>true</RightHand>
        <Perspective>true</Perspective>
        <IsSelectedCamera>true</IsSelectedCamera>
       </Camera>
       <Camera>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Front(XY)-Camera</Name>
        <Position>
         <Z>
     <Value>10</Value>
         </Z>
        </Position>
        <Orientation>
         <ZAxis>
     <Z>
      <Value>-1</Value>
     </Z>
         </ZAxis>
         <YAxis>
     <Y>
      <Value>1</Value>
     </Y>
         </YAxis>
         <OrientationType>Direct3D</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
        <FrontPlane>0.01</FrontPlane>
        <BackPlane>100</BackPlane>
        <Field>10</Field>
        <Fieldy>45</Fieldy>
        <PlaneLeft>-10</PlaneLeft>
        <PlaneRight>10</PlaneRight>
        <PlaneTop>10</PlaneTop>
        <PlaneBottom>-10</PlaneBottom>
        <UseLookatPosition>true</UseLookatPosition>
        <LookatPosition>
        </LookatPosition>
        <UseAlwaysLookUp>true</UseAlwaysLookUp>
        <LookUpVector>
         <Y>
     <Value>1</Value>
         </Y>
        </LookUpVector>
        <RightHand>true</RightHand>
        <Perspective>false</Perspective>
        <IsSelectedCamera>false</IsSelectedCamera>
       </Camera>
       <Camera>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Side(YZ)-Camera</Name>
        <Position>
         <X>
     <Value>10</Value>
         </X>
        </Position>
        <Orientation>
         <ZAxis>
     <X>
      <Value>-1</Value>
     </X>
         </ZAxis>
         <YAxis>
     <Z>
      <Value>1</Value>
     </Z>
         </YAxis>
         <OrientationType>Direct3D</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
        <FrontPlane>0.01</FrontPlane>
        <BackPlane>100</BackPlane>
        <Field>10</Field>
        <Fieldy>45</Fieldy>
        <PlaneLeft>-10</PlaneLeft>
        <PlaneRight>10</PlaneRight>
        <PlaneTop>10</PlaneTop>
        <PlaneBottom>-10</PlaneBottom>
        <UseLookatPosition>true</UseLookatPosition>
        <LookatPosition>
        </LookatPosition>
        <UseAlwaysLookUp>true</UseAlwaysLookUp>
        <LookUpVector>
         <Z>
     <Value>1</Value>
         </Z>
        </LookUpVector>
        <RightHand>true</RightHand>
        <Perspective>false</Perspective>
        <IsSelectedCamera>false</IsSelectedCamera>
       </Camera>
       <Camera>
        <ShowReferenceFrame>false</ShowReferenceFrame>
        <Name>Top(XZ)-Camera</Name>
        <Position>
         <Y>
     <Value>10</Value>
         </Y>
        </Position>
        <Orientation>
         <ZAxis>
     <Y>
      <Value>-1</Value>
     </Y>
         </ZAxis>
         <YAxis>
     <X>
      <Value>1</Value>
     </X>
         </YAxis>
         <OrientationType>Direct3D</OrientationType>
        </Orientation>
        <LockX>false</LockX>
        <LockY>false</LockY>
        <LockZ>false</LockZ>
        <LockXPitch>false</LockXPitch>
        <LockYYaw>false</LockYYaw>
        <LockZRoll>false</LockZRoll>
        <Childs>
        </Childs>
        <FrontPlane>0.01</FrontPlane>
        <BackPlane>100</BackPlane>
        <Field>10</Field>
        <Fieldy>45</Fieldy>
        <PlaneLeft>-10</PlaneLeft>
        <PlaneRight>10</PlaneRight>
        <PlaneTop>10</PlaneTop>
        <PlaneBottom>-10</PlaneBottom>
        <UseLookatPosition>true</UseLookatPosition>
        <LookatPosition>
        </LookatPosition>
        <UseAlwaysLookUp>true</UseAlwaysLookUp>
        <LookUpVector>
         <X>
     <Value>1</Value>
         </X>
        </LookUpVector>
        <RightHand>true</RightHand>
        <Perspective>false</Perspective>
        <IsSelectedCamera>false</IsSelectedCamera>
       </Camera>
      </Childs>
     </Frame>
         </Childs>
        </Frame>
       </Childs>
      </Frame>
     </MainFrame>
    </Plot>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <UseWindowsBGColor>true</UseWindowsBGColor>
       <BGColor>13160660</BGColor>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>true</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>Brake status</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>30</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-0.4</Minimum>
       <Maximum>1.6</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label></Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\X0\condition[2]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\X0\condition[3]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\X0\condition[4]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\X0\condition[5]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\X0\condition[6]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\X0\condition[7]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\X0\condition[8]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\X0\condition[9]</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>16711680</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16711680</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\X0\condition[1]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>16711935</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16711935</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\X0\condition[2]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>255</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>255</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\X0\condition[3]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>65280</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>65280</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\X0\condition[4]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>0</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>0</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\X0\condition[5]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>10040319</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>10040319</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\X0\condition[6]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>16763904</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16763904</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\X0\condition[7]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>26367</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>26367</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\X0\condition[8]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>3368448</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>3368448</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\X0\condition[9]</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
     </Legenda>
     <StripChartPlots>
      <DistributState>2</DistributState>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
     </StripChartPlots>
    </Plot>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <UseWindowsBGColor>true</UseWindowsBGColor>
       <BGColor>13160660</BGColor>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>true</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>Residuals</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>-10</Minimum>
       <Maximum>40</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-8e-006</Minimum>
       <Maximum>1.2e-005</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label></Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\SignalMonitor\input[2]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\SignalMonitor\input[3]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\SignalMonitor\input[4]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\SignalMonitor\input[5]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\SignalMonitor\input[6]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\SignalMonitor\input[7]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\SignalMonitor\input[8]</Label>
      </Axis>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>10</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>model\SignalMonitor\input[9]</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>16711680</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16711680</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\SignalMonitor\input[1]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>16711935</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16711935</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\SignalMonitor\input[2]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>255</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>255</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\SignalMonitor\input[3]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>65280</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>65280</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\SignalMonitor\input[4]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>0</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>0</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\SignalMonitor\input[5]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>10040319</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>10040319</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\SignalMonitor\input[6]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>16763904</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16763904</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\SignalMonitor\input[7]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>26367</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>26367</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\SignalMonitor\input[8]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>3368448</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>3368448</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\SignalMonitor\input[9]</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
     </Legenda>
     <StripChartPlots>
      <DistributState>2</DistributState>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
     </StripChartPlots>
    </Plot>
    <Plot>
     <PlotType>GraphPlot</PlotType>
     <BasePlot>
       <UseWindowsBGColor>true</UseWindowsBGColor>
       <BGColor>13160660</BGColor>
     </BasePlot>
     <Grid>
      <DrawGrid>true</DrawGrid>
      <GridColor>15780518</GridColor>
      <XTicks>10</XTicks>
      <YTicks>10</YTicks>
      <ZTicks>10</ZTicks>
      <Use3DLook>false</Use3DLook>
     </Grid>
     <PlotBGColor>16777215</PlotBGColor>
     <ShowPlotTitle>true</ShowPlotTitle>
     <TitlePosition>1</TitlePosition>
     <PlotTitle>model</PlotTitle>
     <ShowXValues>true</ShowXValues>
     <Fonts>
      <TitleFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </TitleFont>
      <LabelFont>
       <Name>Arial</Name>
       <Height>12</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </LabelFont>
      <ValuesFont>
       <Name>Arial</Name>
       <Height>10</Height>
       <PitchFamily>34</PitchFamily>
       <Weight>400</Weight>
       <Italic>0</Italic>
       <UnderLine>0</UnderLine>
       <StrikeOut>0</StrikeOut>
       <Color>0</Color>
      </ValuesFont>
     </Fonts>
     <SharedXAxis>true</SharedXAxis>
     <SharedYAxis>true</SharedYAxis>
     <SharedZAxis>false</SharedZAxis>
     <XAxes>
      <Axis>
       <Minimum>0</Minimum>
       <Maximum>60</Maximum>
       <Linear>true</Linear>
       <Scaling>3</Scaling>
       <Label>time</Label>
      </Axis>
     </XAxes>
     <YAxes>
      <Axis>
       <Minimum>-350</Minimum>
       <Maximum>150</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>state[1,1]</Label>
      </Axis>
      <Axis>
       <Minimum>-0.8</Minimum>
       <Maximum>1.2</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>state[2,2]</Label>
      </Axis>
      <Axis>
       <Minimum>-0.8</Minimum>
       <Maximum>1.2</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>state[3,3]</Label>
      </Axis>
      <Axis>
       <Minimum>-0.8</Minimum>
       <Maximum>1.2</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>Wr[1]</Label>
      </Axis>
      <Axis>
       <Minimum>-0.8</Minimum>
       <Maximum>1.2</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>Wr[2]</Label>
      </Axis>
      <Axis>
       <Minimum>-0.8</Minimum>
       <Maximum>1.2</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>Wr[3]</Label>
      </Axis>
      <Axis>
       <Minimum>-0.8</Minimum>
       <Maximum>1.2</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>Wr[4]</Label>
      </Axis>
      <Axis>
       <Minimum>-0.8</Minimum>
       <Maximum>1.2</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>Wr[5]</Label>
      </Axis>
      <Axis>
       <Minimum>-0.8</Minimum>
       <Maximum>1.2</Maximum>
       <Linear>true</Linear>
       <Scaling>1</Scaling>
       <Label>Wr[6]</Label>
      </Axis>
     </YAxes>
     <ZAxes>
     </ZAxes>
     <Curves>
      <Curve>
       <LineColor>16711935</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16711935</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\CtipControl\state[1,1]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>255</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>255</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\CtipControl\state[2,2]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>65280</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>65280</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\CtipControl\state[3,3]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>0</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>0</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\CtipControl\Wr[1]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>10040319</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>10040319</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\CtipControl\Wr[2]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>16763904</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16763904</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\CtipControl\Wr[3]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>26367</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>26367</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\CtipControl\Wr[4]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>3368448</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>3368448</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\CtipControl\Wr[5]</VarName>
       </YCurveData>
      </Curve>
      <Curve>
       <LineColor>16764108</LineColor>
       <LineStyle>1</LineStyle>
       <TickColor>16764108</TickColor>
       <TickStyle>0</TickStyle>
       <PixelThresshold>1</PixelThresshold>
       <LineThickness>1</LineThickness>
       <LineOrder>1</LineOrder>
       <ShowYValues>true</ShowYValues>
       <XCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>time</VarName>
       </XCurveData>
       <YCurveData>
        <ShowUnit>true</ShowUnit>
        <VarName>model\CtipControl\Wr[6]</VarName>
       </YCurveData>
      </Curve>
     </Curves>
     <Legenda>
      <ShowLegenda>true</ShowLegenda>
     </Legenda>
     <StripChartPlots>
      <DistributState>2</DistributState>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
      <StripChartPlot>
       <Legenda>
        <ShowLegenda>true</ShowLegenda>
       </Legenda>
      </StripChartPlot>
     </StripChartPlots>
    </Plot>
   </Plots>
   <WindowRectangles virtualDesktopWidth="1680" virtualDesktopHeight="1028">
     <WindowRectangle monitor="0" left="0" top="0" right="1680" bottom="1028">
0.00357143 0.020428 0.767262 0.740272
     </WindowRectangle>
     <WindowRectangle monitor="0" left="0" top="0" right="1680" bottom="1028">
0.27619 0.174125 0.872024 0.910506
     </WindowRectangle>
     <WindowRectangle monitor="0" left="0" top="0" right="1680" bottom="1028">
0.00535714 0.0214008 0.747024 0.772374
     </WindowRectangle>
     <WindowRectangle monitor="0" left="0" top="0" right="1680" bottom="1028">
0.0142857 0.308366 1.00238 1.13716
     </WindowRectangle>
     <WindowRectangle monitor="0" left="0" top="0" right="1680" bottom="1028">
0.233929 0.0972763 0.843452 0.68677
     </WindowRectangle>
   </WindowRectangles>
  </PlotSpecs>
  <RunSpecs>
   <SimulatorSettings>
    <StartTime>0</StartTime>
    <FinishTime>30</FinishTime>
    <Warp>false</Warp>
    <UseOutputAfterEach>false</UseOutputAfterEach>
    <OutputAfterEach>0.1</OutputAfterEach>
    <EventEpsilon>1e-006</EventEpsilon>
    <AlgebraicTolerance>1e-007</AlgebraicTolerance>
    <SteadyStateAnalysis>false</SteadyStateAnalysis>
   </SimulatorSettings>
   <IntegrationMethods>
    <IntegrationMethod>
     <Name>Euler</Name>
     <StepSize>0.01</StepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>BackwardEuler</Name>
     <AbsoluteTolerance>1e-005</AbsoluteTolerance>
     <RelativeTolerance>1e-005</RelativeTolerance>
     <AlgebraicAbsoluteTolerance>1e-005</AlgebraicAbsoluteTolerance>
     <AlgebraicRelativeTolerance>1e-005</AlgebraicRelativeTolerance>
     <StepSize>0.01</StepSize>
     <Alpha>1</Alpha>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>AdamsBashforth</Name>
     <StepSize>0.01</StepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>RungeKutta2</Name>
     <StepSize>0.01</StepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>RungeKutta4</Name>
     <StepSize>1e-005</StepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>RungeKutta8</Name>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0</MaximumStepSize>
     <AbsoluteTolerance>1e-006</AbsoluteTolerance>
     <RelativeTolerance>1e-006</RelativeTolerance>
     <SafetyFactor>0.9</SafetyFactor>
     <Factor1>0.33</Factor1>
     <Factor2>6</Factor2>
     <Beta>0</Beta>
     <UseMaxNrSteps>false</UseMaxNrSteps>
     <MaxNrSteps>100000</MaxNrSteps>
     <UseStiffDetection>false</UseStiffDetection>
     <MaxNrStiffnessSteps>1000</MaxNrStiffnessSteps>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>RungeKuttaFehlberg</Name>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0</MaximumStepSize>
     <AbsoluteTolerance>1e-006</AbsoluteTolerance>
     <RelativeTolerance>1e-006</RelativeTolerance>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>VodeAdams</Name>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0</MaximumStepSize>
     <AbsoluteTolerance>1e-006</AbsoluteTolerance>
     <RelativeTolerance>1e-006</RelativeTolerance>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>BDFMethod</Name>
     <AbsoluteTolerance>1e-005</AbsoluteTolerance>
     <RelativeTolerance>1e-005</RelativeTolerance>
     <AlgebraicAbsoluteTolerance>1e-005</AlgebraicAbsoluteTolerance>
     <AlgebraicRelativeTolerance>1e-005</AlgebraicRelativeTolerance>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0</MaximumStepSize>
     <UseFixedStepSize>false</UseFixedStepSize>
     <FixedStepSize>0</FixedStepSize>
    </IntegrationMethod>
    <IntegrationMethod>
     <Name>MeBDFiMethod</Name>
     <AbsoluteTolerance>9e-005</AbsoluteTolerance>
     <RelativeTolerance>1e-005</RelativeTolerance>
     <AlgebraicAbsoluteTolerance>9e-005</AlgebraicAbsoluteTolerance>
     <AlgebraicRelativeTolerance>1e-005</AlgebraicRelativeTolerance>
     <UseInitialStepSize>false</UseInitialStepSize>
     <InitialStepSize>0</InitialStepSize>
     <UseMaximumStepSize>false</UseMaximumStepSize>
     <MaximumStepSize>0</MaximumStepSize>
     <UseFixedStepSize>false</UseFixedStepSize>
     <FixedStepSize>0</FixedStepSize>
    </IntegrationMethod>
    <SelectedIntegrationMethod>9</SelectedIntegrationMethod>
   </IntegrationMethods>
  </RunSpecs>
  <MultipleRun>
   <NrSteps>10</NrSteps>
   <CopyFromStates>false</CopyFromStates>
   <JoinParameterVariation>true</JoinParameterVariation>
   <ClearAfterRun>true</ClearAfterRun>
   <RedrawAfterRun>false</RedrawAfterRun>
   <DrawDuringSimulation>true</DrawDuringSimulation>
   <ActionBeforeOptimization>0</ActionBeforeOptimization>
   <CompareValue>0</CompareValue>
   <UseCompareValue>true</UseCompareValue>
   <MultipleRunType>MultipleRun</MultipleRunType>
   <Minimize>true</Minimize>
   <OptimizationVariable></OptimizationVariable>
   <ResulVarUsage>UseEndValue</ResulVarUsage>
   <Tolerance>0.001</Tolerance>
   <OptimizationMethod>BroydonFletcherGoldfarbShanno</OptimizationMethod>
   <MultipleRunVariables>
   </MultipleRunVariables>
  </MultipleRun>
  <ExportData>
   <WriteAsText>true</WriteAsText>
   <ReadAsText>true</ReadAsText>
   <WriteHeader>true</WriteHeader>
   <ReadHeader>true</ReadHeader>
   <ReadFilename></ReadFilename>
   <WriteFilename></WriteFilename>
   <DoWrite>false</DoWrite>
   <ExportVariables>
   </ExportVariables>
   <ImportVariables>
   </ImportVariables>
  </ExportData>
  <BreakPoints>
  </BreakPoints>
  <AnimationPlayback>
   <PlaybackSpeed>1</PlaybackSpeed>
  </AnimationPlayback>
</ExpData>
  </Experiment>
</Experiments>
</Document>
